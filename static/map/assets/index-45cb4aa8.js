var WR=Object.defineProperty;var HR=(t,e,n)=>e in t?WR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var T=(t,e,n)=>(HR(t,typeof e!="symbol"?e+"":e,n),n);function XR(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var jV=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lf(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Tw={exports:{}},ee={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ka=Symbol.for("react.element"),YR=Symbol.for("react.portal"),KR=Symbol.for("react.fragment"),qR=Symbol.for("react.strict_mode"),ZR=Symbol.for("react.profiler"),QR=Symbol.for("react.provider"),JR=Symbol.for("react.context"),GR=Symbol.for("react.forward_ref"),ex=Symbol.for("react.suspense"),tx=Symbol.for("react.memo"),nx=Symbol.for("react.lazy"),ty=Symbol.iterator;function rx(t){return t===null||typeof t!="object"?null:(t=ty&&t[ty]||t["@@iterator"],typeof t=="function"?t:null)}var ww={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Sw=Object.assign,Ew={};function Xs(t,e,n){this.props=t,this.context=e,this.refs=Ew,this.updater=n||ww}Xs.prototype.isReactComponent={};Xs.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Xs.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function bw(){}bw.prototype=Xs.prototype;function Ug(t,e,n){this.props=t,this.context=e,this.refs=Ew,this.updater=n||ww}var zg=Ug.prototype=new bw;zg.constructor=Ug;Sw(zg,Xs.prototype);zg.isPureReactComponent=!0;var ny=Array.isArray,Aw=Object.prototype.hasOwnProperty,$g={current:null},Rw={key:!0,ref:!0,__self:!0,__source:!0};function xw(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)Aw.call(e,r)&&!Rw.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:ka,type:t,key:s,ref:o,props:i,_owner:$g.current}}function ix(t,e){return{$$typeof:ka,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Vg(t){return typeof t=="object"&&t!==null&&t.$$typeof===ka}function sx(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var ry=/\/+/g;function uh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?sx(""+t.key):e.toString(36)}function tc(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ka:case YR:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+uh(o,0):r,ny(i)?(n="",t!=null&&(n=t.replace(ry,"$&/")+"/"),tc(i,e,n,"",function(c){return c})):i!=null&&(Vg(i)&&(i=ix(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(ry,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",ny(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+uh(s,a);o+=tc(s,e,n,l,i)}else if(l=rx(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+uh(s,a++),o+=tc(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function ul(t,e,n){if(t==null)return t;var r=[],i=0;return tc(t,r,"","",function(s){return e.call(n,s,i++)}),r}function ox(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ct={current:null},nc={transition:null},ax={ReactCurrentDispatcher:ct,ReactCurrentBatchConfig:nc,ReactCurrentOwner:$g};function Cw(){throw Error("act(...) is not supported in production builds of React.")}ee.Children={map:ul,forEach:function(t,e,n){ul(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ul(t,function(){e++}),e},toArray:function(t){return ul(t,function(e){return e})||[]},only:function(t){if(!Vg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ee.Component=Xs;ee.Fragment=KR;ee.Profiler=ZR;ee.PureComponent=Ug;ee.StrictMode=qR;ee.Suspense=ex;ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ax;ee.act=Cw;ee.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Sw({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=$g.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)Aw.call(e,l)&&!Rw.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:ka,type:t.type,key:i,ref:s,props:r,_owner:o}};ee.createContext=function(t){return t={$$typeof:JR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:QR,_context:t},t.Consumer=t};ee.createElement=xw;ee.createFactory=function(t){var e=xw.bind(null,t);return e.type=t,e};ee.createRef=function(){return{current:null}};ee.forwardRef=function(t){return{$$typeof:GR,render:t}};ee.isValidElement=Vg;ee.lazy=function(t){return{$$typeof:nx,_payload:{_status:-1,_result:t},_init:ox}};ee.memo=function(t,e){return{$$typeof:tx,type:t,compare:e===void 0?null:e}};ee.startTransition=function(t){var e=nc.transition;nc.transition={};try{t()}finally{nc.transition=e}};ee.unstable_act=Cw;ee.useCallback=function(t,e){return ct.current.useCallback(t,e)};ee.useContext=function(t){return ct.current.useContext(t)};ee.useDebugValue=function(){};ee.useDeferredValue=function(t){return ct.current.useDeferredValue(t)};ee.useEffect=function(t,e){return ct.current.useEffect(t,e)};ee.useId=function(){return ct.current.useId()};ee.useImperativeHandle=function(t,e,n){return ct.current.useImperativeHandle(t,e,n)};ee.useInsertionEffect=function(t,e){return ct.current.useInsertionEffect(t,e)};ee.useLayoutEffect=function(t,e){return ct.current.useLayoutEffect(t,e)};ee.useMemo=function(t,e){return ct.current.useMemo(t,e)};ee.useReducer=function(t,e,n){return ct.current.useReducer(t,e,n)};ee.useRef=function(t){return ct.current.useRef(t)};ee.useState=function(t){return ct.current.useState(t)};ee.useSyncExternalStore=function(t,e,n){return ct.current.useSyncExternalStore(t,e,n)};ee.useTransition=function(){return ct.current.useTransition()};ee.version="18.3.1";Tw.exports=ee;var M=Tw.exports;const te=lf(M);var ht=function(){return ht=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},ht.apply(this,arguments)};function Cc(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var _e="-ms-",Oo="-moz-",ae="-webkit-",Pw="comm",cf="rule",jg="decl",lx="@import",Iw="@keyframes",cx="@layer",Mw=Math.abs,Wg=String.fromCharCode,Dd=Object.assign;function ux(t,e){return $e(t,0)^45?(((e<<2^$e(t,0))<<2^$e(t,1))<<2^$e(t,2))<<2^$e(t,3):0}function Nw(t){return t.trim()}function kn(t,e){return(t=e.exec(t))?t[0]:t}function Q(t,e,n){return t.replace(e,n)}function rc(t,e,n){return t.indexOf(e,n)}function $e(t,e){return t.charCodeAt(e)|0}function Ss(t,e,n){return t.slice(e,n)}function _n(t){return t.length}function kw(t){return t.length}function bo(t,e){return e.push(t),t}function fx(t,e){return t.map(e).join("")}function iy(t,e){return t.filter(function(n){return!kn(n,e)})}var uf=1,Es=1,Ow=0,Lt=0,Ne=0,Ys="";function ff(t,e,n,r,i,s,o,a){return{value:t,root:e,parent:n,type:r,props:i,children:s,line:uf,column:Es,length:o,return:"",siblings:a}}function ir(t,e){return Dd(ff("",null,null,"",null,null,0,t.siblings),t,{length:-t.length},e)}function Ci(t){for(;t.root;)t=ir(t.root,{children:[t]});bo(t,t.siblings)}function hx(){return Ne}function dx(){return Ne=Lt>0?$e(Ys,--Lt):0,Es--,Ne===10&&(Es=1,uf--),Ne}function Jt(){return Ne=Lt<Ow?$e(Ys,Lt++):0,Es++,Ne===10&&(Es=1,uf++),Ne}function ri(){return $e(Ys,Lt)}function ic(){return Lt}function hf(t,e){return Ss(Ys,t,e)}function Bd(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function px(t){return uf=Es=1,Ow=_n(Ys=t),Lt=0,[]}function gx(t){return Ys="",t}function fh(t){return Nw(hf(Lt-1,Ld(t===91?t+2:t===40?t+1:t)))}function _x(t){for(;(Ne=ri())&&Ne<33;)Jt();return Bd(t)>2||Bd(Ne)>3?"":" "}function mx(t,e){for(;--e&&Jt()&&!(Ne<48||Ne>102||Ne>57&&Ne<65||Ne>70&&Ne<97););return hf(t,ic()+(e<6&&ri()==32&&Jt()==32))}function Ld(t){for(;Jt();)switch(Ne){case t:return Lt;case 34:case 39:t!==34&&t!==39&&Ld(Ne);break;case 40:t===41&&Ld(t);break;case 92:Jt();break}return Lt}function yx(t,e){for(;Jt()&&t+Ne!==47+10;)if(t+Ne===42+42&&ri()===47)break;return"/*"+hf(e,Lt-1)+"*"+Wg(t===47?t:Jt())}function vx(t){for(;!Bd(ri());)Jt();return hf(t,Lt)}function Tx(t){return gx(sc("",null,null,null,[""],t=px(t),0,[0],t))}function sc(t,e,n,r,i,s,o,a,l){for(var c=0,u=0,f=o,h=0,d=0,g=0,_=1,b=1,m=1,p=0,y="",w=i,A=s,x=r,I=y;b;)switch(g=p,p=Jt()){case 40:if(g!=108&&$e(I,f-1)==58){rc(I+=Q(fh(p),"&","&\f"),"&\f",Mw(c?a[c-1]:0))!=-1&&(m=-1);break}case 34:case 39:case 91:I+=fh(p);break;case 9:case 10:case 13:case 32:I+=_x(g);break;case 92:I+=mx(ic()-1,7);continue;case 47:switch(ri()){case 42:case 47:bo(wx(yx(Jt(),ic()),e,n,l),l);break;default:I+="/"}break;case 123*_:a[c++]=_n(I)*m;case 125*_:case 59:case 0:switch(p){case 0:case 125:b=0;case 59+u:m==-1&&(I=Q(I,/\f/g,"")),d>0&&_n(I)-f&&bo(d>32?oy(I+";",r,n,f-1,l):oy(Q(I," ","")+";",r,n,f-2,l),l);break;case 59:I+=";";default:if(bo(x=sy(I,e,n,c,u,i,a,y,w=[],A=[],f,s),s),p===123)if(u===0)sc(I,e,x,x,w,s,f,a,A);else switch(h===99&&$e(I,3)===110?100:h){case 100:case 108:case 109:case 115:sc(t,x,x,r&&bo(sy(t,x,x,0,0,i,a,y,i,w=[],f,A),A),i,A,f,a,r?w:A);break;default:sc(I,x,x,x,[""],A,0,a,A)}}c=u=d=0,_=m=1,y=I="",f=o;break;case 58:f=1+_n(I),d=g;default:if(_<1){if(p==123)--_;else if(p==125&&_++==0&&dx()==125)continue}switch(I+=Wg(p),p*_){case 38:m=u>0?1:(I+="\f",-1);break;case 44:a[c++]=(_n(I)-1)*m,m=1;break;case 64:ri()===45&&(I+=fh(Jt())),h=ri(),u=f=_n(y=I+=vx(ic())),p++;break;case 45:g===45&&_n(I)==2&&(_=0)}}return s}function sy(t,e,n,r,i,s,o,a,l,c,u,f){for(var h=i-1,d=i===0?s:[""],g=kw(d),_=0,b=0,m=0;_<r;++_)for(var p=0,y=Ss(t,h+1,h=Mw(b=o[_])),w=t;p<g;++p)(w=Nw(b>0?d[p]+" "+y:Q(y,/&\f/g,d[p])))&&(l[m++]=w);return ff(t,e,n,i===0?cf:a,l,c,u,f)}function wx(t,e,n,r){return ff(t,e,n,Pw,Wg(hx()),Ss(t,2,-2),0,r)}function oy(t,e,n,r,i){return ff(t,e,n,jg,Ss(t,0,r),Ss(t,r+1,-1),r,i)}function Fw(t,e,n){switch(ux(t,e)){case 5103:return ae+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return ae+t+t;case 4789:return Oo+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return ae+t+Oo+t+_e+t+t;case 5936:switch($e(t,e+11)){case 114:return ae+t+_e+Q(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return ae+t+_e+Q(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return ae+t+_e+Q(t,/[svh]\w+-[tblr]{2}/,"lr")+t}case 6828:case 4268:case 2903:return ae+t+_e+t+t;case 6165:return ae+t+_e+"flex-"+t+t;case 5187:return ae+t+Q(t,/(\w+).+(:[^]+)/,ae+"box-$1$2"+_e+"flex-$1$2")+t;case 5443:return ae+t+_e+"flex-item-"+Q(t,/flex-|-self/g,"")+(kn(t,/flex-|baseline/)?"":_e+"grid-row-"+Q(t,/flex-|-self/g,""))+t;case 4675:return ae+t+_e+"flex-line-pack"+Q(t,/align-content|flex-|-self/g,"")+t;case 5548:return ae+t+_e+Q(t,"shrink","negative")+t;case 5292:return ae+t+_e+Q(t,"basis","preferred-size")+t;case 6060:return ae+"box-"+Q(t,"-grow","")+ae+t+_e+Q(t,"grow","positive")+t;case 4554:return ae+Q(t,/([^-])(transform)/g,"$1"+ae+"$2")+t;case 6187:return Q(Q(Q(t,/(zoom-|grab)/,ae+"$1"),/(image-set)/,ae+"$1"),t,"")+t;case 5495:case 3959:return Q(t,/(image-set\([^]*)/,ae+"$1$`$1");case 4968:return Q(Q(t,/(.+:)(flex-)?(.*)/,ae+"box-pack:$3"+_e+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+ae+t+t;case 4200:if(!kn(t,/flex-|baseline/))return _e+"grid-column-align"+Ss(t,e)+t;break;case 2592:case 3360:return _e+Q(t,"template-","")+t;case 4384:case 3616:return n&&n.some(function(r,i){return e=i,kn(r.props,/grid-\w+-end/)})?~rc(t+(n=n[e].value),"span",0)?t:_e+Q(t,"-start","")+t+_e+"grid-row-span:"+(~rc(n,"span",0)?kn(n,/\d+/):+kn(n,/\d+/)-+kn(t,/\d+/))+";":_e+Q(t,"-start","")+t;case 4896:case 4128:return n&&n.some(function(r){return kn(r.props,/grid-\w+-start/)})?t:_e+Q(Q(t,"-end","-span"),"span ","")+t;case 4095:case 3583:case 4068:case 2532:return Q(t,/(.+)-inline(.+)/,ae+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(_n(t)-1-e>6)switch($e(t,e+1)){case 109:if($e(t,e+4)!==45)break;case 102:return Q(t,/(.+:)(.+)-([^]+)/,"$1"+ae+"$2-$3$1"+Oo+($e(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~rc(t,"stretch",0)?Fw(Q(t,"stretch","fill-available"),e,n)+t:t}break;case 5152:case 5920:return Q(t,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(r,i,s,o,a,l,c){return _e+i+":"+s+c+(o?_e+i+"-span:"+(a?l:+l-+s)+c:"")+t});case 4949:if($e(t,e+6)===121)return Q(t,":",":"+ae)+t;break;case 6444:switch($e(t,$e(t,14)===45?18:11)){case 120:return Q(t,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+ae+($e(t,14)===45?"inline-":"")+"box$3$1"+ae+"$2$3$1"+_e+"$2box$3")+t;case 100:return Q(t,":",":"+_e)+t}break;case 5719:case 2647:case 2135:case 3927:case 2391:return Q(t,"scroll-","scroll-snap-")+t}return t}function Pc(t,e){for(var n="",r=0;r<t.length;r++)n+=e(t[r],r,t,e)||"";return n}function Sx(t,e,n,r){switch(t.type){case cx:if(t.children.length)break;case lx:case jg:return t.return=t.return||t.value;case Pw:return"";case Iw:return t.return=t.value+"{"+Pc(t.children,r)+"}";case cf:if(!_n(t.value=t.props.join(",")))return""}return _n(n=Pc(t.children,r))?t.return=t.value+"{"+n+"}":""}function Ex(t){var e=kw(t);return function(n,r,i,s){for(var o="",a=0;a<e;a++)o+=t[a](n,r,i,s)||"";return o}}function bx(t){return function(e){e.root||(e=e.return)&&t(e)}}function Ax(t,e,n,r){if(t.length>-1&&!t.return)switch(t.type){case jg:t.return=Fw(t.value,t.length,n);return;case Iw:return Pc([ir(t,{value:Q(t.value,"@","@"+ae)})],r);case cf:if(t.length)return fx(n=t.props,function(i){switch(kn(i,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":Ci(ir(t,{props:[Q(i,/:(read-\w+)/,":"+Oo+"$1")]})),Ci(ir(t,{props:[i]})),Dd(t,{props:iy(n,r)});break;case"::placeholder":Ci(ir(t,{props:[Q(i,/:(plac\w+)/,":"+ae+"input-$1")]})),Ci(ir(t,{props:[Q(i,/:(plac\w+)/,":"+Oo+"$1")]})),Ci(ir(t,{props:[Q(i,/:(plac\w+)/,_e+"input-$1")]})),Ci(ir(t,{props:[i]})),Dd(t,{props:iy(n,r)});break}return""})}}var Rx={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},bs=typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_ATTR||{}.SC_ATTR)||"data-styled",Dw="active",Bw="data-styled-version",df="6.1.13",Hg=`/*!sc*/
`,Ic=typeof window<"u"&&"HTMLElement"in window,xx=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==""?{}.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&{}.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&{}.SC_DISABLE_SPEEDY!==void 0&&{}.SC_DISABLE_SPEEDY!==""&&{}.SC_DISABLE_SPEEDY!=="false"&&{}.SC_DISABLE_SPEEDY),pf=Object.freeze([]),As=Object.freeze({});function Cx(t,e,n){return n===void 0&&(n=As),t.theme!==n.theme&&t.theme||e||n.theme}var Lw=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),Px=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,Ix=/(^-|-$)/g;function ay(t){return t.replace(Px,"-").replace(Ix,"")}var Mx=/(a)(d)/gi,fl=52,ly=function(t){return String.fromCharCode(t+(t>25?39:97))};function Ud(t){var e,n="";for(e=Math.abs(t);e>fl;e=e/fl|0)n=ly(e%fl)+n;return(ly(e%fl)+n).replace(Mx,"$1-$2")}var hh,Uw=5381,ji=function(t,e){for(var n=e.length;n;)t=33*t^e.charCodeAt(--n);return t},zw=function(t){return ji(Uw,t)};function Nx(t){return Ud(zw(t)>>>0)}function kx(t){return t.displayName||t.name||"Component"}function dh(t){return typeof t=="string"&&!0}var $w=typeof Symbol=="function"&&Symbol.for,Vw=$w?Symbol.for("react.memo"):60115,Ox=$w?Symbol.for("react.forward_ref"):60112,Fx={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Dx={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},jw={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Bx=((hh={})[Ox]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},hh[Vw]=jw,hh);function cy(t){return("type"in(e=t)&&e.type.$$typeof)===Vw?jw:"$$typeof"in t?Bx[t.$$typeof]:Fx;var e}var Lx=Object.defineProperty,Ux=Object.getOwnPropertyNames,uy=Object.getOwnPropertySymbols,zx=Object.getOwnPropertyDescriptor,$x=Object.getPrototypeOf,fy=Object.prototype;function Ww(t,e,n){if(typeof e!="string"){if(fy){var r=$x(e);r&&r!==fy&&Ww(t,r,n)}var i=Ux(e);uy&&(i=i.concat(uy(e)));for(var s=cy(t),o=cy(e),a=0;a<i.length;++a){var l=i[a];if(!(l in Dx||n&&n[l]||o&&l in o||s&&l in s)){var c=zx(e,l);try{Lx(t,l,c)}catch{}}}}return t}function Rs(t){return typeof t=="function"}function Xg(t){return typeof t=="object"&&"styledComponentId"in t}function Zr(t,e){return t&&e?"".concat(t," ").concat(e):t||e||""}function hy(t,e){if(t.length===0)return"";for(var n=t[0],r=1;r<t.length;r++)n+=e?e+t[r]:t[r];return n}function Go(t){return t!==null&&typeof t=="object"&&t.constructor.name===Object.name&&!("props"in t&&t.$$typeof)}function zd(t,e,n){if(n===void 0&&(n=!1),!n&&!Go(t)&&!Array.isArray(t))return e;if(Array.isArray(e))for(var r=0;r<e.length;r++)t[r]=zd(t[r],e[r]);else if(Go(e))for(var r in e)t[r]=zd(t[r],e[r]);return t}function Yg(t,e){Object.defineProperty(t,"toString",{value:e})}function Oa(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(t," for more information.").concat(e.length>0?" Args: ".concat(e.join(", ")):""))}var Vx=function(){function t(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}return t.prototype.indexOfGroup=function(e){for(var n=0,r=0;r<e;r++)n+=this.groupSizes[r];return n},t.prototype.insertRules=function(e,n){if(e>=this.groupSizes.length){for(var r=this.groupSizes,i=r.length,s=i;e>=s;)if((s<<=1)<0)throw Oa(16,"".concat(e));this.groupSizes=new Uint32Array(s),this.groupSizes.set(r),this.length=s;for(var o=i;o<s;o++)this.groupSizes[o]=0}for(var a=this.indexOfGroup(e+1),l=(o=0,n.length);o<l;o++)this.tag.insertRule(a,n[o])&&(this.groupSizes[e]++,a++)},t.prototype.clearGroup=function(e){if(e<this.length){var n=this.groupSizes[e],r=this.indexOfGroup(e),i=r+n;this.groupSizes[e]=0;for(var s=r;s<i;s++)this.tag.deleteRule(r)}},t.prototype.getGroup=function(e){var n="";if(e>=this.length||this.groupSizes[e]===0)return n;for(var r=this.groupSizes[e],i=this.indexOfGroup(e),s=i+r,o=i;o<s;o++)n+="".concat(this.tag.getRule(o)).concat(Hg);return n},t}(),oc=new Map,Mc=new Map,ac=1,hl=function(t){if(oc.has(t))return oc.get(t);for(;Mc.has(ac);)ac++;var e=ac++;return oc.set(t,e),Mc.set(e,t),e},jx=function(t,e){ac=e+1,oc.set(t,e),Mc.set(e,t)},Wx="style[".concat(bs,"][").concat(Bw,'="').concat(df,'"]'),Hx=new RegExp("^".concat(bs,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),Xx=function(t,e,n){for(var r,i=n.split(","),s=0,o=i.length;s<o;s++)(r=i[s])&&t.registerName(e,r)},Yx=function(t,e){for(var n,r=((n=e.textContent)!==null&&n!==void 0?n:"").split(Hg),i=[],s=0,o=r.length;s<o;s++){var a=r[s].trim();if(a){var l=a.match(Hx);if(l){var c=0|parseInt(l[1],10),u=l[2];c!==0&&(jx(u,c),Xx(t,u,l[3]),t.getTag().insertRules(c,i)),i.length=0}else i.push(a)}}},dy=function(t){for(var e=document.querySelectorAll(Wx),n=0,r=e.length;n<r;n++){var i=e[n];i&&i.getAttribute(bs)!==Dw&&(Yx(t,i),i.parentNode&&i.parentNode.removeChild(i))}};function Kx(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var Hw=function(t){var e=document.head,n=t||e,r=document.createElement("style"),i=function(a){var l=Array.from(a.querySelectorAll("style[".concat(bs,"]")));return l[l.length-1]}(n),s=i!==void 0?i.nextSibling:null;r.setAttribute(bs,Dw),r.setAttribute(Bw,df);var o=Kx();return o&&r.setAttribute("nonce",o),n.insertBefore(r,s),r},qx=function(){function t(e){this.element=Hw(e),this.element.appendChild(document.createTextNode("")),this.sheet=function(n){if(n.sheet)return n.sheet;for(var r=document.styleSheets,i=0,s=r.length;i<s;i++){var o=r[i];if(o.ownerNode===n)return o}throw Oa(17)}(this.element),this.length=0}return t.prototype.insertRule=function(e,n){try{return this.sheet.insertRule(n,e),this.length++,!0}catch{return!1}},t.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.prototype.getRule=function(e){var n=this.sheet.cssRules[e];return n&&n.cssText?n.cssText:""},t}(),Zx=function(){function t(e){this.element=Hw(e),this.nodes=this.element.childNodes,this.length=0}return t.prototype.insertRule=function(e,n){if(e<=this.length&&e>=0){var r=document.createTextNode(n);return this.element.insertBefore(r,this.nodes[e]||null),this.length++,!0}return!1},t.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},t}(),Qx=function(){function t(e){this.rules=[],this.length=0}return t.prototype.insertRule=function(e,n){return e<=this.length&&(this.rules.splice(e,0,n),this.length++,!0)},t.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},t}(),py=Ic,Jx={isServer:!Ic,useCSSOMInjection:!xx},Xw=function(){function t(e,n,r){e===void 0&&(e=As),n===void 0&&(n={});var i=this;this.options=ht(ht({},Jx),e),this.gs=n,this.names=new Map(r),this.server=!!e.isServer,!this.server&&Ic&&py&&(py=!1,dy(this)),Yg(this,function(){return function(s){for(var o=s.getTag(),a=o.length,l="",c=function(f){var h=function(m){return Mc.get(m)}(f);if(h===void 0)return"continue";var d=s.names.get(h),g=o.getGroup(f);if(d===void 0||!d.size||g.length===0)return"continue";var _="".concat(bs,".g").concat(f,'[id="').concat(h,'"]'),b="";d!==void 0&&d.forEach(function(m){m.length>0&&(b+="".concat(m,","))}),l+="".concat(g).concat(_,'{content:"').concat(b,'"}').concat(Hg)},u=0;u<a;u++)c(u);return l}(i)})}return t.registerId=function(e){return hl(e)},t.prototype.rehydrate=function(){!this.server&&Ic&&dy(this)},t.prototype.reconstructWithOptions=function(e,n){return n===void 0&&(n=!0),new t(ht(ht({},this.options),e),this.gs,n&&this.names||void 0)},t.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.prototype.getTag=function(){return this.tag||(this.tag=(e=function(n){var r=n.useCSSOMInjection,i=n.target;return n.isServer?new Qx(i):r?new qx(i):new Zx(i)}(this.options),new Vx(e)));var e},t.prototype.hasNameForId=function(e,n){return this.names.has(e)&&this.names.get(e).has(n)},t.prototype.registerName=function(e,n){if(hl(e),this.names.has(e))this.names.get(e).add(n);else{var r=new Set;r.add(n),this.names.set(e,r)}},t.prototype.insertRules=function(e,n,r){this.registerName(e,n),this.getTag().insertRules(hl(e),r)},t.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.prototype.clearRules=function(e){this.getTag().clearGroup(hl(e)),this.clearNames(e)},t.prototype.clearTag=function(){this.tag=void 0},t}(),Gx=/&/g,eC=/^\s*\/\/.*$/gm;function Yw(t,e){return t.map(function(n){return n.type==="rule"&&(n.value="".concat(e," ").concat(n.value),n.value=n.value.replaceAll(",",",".concat(e," ")),n.props=n.props.map(function(r){return"".concat(e," ").concat(r)})),Array.isArray(n.children)&&n.type!=="@keyframes"&&(n.children=Yw(n.children,e)),n})}function tC(t){var e,n,r,i=t===void 0?As:t,s=i.options,o=s===void 0?As:s,a=i.plugins,l=a===void 0?pf:a,c=function(h,d,g){return g.startsWith(n)&&g.endsWith(n)&&g.replaceAll(n,"").length>0?".".concat(e):h},u=l.slice();u.push(function(h){h.type===cf&&h.value.includes("&")&&(h.props[0]=h.props[0].replace(Gx,n).replace(r,c))}),o.prefix&&u.push(Ax),u.push(Sx);var f=function(h,d,g,_){d===void 0&&(d=""),g===void 0&&(g=""),_===void 0&&(_="&"),e=_,n=d,r=new RegExp("\\".concat(n,"\\b"),"g");var b=h.replace(eC,""),m=Tx(g||d?"".concat(g," ").concat(d," { ").concat(b," }"):b);o.namespace&&(m=Yw(m,o.namespace));var p=[];return Pc(m,Ex(u.concat(bx(function(y){return p.push(y)})))),p};return f.hash=l.length?l.reduce(function(h,d){return d.name||Oa(15),ji(h,d.name)},Uw).toString():"",f}var nC=new Xw,$d=tC(),Kw=te.createContext({shouldForwardProp:void 0,styleSheet:nC,stylis:$d});Kw.Consumer;te.createContext(void 0);function gy(){return M.useContext(Kw)}var rC=function(){function t(e,n){var r=this;this.inject=function(i,s){s===void 0&&(s=$d);var o=r.name+s.hash;i.hasNameForId(r.id,o)||i.insertRules(r.id,o,s(r.rules,o,"@keyframes"))},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=n,Yg(this,function(){throw Oa(12,String(r.name))})}return t.prototype.getName=function(e){return e===void 0&&(e=$d),this.name+e.hash},t}(),iC=function(t){return t>="A"&&t<="Z"};function _y(t){for(var e="",n=0;n<t.length;n++){var r=t[n];if(n===1&&r==="-"&&t[0]==="-")return t;iC(r)?e+="-"+r.toLowerCase():e+=r}return e.startsWith("ms-")?"-"+e:e}var qw=function(t){return t==null||t===!1||t===""},Zw=function(t){var e,n,r=[];for(var i in t){var s=t[i];t.hasOwnProperty(i)&&!qw(s)&&(Array.isArray(s)&&s.isCss||Rs(s)?r.push("".concat(_y(i),":"),s,";"):Go(s)?r.push.apply(r,Cc(Cc(["".concat(i," {")],Zw(s),!1),["}"],!1)):r.push("".concat(_y(i),": ").concat((e=i,(n=s)==null||typeof n=="boolean"||n===""?"":typeof n!="number"||n===0||e in Rx||e.startsWith("--")?String(n).trim():"".concat(n,"px")),";")))}return r};function ii(t,e,n,r){if(qw(t))return[];if(Xg(t))return[".".concat(t.styledComponentId)];if(Rs(t)){if(!Rs(s=t)||s.prototype&&s.prototype.isReactComponent||!e)return[t];var i=t(e);return ii(i,e,n,r)}var s;return t instanceof rC?n?(t.inject(n,r),[t.getName(r)]):[t]:Go(t)?Zw(t):Array.isArray(t)?Array.prototype.concat.apply(pf,t.map(function(o){return ii(o,e,n,r)})):[t.toString()]}function sC(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(Rs(n)&&!Xg(n))return!1}return!0}var oC=zw(df),aC=function(){function t(e,n,r){this.rules=e,this.staticRulesId="",this.isStatic=(r===void 0||r.isStatic)&&sC(e),this.componentId=n,this.baseHash=ji(oC,n),this.baseStyle=r,Xw.registerId(n)}return t.prototype.generateAndInjectStyles=function(e,n,r){var i=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,n,r):"";if(this.isStatic&&!r.hash)if(this.staticRulesId&&n.hasNameForId(this.componentId,this.staticRulesId))i=Zr(i,this.staticRulesId);else{var s=hy(ii(this.rules,e,n,r)),o=Ud(ji(this.baseHash,s)>>>0);if(!n.hasNameForId(this.componentId,o)){var a=r(s,".".concat(o),void 0,this.componentId);n.insertRules(this.componentId,o,a)}i=Zr(i,o),this.staticRulesId=o}else{for(var l=ji(this.baseHash,r.hash),c="",u=0;u<this.rules.length;u++){var f=this.rules[u];if(typeof f=="string")c+=f;else if(f){var h=hy(ii(f,e,n,r));l=ji(l,h+u),c+=h}}if(c){var d=Ud(l>>>0);n.hasNameForId(this.componentId,d)||n.insertRules(this.componentId,d,r(c,".".concat(d),void 0,this.componentId)),i=Zr(i,d)}}return i},t}(),Qw=te.createContext(void 0);Qw.Consumer;var ph={};function lC(t,e,n){var r=Xg(t),i=t,s=!dh(t),o=e.attrs,a=o===void 0?pf:o,l=e.componentId,c=l===void 0?function(w,A){var x=typeof w!="string"?"sc":ay(w);ph[x]=(ph[x]||0)+1;var I="".concat(x,"-").concat(Nx(df+x+ph[x]));return A?"".concat(A,"-").concat(I):I}(e.displayName,e.parentComponentId):l,u=e.displayName,f=u===void 0?function(w){return dh(w)?"styled.".concat(w):"Styled(".concat(kx(w),")")}(t):u,h=e.displayName&&e.componentId?"".concat(ay(e.displayName),"-").concat(e.componentId):e.componentId||c,d=r&&i.attrs?i.attrs.concat(a).filter(Boolean):a,g=e.shouldForwardProp;if(r&&i.shouldForwardProp){var _=i.shouldForwardProp;if(e.shouldForwardProp){var b=e.shouldForwardProp;g=function(w,A){return _(w,A)&&b(w,A)}}else g=_}var m=new aC(n,h,r?i.componentStyle:void 0);function p(w,A){return function(x,I,O){var D=x.attrs,z=x.componentStyle,H=x.defaultProps,Y=x.foldedComponentIds,K=x.styledComponentId,Z=x.target,Le=te.useContext(Qw),Cn=gy(),xt=x.shouldForwardProp||Cn.shouldForwardProp,V=Cx(I,Le,H)||As,X=function(Ct,He,de){for(var st,oe=ht(ht({},He),{className:void 0,theme:de}),Ie=0;Ie<Ct.length;Ie+=1){var jt=Rs(st=Ct[Ie])?st(oe):st;for(var Je in jt)oe[Je]=Je==="className"?Zr(oe[Je],jt[Je]):Je==="style"?ht(ht({},oe[Je]),jt[Je]):jt[Je]}return He.className&&(oe.className=Zr(oe.className,He.className)),oe}(D,I,V),q=X.as||Z,se={};for(var ne in X)X[ne]===void 0||ne[0]==="$"||ne==="as"||ne==="theme"&&X.theme===V||(ne==="forwardedAs"?se.as=X.forwardedAs:xt&&!xt(ne,q)||(se[ne]=X[ne]));var Vt=function(Ct,He){var de=gy(),st=Ct.generateAndInjectStyles(He,de.styleSheet,de.stylis);return st}(z,X),We=Zr(Y,K);return Vt&&(We+=" "+Vt),X.className&&(We+=" "+X.className),se[dh(q)&&!Lw.has(q)?"class":"className"]=We,se.ref=O,M.createElement(q,se)}(y,w,A)}p.displayName=f;var y=te.forwardRef(p);return y.attrs=d,y.componentStyle=m,y.displayName=f,y.shouldForwardProp=g,y.foldedComponentIds=r?Zr(i.foldedComponentIds,i.styledComponentId):"",y.styledComponentId=h,y.target=r?i.target:t,Object.defineProperty(y,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(w){this._foldedDefaultProps=r?function(A){for(var x=[],I=1;I<arguments.length;I++)x[I-1]=arguments[I];for(var O=0,D=x;O<D.length;O++)zd(A,D[O],!0);return A}({},i.defaultProps,w):w}}),Yg(y,function(){return".".concat(y.styledComponentId)}),s&&Ww(y,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),y}function my(t,e){for(var n=[t[0]],r=0,i=e.length;r<i;r+=1)n.push(e[r],t[r+1]);return n}var yy=function(t){return Object.assign(t,{isCss:!0})};function cC(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Rs(t)||Go(t))return yy(ii(my(pf,Cc([t],e,!0))));var r=t;return e.length===0&&r.length===1&&typeof r[0]=="string"?ii(r):yy(ii(my(r,e)))}function Vd(t,e,n){if(n===void 0&&(n=As),!e)throw Oa(1,e);var r=function(i){for(var s=[],o=1;o<arguments.length;o++)s[o-1]=arguments[o];return t(e,n,cC.apply(void 0,Cc([i],s,!1)))};return r.attrs=function(i){return Vd(t,e,ht(ht({},n),{attrs:Array.prototype.concat(n.attrs,i).filter(Boolean)}))},r.withConfig=function(i){return Vd(t,e,ht(ht({},n),i))},r}var Jw=function(t){return Vd(lC,t)},Gw=Jw;Lw.forEach(function(t){Gw[t]=Jw(t)});var e1={exports:{}},At={},t1={exports:{}},n1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,X){var q=V.length;V.push(X);e:for(;0<q;){var se=q-1>>>1,ne=V[se];if(0<i(ne,X))V[se]=X,V[q]=ne,q=se;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var X=V[0],q=V.pop();if(q!==X){V[0]=q;e:for(var se=0,ne=V.length,Vt=ne>>>1;se<Vt;){var We=2*(se+1)-1,Ct=V[We],He=We+1,de=V[He];if(0>i(Ct,q))He<ne&&0>i(de,Ct)?(V[se]=de,V[He]=q,se=He):(V[se]=Ct,V[We]=q,se=We);else if(He<ne&&0>i(de,q))V[se]=de,V[He]=q,se=He;else break e}}return X}function i(V,X){var q=V.sortIndex-X.sortIndex;return q!==0?q:V.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,f=null,h=3,d=!1,g=!1,_=!1,b=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(V){for(var X=n(c);X!==null;){if(X.callback===null)r(c);else if(X.startTime<=V)r(c),X.sortIndex=X.expirationTime,e(l,X);else break;X=n(c)}}function w(V){if(_=!1,y(V),!g)if(n(l)!==null)g=!0,Cn(A);else{var X=n(c);X!==null&&xt(w,X.startTime-V)}}function A(V,X){g=!1,_&&(_=!1,m(O),O=-1),d=!0;var q=h;try{for(y(X),f=n(l);f!==null&&(!(f.expirationTime>X)||V&&!H());){var se=f.callback;if(typeof se=="function"){f.callback=null,h=f.priorityLevel;var ne=se(f.expirationTime<=X);X=t.unstable_now(),typeof ne=="function"?f.callback=ne:f===n(l)&&r(l),y(X)}else r(l);f=n(l)}if(f!==null)var Vt=!0;else{var We=n(c);We!==null&&xt(w,We.startTime-X),Vt=!1}return Vt}finally{f=null,h=q,d=!1}}var x=!1,I=null,O=-1,D=5,z=-1;function H(){return!(t.unstable_now()-z<D)}function Y(){if(I!==null){var V=t.unstable_now();z=V;var X=!0;try{X=I(!0,V)}finally{X?K():(x=!1,I=null)}}else x=!1}var K;if(typeof p=="function")K=function(){p(Y)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,Le=Z.port2;Z.port1.onmessage=Y,K=function(){Le.postMessage(null)}}else K=function(){b(Y,0)};function Cn(V){I=V,x||(x=!0,K())}function xt(V,X){O=b(function(){V(t.unstable_now())},X)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){g||d||(g=!0,Cn(A))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(V){switch(h){case 1:case 2:case 3:var X=3;break;default:X=h}var q=h;h=X;try{return V()}finally{h=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,X){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var q=h;h=V;try{return X()}finally{h=q}},t.unstable_scheduleCallback=function(V,X,q){var se=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?se+q:se):q=se,V){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=q+ne,V={id:u++,callback:X,priorityLevel:V,startTime:q,expirationTime:ne,sortIndex:-1},q>se?(V.sortIndex=q,e(c,V),n(l)===null&&V===n(c)&&(_?(m(O),O=-1):_=!0,xt(w,q-se))):(V.sortIndex=ne,e(l,V),g||d||(g=!0,Cn(A))),V},t.unstable_shouldYield=H,t.unstable_wrapCallback=function(V){var X=h;return function(){var q=h;h=X;try{return V.apply(this,arguments)}finally{h=q}}}})(n1);t1.exports=n1;var uC=t1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fC=M,bt=uC;function L(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r1=new Set,ea={};function vi(t,e){xs(t,e),xs(t+"Capture",e)}function xs(t,e){for(ea[t]=e,t=0;t<e.length;t++)r1.add(e[t])}var Vn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jd=Object.prototype.hasOwnProperty,hC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,vy={},Ty={};function dC(t){return jd.call(Ty,t)?!0:jd.call(vy,t)?!1:hC.test(t)?Ty[t]=!0:(vy[t]=!0,!1)}function pC(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function gC(t,e,n,r){if(e===null||typeof e>"u"||pC(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ut(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Qe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Qe[t]=new ut(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Qe[e]=new ut(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Qe[t]=new ut(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Qe[t]=new ut(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Qe[t]=new ut(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Qe[t]=new ut(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Qe[t]=new ut(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Qe[t]=new ut(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Qe[t]=new ut(t,5,!1,t.toLowerCase(),null,!1,!1)});var Kg=/[\-:]([a-z])/g;function qg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Kg,qg);Qe[e]=new ut(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Kg,qg);Qe[e]=new ut(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Kg,qg);Qe[e]=new ut(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Qe[t]=new ut(t,1,!1,t.toLowerCase(),null,!1,!1)});Qe.xlinkHref=new ut("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Qe[t]=new ut(t,1,!1,t.toLowerCase(),null,!0,!0)});function Zg(t,e,n,r){var i=Qe.hasOwnProperty(e)?Qe[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(gC(e,n,i,r)&&(n=null),r||i===null?dC(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Yn=fC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,dl=Symbol.for("react.element"),Wi=Symbol.for("react.portal"),Hi=Symbol.for("react.fragment"),Qg=Symbol.for("react.strict_mode"),Wd=Symbol.for("react.profiler"),i1=Symbol.for("react.provider"),s1=Symbol.for("react.context"),Jg=Symbol.for("react.forward_ref"),Hd=Symbol.for("react.suspense"),Xd=Symbol.for("react.suspense_list"),Gg=Symbol.for("react.memo"),sr=Symbol.for("react.lazy"),o1=Symbol.for("react.offscreen"),wy=Symbol.iterator;function io(t){return t===null||typeof t!="object"?null:(t=wy&&t[wy]||t["@@iterator"],typeof t=="function"?t:null)}var Ae=Object.assign,gh;function Ao(t){if(gh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);gh=e&&e[1]||""}return`
`+gh+t}var _h=!1;function mh(t,e){if(!t||_h)return"";_h=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{_h=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ao(t):""}function _C(t){switch(t.tag){case 5:return Ao(t.type);case 16:return Ao("Lazy");case 13:return Ao("Suspense");case 19:return Ao("SuspenseList");case 0:case 2:case 15:return t=mh(t.type,!1),t;case 11:return t=mh(t.type.render,!1),t;case 1:return t=mh(t.type,!0),t;default:return""}}function Yd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Hi:return"Fragment";case Wi:return"Portal";case Wd:return"Profiler";case Qg:return"StrictMode";case Hd:return"Suspense";case Xd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case s1:return(t.displayName||"Context")+".Consumer";case i1:return(t._context.displayName||"Context")+".Provider";case Jg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Gg:return e=t.displayName||null,e!==null?e:Yd(t.type)||"Memo";case sr:e=t._payload,t=t._init;try{return Yd(t(e))}catch{}}return null}function mC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Yd(e);case 8:return e===Qg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Cr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function a1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function yC(t){var e=a1(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function pl(t){t._valueTracker||(t._valueTracker=yC(t))}function l1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=a1(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Nc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Kd(t,e){var n=e.checked;return Ae({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Sy(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Cr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function c1(t,e){e=e.checked,e!=null&&Zg(t,"checked",e,!1)}function qd(t,e){c1(t,e);var n=Cr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Zd(t,e.type,n):e.hasOwnProperty("defaultValue")&&Zd(t,e.type,Cr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ey(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Zd(t,e,n){(e!=="number"||Nc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ro=Array.isArray;function us(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Cr(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Qd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return Ae({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function by(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(L(92));if(Ro(n)){if(1<n.length)throw Error(L(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Cr(n)}}function u1(t,e){var n=Cr(e.value),r=Cr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Ay(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function f1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Jd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?f1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var gl,h1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(gl=gl||document.createElement("div"),gl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=gl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ta(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Fo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vC=["Webkit","ms","Moz","O"];Object.keys(Fo).forEach(function(t){vC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Fo[e]=Fo[t]})});function d1(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Fo.hasOwnProperty(t)&&Fo[t]?(""+e).trim():e+"px"}function p1(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=d1(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var TC=Ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gd(t,e){if(e){if(TC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function ep(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var tp=null;function e_(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var np=null,fs=null,hs=null;function Ry(t){if(t=Ba(t)){if(typeof np!="function")throw Error(L(280));var e=t.stateNode;e&&(e=vf(e),np(t.stateNode,t.type,e))}}function g1(t){fs?hs?hs.push(t):hs=[t]:fs=t}function _1(){if(fs){var t=fs,e=hs;if(hs=fs=null,Ry(t),e)for(t=0;t<e.length;t++)Ry(e[t])}}function m1(t,e){return t(e)}function y1(){}var yh=!1;function v1(t,e,n){if(yh)return t(e,n);yh=!0;try{return m1(t,e,n)}finally{yh=!1,(fs!==null||hs!==null)&&(y1(),_1())}}function na(t,e){var n=t.stateNode;if(n===null)return null;var r=vf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(L(231,e,typeof n));return n}var rp=!1;if(Vn)try{var so={};Object.defineProperty(so,"passive",{get:function(){rp=!0}}),window.addEventListener("test",so,so),window.removeEventListener("test",so,so)}catch{rp=!1}function wC(t,e,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var Do=!1,kc=null,Oc=!1,ip=null,SC={onError:function(t){Do=!0,kc=t}};function EC(t,e,n,r,i,s,o,a,l){Do=!1,kc=null,wC.apply(SC,arguments)}function bC(t,e,n,r,i,s,o,a,l){if(EC.apply(this,arguments),Do){if(Do){var c=kc;Do=!1,kc=null}else throw Error(L(198));Oc||(Oc=!0,ip=c)}}function Ti(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function T1(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function xy(t){if(Ti(t)!==t)throw Error(L(188))}function AC(t){var e=t.alternate;if(!e){if(e=Ti(t),e===null)throw Error(L(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return xy(i),t;if(s===r)return xy(i),e;s=s.sibling}throw Error(L(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(L(189))}}if(n.alternate!==r)throw Error(L(190))}if(n.tag!==3)throw Error(L(188));return n.stateNode.current===n?t:e}function w1(t){return t=AC(t),t!==null?S1(t):null}function S1(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=S1(t);if(e!==null)return e;t=t.sibling}return null}var E1=bt.unstable_scheduleCallback,Cy=bt.unstable_cancelCallback,RC=bt.unstable_shouldYield,xC=bt.unstable_requestPaint,Pe=bt.unstable_now,CC=bt.unstable_getCurrentPriorityLevel,t_=bt.unstable_ImmediatePriority,b1=bt.unstable_UserBlockingPriority,Fc=bt.unstable_NormalPriority,PC=bt.unstable_LowPriority,A1=bt.unstable_IdlePriority,gf=null,Sn=null;function IC(t){if(Sn&&typeof Sn.onCommitFiberRoot=="function")try{Sn.onCommitFiberRoot(gf,t,void 0,(t.current.flags&128)===128)}catch{}}var Gt=Math.clz32?Math.clz32:kC,MC=Math.log,NC=Math.LN2;function kC(t){return t>>>=0,t===0?32:31-(MC(t)/NC|0)|0}var _l=64,ml=4194304;function xo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Dc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=xo(a):(s&=o,s!==0&&(r=xo(s)))}else o=n&~i,o!==0?r=xo(o):s!==0&&(r=xo(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Gt(e),i=1<<n,r|=t[n],e&=~i;return r}function OC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function FC(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Gt(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=OC(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function sp(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function R1(){var t=_l;return _l<<=1,!(_l&4194240)&&(_l=64),t}function vh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Fa(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Gt(e),t[e]=n}function DC(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Gt(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function n_(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Gt(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var le=0;function x1(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var C1,r_,P1,I1,M1,op=!1,yl=[],yr=null,vr=null,Tr=null,ra=new Map,ia=new Map,cr=[],BC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Py(t,e){switch(t){case"focusin":case"focusout":yr=null;break;case"dragenter":case"dragleave":vr=null;break;case"mouseover":case"mouseout":Tr=null;break;case"pointerover":case"pointerout":ra.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ia.delete(e.pointerId)}}function oo(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Ba(e),e!==null&&r_(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function LC(t,e,n,r,i){switch(e){case"focusin":return yr=oo(yr,t,e,n,r,i),!0;case"dragenter":return vr=oo(vr,t,e,n,r,i),!0;case"mouseover":return Tr=oo(Tr,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return ra.set(s,oo(ra.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,ia.set(s,oo(ia.get(s)||null,t,e,n,r,i)),!0}return!1}function N1(t){var e=Qr(t.target);if(e!==null){var n=Ti(e);if(n!==null){if(e=n.tag,e===13){if(e=T1(n),e!==null){t.blockedOn=e,M1(t.priority,function(){P1(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function lc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ap(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);tp=r,n.target.dispatchEvent(r),tp=null}else return e=Ba(n),e!==null&&r_(e),t.blockedOn=n,!1;e.shift()}return!0}function Iy(t,e,n){lc(t)&&n.delete(e)}function UC(){op=!1,yr!==null&&lc(yr)&&(yr=null),vr!==null&&lc(vr)&&(vr=null),Tr!==null&&lc(Tr)&&(Tr=null),ra.forEach(Iy),ia.forEach(Iy)}function ao(t,e){t.blockedOn===e&&(t.blockedOn=null,op||(op=!0,bt.unstable_scheduleCallback(bt.unstable_NormalPriority,UC)))}function sa(t){function e(i){return ao(i,t)}if(0<yl.length){ao(yl[0],t);for(var n=1;n<yl.length;n++){var r=yl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(yr!==null&&ao(yr,t),vr!==null&&ao(vr,t),Tr!==null&&ao(Tr,t),ra.forEach(e),ia.forEach(e),n=0;n<cr.length;n++)r=cr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<cr.length&&(n=cr[0],n.blockedOn===null);)N1(n),n.blockedOn===null&&cr.shift()}var ds=Yn.ReactCurrentBatchConfig,Bc=!0;function zC(t,e,n,r){var i=le,s=ds.transition;ds.transition=null;try{le=1,i_(t,e,n,r)}finally{le=i,ds.transition=s}}function $C(t,e,n,r){var i=le,s=ds.transition;ds.transition=null;try{le=4,i_(t,e,n,r)}finally{le=i,ds.transition=s}}function i_(t,e,n,r){if(Bc){var i=ap(t,e,n,r);if(i===null)Ph(t,e,r,Lc,n),Py(t,r);else if(LC(i,t,e,n,r))r.stopPropagation();else if(Py(t,r),e&4&&-1<BC.indexOf(t)){for(;i!==null;){var s=Ba(i);if(s!==null&&C1(s),s=ap(t,e,n,r),s===null&&Ph(t,e,r,Lc,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Ph(t,e,r,null,n)}}var Lc=null;function ap(t,e,n,r){if(Lc=null,t=e_(r),t=Qr(t),t!==null)if(e=Ti(t),e===null)t=null;else if(n=e.tag,n===13){if(t=T1(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Lc=t,null}function k1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(CC()){case t_:return 1;case b1:return 4;case Fc:case PC:return 16;case A1:return 536870912;default:return 16}default:return 16}}var hr=null,s_=null,cc=null;function O1(){if(cc)return cc;var t,e=s_,n=e.length,r,i="value"in hr?hr.value:hr.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return cc=i.slice(t,1<r?1-r:void 0)}function uc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function vl(){return!0}function My(){return!1}function Rt(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?vl:My,this.isPropagationStopped=My,this}return Ae(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=vl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=vl)},persist:function(){},isPersistent:vl}),e}var Ks={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},o_=Rt(Ks),Da=Ae({},Ks,{view:0,detail:0}),VC=Rt(Da),Th,wh,lo,_f=Ae({},Da,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:a_,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==lo&&(lo&&t.type==="mousemove"?(Th=t.screenX-lo.screenX,wh=t.screenY-lo.screenY):wh=Th=0,lo=t),Th)},movementY:function(t){return"movementY"in t?t.movementY:wh}}),Ny=Rt(_f),jC=Ae({},_f,{dataTransfer:0}),WC=Rt(jC),HC=Ae({},Da,{relatedTarget:0}),Sh=Rt(HC),XC=Ae({},Ks,{animationName:0,elapsedTime:0,pseudoElement:0}),YC=Rt(XC),KC=Ae({},Ks,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),qC=Rt(KC),ZC=Ae({},Ks,{data:0}),ky=Rt(ZC),QC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},JC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},GC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function eP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=GC[t])?!!e[t]:!1}function a_(){return eP}var tP=Ae({},Da,{key:function(t){if(t.key){var e=QC[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=uc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?JC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:a_,charCode:function(t){return t.type==="keypress"?uc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?uc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),nP=Rt(tP),rP=Ae({},_f,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Oy=Rt(rP),iP=Ae({},Da,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:a_}),sP=Rt(iP),oP=Ae({},Ks,{propertyName:0,elapsedTime:0,pseudoElement:0}),aP=Rt(oP),lP=Ae({},_f,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),cP=Rt(lP),uP=[9,13,27,32],l_=Vn&&"CompositionEvent"in window,Bo=null;Vn&&"documentMode"in document&&(Bo=document.documentMode);var fP=Vn&&"TextEvent"in window&&!Bo,F1=Vn&&(!l_||Bo&&8<Bo&&11>=Bo),Fy=String.fromCharCode(32),Dy=!1;function D1(t,e){switch(t){case"keyup":return uP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function B1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Xi=!1;function hP(t,e){switch(t){case"compositionend":return B1(e);case"keypress":return e.which!==32?null:(Dy=!0,Fy);case"textInput":return t=e.data,t===Fy&&Dy?null:t;default:return null}}function dP(t,e){if(Xi)return t==="compositionend"||!l_&&D1(t,e)?(t=O1(),cc=s_=hr=null,Xi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return F1&&e.locale!=="ko"?null:e.data;default:return null}}var pP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function By(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!pP[t.type]:e==="textarea"}function L1(t,e,n,r){g1(r),e=Uc(e,"onChange"),0<e.length&&(n=new o_("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Lo=null,oa=null;function gP(t){q1(t,0)}function mf(t){var e=qi(t);if(l1(e))return t}function _P(t,e){if(t==="change")return e}var U1=!1;if(Vn){var Eh;if(Vn){var bh="oninput"in document;if(!bh){var Ly=document.createElement("div");Ly.setAttribute("oninput","return;"),bh=typeof Ly.oninput=="function"}Eh=bh}else Eh=!1;U1=Eh&&(!document.documentMode||9<document.documentMode)}function Uy(){Lo&&(Lo.detachEvent("onpropertychange",z1),oa=Lo=null)}function z1(t){if(t.propertyName==="value"&&mf(oa)){var e=[];L1(e,oa,t,e_(t)),v1(gP,e)}}function mP(t,e,n){t==="focusin"?(Uy(),Lo=e,oa=n,Lo.attachEvent("onpropertychange",z1)):t==="focusout"&&Uy()}function yP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return mf(oa)}function vP(t,e){if(t==="click")return mf(e)}function TP(t,e){if(t==="input"||t==="change")return mf(e)}function wP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var rn=typeof Object.is=="function"?Object.is:wP;function aa(t,e){if(rn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!jd.call(e,i)||!rn(t[i],e[i]))return!1}return!0}function zy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function $y(t,e){var n=zy(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=zy(n)}}function $1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?$1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function V1(){for(var t=window,e=Nc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Nc(t.document)}return e}function c_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function SP(t){var e=V1(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&$1(n.ownerDocument.documentElement,n)){if(r!==null&&c_(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=$y(n,s);var o=$y(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var EP=Vn&&"documentMode"in document&&11>=document.documentMode,Yi=null,lp=null,Uo=null,cp=!1;function Vy(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;cp||Yi==null||Yi!==Nc(r)||(r=Yi,"selectionStart"in r&&c_(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Uo&&aa(Uo,r)||(Uo=r,r=Uc(lp,"onSelect"),0<r.length&&(e=new o_("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Yi)))}function Tl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ki={animationend:Tl("Animation","AnimationEnd"),animationiteration:Tl("Animation","AnimationIteration"),animationstart:Tl("Animation","AnimationStart"),transitionend:Tl("Transition","TransitionEnd")},Ah={},j1={};Vn&&(j1=document.createElement("div").style,"AnimationEvent"in window||(delete Ki.animationend.animation,delete Ki.animationiteration.animation,delete Ki.animationstart.animation),"TransitionEvent"in window||delete Ki.transitionend.transition);function yf(t){if(Ah[t])return Ah[t];if(!Ki[t])return t;var e=Ki[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in j1)return Ah[t]=e[n];return t}var W1=yf("animationend"),H1=yf("animationiteration"),X1=yf("animationstart"),Y1=yf("transitionend"),K1=new Map,jy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kr(t,e){K1.set(t,e),vi(e,[t])}for(var Rh=0;Rh<jy.length;Rh++){var xh=jy[Rh],bP=xh.toLowerCase(),AP=xh[0].toUpperCase()+xh.slice(1);kr(bP,"on"+AP)}kr(W1,"onAnimationEnd");kr(H1,"onAnimationIteration");kr(X1,"onAnimationStart");kr("dblclick","onDoubleClick");kr("focusin","onFocus");kr("focusout","onBlur");kr(Y1,"onTransitionEnd");xs("onMouseEnter",["mouseout","mouseover"]);xs("onMouseLeave",["mouseout","mouseover"]);xs("onPointerEnter",["pointerout","pointerover"]);xs("onPointerLeave",["pointerout","pointerover"]);vi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vi("onBeforeInput",["compositionend","keypress","textInput","paste"]);vi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Co="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),RP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Co));function Wy(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,bC(r,e,void 0,t),t.currentTarget=null}function q1(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Wy(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Wy(i,a,c),s=l}}}if(Oc)throw t=ip,Oc=!1,ip=null,t}function me(t,e){var n=e[pp];n===void 0&&(n=e[pp]=new Set);var r=t+"__bubble";n.has(r)||(Z1(e,t,2,!1),n.add(r))}function Ch(t,e,n){var r=0;e&&(r|=4),Z1(n,t,r,e)}var wl="_reactListening"+Math.random().toString(36).slice(2);function la(t){if(!t[wl]){t[wl]=!0,r1.forEach(function(n){n!=="selectionchange"&&(RP.has(n)||Ch(n,!1,t),Ch(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[wl]||(e[wl]=!0,Ch("selectionchange",!1,e))}}function Z1(t,e,n,r){switch(k1(e)){case 1:var i=zC;break;case 4:i=$C;break;default:i=i_}n=i.bind(null,e,n,t),i=void 0,!rp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Ph(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Qr(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}v1(function(){var c=s,u=e_(n),f=[];e:{var h=K1.get(t);if(h!==void 0){var d=o_,g=t;switch(t){case"keypress":if(uc(n)===0)break e;case"keydown":case"keyup":d=nP;break;case"focusin":g="focus",d=Sh;break;case"focusout":g="blur",d=Sh;break;case"beforeblur":case"afterblur":d=Sh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=Ny;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=WC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=sP;break;case W1:case H1:case X1:d=YC;break;case Y1:d=aP;break;case"scroll":d=VC;break;case"wheel":d=cP;break;case"copy":case"cut":case"paste":d=qC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=Oy}var _=(e&4)!==0,b=!_&&t==="scroll",m=_?h!==null?h+"Capture":null:h;_=[];for(var p=c,y;p!==null;){y=p;var w=y.stateNode;if(y.tag===5&&w!==null&&(y=w,m!==null&&(w=na(p,m),w!=null&&_.push(ca(p,w,y)))),b)break;p=p.return}0<_.length&&(h=new d(h,g,null,n,u),f.push({event:h,listeners:_}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",d=t==="mouseout"||t==="pointerout",h&&n!==tp&&(g=n.relatedTarget||n.fromElement)&&(Qr(g)||g[jn]))break e;if((d||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,d?(g=n.relatedTarget||n.toElement,d=c,g=g?Qr(g):null,g!==null&&(b=Ti(g),g!==b||g.tag!==5&&g.tag!==6)&&(g=null)):(d=null,g=c),d!==g)){if(_=Ny,w="onMouseLeave",m="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(_=Oy,w="onPointerLeave",m="onPointerEnter",p="pointer"),b=d==null?h:qi(d),y=g==null?h:qi(g),h=new _(w,p+"leave",d,n,u),h.target=b,h.relatedTarget=y,w=null,Qr(u)===c&&(_=new _(m,p+"enter",g,n,u),_.target=y,_.relatedTarget=b,w=_),b=w,d&&g)t:{for(_=d,m=g,p=0,y=_;y;y=Pi(y))p++;for(y=0,w=m;w;w=Pi(w))y++;for(;0<p-y;)_=Pi(_),p--;for(;0<y-p;)m=Pi(m),y--;for(;p--;){if(_===m||m!==null&&_===m.alternate)break t;_=Pi(_),m=Pi(m)}_=null}else _=null;d!==null&&Hy(f,h,d,_,!1),g!==null&&b!==null&&Hy(f,b,g,_,!0)}}e:{if(h=c?qi(c):window,d=h.nodeName&&h.nodeName.toLowerCase(),d==="select"||d==="input"&&h.type==="file")var A=_P;else if(By(h))if(U1)A=TP;else{A=yP;var x=mP}else(d=h.nodeName)&&d.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(A=vP);if(A&&(A=A(t,c))){L1(f,A,n,u);break e}x&&x(t,h,c),t==="focusout"&&(x=h._wrapperState)&&x.controlled&&h.type==="number"&&Zd(h,"number",h.value)}switch(x=c?qi(c):window,t){case"focusin":(By(x)||x.contentEditable==="true")&&(Yi=x,lp=c,Uo=null);break;case"focusout":Uo=lp=Yi=null;break;case"mousedown":cp=!0;break;case"contextmenu":case"mouseup":case"dragend":cp=!1,Vy(f,n,u);break;case"selectionchange":if(EP)break;case"keydown":case"keyup":Vy(f,n,u)}var I;if(l_)e:{switch(t){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Xi?D1(t,n)&&(O="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(O="onCompositionStart");O&&(F1&&n.locale!=="ko"&&(Xi||O!=="onCompositionStart"?O==="onCompositionEnd"&&Xi&&(I=O1()):(hr=u,s_="value"in hr?hr.value:hr.textContent,Xi=!0)),x=Uc(c,O),0<x.length&&(O=new ky(O,t,null,n,u),f.push({event:O,listeners:x}),I?O.data=I:(I=B1(n),I!==null&&(O.data=I)))),(I=fP?hP(t,n):dP(t,n))&&(c=Uc(c,"onBeforeInput"),0<c.length&&(u=new ky("onBeforeInput","beforeinput",null,n,u),f.push({event:u,listeners:c}),u.data=I))}q1(f,e)})}function ca(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Uc(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=na(t,n),s!=null&&r.unshift(ca(t,s,i)),s=na(t,e),s!=null&&r.push(ca(t,s,i))),t=t.return}return r}function Pi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Hy(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=na(n,s),l!=null&&o.unshift(ca(n,l,a))):i||(l=na(n,s),l!=null&&o.push(ca(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var xP=/\r\n?/g,CP=/\u0000|\uFFFD/g;function Xy(t){return(typeof t=="string"?t:""+t).replace(xP,`
`).replace(CP,"")}function Sl(t,e,n){if(e=Xy(e),Xy(t)!==e&&n)throw Error(L(425))}function zc(){}var up=null,fp=null;function hp(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var dp=typeof setTimeout=="function"?setTimeout:void 0,PP=typeof clearTimeout=="function"?clearTimeout:void 0,Yy=typeof Promise=="function"?Promise:void 0,IP=typeof queueMicrotask=="function"?queueMicrotask:typeof Yy<"u"?function(t){return Yy.resolve(null).then(t).catch(MP)}:dp;function MP(t){setTimeout(function(){throw t})}function Ih(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),sa(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);sa(e)}function wr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Ky(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var qs=Math.random().toString(36).slice(2),mn="__reactFiber$"+qs,ua="__reactProps$"+qs,jn="__reactContainer$"+qs,pp="__reactEvents$"+qs,NP="__reactListeners$"+qs,kP="__reactHandles$"+qs;function Qr(t){var e=t[mn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[jn]||n[mn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Ky(t);t!==null;){if(n=t[mn])return n;t=Ky(t)}return e}t=n,n=t.parentNode}return null}function Ba(t){return t=t[mn]||t[jn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function qi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(L(33))}function vf(t){return t[ua]||null}var gp=[],Zi=-1;function Or(t){return{current:t}}function ye(t){0>Zi||(t.current=gp[Zi],gp[Zi]=null,Zi--)}function pe(t,e){Zi++,gp[Zi]=t.current,t.current=e}var Pr={},it=Or(Pr),pt=Or(!1),ui=Pr;function Cs(t,e){var n=t.type.contextTypes;if(!n)return Pr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function gt(t){return t=t.childContextTypes,t!=null}function $c(){ye(pt),ye(it)}function qy(t,e,n){if(it.current!==Pr)throw Error(L(168));pe(it,e),pe(pt,n)}function Q1(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(L(108,mC(t)||"Unknown",i));return Ae({},n,r)}function Vc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Pr,ui=it.current,pe(it,t),pe(pt,pt.current),!0}function Zy(t,e,n){var r=t.stateNode;if(!r)throw Error(L(169));n?(t=Q1(t,e,ui),r.__reactInternalMemoizedMergedChildContext=t,ye(pt),ye(it),pe(it,t)):ye(pt),pe(pt,n)}var Dn=null,Tf=!1,Mh=!1;function J1(t){Dn===null?Dn=[t]:Dn.push(t)}function OP(t){Tf=!0,J1(t)}function Fr(){if(!Mh&&Dn!==null){Mh=!0;var t=0,e=le;try{var n=Dn;for(le=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Dn=null,Tf=!1}catch(i){throw Dn!==null&&(Dn=Dn.slice(t+1)),E1(t_,Fr),i}finally{le=e,Mh=!1}}return null}var Qi=[],Ji=0,jc=null,Wc=0,Nt=[],kt=0,fi=null,Ln=1,Un="";function Wr(t,e){Qi[Ji++]=Wc,Qi[Ji++]=jc,jc=t,Wc=e}function G1(t,e,n){Nt[kt++]=Ln,Nt[kt++]=Un,Nt[kt++]=fi,fi=t;var r=Ln;t=Un;var i=32-Gt(r)-1;r&=~(1<<i),n+=1;var s=32-Gt(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Ln=1<<32-Gt(e)+i|n<<i|r,Un=s+t}else Ln=1<<s|n<<i|r,Un=t}function u_(t){t.return!==null&&(Wr(t,1),G1(t,1,0))}function f_(t){for(;t===jc;)jc=Qi[--Ji],Qi[Ji]=null,Wc=Qi[--Ji],Qi[Ji]=null;for(;t===fi;)fi=Nt[--kt],Nt[kt]=null,Un=Nt[--kt],Nt[kt]=null,Ln=Nt[--kt],Nt[kt]=null}var Et=null,wt=null,ve=!1,Kt=null;function eS(t,e){var n=Ot(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Qy(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Et=t,wt=wr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Et=t,wt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=fi!==null?{id:Ln,overflow:Un}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ot(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Et=t,wt=null,!0):!1;default:return!1}}function _p(t){return(t.mode&1)!==0&&(t.flags&128)===0}function mp(t){if(ve){var e=wt;if(e){var n=e;if(!Qy(t,e)){if(_p(t))throw Error(L(418));e=wr(n.nextSibling);var r=Et;e&&Qy(t,e)?eS(r,n):(t.flags=t.flags&-4097|2,ve=!1,Et=t)}}else{if(_p(t))throw Error(L(418));t.flags=t.flags&-4097|2,ve=!1,Et=t}}}function Jy(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Et=t}function El(t){if(t!==Et)return!1;if(!ve)return Jy(t),ve=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!hp(t.type,t.memoizedProps)),e&&(e=wt)){if(_p(t))throw tS(),Error(L(418));for(;e;)eS(t,e),e=wr(e.nextSibling)}if(Jy(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(L(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){wt=wr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}wt=null}}else wt=Et?wr(t.stateNode.nextSibling):null;return!0}function tS(){for(var t=wt;t;)t=wr(t.nextSibling)}function Ps(){wt=Et=null,ve=!1}function h_(t){Kt===null?Kt=[t]:Kt.push(t)}var FP=Yn.ReactCurrentBatchConfig;function co(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(L(309));var r=n.stateNode}if(!r)throw Error(L(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(L(284));if(!n._owner)throw Error(L(290,t))}return t}function bl(t,e){throw t=Object.prototype.toString.call(e),Error(L(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Gy(t){var e=t._init;return e(t._payload)}function nS(t){function e(m,p){if(t){var y=m.deletions;y===null?(m.deletions=[p],m.flags|=16):y.push(p)}}function n(m,p){if(!t)return null;for(;p!==null;)e(m,p),p=p.sibling;return null}function r(m,p){for(m=new Map;p!==null;)p.key!==null?m.set(p.key,p):m.set(p.index,p),p=p.sibling;return m}function i(m,p){return m=Ar(m,p),m.index=0,m.sibling=null,m}function s(m,p,y){return m.index=y,t?(y=m.alternate,y!==null?(y=y.index,y<p?(m.flags|=2,p):y):(m.flags|=2,p)):(m.flags|=1048576,p)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function a(m,p,y,w){return p===null||p.tag!==6?(p=Lh(y,m.mode,w),p.return=m,p):(p=i(p,y),p.return=m,p)}function l(m,p,y,w){var A=y.type;return A===Hi?u(m,p,y.props.children,w,y.key):p!==null&&(p.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===sr&&Gy(A)===p.type)?(w=i(p,y.props),w.ref=co(m,p,y),w.return=m,w):(w=mc(y.type,y.key,y.props,null,m.mode,w),w.ref=co(m,p,y),w.return=m,w)}function c(m,p,y,w){return p===null||p.tag!==4||p.stateNode.containerInfo!==y.containerInfo||p.stateNode.implementation!==y.implementation?(p=Uh(y,m.mode,w),p.return=m,p):(p=i(p,y.children||[]),p.return=m,p)}function u(m,p,y,w,A){return p===null||p.tag!==7?(p=oi(y,m.mode,w,A),p.return=m,p):(p=i(p,y),p.return=m,p)}function f(m,p,y){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Lh(""+p,m.mode,y),p.return=m,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case dl:return y=mc(p.type,p.key,p.props,null,m.mode,y),y.ref=co(m,null,p),y.return=m,y;case Wi:return p=Uh(p,m.mode,y),p.return=m,p;case sr:var w=p._init;return f(m,w(p._payload),y)}if(Ro(p)||io(p))return p=oi(p,m.mode,y,null),p.return=m,p;bl(m,p)}return null}function h(m,p,y,w){var A=p!==null?p.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return A!==null?null:a(m,p,""+y,w);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case dl:return y.key===A?l(m,p,y,w):null;case Wi:return y.key===A?c(m,p,y,w):null;case sr:return A=y._init,h(m,p,A(y._payload),w)}if(Ro(y)||io(y))return A!==null?null:u(m,p,y,w,null);bl(m,y)}return null}function d(m,p,y,w,A){if(typeof w=="string"&&w!==""||typeof w=="number")return m=m.get(y)||null,a(p,m,""+w,A);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case dl:return m=m.get(w.key===null?y:w.key)||null,l(p,m,w,A);case Wi:return m=m.get(w.key===null?y:w.key)||null,c(p,m,w,A);case sr:var x=w._init;return d(m,p,y,x(w._payload),A)}if(Ro(w)||io(w))return m=m.get(y)||null,u(p,m,w,A,null);bl(p,w)}return null}function g(m,p,y,w){for(var A=null,x=null,I=p,O=p=0,D=null;I!==null&&O<y.length;O++){I.index>O?(D=I,I=null):D=I.sibling;var z=h(m,I,y[O],w);if(z===null){I===null&&(I=D);break}t&&I&&z.alternate===null&&e(m,I),p=s(z,p,O),x===null?A=z:x.sibling=z,x=z,I=D}if(O===y.length)return n(m,I),ve&&Wr(m,O),A;if(I===null){for(;O<y.length;O++)I=f(m,y[O],w),I!==null&&(p=s(I,p,O),x===null?A=I:x.sibling=I,x=I);return ve&&Wr(m,O),A}for(I=r(m,I);O<y.length;O++)D=d(I,m,O,y[O],w),D!==null&&(t&&D.alternate!==null&&I.delete(D.key===null?O:D.key),p=s(D,p,O),x===null?A=D:x.sibling=D,x=D);return t&&I.forEach(function(H){return e(m,H)}),ve&&Wr(m,O),A}function _(m,p,y,w){var A=io(y);if(typeof A!="function")throw Error(L(150));if(y=A.call(y),y==null)throw Error(L(151));for(var x=A=null,I=p,O=p=0,D=null,z=y.next();I!==null&&!z.done;O++,z=y.next()){I.index>O?(D=I,I=null):D=I.sibling;var H=h(m,I,z.value,w);if(H===null){I===null&&(I=D);break}t&&I&&H.alternate===null&&e(m,I),p=s(H,p,O),x===null?A=H:x.sibling=H,x=H,I=D}if(z.done)return n(m,I),ve&&Wr(m,O),A;if(I===null){for(;!z.done;O++,z=y.next())z=f(m,z.value,w),z!==null&&(p=s(z,p,O),x===null?A=z:x.sibling=z,x=z);return ve&&Wr(m,O),A}for(I=r(m,I);!z.done;O++,z=y.next())z=d(I,m,O,z.value,w),z!==null&&(t&&z.alternate!==null&&I.delete(z.key===null?O:z.key),p=s(z,p,O),x===null?A=z:x.sibling=z,x=z);return t&&I.forEach(function(Y){return e(m,Y)}),ve&&Wr(m,O),A}function b(m,p,y,w){if(typeof y=="object"&&y!==null&&y.type===Hi&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case dl:e:{for(var A=y.key,x=p;x!==null;){if(x.key===A){if(A=y.type,A===Hi){if(x.tag===7){n(m,x.sibling),p=i(x,y.props.children),p.return=m,m=p;break e}}else if(x.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===sr&&Gy(A)===x.type){n(m,x.sibling),p=i(x,y.props),p.ref=co(m,x,y),p.return=m,m=p;break e}n(m,x);break}else e(m,x);x=x.sibling}y.type===Hi?(p=oi(y.props.children,m.mode,w,y.key),p.return=m,m=p):(w=mc(y.type,y.key,y.props,null,m.mode,w),w.ref=co(m,p,y),w.return=m,m=w)}return o(m);case Wi:e:{for(x=y.key;p!==null;){if(p.key===x)if(p.tag===4&&p.stateNode.containerInfo===y.containerInfo&&p.stateNode.implementation===y.implementation){n(m,p.sibling),p=i(p,y.children||[]),p.return=m,m=p;break e}else{n(m,p);break}else e(m,p);p=p.sibling}p=Uh(y,m.mode,w),p.return=m,m=p}return o(m);case sr:return x=y._init,b(m,p,x(y._payload),w)}if(Ro(y))return g(m,p,y,w);if(io(y))return _(m,p,y,w);bl(m,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,p!==null&&p.tag===6?(n(m,p.sibling),p=i(p,y),p.return=m,m=p):(n(m,p),p=Lh(y,m.mode,w),p.return=m,m=p),o(m)):n(m,p)}return b}var Is=nS(!0),rS=nS(!1),Hc=Or(null),Xc=null,Gi=null,d_=null;function p_(){d_=Gi=Xc=null}function g_(t){var e=Hc.current;ye(Hc),t._currentValue=e}function yp(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ps(t,e){Xc=t,d_=Gi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(dt=!0),t.firstContext=null)}function Ut(t){var e=t._currentValue;if(d_!==t)if(t={context:t,memoizedValue:e,next:null},Gi===null){if(Xc===null)throw Error(L(308));Gi=t,Xc.dependencies={lanes:0,firstContext:t}}else Gi=Gi.next=t;return e}var Jr=null;function __(t){Jr===null?Jr=[t]:Jr.push(t)}function iS(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,__(e)):(n.next=i.next,i.next=n),e.interleaved=n,Wn(t,r)}function Wn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var or=!1;function m_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function $n(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Sr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,re&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Wn(t,n)}return i=r.interleaved,i===null?(e.next=e,__(r)):(e.next=i.next,i.next=e),r.interleaved=e,Wn(t,n)}function fc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,n_(t,n)}}function e0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Yc(t,e,n,r){var i=t.updateQueue;or=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,u=c=l=null,a=s;do{var h=a.lane,d=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var g=t,_=a;switch(h=e,d=n,_.tag){case 1:if(g=_.payload,typeof g=="function"){f=g.call(d,f,h);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=_.payload,h=typeof g=="function"?g.call(d,f,h):g,h==null)break e;f=Ae({},f,h);break e;case 2:or=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else d={eventTime:d,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=d,l=f):u=u.next=d,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(u===null&&(l=f),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);di|=o,t.lanes=o,t.memoizedState=f}}function t0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(L(191,i));i.call(r)}}}var La={},En=Or(La),fa=Or(La),ha=Or(La);function Gr(t){if(t===La)throw Error(L(174));return t}function y_(t,e){switch(pe(ha,e),pe(fa,t),pe(En,La),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Jd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Jd(e,t)}ye(En),pe(En,e)}function Ms(){ye(En),ye(fa),ye(ha)}function oS(t){Gr(ha.current);var e=Gr(En.current),n=Jd(e,t.type);e!==n&&(pe(fa,t),pe(En,n))}function v_(t){fa.current===t&&(ye(En),ye(fa))}var Se=Or(0);function Kc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Nh=[];function T_(){for(var t=0;t<Nh.length;t++)Nh[t]._workInProgressVersionPrimary=null;Nh.length=0}var hc=Yn.ReactCurrentDispatcher,kh=Yn.ReactCurrentBatchConfig,hi=0,be=null,De=null,Ve=null,qc=!1,zo=!1,da=0,DP=0;function Ge(){throw Error(L(321))}function w_(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!rn(t[n],e[n]))return!1;return!0}function S_(t,e,n,r,i,s){if(hi=s,be=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,hc.current=t===null||t.memoizedState===null?zP:$P,t=n(r,i),zo){s=0;do{if(zo=!1,da=0,25<=s)throw Error(L(301));s+=1,Ve=De=null,e.updateQueue=null,hc.current=VP,t=n(r,i)}while(zo)}if(hc.current=Zc,e=De!==null&&De.next!==null,hi=0,Ve=De=be=null,qc=!1,e)throw Error(L(300));return t}function E_(){var t=da!==0;return da=0,t}function pn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ve===null?be.memoizedState=Ve=t:Ve=Ve.next=t,Ve}function zt(){if(De===null){var t=be.alternate;t=t!==null?t.memoizedState:null}else t=De.next;var e=Ve===null?be.memoizedState:Ve.next;if(e!==null)Ve=e,De=t;else{if(t===null)throw Error(L(310));De=t,t={memoizedState:De.memoizedState,baseState:De.baseState,baseQueue:De.baseQueue,queue:De.queue,next:null},Ve===null?be.memoizedState=Ve=t:Ve=Ve.next=t}return Ve}function pa(t,e){return typeof e=="function"?e(t):e}function Oh(t){var e=zt(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=De,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((hi&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,be.lanes|=u,di|=u}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,rn(r,e.memoizedState)||(dt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,be.lanes|=s,di|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Fh(t){var e=zt(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);rn(s,e.memoizedState)||(dt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function aS(){}function lS(t,e){var n=be,r=zt(),i=e(),s=!rn(r.memoizedState,i);if(s&&(r.memoizedState=i,dt=!0),r=r.queue,b_(fS.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Ve!==null&&Ve.memoizedState.tag&1){if(n.flags|=2048,ga(9,uS.bind(null,n,r,i,e),void 0,null),je===null)throw Error(L(349));hi&30||cS(n,e,i)}return i}function cS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=be.updateQueue,e===null?(e={lastEffect:null,stores:null},be.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function uS(t,e,n,r){e.value=n,e.getSnapshot=r,hS(e)&&dS(t)}function fS(t,e,n){return n(function(){hS(e)&&dS(t)})}function hS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!rn(t,n)}catch{return!0}}function dS(t){var e=Wn(t,1);e!==null&&en(e,t,1,-1)}function n0(t){var e=pn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pa,lastRenderedState:t},e.queue=t,t=t.dispatch=UP.bind(null,be,t),[e.memoizedState,t]}function ga(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=be.updateQueue,e===null?(e={lastEffect:null,stores:null},be.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function pS(){return zt().memoizedState}function dc(t,e,n,r){var i=pn();be.flags|=t,i.memoizedState=ga(1|e,n,void 0,r===void 0?null:r)}function wf(t,e,n,r){var i=zt();r=r===void 0?null:r;var s=void 0;if(De!==null){var o=De.memoizedState;if(s=o.destroy,r!==null&&w_(r,o.deps)){i.memoizedState=ga(e,n,s,r);return}}be.flags|=t,i.memoizedState=ga(1|e,n,s,r)}function r0(t,e){return dc(8390656,8,t,e)}function b_(t,e){return wf(2048,8,t,e)}function gS(t,e){return wf(4,2,t,e)}function _S(t,e){return wf(4,4,t,e)}function mS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function yS(t,e,n){return n=n!=null?n.concat([t]):null,wf(4,4,mS.bind(null,e,t),n)}function A_(){}function vS(t,e){var n=zt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&w_(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function TS(t,e){var n=zt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&w_(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function wS(t,e,n){return hi&21?(rn(n,e)||(n=R1(),be.lanes|=n,di|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,dt=!0),t.memoizedState=n)}function BP(t,e){var n=le;le=n!==0&&4>n?n:4,t(!0);var r=kh.transition;kh.transition={};try{t(!1),e()}finally{le=n,kh.transition=r}}function SS(){return zt().memoizedState}function LP(t,e,n){var r=br(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ES(t))bS(e,n);else if(n=iS(t,e,n,r),n!==null){var i=lt();en(n,t,r,i),AS(n,e,r)}}function UP(t,e,n){var r=br(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ES(t))bS(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,rn(a,o)){var l=e.interleaved;l===null?(i.next=i,__(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=iS(t,e,i,r),n!==null&&(i=lt(),en(n,t,r,i),AS(n,e,r))}}function ES(t){var e=t.alternate;return t===be||e!==null&&e===be}function bS(t,e){zo=qc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function AS(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,n_(t,n)}}var Zc={readContext:Ut,useCallback:Ge,useContext:Ge,useEffect:Ge,useImperativeHandle:Ge,useInsertionEffect:Ge,useLayoutEffect:Ge,useMemo:Ge,useReducer:Ge,useRef:Ge,useState:Ge,useDebugValue:Ge,useDeferredValue:Ge,useTransition:Ge,useMutableSource:Ge,useSyncExternalStore:Ge,useId:Ge,unstable_isNewReconciler:!1},zP={readContext:Ut,useCallback:function(t,e){return pn().memoizedState=[t,e===void 0?null:e],t},useContext:Ut,useEffect:r0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,dc(4194308,4,mS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return dc(4194308,4,t,e)},useInsertionEffect:function(t,e){return dc(4,2,t,e)},useMemo:function(t,e){var n=pn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=pn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=LP.bind(null,be,t),[r.memoizedState,t]},useRef:function(t){var e=pn();return t={current:t},e.memoizedState=t},useState:n0,useDebugValue:A_,useDeferredValue:function(t){return pn().memoizedState=t},useTransition:function(){var t=n0(!1),e=t[0];return t=BP.bind(null,t[1]),pn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=be,i=pn();if(ve){if(n===void 0)throw Error(L(407));n=n()}else{if(n=e(),je===null)throw Error(L(349));hi&30||cS(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,r0(fS.bind(null,r,s,t),[t]),r.flags|=2048,ga(9,uS.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=pn(),e=je.identifierPrefix;if(ve){var n=Un,r=Ln;n=(r&~(1<<32-Gt(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=da++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=DP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},$P={readContext:Ut,useCallback:vS,useContext:Ut,useEffect:b_,useImperativeHandle:yS,useInsertionEffect:gS,useLayoutEffect:_S,useMemo:TS,useReducer:Oh,useRef:pS,useState:function(){return Oh(pa)},useDebugValue:A_,useDeferredValue:function(t){var e=zt();return wS(e,De.memoizedState,t)},useTransition:function(){var t=Oh(pa)[0],e=zt().memoizedState;return[t,e]},useMutableSource:aS,useSyncExternalStore:lS,useId:SS,unstable_isNewReconciler:!1},VP={readContext:Ut,useCallback:vS,useContext:Ut,useEffect:b_,useImperativeHandle:yS,useInsertionEffect:gS,useLayoutEffect:_S,useMemo:TS,useReducer:Fh,useRef:pS,useState:function(){return Fh(pa)},useDebugValue:A_,useDeferredValue:function(t){var e=zt();return De===null?e.memoizedState=t:wS(e,De.memoizedState,t)},useTransition:function(){var t=Fh(pa)[0],e=zt().memoizedState;return[t,e]},useMutableSource:aS,useSyncExternalStore:lS,useId:SS,unstable_isNewReconciler:!1};function Xt(t,e){if(t&&t.defaultProps){e=Ae({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function vp(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ae({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Sf={isMounted:function(t){return(t=t._reactInternals)?Ti(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=lt(),i=br(t),s=$n(r,i);s.payload=e,n!=null&&(s.callback=n),e=Sr(t,s,i),e!==null&&(en(e,t,i,r),fc(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=lt(),i=br(t),s=$n(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Sr(t,s,i),e!==null&&(en(e,t,i,r),fc(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=lt(),r=br(t),i=$n(n,r);i.tag=2,e!=null&&(i.callback=e),e=Sr(t,i,r),e!==null&&(en(e,t,r,n),fc(e,t,r))}};function i0(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!aa(n,r)||!aa(i,s):!0}function RS(t,e,n){var r=!1,i=Pr,s=e.contextType;return typeof s=="object"&&s!==null?s=Ut(s):(i=gt(e)?ui:it.current,r=e.contextTypes,s=(r=r!=null)?Cs(t,i):Pr),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Sf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function s0(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Sf.enqueueReplaceState(e,e.state,null)}function Tp(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},m_(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Ut(s):(s=gt(e)?ui:it.current,i.context=Cs(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(vp(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Sf.enqueueReplaceState(i,i.state,null),Yc(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Ns(t,e){try{var n="",r=e;do n+=_C(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Dh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function wp(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var jP=typeof WeakMap=="function"?WeakMap:Map;function xS(t,e,n){n=$n(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Jc||(Jc=!0,Mp=r),wp(t,e)},n}function CS(t,e,n){n=$n(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){wp(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){wp(t,e),typeof r!="function"&&(Er===null?Er=new Set([this]):Er.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function o0(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new jP;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=r3.bind(null,t,e,n),e.then(t,t))}function a0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function l0(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=$n(-1,1),e.tag=2,Sr(n,e,1))),n.lanes|=1),t)}var WP=Yn.ReactCurrentOwner,dt=!1;function at(t,e,n,r){e.child=t===null?rS(e,null,n,r):Is(e,t.child,n,r)}function c0(t,e,n,r,i){n=n.render;var s=e.ref;return ps(e,i),r=S_(t,e,n,r,s,i),n=E_(),t!==null&&!dt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Hn(t,e,i)):(ve&&n&&u_(e),e.flags|=1,at(t,e,r,i),e.child)}function u0(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!k_(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,PS(t,e,s,r,i)):(t=mc(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:aa,n(o,r)&&t.ref===e.ref)return Hn(t,e,i)}return e.flags|=1,t=Ar(s,r),t.ref=e.ref,t.return=e,e.child=t}function PS(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(aa(s,r)&&t.ref===e.ref)if(dt=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(dt=!0);else return e.lanes=t.lanes,Hn(t,e,i)}return Sp(t,e,n,r,i)}function IS(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},pe(ts,vt),vt|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,pe(ts,vt),vt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,pe(ts,vt),vt|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,pe(ts,vt),vt|=r;return at(t,e,i,n),e.child}function MS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Sp(t,e,n,r,i){var s=gt(n)?ui:it.current;return s=Cs(e,s),ps(e,i),n=S_(t,e,n,r,s,i),r=E_(),t!==null&&!dt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Hn(t,e,i)):(ve&&r&&u_(e),e.flags|=1,at(t,e,n,i),e.child)}function f0(t,e,n,r,i){if(gt(n)){var s=!0;Vc(e)}else s=!1;if(ps(e,i),e.stateNode===null)pc(t,e),RS(e,n,r),Tp(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Ut(c):(c=gt(n)?ui:it.current,c=Cs(e,c));var u=n.getDerivedStateFromProps,f=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&s0(e,o,r,c),or=!1;var h=e.memoizedState;o.state=h,Yc(e,r,o,i),l=e.memoizedState,a!==r||h!==l||pt.current||or?(typeof u=="function"&&(vp(e,n,u,r),l=e.memoizedState),(a=or||i0(e,n,a,r,h,l,c))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,sS(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Xt(e.type,a),o.props=c,f=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ut(l):(l=gt(n)?ui:it.current,l=Cs(e,l));var d=n.getDerivedStateFromProps;(u=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||h!==l)&&s0(e,o,r,l),or=!1,h=e.memoizedState,o.state=h,Yc(e,r,o,i);var g=e.memoizedState;a!==f||h!==g||pt.current||or?(typeof d=="function"&&(vp(e,n,d,r),g=e.memoizedState),(c=or||i0(e,n,c,r,h,g,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Ep(t,e,n,r,s,i)}function Ep(t,e,n,r,i,s){MS(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Zy(e,n,!1),Hn(t,e,s);r=e.stateNode,WP.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Is(e,t.child,null,s),e.child=Is(e,null,a,s)):at(t,e,a,s),e.memoizedState=r.state,i&&Zy(e,n,!0),e.child}function NS(t){var e=t.stateNode;e.pendingContext?qy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&qy(t,e.context,!1),y_(t,e.containerInfo)}function h0(t,e,n,r,i){return Ps(),h_(i),e.flags|=256,at(t,e,n,r),e.child}var bp={dehydrated:null,treeContext:null,retryLane:0};function Ap(t){return{baseLanes:t,cachePool:null,transitions:null}}function kS(t,e,n){var r=e.pendingProps,i=Se.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),pe(Se,i&1),t===null)return mp(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Af(o,r,0,null),t=oi(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Ap(n),e.memoizedState=bp,t):R_(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return HP(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ar(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Ar(a,s):(s=oi(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Ap(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=bp,r}return s=t.child,t=s.sibling,r=Ar(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function R_(t,e){return e=Af({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Al(t,e,n,r){return r!==null&&h_(r),Is(e,t.child,null,n),t=R_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function HP(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Dh(Error(L(422))),Al(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Af({mode:"visible",children:r.children},i,0,null),s=oi(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Is(e,t.child,null,o),e.child.memoizedState=Ap(o),e.memoizedState=bp,s);if(!(e.mode&1))return Al(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(L(419)),r=Dh(s,r,void 0),Al(t,e,o,r)}if(a=(o&t.childLanes)!==0,dt||a){if(r=je,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Wn(t,i),en(r,t,i,-1))}return N_(),r=Dh(Error(L(421))),Al(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=i3.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,wt=wr(i.nextSibling),Et=e,ve=!0,Kt=null,t!==null&&(Nt[kt++]=Ln,Nt[kt++]=Un,Nt[kt++]=fi,Ln=t.id,Un=t.overflow,fi=e),e=R_(e,r.children),e.flags|=4096,e)}function d0(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),yp(t.return,e,n)}function Bh(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function OS(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(at(t,e,r.children,n),r=Se.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&d0(t,n,e);else if(t.tag===19)d0(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(pe(Se,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Kc(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Bh(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Kc(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Bh(e,!0,n,null,s);break;case"together":Bh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function pc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Hn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),di|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(L(153));if(e.child!==null){for(t=e.child,n=Ar(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ar(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function XP(t,e,n){switch(e.tag){case 3:NS(e),Ps();break;case 5:oS(e);break;case 1:gt(e.type)&&Vc(e);break;case 4:y_(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;pe(Hc,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(pe(Se,Se.current&1),e.flags|=128,null):n&e.child.childLanes?kS(t,e,n):(pe(Se,Se.current&1),t=Hn(t,e,n),t!==null?t.sibling:null);pe(Se,Se.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return OS(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),pe(Se,Se.current),r)break;return null;case 22:case 23:return e.lanes=0,IS(t,e,n)}return Hn(t,e,n)}var FS,Rp,DS,BS;FS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Rp=function(){};DS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Gr(En.current);var s=null;switch(n){case"input":i=Kd(t,i),r=Kd(t,r),s=[];break;case"select":i=Ae({},i,{value:void 0}),r=Ae({},r,{value:void 0}),s=[];break;case"textarea":i=Qd(t,i),r=Qd(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=zc)}Gd(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ea.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ea.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&me("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};BS=function(t,e,n,r){n!==r&&(e.flags|=4)};function uo(t,e){if(!ve)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function et(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function YP(t,e,n){var r=e.pendingProps;switch(f_(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return et(e),null;case 1:return gt(e.type)&&$c(),et(e),null;case 3:return r=e.stateNode,Ms(),ye(pt),ye(it),T_(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(El(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Kt!==null&&(Op(Kt),Kt=null))),Rp(t,e),et(e),null;case 5:v_(e);var i=Gr(ha.current);if(n=e.type,t!==null&&e.stateNode!=null)DS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(L(166));return et(e),null}if(t=Gr(En.current),El(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[mn]=e,r[ua]=s,t=(e.mode&1)!==0,n){case"dialog":me("cancel",r),me("close",r);break;case"iframe":case"object":case"embed":me("load",r);break;case"video":case"audio":for(i=0;i<Co.length;i++)me(Co[i],r);break;case"source":me("error",r);break;case"img":case"image":case"link":me("error",r),me("load",r);break;case"details":me("toggle",r);break;case"input":Sy(r,s),me("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},me("invalid",r);break;case"textarea":by(r,s),me("invalid",r)}Gd(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Sl(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Sl(r.textContent,a,t),i=["children",""+a]):ea.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&me("scroll",r)}switch(n){case"input":pl(r),Ey(r,s,!0);break;case"textarea":pl(r),Ay(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=zc)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=f1(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[mn]=e,t[ua]=r,FS(t,e,!1,!1),e.stateNode=t;e:{switch(o=ep(n,r),n){case"dialog":me("cancel",t),me("close",t),i=r;break;case"iframe":case"object":case"embed":me("load",t),i=r;break;case"video":case"audio":for(i=0;i<Co.length;i++)me(Co[i],t);i=r;break;case"source":me("error",t),i=r;break;case"img":case"image":case"link":me("error",t),me("load",t),i=r;break;case"details":me("toggle",t),i=r;break;case"input":Sy(t,r),i=Kd(t,r),me("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ae({},r,{value:void 0}),me("invalid",t);break;case"textarea":by(t,r),i=Qd(t,r),me("invalid",t);break;default:i=r}Gd(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?p1(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&h1(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&ta(t,l):typeof l=="number"&&ta(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ea.hasOwnProperty(s)?l!=null&&s==="onScroll"&&me("scroll",t):l!=null&&Zg(t,s,l,o))}switch(n){case"input":pl(t),Ey(t,r,!1);break;case"textarea":pl(t),Ay(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Cr(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?us(t,!!r.multiple,s,!1):r.defaultValue!=null&&us(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=zc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return et(e),null;case 6:if(t&&e.stateNode!=null)BS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(L(166));if(n=Gr(ha.current),Gr(En.current),El(e)){if(r=e.stateNode,n=e.memoizedProps,r[mn]=e,(s=r.nodeValue!==n)&&(t=Et,t!==null))switch(t.tag){case 3:Sl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Sl(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[mn]=e,e.stateNode=r}return et(e),null;case 13:if(ye(Se),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ve&&wt!==null&&e.mode&1&&!(e.flags&128))tS(),Ps(),e.flags|=98560,s=!1;else if(s=El(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(L(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(L(317));s[mn]=e}else Ps(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;et(e),s=!1}else Kt!==null&&(Op(Kt),Kt=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Se.current&1?Be===0&&(Be=3):N_())),e.updateQueue!==null&&(e.flags|=4),et(e),null);case 4:return Ms(),Rp(t,e),t===null&&la(e.stateNode.containerInfo),et(e),null;case 10:return g_(e.type._context),et(e),null;case 17:return gt(e.type)&&$c(),et(e),null;case 19:if(ye(Se),s=e.memoizedState,s===null)return et(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)uo(s,!1);else{if(Be!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Kc(t),o!==null){for(e.flags|=128,uo(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return pe(Se,Se.current&1|2),e.child}t=t.sibling}s.tail!==null&&Pe()>ks&&(e.flags|=128,r=!0,uo(s,!1),e.lanes=4194304)}else{if(!r)if(t=Kc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),uo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ve)return et(e),null}else 2*Pe()-s.renderingStartTime>ks&&n!==1073741824&&(e.flags|=128,r=!0,uo(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Pe(),e.sibling=null,n=Se.current,pe(Se,r?n&1|2:n&1),e):(et(e),null);case 22:case 23:return M_(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?vt&1073741824&&(et(e),e.subtreeFlags&6&&(e.flags|=8192)):et(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function KP(t,e){switch(f_(e),e.tag){case 1:return gt(e.type)&&$c(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ms(),ye(pt),ye(it),T_(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return v_(e),null;case 13:if(ye(Se),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(L(340));Ps()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ye(Se),null;case 4:return Ms(),null;case 10:return g_(e.type._context),null;case 22:case 23:return M_(),null;case 24:return null;default:return null}}var Rl=!1,rt=!1,qP=typeof WeakSet=="function"?WeakSet:Set,W=null;function es(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ce(t,e,r)}else n.current=null}function xp(t,e,n){try{n()}catch(r){Ce(t,e,r)}}var p0=!1;function ZP(t,e){if(up=Bc,t=V1(),c_(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,f=t,h=null;t:for(;;){for(var d;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(d=f.firstChild)!==null;)h=f,f=d;for(;;){if(f===t)break t;if(h===n&&++c===i&&(a=o),h===s&&++u===r&&(l=o),(d=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=d}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(fp={focusedElem:t,selectionRange:n},Bc=!1,W=e;W!==null;)if(e=W,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,W=t;else for(;W!==null;){e=W;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var _=g.memoizedProps,b=g.memoizedState,m=e.stateNode,p=m.getSnapshotBeforeUpdate(e.elementType===e.type?_:Xt(e.type,_),b);m.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(w){Ce(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,W=t;break}W=e.return}return g=p0,p0=!1,g}function $o(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&xp(e,n,s)}i=i.next}while(i!==r)}}function Ef(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Cp(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function LS(t){var e=t.alternate;e!==null&&(t.alternate=null,LS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[mn],delete e[ua],delete e[pp],delete e[NP],delete e[kP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function US(t){return t.tag===5||t.tag===3||t.tag===4}function g0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||US(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Pp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=zc));else if(r!==4&&(t=t.child,t!==null))for(Pp(t,e,n),t=t.sibling;t!==null;)Pp(t,e,n),t=t.sibling}function Ip(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Ip(t,e,n),t=t.sibling;t!==null;)Ip(t,e,n),t=t.sibling}var Ke=null,Yt=!1;function Gn(t,e,n){for(n=n.child;n!==null;)zS(t,e,n),n=n.sibling}function zS(t,e,n){if(Sn&&typeof Sn.onCommitFiberUnmount=="function")try{Sn.onCommitFiberUnmount(gf,n)}catch{}switch(n.tag){case 5:rt||es(n,e);case 6:var r=Ke,i=Yt;Ke=null,Gn(t,e,n),Ke=r,Yt=i,Ke!==null&&(Yt?(t=Ke,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ke.removeChild(n.stateNode));break;case 18:Ke!==null&&(Yt?(t=Ke,n=n.stateNode,t.nodeType===8?Ih(t.parentNode,n):t.nodeType===1&&Ih(t,n),sa(t)):Ih(Ke,n.stateNode));break;case 4:r=Ke,i=Yt,Ke=n.stateNode.containerInfo,Yt=!0,Gn(t,e,n),Ke=r,Yt=i;break;case 0:case 11:case 14:case 15:if(!rt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&xp(n,e,o),i=i.next}while(i!==r)}Gn(t,e,n);break;case 1:if(!rt&&(es(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ce(n,e,a)}Gn(t,e,n);break;case 21:Gn(t,e,n);break;case 22:n.mode&1?(rt=(r=rt)||n.memoizedState!==null,Gn(t,e,n),rt=r):Gn(t,e,n);break;default:Gn(t,e,n)}}function _0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new qP),e.forEach(function(r){var i=s3.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Ht(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ke=a.stateNode,Yt=!1;break e;case 3:Ke=a.stateNode.containerInfo,Yt=!0;break e;case 4:Ke=a.stateNode.containerInfo,Yt=!0;break e}a=a.return}if(Ke===null)throw Error(L(160));zS(s,o,i),Ke=null,Yt=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Ce(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)$S(e,t),e=e.sibling}function $S(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ht(e,t),ln(t),r&4){try{$o(3,t,t.return),Ef(3,t)}catch(_){Ce(t,t.return,_)}try{$o(5,t,t.return)}catch(_){Ce(t,t.return,_)}}break;case 1:Ht(e,t),ln(t),r&512&&n!==null&&es(n,n.return);break;case 5:if(Ht(e,t),ln(t),r&512&&n!==null&&es(n,n.return),t.flags&32){var i=t.stateNode;try{ta(i,"")}catch(_){Ce(t,t.return,_)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&c1(i,s),ep(a,o);var c=ep(a,s);for(o=0;o<l.length;o+=2){var u=l[o],f=l[o+1];u==="style"?p1(i,f):u==="dangerouslySetInnerHTML"?h1(i,f):u==="children"?ta(i,f):Zg(i,u,f,c)}switch(a){case"input":qd(i,s);break;case"textarea":u1(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?us(i,!!s.multiple,d,!1):h!==!!s.multiple&&(s.defaultValue!=null?us(i,!!s.multiple,s.defaultValue,!0):us(i,!!s.multiple,s.multiple?[]:"",!1))}i[ua]=s}catch(_){Ce(t,t.return,_)}}break;case 6:if(Ht(e,t),ln(t),r&4){if(t.stateNode===null)throw Error(L(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(_){Ce(t,t.return,_)}}break;case 3:if(Ht(e,t),ln(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{sa(e.containerInfo)}catch(_){Ce(t,t.return,_)}break;case 4:Ht(e,t),ln(t);break;case 13:Ht(e,t),ln(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(P_=Pe())),r&4&&_0(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(rt=(c=rt)||u,Ht(e,t),rt=c):Ht(e,t),ln(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(W=t,u=t.child;u!==null;){for(f=W=u;W!==null;){switch(h=W,d=h.child,h.tag){case 0:case 11:case 14:case 15:$o(4,h,h.return);break;case 1:es(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(_){Ce(r,n,_)}}break;case 5:es(h,h.return);break;case 22:if(h.memoizedState!==null){y0(f);continue}}d!==null?(d.return=h,W=d):y0(f)}u=u.sibling}e:for(u=null,f=t;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=d1("display",o))}catch(_){Ce(t,t.return,_)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(_){Ce(t,t.return,_)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ht(e,t),ln(t),r&4&&_0(t);break;case 21:break;default:Ht(e,t),ln(t)}}function ln(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(US(n)){var r=n;break e}n=n.return}throw Error(L(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ta(i,""),r.flags&=-33);var s=g0(t);Ip(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=g0(t);Pp(t,a,o);break;default:throw Error(L(161))}}catch(l){Ce(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function QP(t,e,n){W=t,VS(t)}function VS(t,e,n){for(var r=(t.mode&1)!==0;W!==null;){var i=W,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Rl;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||rt;a=Rl;var c=rt;if(Rl=o,(rt=l)&&!c)for(W=i;W!==null;)o=W,l=o.child,o.tag===22&&o.memoizedState!==null?v0(i):l!==null?(l.return=o,W=l):v0(i);for(;s!==null;)W=s,VS(s),s=s.sibling;W=i,Rl=a,rt=c}m0(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,W=s):m0(t)}}function m0(t){for(;W!==null;){var e=W;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:rt||Ef(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!rt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Xt(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&t0(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}t0(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&sa(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}rt||e.flags&512&&Cp(e)}catch(h){Ce(e,e.return,h)}}if(e===t){W=null;break}if(n=e.sibling,n!==null){n.return=e.return,W=n;break}W=e.return}}function y0(t){for(;W!==null;){var e=W;if(e===t){W=null;break}var n=e.sibling;if(n!==null){n.return=e.return,W=n;break}W=e.return}}function v0(t){for(;W!==null;){var e=W;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ef(4,e)}catch(l){Ce(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Ce(e,i,l)}}var s=e.return;try{Cp(e)}catch(l){Ce(e,s,l)}break;case 5:var o=e.return;try{Cp(e)}catch(l){Ce(e,o,l)}}}catch(l){Ce(e,e.return,l)}if(e===t){W=null;break}var a=e.sibling;if(a!==null){a.return=e.return,W=a;break}W=e.return}}var JP=Math.ceil,Qc=Yn.ReactCurrentDispatcher,x_=Yn.ReactCurrentOwner,Dt=Yn.ReactCurrentBatchConfig,re=0,je=null,Oe=null,qe=0,vt=0,ts=Or(0),Be=0,_a=null,di=0,bf=0,C_=0,Vo=null,ft=null,P_=0,ks=1/0,On=null,Jc=!1,Mp=null,Er=null,xl=!1,dr=null,Gc=0,jo=0,Np=null,gc=-1,_c=0;function lt(){return re&6?Pe():gc!==-1?gc:gc=Pe()}function br(t){return t.mode&1?re&2&&qe!==0?qe&-qe:FP.transition!==null?(_c===0&&(_c=R1()),_c):(t=le,t!==0||(t=window.event,t=t===void 0?16:k1(t.type)),t):1}function en(t,e,n,r){if(50<jo)throw jo=0,Np=null,Error(L(185));Fa(t,n,r),(!(re&2)||t!==je)&&(t===je&&(!(re&2)&&(bf|=n),Be===4&&ur(t,qe)),_t(t,r),n===1&&re===0&&!(e.mode&1)&&(ks=Pe()+500,Tf&&Fr()))}function _t(t,e){var n=t.callbackNode;FC(t,e);var r=Dc(t,t===je?qe:0);if(r===0)n!==null&&Cy(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Cy(n),e===1)t.tag===0?OP(T0.bind(null,t)):J1(T0.bind(null,t)),IP(function(){!(re&6)&&Fr()}),n=null;else{switch(x1(r)){case 1:n=t_;break;case 4:n=b1;break;case 16:n=Fc;break;case 536870912:n=A1;break;default:n=Fc}n=ZS(n,jS.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function jS(t,e){if(gc=-1,_c=0,re&6)throw Error(L(327));var n=t.callbackNode;if(gs()&&t.callbackNode!==n)return null;var r=Dc(t,t===je?qe:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=eu(t,r);else{e=r;var i=re;re|=2;var s=HS();(je!==t||qe!==e)&&(On=null,ks=Pe()+500,si(t,e));do try{t3();break}catch(a){WS(t,a)}while(1);p_(),Qc.current=s,re=i,Oe!==null?e=0:(je=null,qe=0,e=Be)}if(e!==0){if(e===2&&(i=sp(t),i!==0&&(r=i,e=kp(t,i))),e===1)throw n=_a,si(t,0),ur(t,r),_t(t,Pe()),n;if(e===6)ur(t,r);else{if(i=t.current.alternate,!(r&30)&&!GP(i)&&(e=eu(t,r),e===2&&(s=sp(t),s!==0&&(r=s,e=kp(t,s))),e===1))throw n=_a,si(t,0),ur(t,r),_t(t,Pe()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(L(345));case 2:Hr(t,ft,On);break;case 3:if(ur(t,r),(r&130023424)===r&&(e=P_+500-Pe(),10<e)){if(Dc(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){lt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=dp(Hr.bind(null,t,ft,On),e);break}Hr(t,ft,On);break;case 4:if(ur(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Gt(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Pe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*JP(r/1960))-r,10<r){t.timeoutHandle=dp(Hr.bind(null,t,ft,On),r);break}Hr(t,ft,On);break;case 5:Hr(t,ft,On);break;default:throw Error(L(329))}}}return _t(t,Pe()),t.callbackNode===n?jS.bind(null,t):null}function kp(t,e){var n=Vo;return t.current.memoizedState.isDehydrated&&(si(t,e).flags|=256),t=eu(t,e),t!==2&&(e=ft,ft=n,e!==null&&Op(e)),t}function Op(t){ft===null?ft=t:ft.push.apply(ft,t)}function GP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!rn(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ur(t,e){for(e&=~C_,e&=~bf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Gt(e),r=1<<n;t[n]=-1,e&=~r}}function T0(t){if(re&6)throw Error(L(327));gs();var e=Dc(t,0);if(!(e&1))return _t(t,Pe()),null;var n=eu(t,e);if(t.tag!==0&&n===2){var r=sp(t);r!==0&&(e=r,n=kp(t,r))}if(n===1)throw n=_a,si(t,0),ur(t,e),_t(t,Pe()),n;if(n===6)throw Error(L(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Hr(t,ft,On),_t(t,Pe()),null}function I_(t,e){var n=re;re|=1;try{return t(e)}finally{re=n,re===0&&(ks=Pe()+500,Tf&&Fr())}}function pi(t){dr!==null&&dr.tag===0&&!(re&6)&&gs();var e=re;re|=1;var n=Dt.transition,r=le;try{if(Dt.transition=null,le=1,t)return t()}finally{le=r,Dt.transition=n,re=e,!(re&6)&&Fr()}}function M_(){vt=ts.current,ye(ts)}function si(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,PP(n)),Oe!==null)for(n=Oe.return;n!==null;){var r=n;switch(f_(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&$c();break;case 3:Ms(),ye(pt),ye(it),T_();break;case 5:v_(r);break;case 4:Ms();break;case 13:ye(Se);break;case 19:ye(Se);break;case 10:g_(r.type._context);break;case 22:case 23:M_()}n=n.return}if(je=t,Oe=t=Ar(t.current,null),qe=vt=e,Be=0,_a=null,C_=bf=di=0,ft=Vo=null,Jr!==null){for(e=0;e<Jr.length;e++)if(n=Jr[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Jr=null}return t}function WS(t,e){do{var n=Oe;try{if(p_(),hc.current=Zc,qc){for(var r=be.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}qc=!1}if(hi=0,Ve=De=be=null,zo=!1,da=0,x_.current=null,n===null||n.return===null){Be=1,_a=e,Oe=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=qe,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var d=a0(o);if(d!==null){d.flags&=-257,l0(d,o,a,s,e),d.mode&1&&o0(s,c,e),e=d,l=c;var g=e.updateQueue;if(g===null){var _=new Set;_.add(l),e.updateQueue=_}else g.add(l);break e}else{if(!(e&1)){o0(s,c,e),N_();break e}l=Error(L(426))}}else if(ve&&a.mode&1){var b=a0(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),l0(b,o,a,s,e),h_(Ns(l,a));break e}}s=l=Ns(l,a),Be!==4&&(Be=2),Vo===null?Vo=[s]:Vo.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var m=xS(s,l,e);e0(s,m);break e;case 1:a=l;var p=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof p.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Er===null||!Er.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=CS(s,a,e);e0(s,w);break e}}s=s.return}while(s!==null)}YS(n)}catch(A){e=A,Oe===n&&n!==null&&(Oe=n=n.return);continue}break}while(1)}function HS(){var t=Qc.current;return Qc.current=Zc,t===null?Zc:t}function N_(){(Be===0||Be===3||Be===2)&&(Be=4),je===null||!(di&268435455)&&!(bf&268435455)||ur(je,qe)}function eu(t,e){var n=re;re|=2;var r=HS();(je!==t||qe!==e)&&(On=null,si(t,e));do try{e3();break}catch(i){WS(t,i)}while(1);if(p_(),re=n,Qc.current=r,Oe!==null)throw Error(L(261));return je=null,qe=0,Be}function e3(){for(;Oe!==null;)XS(Oe)}function t3(){for(;Oe!==null&&!RC();)XS(Oe)}function XS(t){var e=qS(t.alternate,t,vt);t.memoizedProps=t.pendingProps,e===null?YS(t):Oe=e,x_.current=null}function YS(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=KP(n,e),n!==null){n.flags&=32767,Oe=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Be=6,Oe=null;return}}else if(n=YP(n,e,vt),n!==null){Oe=n;return}if(e=e.sibling,e!==null){Oe=e;return}Oe=e=t}while(e!==null);Be===0&&(Be=5)}function Hr(t,e,n){var r=le,i=Dt.transition;try{Dt.transition=null,le=1,n3(t,e,n,r)}finally{Dt.transition=i,le=r}return null}function n3(t,e,n,r){do gs();while(dr!==null);if(re&6)throw Error(L(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(L(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(DC(t,s),t===je&&(Oe=je=null,qe=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||xl||(xl=!0,ZS(Fc,function(){return gs(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Dt.transition,Dt.transition=null;var o=le;le=1;var a=re;re|=4,x_.current=null,ZP(t,n),$S(n,t),SP(fp),Bc=!!up,fp=up=null,t.current=n,QP(n),xC(),re=a,le=o,Dt.transition=s}else t.current=n;if(xl&&(xl=!1,dr=t,Gc=i),s=t.pendingLanes,s===0&&(Er=null),IC(n.stateNode),_t(t,Pe()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Jc)throw Jc=!1,t=Mp,Mp=null,t;return Gc&1&&t.tag!==0&&gs(),s=t.pendingLanes,s&1?t===Np?jo++:(jo=0,Np=t):jo=0,Fr(),null}function gs(){if(dr!==null){var t=x1(Gc),e=Dt.transition,n=le;try{if(Dt.transition=null,le=16>t?16:t,dr===null)var r=!1;else{if(t=dr,dr=null,Gc=0,re&6)throw Error(L(331));var i=re;for(re|=4,W=t.current;W!==null;){var s=W,o=s.child;if(W.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(W=c;W!==null;){var u=W;switch(u.tag){case 0:case 11:case 15:$o(8,u,s)}var f=u.child;if(f!==null)f.return=u,W=f;else for(;W!==null;){u=W;var h=u.sibling,d=u.return;if(LS(u),u===c){W=null;break}if(h!==null){h.return=d,W=h;break}W=d}}}var g=s.alternate;if(g!==null){var _=g.child;if(_!==null){g.child=null;do{var b=_.sibling;_.sibling=null,_=b}while(_!==null)}}W=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,W=o;else e:for(;W!==null;){if(s=W,s.flags&2048)switch(s.tag){case 0:case 11:case 15:$o(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,W=m;break e}W=s.return}}var p=t.current;for(W=p;W!==null;){o=W;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,W=y;else e:for(o=p;W!==null;){if(a=W,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ef(9,a)}}catch(A){Ce(a,a.return,A)}if(a===o){W=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,W=w;break e}W=a.return}}if(re=i,Fr(),Sn&&typeof Sn.onPostCommitFiberRoot=="function")try{Sn.onPostCommitFiberRoot(gf,t)}catch{}r=!0}return r}finally{le=n,Dt.transition=e}}return!1}function w0(t,e,n){e=Ns(n,e),e=xS(t,e,1),t=Sr(t,e,1),e=lt(),t!==null&&(Fa(t,1,e),_t(t,e))}function Ce(t,e,n){if(t.tag===3)w0(t,t,n);else for(;e!==null;){if(e.tag===3){w0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Er===null||!Er.has(r))){t=Ns(n,t),t=CS(e,t,1),e=Sr(e,t,1),t=lt(),e!==null&&(Fa(e,1,t),_t(e,t));break}}e=e.return}}function r3(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=lt(),t.pingedLanes|=t.suspendedLanes&n,je===t&&(qe&n)===n&&(Be===4||Be===3&&(qe&130023424)===qe&&500>Pe()-P_?si(t,0):C_|=n),_t(t,e)}function KS(t,e){e===0&&(t.mode&1?(e=ml,ml<<=1,!(ml&130023424)&&(ml=4194304)):e=1);var n=lt();t=Wn(t,e),t!==null&&(Fa(t,e,n),_t(t,n))}function i3(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),KS(t,n)}function s3(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(L(314))}r!==null&&r.delete(e),KS(t,n)}var qS;qS=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||pt.current)dt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return dt=!1,XP(t,e,n);dt=!!(t.flags&131072)}else dt=!1,ve&&e.flags&1048576&&G1(e,Wc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;pc(t,e),t=e.pendingProps;var i=Cs(e,it.current);ps(e,n),i=S_(null,e,r,t,i,n);var s=E_();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,gt(r)?(s=!0,Vc(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,m_(e),i.updater=Sf,e.stateNode=i,i._reactInternals=e,Tp(e,r,t,n),e=Ep(null,e,r,!0,s,n)):(e.tag=0,ve&&s&&u_(e),at(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(pc(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=a3(r),t=Xt(r,t),i){case 0:e=Sp(null,e,r,t,n);break e;case 1:e=f0(null,e,r,t,n);break e;case 11:e=c0(null,e,r,t,n);break e;case 14:e=u0(null,e,r,Xt(r.type,t),n);break e}throw Error(L(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xt(r,i),Sp(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xt(r,i),f0(t,e,r,i,n);case 3:e:{if(NS(e),t===null)throw Error(L(387));r=e.pendingProps,s=e.memoizedState,i=s.element,sS(t,e),Yc(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Ns(Error(L(423)),e),e=h0(t,e,r,n,i);break e}else if(r!==i){i=Ns(Error(L(424)),e),e=h0(t,e,r,n,i);break e}else for(wt=wr(e.stateNode.containerInfo.firstChild),Et=e,ve=!0,Kt=null,n=rS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ps(),r===i){e=Hn(t,e,n);break e}at(t,e,r,n)}e=e.child}return e;case 5:return oS(e),t===null&&mp(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,hp(r,i)?o=null:s!==null&&hp(r,s)&&(e.flags|=32),MS(t,e),at(t,e,o,n),e.child;case 6:return t===null&&mp(e),null;case 13:return kS(t,e,n);case 4:return y_(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Is(e,null,r,n):at(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xt(r,i),c0(t,e,r,i,n);case 7:return at(t,e,e.pendingProps,n),e.child;case 8:return at(t,e,e.pendingProps.children,n),e.child;case 12:return at(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,pe(Hc,r._currentValue),r._currentValue=o,s!==null)if(rn(s.value,o)){if(s.children===i.children&&!pt.current){e=Hn(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=$n(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),yp(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(L(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),yp(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}at(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ps(e,n),i=Ut(i),r=r(i),e.flags|=1,at(t,e,r,n),e.child;case 14:return r=e.type,i=Xt(r,e.pendingProps),i=Xt(r.type,i),u0(t,e,r,i,n);case 15:return PS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xt(r,i),pc(t,e),e.tag=1,gt(r)?(t=!0,Vc(e)):t=!1,ps(e,n),RS(e,r,i),Tp(e,r,i,n),Ep(null,e,r,!0,t,n);case 19:return OS(t,e,n);case 22:return IS(t,e,n)}throw Error(L(156,e.tag))};function ZS(t,e){return E1(t,e)}function o3(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ot(t,e,n,r){return new o3(t,e,n,r)}function k_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function a3(t){if(typeof t=="function")return k_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Jg)return 11;if(t===Gg)return 14}return 2}function Ar(t,e){var n=t.alternate;return n===null?(n=Ot(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function mc(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")k_(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Hi:return oi(n.children,i,s,e);case Qg:o=8,i|=8;break;case Wd:return t=Ot(12,n,e,i|2),t.elementType=Wd,t.lanes=s,t;case Hd:return t=Ot(13,n,e,i),t.elementType=Hd,t.lanes=s,t;case Xd:return t=Ot(19,n,e,i),t.elementType=Xd,t.lanes=s,t;case o1:return Af(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case i1:o=10;break e;case s1:o=9;break e;case Jg:o=11;break e;case Gg:o=14;break e;case sr:o=16,r=null;break e}throw Error(L(130,t==null?t:typeof t,""))}return e=Ot(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function oi(t,e,n,r){return t=Ot(7,t,r,e),t.lanes=n,t}function Af(t,e,n,r){return t=Ot(22,t,r,e),t.elementType=o1,t.lanes=n,t.stateNode={isHidden:!1},t}function Lh(t,e,n){return t=Ot(6,t,null,e),t.lanes=n,t}function Uh(t,e,n){return e=Ot(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function l3(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vh(0),this.expirationTimes=vh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vh(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function O_(t,e,n,r,i,s,o,a,l){return t=new l3(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ot(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},m_(s),t}function c3(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function QS(t){if(!t)return Pr;t=t._reactInternals;e:{if(Ti(t)!==t||t.tag!==1)throw Error(L(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(gt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(t.tag===1){var n=t.type;if(gt(n))return Q1(t,n,e)}return e}function JS(t,e,n,r,i,s,o,a,l){return t=O_(n,r,!0,t,i,s,o,a,l),t.context=QS(null),n=t.current,r=lt(),i=br(n),s=$n(r,i),s.callback=e??null,Sr(n,s,i),t.current.lanes=i,Fa(t,i,r),_t(t,r),t}function Rf(t,e,n,r){var i=e.current,s=lt(),o=br(i);return n=QS(n),e.context===null?e.context=n:e.pendingContext=n,e=$n(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Sr(i,e,o),t!==null&&(en(t,i,o,s),fc(t,i,o)),o}function tu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function S0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function F_(t,e){S0(t,e),(t=t.alternate)&&S0(t,e)}function u3(){return null}var GS=typeof reportError=="function"?reportError:function(t){console.error(t)};function D_(t){this._internalRoot=t}xf.prototype.render=D_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(L(409));Rf(t,e,null,null)};xf.prototype.unmount=D_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;pi(function(){Rf(null,t,null,null)}),e[jn]=null}};function xf(t){this._internalRoot=t}xf.prototype.unstable_scheduleHydration=function(t){if(t){var e=I1();t={blockedOn:null,target:t,priority:e};for(var n=0;n<cr.length&&e!==0&&e<cr[n].priority;n++);cr.splice(n,0,t),n===0&&N1(t)}};function B_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Cf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function E0(){}function f3(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=tu(o);s.call(c)}}var o=JS(e,r,t,0,null,!1,!1,"",E0);return t._reactRootContainer=o,t[jn]=o.current,la(t.nodeType===8?t.parentNode:t),pi(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=tu(l);a.call(c)}}var l=O_(t,0,!1,null,null,!1,!1,"",E0);return t._reactRootContainer=l,t[jn]=l.current,la(t.nodeType===8?t.parentNode:t),pi(function(){Rf(e,l,n,r)}),l}function Pf(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=tu(o);a.call(l)}}Rf(e,o,t,i)}else o=f3(n,e,t,i,r);return tu(o)}C1=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=xo(e.pendingLanes);n!==0&&(n_(e,n|1),_t(e,Pe()),!(re&6)&&(ks=Pe()+500,Fr()))}break;case 13:pi(function(){var r=Wn(t,1);if(r!==null){var i=lt();en(r,t,1,i)}}),F_(t,1)}};r_=function(t){if(t.tag===13){var e=Wn(t,134217728);if(e!==null){var n=lt();en(e,t,134217728,n)}F_(t,134217728)}};P1=function(t){if(t.tag===13){var e=br(t),n=Wn(t,e);if(n!==null){var r=lt();en(n,t,e,r)}F_(t,e)}};I1=function(){return le};M1=function(t,e){var n=le;try{return le=t,e()}finally{le=n}};np=function(t,e,n){switch(e){case"input":if(qd(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=vf(r);if(!i)throw Error(L(90));l1(r),qd(r,i)}}}break;case"textarea":u1(t,n);break;case"select":e=n.value,e!=null&&us(t,!!n.multiple,e,!1)}};m1=I_;y1=pi;var h3={usingClientEntryPoint:!1,Events:[Ba,qi,vf,g1,_1,I_]},fo={findFiberByHostInstance:Qr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},d3={bundleType:fo.bundleType,version:fo.version,rendererPackageName:fo.rendererPackageName,rendererConfig:fo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Yn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=w1(t),t===null?null:t.stateNode},findFiberByHostInstance:fo.findFiberByHostInstance||u3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cl.isDisabled&&Cl.supportsFiber)try{gf=Cl.inject(d3),Sn=Cl}catch{}}At.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=h3;At.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!B_(e))throw Error(L(200));return c3(t,e,null,n)};At.createRoot=function(t,e){if(!B_(t))throw Error(L(299));var n=!1,r="",i=GS;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=O_(t,1,!1,null,null,n,!1,r,i),t[jn]=e.current,la(t.nodeType===8?t.parentNode:t),new D_(e)};At.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(L(188)):(t=Object.keys(t).join(","),Error(L(268,t)));return t=w1(e),t=t===null?null:t.stateNode,t};At.flushSync=function(t){return pi(t)};At.hydrate=function(t,e,n){if(!Cf(e))throw Error(L(200));return Pf(null,t,e,!0,n)};At.hydrateRoot=function(t,e,n){if(!B_(t))throw Error(L(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=GS;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=JS(e,null,t,1,n??null,i,!1,s,o),t[jn]=e.current,la(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new xf(e)};At.render=function(t,e,n){if(!Cf(e))throw Error(L(200));return Pf(null,t,e,!1,n)};At.unmountComponentAtNode=function(t){if(!Cf(t))throw Error(L(40));return t._reactRootContainer?(pi(function(){Pf(null,null,t,!1,function(){t._reactRootContainer=null,t[jn]=null})}),!0):!1};At.unstable_batchedUpdates=I_;At.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Cf(n))throw Error(L(200));if(t==null||t._reactInternals===void 0)throw Error(L(38));return Pf(t,e,n,!1,r)};At.version="18.3.1-next-f1338f8080-20240426";function eE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(eE)}catch(t){console.error(t)}}eE(),e1.exports=At;var Ua=e1.exports;const p3=lf(Ua);var tE,b0=Ua;tE=b0.createRoot,b0.hydrateRoot;const g3="modulepreload",_3=function(t){return"/map/"+t},A0={},m3=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=_3(s),s in A0)return;A0[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let u=i.length-1;u>=0;u--){const f=i[u];if(f.href===s&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":g3,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((u,f)=>{c.addEventListener("load",u),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},y3=M.createContext(null);function v3(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function Bn(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Bn(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!Bn(t[i],e[i]))return!1;return!0}return!1}function T3(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function R0(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();Bn(n,r)||e.setProjection(n)}function x0(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function C0(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const w3=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function P0(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const s=e[r.ref];if(s){i=i||Object.assign({},r),delete i.ref;for(const o of w3)o in s&&(i[o]=s[o])}return i||r});return{...t,layers:n}}const I0={version:8,sources:{},layers:[]},M0={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},zh={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},N0={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},S3=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],E3=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Os{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[N0[i.type]];s?s(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[M0[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[zh[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=Os.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n;const o=i._resizeObserver;o&&(o.disconnect(),o.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:a}=e;return a&&(a.bounds?i.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):r._updateViewState(a,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=I0}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||b3()||null,container:e,style:P0(r)},s=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const u=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=u,n.gl)}const o=new this._MapClass(i);s.padding&&o.setPadding(s.padding),n.cursor&&(o.getCanvas().style.cursor=n.cursor),this._createShadowTransform(o);const a=o._render;o._render=u=>{this._inRender=!0,a.call(o,u),this._inRender=!1};const l=o._renderTaskQueue.run;o._renderTaskQueue.run=u=>{l.call(o._renderTaskQueue,u),this._onBeforeRepaint()},o.on("render",()=>this._onAfterRepaint());const c=o.fire;o.fire=this._fireEvent.bind(this,c),o.on("resize",()=>{this._renderTransform.resize(o.transform.width,o.transform.height)}),o.on("styledata",()=>{this._updateStyleComponents(this.props,{}),R0(o.transform,this._renderTransform)}),o.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const u in M0)o.on(u,this._onPointerEvent);for(const u in zh)o.on(u,this._onCameraEvent);for(const u in N0)o.on(u,this._onEvent);this._map=o}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),Os.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=T3(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:o,bearing:a}=i,l=r.isMoving();l&&(i.cameraElevationReference="sea");const c=C0(i,{...x0(r.transform),...e});if(l&&(i.cameraElevationReference="ground"),c&&n){const u=this._deferredEvents;u.move=!0,u.zoom||(u.zoom=s!==i.zoom),u.rotate||(u.rotate=a!==i.bearing),u.pitch||(u.pitch=o!==i.pitch)}return l||C0(r.transform,e),c}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of S3)if(s in e&&!Bn(e[s],n[s])){i=!0;const o=r[`set${s[0].toUpperCase()}${s.slice(1)}`];o==null||o.call(r,e[s])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=I0,styleDiffing:i=!0}=e,s={diff:i};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(P0(r),s),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!Bn(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!Bn(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!Bn(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const s=this._map;let o=!1;for(const a of E3){const l=(r=e[a])!==null&&r!==void 0?r:!0,c=(i=n[a])!==null&&i!==void 0?i:!0;Bn(l,c)||(o=!0,l?s[a].enable(l):s[a].disable())}return o}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,o=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,a=this._queryRenderedFeatures(e.point),l=a.length>0;!l&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,l&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,o=typeof n=="string"?n:n.type;return o==="move"&&this._updateViewState(this.props,!1),o in zh&&(typeof n=="object"&&(n.viewState=x0(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{R0(this._renderTransform,n),e.transform=n}}}Os.savedMaps=[];function b3(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const A3=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function R3(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const s=e.project(r);return e.transform=i,s},unproject:r=>{const i=e.transform;e.transform=t.transform;const s=e.unproject(r);return e.transform=i,s},queryTerrainElevation:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryTerrainElevation(r,i);return e.transform=s,o},queryRenderedFeatures:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryRenderedFeatures(r,i);return e.transform=s,o}};for(const r of x3(e))!(r in n)&&!A3.includes(r)&&(n[r]=e[r].bind(e));return n}function x3(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const C3=typeof document<"u"?M.useLayoutEffect:M.useEffect,P3=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function I3(t,e){for(const r of P3)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!0)}const If=M.createContext(null);function M3(t,e,n){const r=M.useContext(y3),[i,s]=M.useState(null),o=M.useRef(),{current:a}=M.useRef({mapLib:null,map:null});M.useEffect(()=>{const u=t.mapLib;let f=!0,h;return Promise.resolve(u||n).then(d=>{if(!f)return;if(!d)throw new Error("Invalid mapLib");const g="Map"in d?d:d.default;if(!g.Map)throw new Error("Invalid mapLib");if(I3(g,t),!g.supported||g.supported(t))t.reuseMaps&&(h=Os.reuse(t,o.current)),h||(h=new Os(g.Map,t,o.current)),a.map=R3(h),a.mapLib=g,s(h),r==null||r.onMapMount(a.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(d=>{const{onError:g}=t;g?g({type:"error",target:null,originalEvent:null,error:d}):console.error(d)}),()=>{f=!1,h&&(r==null||r.onMapUnmount(t.id),t.reuseMaps?h.recycle():h.destroy())}},[]),C3(()=>{i&&i.setProps(t)}),M.useImperativeHandle(e,()=>a.map,[i]);const l=M.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),c={height:"100%"};return M.createElement("div",{id:t.id,ref:o,style:l},i&&M.createElement(If.Provider,{value:a},M.createElement("div",{"mapboxgl-children":"",style:c},t.children)))}const N3=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function wi(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!N3.test(r)?n[r]=`${i}px`:n[r]=i}}function k3(t,e){const{map:n,mapLib:r}=M.useContext(If),i=M.useRef({props:t});i.current.props=t;const s=M.useMemo(()=>{let _=!1;M.Children.forEach(t.children,p=>{p&&(_=!0)});const b={...t,element:_?document.createElement("div"):null},m=new r.Marker(b);return m.setLngLat([t.longitude,t.latitude]),m.getElement().addEventListener("click",p=>{var y,w;(w=(y=i.current.props).onClick)===null||w===void 0||w.call(y,{type:"click",target:m,originalEvent:p})}),m.on("dragstart",p=>{var y,w;const A=p;A.lngLat=s.getLngLat(),(w=(y=i.current.props).onDragStart)===null||w===void 0||w.call(y,A)}),m.on("drag",p=>{var y,w;const A=p;A.lngLat=s.getLngLat(),(w=(y=i.current.props).onDrag)===null||w===void 0||w.call(y,A)}),m.on("dragend",p=>{var y,w;const A=p;A.lngLat=s.getLngLat(),(w=(y=i.current.props).onDragEnd)===null||w===void 0||w.call(y,A)}),m},[]);M.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:o,latitude:a,offset:l,style:c,draggable:u=!1,popup:f=null,rotation:h=0,rotationAlignment:d="auto",pitchAlignment:g="auto"}=t;return M.useEffect(()=>{wi(s.getElement(),c)},[c]),M.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==o||s.getLngLat().lat!==a)&&s.setLngLat([o,a]),l&&!v3(s.getOffset(),l)&&s.setOffset(l),s.isDraggable()!==u&&s.setDraggable(u),s.getRotation()!==h&&s.setRotation(h),s.getRotationAlignment()!==d&&s.setRotationAlignment(d),s.getPitchAlignment()!==g&&s.setPitchAlignment(g),s.getPopup()!==f&&s.setPopup(f),Ua.createPortal(t.children,s.getElement())}M.memo(M.forwardRef(k3));function k0(t){return new Set(t?t.trim().split(/\s+/):[])}function O3(t,e){const{map:n,mapLib:r}=M.useContext(If),i=M.useMemo(()=>document.createElement("div"),[]),s=M.useRef({props:t});s.current.props=t;const o=M.useMemo(()=>{const a={...t},l=new r.Popup(a);return l.setLngLat([t.longitude,t.latitude]),l.once("open",c=>{var u,f;(f=(u=s.current.props).onOpen)===null||f===void 0||f.call(u,c)}),l},[]);if(M.useEffect(()=>{const a=l=>{var c,u;(u=(c=s.current.props).onClose)===null||u===void 0||u.call(c,l)};return o.on("close",a),o.setDOMContent(i).addTo(n.getMap()),()=>{o.off("close",a),o.isOpen()&&o.remove()}},[]),M.useEffect(()=>{wi(o.getElement(),t.style)},[t.style]),M.useImperativeHandle(e,()=>o,[]),o.isOpen()&&((o.getLngLat().lng!==t.longitude||o.getLngLat().lat!==t.latitude)&&o.setLngLat([t.longitude,t.latitude]),t.offset&&!Bn(o.options.offset,t.offset)&&o.setOffset(t.offset),(o.options.anchor!==t.anchor||o.options.maxWidth!==t.maxWidth)&&(o.options.anchor=t.anchor,o.setMaxWidth(t.maxWidth)),o.options.className!==t.className)){const a=k0(o.options.className),l=k0(t.className);for(const c of a)l.has(c)||o.removeClassName(c);for(const c of l)a.has(c)||o.addClassName(c);o.options.className=t.className}return Ua.createPortal(t.children,i)}const F3=M.memo(M.forwardRef(O3));function Zs(t,e,n,r){const i=M.useContext(If),s=M.useMemo(()=>t(i),[]);return M.useEffect(()=>{const o=r||n||e,a=typeof e=="function"&&typeof n=="function"?e:null,l=typeof n=="function"?n:typeof e=="function"?e:null,{map:c}=i;return c.hasControl(s)||(c.addControl(s,o==null?void 0:o.position),a&&a(i)),()=>{l&&l(i),c.hasControl(s)&&c.removeControl(s)}},[]),s}function D3(t){const e=Zs(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return M.useEffect(()=>{wi(e._container,t.style)},[t.style]),null}M.memo(D3);function B3(t){const e=Zs(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return M.useEffect(()=>{wi(e._controlContainer,t.style)},[t.style]),null}M.memo(B3);function L3(t,e){const n=M.useRef({props:t}),r=Zs(({mapLib:i})=>{const s=new i.GeolocateControl(t),o=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||o(a)},s.on("geolocate",a=>{var l,c;(c=(l=n.current.props).onGeolocate)===null||c===void 0||c.call(l,a)}),s.on("error",a=>{var l,c;(c=(l=n.current.props).onError)===null||c===void 0||c.call(l,a)}),s.on("outofmaxbounds",a=>{var l,c;(c=(l=n.current.props).onOutOfMaxBounds)===null||c===void 0||c.call(l,a)}),s.on("trackuserlocationstart",a=>{var l,c;(c=(l=n.current.props).onTrackUserLocationStart)===null||c===void 0||c.call(l,a)}),s.on("trackuserlocationend",a=>{var l,c;(c=(l=n.current.props).onTrackUserLocationEnd)===null||c===void 0||c.call(l,a)}),s},{position:t.position});return n.current.props=t,M.useImperativeHandle(e,()=>r,[]),M.useEffect(()=>{wi(r._container,t.style)},[t.style]),null}M.memo(M.forwardRef(L3));function U3(t){const e=Zs(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return M.useEffect(()=>{wi(e._container,t.style)},[t.style]),null}M.memo(U3);function z3(t){const e=Zs(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=M.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),M.useEffect(()=>{wi(e._container,i)},[i]),null}M.memo(z3);const $3=m3(()=>import("./maplibre-gl-7cfcdf76.js").then(t=>t.m),[]),V3=(()=>M.forwardRef(function(e,n){return M3(e,n,$3)}))(),j3=F3;var yn=function(){return yn=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},yn.apply(this,arguments)};function nE(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function W3(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var yc="right-scroll-bar-position",vc="width-before-scroll-bar",H3="with-scroll-bars-hidden",X3="--removed-body-scroll-bar-size";function $h(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Y3(t,e){var n=M.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}var K3=typeof window<"u"?M.useLayoutEffect:M.useEffect,O0=new WeakMap;function q3(t,e){var n=Y3(e||null,function(r){return t.forEach(function(i){return $h(i,r)})});return K3(function(){var r=O0.get(n);if(r){var i=new Set(r),s=new Set(t),o=n.current;i.forEach(function(a){s.has(a)||$h(a,null)}),s.forEach(function(a){i.has(a)||$h(a,o)})}O0.set(n,t)},[t]),n}function Z3(t){return t}function Q3(t,e){e===void 0&&(e=Z3);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var o=e(s,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(r=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(s),o=n}var l=function(){var u=o;o=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),n}}}};return i}function J3(t){t===void 0&&(t={});var e=Q3(null);return e.options=yn({async:!0,ssr:!1},t),e}var rE=function(t){var e=t.sideCar,n=nE(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return M.createElement(r,yn({},n))};rE.isSideCarExport=!0;function G3(t,e){return t.useMedium(e),rE}var iE=J3(),Vh=function(){},Mf=M.forwardRef(function(t,e){var n=M.useRef(null),r=M.useState({onScrollCapture:Vh,onWheelCapture:Vh,onTouchMoveCapture:Vh}),i=r[0],s=r[1],o=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,f=t.shards,h=t.sideCar,d=t.noIsolation,g=t.inert,_=t.allowPinchZoom,b=t.as,m=b===void 0?"div":b,p=t.gapMode,y=nE(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),w=h,A=q3([n,e]),x=yn(yn({},y),i);return M.createElement(M.Fragment,null,u&&M.createElement(w,{sideCar:iE,removeScrollBar:c,shards:f,noIsolation:d,inert:g,setCallbacks:s,allowPinchZoom:!!_,lockRef:n,gapMode:p}),o?M.cloneElement(M.Children.only(a),yn(yn({},x),{ref:A})):M.createElement(m,yn({},x,{className:l,ref:A}),a))});Mf.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Mf.classNames={fullWidth:vc,zeroRight:yc};var F0,e2=function(){if(F0)return F0;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function t2(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=e2();return e&&t.setAttribute("nonce",e),t}function n2(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function r2(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var i2=function(){var t=0,e=null;return{add:function(n){t==0&&(e=t2())&&(n2(e,n),r2(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},s2=function(){var t=i2();return function(e,n){M.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},sE=function(){var t=s2(),e=function(n){var r=n.styles,i=n.dynamic;return t(r,i),null};return e},o2={left:0,top:0,right:0,gap:0},jh=function(t){return parseInt(t||"",10)||0},a2=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],i=e[t==="padding"?"paddingRight":"marginRight"];return[jh(n),jh(r),jh(i)]},l2=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return o2;var e=a2(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},c2=sE(),_s="data-scroll-locked",u2=function(t,e,n,r){var i=t.left,s=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(H3,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(_s,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(yc,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(vc,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(yc," .").concat(yc,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(vc," .").concat(vc,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(_s,`] {
    `).concat(X3,": ").concat(a,`px;
  }
`)},D0=function(){var t=parseInt(document.body.getAttribute(_s)||"0",10);return isFinite(t)?t:0},f2=function(){M.useEffect(function(){return document.body.setAttribute(_s,(D0()+1).toString()),function(){var t=D0()-1;t<=0?document.body.removeAttribute(_s):document.body.setAttribute(_s,t.toString())}},[])},h2=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,i=r===void 0?"margin":r;f2();var s=M.useMemo(function(){return l2(i)},[i]);return M.createElement(c2,{styles:u2(s,!e,i,n?"":"!important")})},Fp=!1;if(typeof window<"u")try{var Pl=Object.defineProperty({},"passive",{get:function(){return Fp=!0,!0}});window.addEventListener("test",Pl,Pl),window.removeEventListener("test",Pl,Pl)}catch{Fp=!1}var Ii=Fp?{passive:!1}:!1,d2=function(t){return t.tagName==="TEXTAREA"},oE=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!d2(t)&&n[e]==="visible")},p2=function(t){return oE(t,"overflowY")},g2=function(t){return oE(t,"overflowX")},B0=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=aE(t,r);if(i){var s=lE(t,r),o=s[1],a=s[2];if(o>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},_2=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},m2=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},aE=function(t,e){return t==="v"?p2(e):g2(e)},lE=function(t,e){return t==="v"?_2(e):m2(e)},y2=function(t,e){return t==="h"&&e==="rtl"?-1:1},v2=function(t,e,n,r,i){var s=y2(t,window.getComputedStyle(e).direction),o=s*r,a=n.target,l=e.contains(a),c=!1,u=o>0,f=0,h=0;do{var d=lE(t,a),g=d[0],_=d[1],b=d[2],m=_-b-s*g;(g||m)&&aE(t,a)&&(f+=m,h+=g),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&(i&&Math.abs(f)<1||!i&&o>f)||!u&&(i&&Math.abs(h)<1||!i&&-o>h))&&(c=!0),c},Il=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},L0=function(t){return[t.deltaX,t.deltaY]},U0=function(t){return t&&"current"in t?t.current:t},T2=function(t,e){return t[0]===e[0]&&t[1]===e[1]},w2=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},S2=0,Mi=[];function E2(t){var e=M.useRef([]),n=M.useRef([0,0]),r=M.useRef(),i=M.useState(S2++)[0],s=M.useState(sE)[0],o=M.useRef(t);M.useEffect(function(){o.current=t},[t]),M.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var _=W3([t.lockRef.current],(t.shards||[]).map(U0),!0).filter(Boolean);return _.forEach(function(b){return b.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),_.forEach(function(b){return b.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var a=M.useCallback(function(_,b){if("touches"in _&&_.touches.length===2||_.type==="wheel"&&_.ctrlKey)return!o.current.allowPinchZoom;var m=Il(_),p=n.current,y="deltaX"in _?_.deltaX:p[0]-m[0],w="deltaY"in _?_.deltaY:p[1]-m[1],A,x=_.target,I=Math.abs(y)>Math.abs(w)?"h":"v";if("touches"in _&&I==="h"&&x.type==="range")return!1;var O=B0(I,x);if(!O)return!0;if(O?A=I:(A=I==="v"?"h":"v",O=B0(I,x)),!O)return!1;if(!r.current&&"changedTouches"in _&&(y||w)&&(r.current=A),!A)return!0;var D=r.current||A;return v2(D,b,_,D==="h"?y:w,!0)},[]),l=M.useCallback(function(_){var b=_;if(!(!Mi.length||Mi[Mi.length-1]!==s)){var m="deltaY"in b?L0(b):Il(b),p=e.current.filter(function(A){return A.name===b.type&&(A.target===b.target||b.target===A.shadowParent)&&T2(A.delta,m)})[0];if(p&&p.should){b.cancelable&&b.preventDefault();return}if(!p){var y=(o.current.shards||[]).map(U0).filter(Boolean).filter(function(A){return A.contains(b.target)}),w=y.length>0?a(b,y[0]):!o.current.noIsolation;w&&b.cancelable&&b.preventDefault()}}},[]),c=M.useCallback(function(_,b,m,p){var y={name:_,delta:b,target:m,should:p,shadowParent:b2(m)};e.current.push(y),setTimeout(function(){e.current=e.current.filter(function(w){return w!==y})},1)},[]),u=M.useCallback(function(_){n.current=Il(_),r.current=void 0},[]),f=M.useCallback(function(_){c(_.type,L0(_),_.target,a(_,t.lockRef.current))},[]),h=M.useCallback(function(_){c(_.type,Il(_),_.target,a(_,t.lockRef.current))},[]);M.useEffect(function(){return Mi.push(s),t.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:h}),document.addEventListener("wheel",l,Ii),document.addEventListener("touchmove",l,Ii),document.addEventListener("touchstart",u,Ii),function(){Mi=Mi.filter(function(_){return _!==s}),document.removeEventListener("wheel",l,Ii),document.removeEventListener("touchmove",l,Ii),document.removeEventListener("touchstart",u,Ii)}},[]);var d=t.removeScrollBar,g=t.inert;return M.createElement(M.Fragment,null,g?M.createElement(s,{styles:w2(i)}):null,d?M.createElement(h2,{gapMode:t.gapMode}):null)}function b2(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const A2=G3(iE,E2);var cE=M.forwardRef(function(t,e){return M.createElement(Mf,yn({},t,{ref:e,sideCar:A2}))});cE.classNames=Mf.classNames;const L_=cE;function Ze(t){return Object.keys(t)}function Wh(t){return t&&typeof t=="object"&&!Array.isArray(t)}function U_(t,e){const n={...t},r=e;return Wh(t)&&Wh(e)&&Object.keys(e).forEach(i=>{Wh(r[i])&&i in t?n[i]=U_(n[i],r[i]):n[i]=r[i]}),n}function R2(t){return t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}function x2(t){var e;return typeof t!="string"||!t.includes("var(--mantine-scale)")?t:(e=t.match(/^calc\((.*?)\)$/))==null?void 0:e[1].split("*")[0].trim()}function Dp(t){const e=x2(t);return typeof e=="number"?e:typeof e=="string"?e.includes("calc")||e.includes("var")?e:e.includes("px")?Number(e.replace("px","")):e.includes("rem")?Number(e.replace("rem",""))*16:e.includes("em")?Number(e.replace("em",""))*16:Number(e):NaN}function Hh(t){return t==="0rem"?"0rem":`calc(${t} * var(--mantine-scale))`}function uE(t,{shouldScale:e=!1}={}){function n(r){if(r===0||r==="0")return`0${t}`;if(typeof r=="number"){const i=`${r/16}${t}`;return e?Hh(i):i}if(typeof r=="string"){if(r===""||r.startsWith("calc(")||r.startsWith("clamp(")||r.includes("rgba("))return r;if(r.includes(","))return r.split(",").map(s=>n(s)).join(",");if(r.includes(" "))return r.split(" ").map(s=>n(s)).join(" ");if(r.includes(t))return e?Hh(r):r;const i=r.replace("px","");if(!Number.isNaN(Number(i))){const s=`${Number(i)/16}${t}`;return e?Hh(s):s}}return r}return n}const F=uE("rem",{shouldScale:!0}),nu=uE("em");function Nf(t){return Object.keys(t).reduce((e,n)=>(t[n]!==void 0&&(e[n]=t[n]),e),{})}function fE(t){return typeof t=="number"?!0:typeof t=="string"?t.startsWith("calc(")||t.startsWith("var(")||t.includes(" ")&&t.trim()!==""?!0:/[0-9]/.test(t.trim().replace("-","")[0]):!1}function C2(t){return Array.isArray(t)||t===null?!1:typeof t=="object"?t.type!==M.Fragment:!1}var hE={exports:{}},kf={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P2=M,I2=Symbol.for("react.element"),M2=Symbol.for("react.fragment"),N2=Object.prototype.hasOwnProperty,k2=P2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,O2={key:!0,ref:!0,__self:!0,__source:!0};function dE(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)N2.call(e,r)&&!O2.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:I2,type:t,key:s,ref:o,props:i,_owner:k2.current}}kf.Fragment=M2;kf.jsx=dE;kf.jsxs=dE;hE.exports=kf;var $=hE.exports;function z_(t){const e=M.createContext(null);return[({children:i,value:s})=>$.jsx(e.Provider,{value:s,children:i}),()=>{const i=M.useContext(e);if(i===null)throw new Error(t);return i}]}const F2={app:100,modal:200,popover:300,overlay:400,max:9999};function za(t){return F2[t]}function Rn(t,e="size",n=!0){if(t!==void 0)return fE(t)?n?F(t):t:`var(--${e}-${t})`}function Of(t){return Rn(t,"mantine-spacing")}function $_(t){return t===void 0?"var(--mantine-radius-default)":Rn(t,"mantine-radius")}function D2(t){return Rn(t,"mantine-font-size")}function B2(t){return Rn(t,"mantine-line-height",!1)}function pE(t){if(t)return Rn(t,"mantine-shadow",!1)}function V_(t,e){return t in e.breakpoints?Dp(e.breakpoints[t]):Dp(t)}function z0(t,e){const n=t.map(r=>({value:r,px:V_(r,e)}));return n.sort((r,i)=>r.px-i.px),n}function gE(){return`mantine-${Math.random().toString(36).slice(2,11)}`}function L2(t,e){try{return t.addEventListener("change",e),()=>t.removeEventListener("change",e)}catch{return t.addListener(e),()=>t.removeListener(e)}}function U2(t,e){return typeof e=="boolean"?e:typeof window<"u"&&"matchMedia"in window?window.matchMedia(t).matches:!1}function z2(t,e,{getInitialValueInEffect:n}={getInitialValueInEffect:!0}){const[r,i]=M.useState(n?e:U2(t)),s=M.useRef();return M.useEffect(()=>{if("matchMedia"in window)return s.current=window.matchMedia(t),i(s.current.matches),L2(s.current,o=>i(o.matches))},[t]),r}const $a=typeof document<"u"?M.useLayoutEffect:M.useEffect;function _E(t,e){const n=M.useRef(!1);M.useEffect(()=>()=>{n.current=!1},[]),M.useEffect(()=>{if(n.current)return t();n.current=!0},e)}function $2({opened:t,shouldReturnFocus:e=!0}){const n=M.useRef(),r=()=>{var i;n.current&&"focus"in n.current&&typeof n.current.focus=="function"&&((i=n.current)==null||i.focus({preventScroll:!0}))};return _E(()=>{let i=-1;const s=o=>{o.key==="Tab"&&window.clearTimeout(i)};return document.addEventListener("keydown",s),t?n.current=document.activeElement:e&&(i=window.setTimeout(r,10)),()=>{window.clearTimeout(i),document.removeEventListener("keydown",s)}},[t,e]),r}function V2(t,e="body > :not(script)"){const n=gE(),r=Array.from(document.querySelectorAll(e)).map(i=>{var l;if((l=i==null?void 0:i.shadowRoot)!=null&&l.contains(t)||i.contains(t))return;const s=i.getAttribute("aria-hidden"),o=i.getAttribute("data-hidden"),a=i.getAttribute("data-focus-id");return i.setAttribute("data-focus-id",n),s===null||s==="false"?i.setAttribute("aria-hidden","true"):!o&&!a&&i.setAttribute("data-hidden",s),{node:i,ariaHidden:o||null}});return()=>{r.forEach(i=>{!i||n!==i.node.getAttribute("data-focus-id")||(i.ariaHidden===null?i.node.removeAttribute("aria-hidden"):i.node.setAttribute("aria-hidden",i.ariaHidden),i.node.removeAttribute("data-focus-id"),i.node.removeAttribute("data-hidden"))})}}const j2=/input|select|textarea|button|object/,mE="a, input, select, textarea, button, object, [tabindex]";function W2(t){return t.style.display==="none"}function H2(t){if(t.getAttribute("aria-hidden")||t.getAttribute("hidden")||t.getAttribute("type")==="hidden")return!1;let n=t;for(;n&&!(n===document.body||n.nodeType===11);){if(W2(n))return!1;n=n.parentNode}return!0}function yE(t){let e=t.getAttribute("tabindex");return e===null&&(e=void 0),parseInt(e,10)}function Bp(t){const e=t.nodeName.toLowerCase(),n=!Number.isNaN(yE(t));return(j2.test(e)&&!t.disabled||t instanceof HTMLAnchorElement&&t.href||n)&&H2(t)}function vE(t){const e=yE(t);return(Number.isNaN(e)||e>=0)&&Bp(t)}function X2(t){return Array.from(t.querySelectorAll(mE)).filter(vE)}function Y2(t,e){const n=X2(t);if(!n.length){e.preventDefault();return}const r=n[e.shiftKey?0:n.length-1],i=t.getRootNode();let s=r===i.activeElement||t===i.activeElement;const o=i.activeElement;if(o.tagName==="INPUT"&&o.getAttribute("type")==="radio"&&(s=n.filter(u=>u.getAttribute("type")==="radio"&&u.getAttribute("name")===o.getAttribute("name")).includes(r)),!s)return;e.preventDefault();const l=n[e.shiftKey?n.length-1:0];l&&l.focus()}function K2(t=!0){const e=M.useRef(),n=M.useRef(null),r=s=>{let o=s.querySelector("[data-autofocus]");if(!o){const a=Array.from(s.querySelectorAll(mE));o=a.find(vE)||a.find(Bp)||null,!o&&Bp(s)&&(o=s)}o&&o.focus({preventScroll:!0})},i=M.useCallback(s=>{if(t){if(s===null){n.current&&(n.current(),n.current=null);return}n.current=V2(s),e.current!==s&&(s?(setTimeout(()=>{s.getRootNode()&&r(s)}),e.current=s):e.current=null)}},[t]);return M.useEffect(()=>{if(!t)return;e.current&&setTimeout(()=>r(e.current));const s=o=>{o.key==="Tab"&&e.current&&Y2(e.current,o)};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s),n.current&&n.current()}},[t]),i}const q2=te["useId".toString()]||(()=>{});function Z2(){const t=q2();return t?`mantine-${t.replace(/:/g,"")}`:""}function Q2(t){const e=Z2(),[n,r]=M.useState(e);return $a(()=>{r(gE())},[]),typeof t=="string"?t:typeof window>"u"?e:n}function TE(t,e,n){M.useEffect(()=>(window.addEventListener(t,e,n),()=>window.removeEventListener(t,e,n)),[t,e])}function wE(t,e){typeof t=="function"?t(e):typeof t=="object"&&t!==null&&"current"in t&&(t.current=e)}function J2(...t){return e=>{t.forEach(n=>wE(n,e))}}function G2(...t){return M.useCallback(J2(...t),t)}function SE(t,e){return z2("(prefers-reduced-motion: reduce)",t,e)}function eI(t=!1,e){const{onOpen:n,onClose:r}=e||{},[i,s]=M.useState(t),o=M.useCallback(()=>{s(c=>c||(n==null||n(),!0))},[n]),a=M.useCallback(()=>{s(c=>c&&(r==null||r(),!1))},[r]),l=M.useCallback(()=>{i?a():o()},[a,o,i]);return[i,{open:o,close:a,toggle:l}]}function EE(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=EE(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function $t(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=EE(t))&&(r&&(r+=" "),r+=e);return r}const tI={};function nI(t){const e={};return t.forEach(n=>{Object.entries(n).forEach(([r,i])=>{e[r]?e[r]=$t(e[r],i):e[r]=i})}),e}function j_({theme:t,classNames:e,props:n,stylesCtx:r}){const s=(Array.isArray(e)?e:[e]).map(o=>typeof o=="function"?o(t,n,r):o||tI);return nI(s)}function Lp({theme:t,styles:e,props:n,stylesCtx:r}){return(Array.isArray(e)?e:[e]).reduce((s,o)=>typeof o=="function"?{...s,...o(t,n,r)}:{...s,...o},{})}const bE=M.createContext(null);function Dr(){const t=M.useContext(bE);if(!t)throw new Error("[@mantine/core] MantineProvider was not found in tree");return t}function rI(){return Dr().cssVariablesResolver}function iI(){return Dr().classNamesPrefix}function W_(){return Dr().getStyleNonce}function sI(){return Dr().withStaticClasses}function oI(){return Dr().headless}function aI(){var t;return(t=Dr().stylesTransform)==null?void 0:t.sx}function lI(){var t;return(t=Dr().stylesTransform)==null?void 0:t.styles}function cI(t){return/^#?([0-9A-F]{3}){1,2}([0-9A-F]{2})?$/i.test(t)}function uI(t){let e=t.replace("#","");if(e.length===3){const o=e.split("");e=[o[0],o[0],o[1],o[1],o[2],o[2]].join("")}if(e.length===8){const o=parseInt(e.slice(6,8),16)/255;return{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16),a:o}}const n=parseInt(e,16),r=n>>16&255,i=n>>8&255,s=n&255;return{r,g:i,b:s,a:1}}function fI(t){const[e,n,r,i]=t.replace(/[^0-9,./]/g,"").split(/[/,]/).map(Number);return{r:e,g:n,b:r,a:i||1}}function hI(t){const e=/^hsla?\(\s*(\d+)\s*,\s*(\d+%)\s*,\s*(\d+%)\s*(,\s*(0?\.\d+|\d+(\.\d+)?))?\s*\)$/i,n=t.match(e);if(!n)return{r:0,g:0,b:0,a:1};const r=parseInt(n[1],10),i=parseInt(n[2],10)/100,s=parseInt(n[3],10)/100,o=n[5]?parseFloat(n[5]):void 0,a=(1-Math.abs(2*s-1))*i,l=r/60,c=a*(1-Math.abs(l%2-1)),u=s-a/2;let f,h,d;return l>=0&&l<1?(f=a,h=c,d=0):l>=1&&l<2?(f=c,h=a,d=0):l>=2&&l<3?(f=0,h=a,d=c):l>=3&&l<4?(f=0,h=c,d=a):l>=4&&l<5?(f=c,h=0,d=a):(f=a,h=0,d=c),{r:Math.round((f+u)*255),g:Math.round((h+u)*255),b:Math.round((d+u)*255),a:o||1}}function H_(t){return cI(t)?uI(t):t.startsWith("rgb")?fI(t):t.startsWith("hsl")?hI(t):{r:0,g:0,b:0,a:1}}function Ml(t,e){if(t.startsWith("var("))return`color-mix(in srgb, ${t}, black ${e*100}%)`;const{r:n,g:r,b:i,a:s}=H_(t),o=1-e,a=l=>Math.round(l*o);return`rgba(${a(n)}, ${a(r)}, ${a(i)}, ${s})`}function ma(t,e){return typeof t.primaryShade=="number"?t.primaryShade:e==="dark"?t.primaryShade.dark:t.primaryShade.light}function Xh(t){return t<=.03928?t/12.92:((t+.055)/1.055)**2.4}function dI(t){const e=t.match(/oklch\((.*?)%\s/);return e?parseFloat(e[1]):null}function pI(t){if(t.startsWith("oklch("))return(dI(t)||0)/100;const{r:e,g:n,b:r}=H_(t),i=e/255,s=n/255,o=r/255,a=Xh(i),l=Xh(s),c=Xh(o);return .2126*a+.7152*l+.0722*c}function ho(t,e=.179){return t.startsWith("var(")?!1:pI(t)>e}function Va({color:t,theme:e,colorScheme:n}){if(typeof t!="string")throw new Error(`[@mantine/core] Failed to parse color. Expected color to be a string, instead got ${typeof t}`);if(t==="bright")return{color:t,value:n==="dark"?e.white:e.black,shade:void 0,isThemeColor:!1,isLight:ho(n==="dark"?e.white:e.black,e.luminanceThreshold),variable:"--mantine-color-bright"};if(t==="dimmed")return{color:t,value:n==="dark"?e.colors.dark[2]:e.colors.gray[7],shade:void 0,isThemeColor:!1,isLight:ho(n==="dark"?e.colors.dark[2]:e.colors.gray[6],e.luminanceThreshold),variable:"--mantine-color-dimmed"};if(t==="white"||t==="black")return{color:t,value:t==="white"?e.white:e.black,shade:void 0,isThemeColor:!1,isLight:ho(t==="white"?e.white:e.black,e.luminanceThreshold),variable:`--mantine-color-${t}`};const[r,i]=t.split("."),s=i?Number(i):void 0,o=r in e.colors;if(o){const a=s!==void 0?e.colors[r][s]:e.colors[r][ma(e,n||"light")];return{color:r,value:a,shade:s,isThemeColor:o,isLight:ho(a,e.luminanceThreshold),variable:i?`--mantine-color-${r}-${s}`:`--mantine-color-${r}-filled`}}return{color:t,value:t,isThemeColor:o,isLight:ho(t,e.luminanceThreshold),shade:s,variable:void 0}}function ya(t,e){const n=Va({color:t||e.primaryColor,theme:e});return n.variable?`var(${n.variable})`:t}function Up(t,e){const n={from:(t==null?void 0:t.from)||e.defaultGradient.from,to:(t==null?void 0:t.to)||e.defaultGradient.to,deg:(t==null?void 0:t.deg)||e.defaultGradient.deg||0},r=ya(n.from,e),i=ya(n.to,e);return`linear-gradient(${n.deg}deg, ${r} 0%, ${i} 100%)`}function gn(t,e){if(typeof t!="string"||e>1||e<0)return"rgba(0, 0, 0, 1)";if(t.startsWith("var(")){const s=(1-e)*100;return`color-mix(in srgb, ${t}, transparent ${s}%)`}if(t.startsWith("oklch"))return t.includes("/")?t.replace(/\/\s*[\d.]+\s*\)/,`/ ${e})`):t.replace(")",` / ${e})`);const{r:n,g:r,b:i}=H_(t);return`rgba(${n}, ${r}, ${i}, ${e})`}const Ni=gn,gI=({color:t,theme:e,variant:n,gradient:r,autoContrast:i})=>{const s=Va({color:t,theme:e}),o=typeof i=="boolean"?i:e.autoContrast;if(n==="filled"){const a=o&&s.isLight?"var(--mantine-color-black)":"var(--mantine-color-white)";return s.isThemeColor?s.shade===void 0?{background:`var(--mantine-color-${t}-filled)`,hover:`var(--mantine-color-${t}-filled-hover)`,color:a,border:`${F(1)} solid transparent`}:{background:`var(--mantine-color-${s.color}-${s.shade})`,hover:`var(--mantine-color-${s.color}-${s.shade===9?8:s.shade+1})`,color:a,border:`${F(1)} solid transparent`}:{background:t,hover:Ml(t,.1),color:a,border:`${F(1)} solid transparent`}}if(n==="light"){if(s.isThemeColor){if(s.shade===void 0)return{background:`var(--mantine-color-${t}-light)`,hover:`var(--mantine-color-${t}-light-hover)`,color:`var(--mantine-color-${t}-light-color)`,border:`${F(1)} solid transparent`};const a=e.colors[s.color][s.shade];return{background:gn(a,.1),hover:gn(a,.12),color:`var(--mantine-color-${s.color}-${Math.min(s.shade,6)})`,border:`${F(1)} solid transparent`}}return{background:gn(t,.1),hover:gn(t,.12),color:t,border:`${F(1)} solid transparent`}}if(n==="outline")return s.isThemeColor?s.shade===void 0?{background:"transparent",hover:`var(--mantine-color-${t}-outline-hover)`,color:`var(--mantine-color-${t}-outline)`,border:`${F(1)} solid var(--mantine-color-${t}-outline)`}:{background:"transparent",hover:gn(e.colors[s.color][s.shade],.05),color:`var(--mantine-color-${s.color}-${s.shade})`,border:`${F(1)} solid var(--mantine-color-${s.color}-${s.shade})`}:{background:"transparent",hover:gn(t,.05),color:t,border:`${F(1)} solid ${t}`};if(n==="subtle"){if(s.isThemeColor){if(s.shade===void 0)return{background:"transparent",hover:`var(--mantine-color-${t}-light-hover)`,color:`var(--mantine-color-${t}-light-color)`,border:`${F(1)} solid transparent`};const a=e.colors[s.color][s.shade];return{background:"transparent",hover:gn(a,.12),color:`var(--mantine-color-${s.color}-${Math.min(s.shade,6)})`,border:`${F(1)} solid transparent`}}return{background:"transparent",hover:gn(t,.12),color:t,border:`${F(1)} solid transparent`}}return n==="transparent"?s.isThemeColor?s.shade===void 0?{background:"transparent",hover:"transparent",color:`var(--mantine-color-${t}-light-color)`,border:`${F(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:`var(--mantine-color-${s.color}-${Math.min(s.shade,6)})`,border:`${F(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:t,border:`${F(1)} solid transparent`}:n==="white"?s.isThemeColor?s.shade===void 0?{background:"var(--mantine-color-white)",hover:Ml(e.white,.01),color:`var(--mantine-color-${t}-filled)`,border:`${F(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:Ml(e.white,.01),color:`var(--mantine-color-${s.color}-${s.shade})`,border:`${F(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:Ml(e.white,.01),color:t,border:`${F(1)} solid transparent`}:n==="gradient"?{background:Up(r,e),hover:Up(r,e),color:"var(--mantine-color-white)",border:"none"}:n==="default"?{background:"var(--mantine-color-default)",hover:"var(--mantine-color-default-hover)",color:"var(--mantine-color-default-color)",border:`${F(1)} solid var(--mantine-color-default-border)`}:{}},_I={dark:["#C9C9C9","#b8b8b8","#828282","#696969","#424242","#3b3b3b","#2e2e2e","#242424","#1f1f1f","#141414"],gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]},$0="-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",X_={scale:1,fontSmoothing:!0,focusRing:"auto",white:"#fff",black:"#000",colors:_I,primaryShade:{light:6,dark:8},primaryColor:"blue",variantColorResolver:gI,autoContrast:!1,luminanceThreshold:.3,fontFamily:$0,fontFamilyMonospace:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace",respectReducedMotion:!1,cursorType:"default",defaultGradient:{from:"blue",to:"cyan",deg:45},defaultRadius:"sm",activeClassName:"mantine-active",focusClassName:"",headings:{fontFamily:$0,fontWeight:"700",textWrap:"wrap",sizes:{h1:{fontSize:F(34),lineHeight:"1.3"},h2:{fontSize:F(26),lineHeight:"1.35"},h3:{fontSize:F(22),lineHeight:"1.4"},h4:{fontSize:F(18),lineHeight:"1.45"},h5:{fontSize:F(16),lineHeight:"1.5"},h6:{fontSize:F(14),lineHeight:"1.5"}}},fontSizes:{xs:F(12),sm:F(14),md:F(16),lg:F(18),xl:F(20)},lineHeights:{xs:"1.4",sm:"1.45",md:"1.55",lg:"1.6",xl:"1.65"},radius:{xs:F(2),sm:F(4),md:F(8),lg:F(16),xl:F(32)},spacing:{xs:F(10),sm:F(12),md:F(16),lg:F(20),xl:F(32)},breakpoints:{xs:"36em",sm:"48em",md:"62em",lg:"75em",xl:"88em"},shadows:{xs:`0 ${F(1)} ${F(3)} rgba(0, 0, 0, 0.05), 0 ${F(1)} ${F(2)} rgba(0, 0, 0, 0.1)`,sm:`0 ${F(1)} ${F(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${F(10)} ${F(15)} ${F(-5)}, rgba(0, 0, 0, 0.04) 0 ${F(7)} ${F(7)} ${F(-5)}`,md:`0 ${F(1)} ${F(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${F(20)} ${F(25)} ${F(-5)}, rgba(0, 0, 0, 0.04) 0 ${F(10)} ${F(10)} ${F(-5)}`,lg:`0 ${F(1)} ${F(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${F(28)} ${F(23)} ${F(-7)}, rgba(0, 0, 0, 0.04) 0 ${F(12)} ${F(12)} ${F(-7)}`,xl:`0 ${F(1)} ${F(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${F(36)} ${F(28)} ${F(-7)}, rgba(0, 0, 0, 0.04) 0 ${F(17)} ${F(17)} ${F(-7)}`},other:{},components:{}};function V0(t){return t==="auto"||t==="dark"||t==="light"}function mI({key:t="mantine-color-scheme-value"}={}){let e;return{get:n=>{if(typeof window>"u")return n;try{const r=window.localStorage.getItem(t);return V0(r)?r:n}catch{return n}},set:n=>{try{window.localStorage.setItem(t,n)}catch(r){console.warn("[@mantine/core] Local storage color scheme manager was unable to save color scheme.",r)}},subscribe:n=>{e=r=>{r.storageArea===window.localStorage&&r.key===t&&V0(r.newValue)&&n(r.newValue)},window.addEventListener("storage",e)},unsubscribe:()=>{window.removeEventListener("storage",e)},clear:()=>{window.localStorage.removeItem(t)}}}const yI="[@mantine/core] MantineProvider: Invalid theme.primaryColor, it accepts only key of theme.colors, learn more  https://mantine.dev/theming/colors/#primary-color",j0="[@mantine/core] MantineProvider: Invalid theme.primaryShade, it accepts only 0-9 integers or an object { light: 0-9, dark: 0-9 }";function Yh(t){return t<0||t>9?!1:parseInt(t.toString(),10)===t}function W0(t){if(!(t.primaryColor in t.colors))throw new Error(yI);if(typeof t.primaryShade=="object"&&(!Yh(t.primaryShade.dark)||!Yh(t.primaryShade.light)))throw new Error(j0);if(typeof t.primaryShade=="number"&&!Yh(t.primaryShade))throw new Error(j0)}function vI(t,e){var r;if(!e)return W0(t),t;const n=U_(t,e);return e.fontFamily&&!((r=e.headings)!=null&&r.fontFamily)&&(n.headings.fontFamily=e.fontFamily),W0(n),n}const Y_=M.createContext(null),TI=()=>M.useContext(Y_)||X_;function Kn(){const t=M.useContext(Y_);if(!t)throw new Error("@mantine/core: MantineProvider was not found in component tree, make sure you have it in your app");return t}function AE({theme:t,children:e,inherit:n=!0}){const r=TI(),i=M.useMemo(()=>vI(n?r:X_,t),[t,r,n]);return $.jsx(Y_.Provider,{value:i,children:e})}AE.displayName="@mantine/core/MantineThemeProvider";function wI(){const t=Kn(),e=W_(),n=Ze(t.breakpoints).reduce((r,i)=>{const s=t.breakpoints[i].includes("px"),o=Dp(t.breakpoints[i]),a=s?`${o-.1}px`:nu(o-.1),l=s?`${o}px`:nu(o);return`${r}@media (max-width: ${a}) {.mantine-visible-from-${i} {display: none !important;}}@media (min-width: ${l}) {.mantine-hidden-from-${i} {display: none !important;}}`},"");return $.jsx("style",{"data-mantine-styles":"classes",nonce:e==null?void 0:e(),dangerouslySetInnerHTML:{__html:n}})}function Kh(t){return Object.entries(t).map(([e,n])=>`${e}: ${n};`).join("")}function po(t,e){return(Array.isArray(t)?t:[t]).reduce((r,i)=>`${i}{${r}}`,e)}function SI(t,e){const n=Kh(t.variables),r=n?po(e,n):"",i=Kh(t.dark),s=Kh(t.light),o=i?po(e===":host"?`${e}([data-mantine-color-scheme="dark"])`:`${e}[data-mantine-color-scheme="dark"]`,i):"",a=s?po(e===":host"?`${e}([data-mantine-color-scheme="light"])`:`${e}[data-mantine-color-scheme="light"]`,s):"";return`${r}${o}${a}`}function EI({color:t,theme:e,autoContrast:n}){return(typeof n=="boolean"?n:e.autoContrast)&&Va({color:t||e.primaryColor,theme:e}).isLight?"var(--mantine-color-black)":"var(--mantine-color-white)"}function H0(t,e){return EI({color:t.colors[t.primaryColor][ma(t,e)],theme:t,autoContrast:null})}function Nl({theme:t,color:e,colorScheme:n,name:r=e,withColorValues:i=!0}){if(!t.colors[e])return{};if(n==="light"){const a=ma(t,"light"),l={[`--mantine-color-${r}-text`]:`var(--mantine-color-${r}-filled)`,[`--mantine-color-${r}-filled`]:`var(--mantine-color-${r}-${a})`,[`--mantine-color-${r}-filled-hover`]:`var(--mantine-color-${r}-${a===9?8:a+1})`,[`--mantine-color-${r}-light`]:Ni(t.colors[e][a],.1),[`--mantine-color-${r}-light-hover`]:Ni(t.colors[e][a],.12),[`--mantine-color-${r}-light-color`]:`var(--mantine-color-${r}-${a})`,[`--mantine-color-${r}-outline`]:`var(--mantine-color-${r}-${a})`,[`--mantine-color-${r}-outline-hover`]:Ni(t.colors[e][a],.05)};return i?{[`--mantine-color-${r}-0`]:t.colors[e][0],[`--mantine-color-${r}-1`]:t.colors[e][1],[`--mantine-color-${r}-2`]:t.colors[e][2],[`--mantine-color-${r}-3`]:t.colors[e][3],[`--mantine-color-${r}-4`]:t.colors[e][4],[`--mantine-color-${r}-5`]:t.colors[e][5],[`--mantine-color-${r}-6`]:t.colors[e][6],[`--mantine-color-${r}-7`]:t.colors[e][7],[`--mantine-color-${r}-8`]:t.colors[e][8],[`--mantine-color-${r}-9`]:t.colors[e][9],...l}:l}const s=ma(t,"dark"),o={[`--mantine-color-${r}-text`]:`var(--mantine-color-${r}-4)`,[`--mantine-color-${r}-filled`]:`var(--mantine-color-${r}-${s})`,[`--mantine-color-${r}-filled-hover`]:`var(--mantine-color-${r}-${s===9?8:s+1})`,[`--mantine-color-${r}-light`]:Ni(t.colors[e][Math.max(0,s-2)],.15),[`--mantine-color-${r}-light-hover`]:Ni(t.colors[e][Math.max(0,s-2)],.2),[`--mantine-color-${r}-light-color`]:`var(--mantine-color-${r}-${Math.max(s-5,0)})`,[`--mantine-color-${r}-outline`]:`var(--mantine-color-${r}-${Math.max(s-4,0)})`,[`--mantine-color-${r}-outline-hover`]:Ni(t.colors[e][Math.max(s-4,0)],.05)};return i?{[`--mantine-color-${r}-0`]:t.colors[e][0],[`--mantine-color-${r}-1`]:t.colors[e][1],[`--mantine-color-${r}-2`]:t.colors[e][2],[`--mantine-color-${r}-3`]:t.colors[e][3],[`--mantine-color-${r}-4`]:t.colors[e][4],[`--mantine-color-${r}-5`]:t.colors[e][5],[`--mantine-color-${r}-6`]:t.colors[e][6],[`--mantine-color-${r}-7`]:t.colors[e][7],[`--mantine-color-${r}-8`]:t.colors[e][8],[`--mantine-color-${r}-9`]:t.colors[e][9],...o}:o}function bI(t){return!!t&&typeof t=="object"&&"mantine-virtual-color"in t}function ki(t,e,n){Ze(e).forEach(r=>Object.assign(t,{[`--mantine-${n}-${r}`]:e[r]}))}const RE=t=>{const e=ma(t,"light"),n=t.defaultRadius in t.radius?t.radius[t.defaultRadius]:F(t.defaultRadius),r={variables:{"--mantine-scale":t.scale.toString(),"--mantine-cursor-type":t.cursorType,"--mantine-color-scheme":"light dark","--mantine-webkit-font-smoothing":t.fontSmoothing?"antialiased":"unset","--mantine-moz-font-smoothing":t.fontSmoothing?"grayscale":"unset","--mantine-color-white":t.white,"--mantine-color-black":t.black,"--mantine-line-height":t.lineHeights.md,"--mantine-font-family":t.fontFamily,"--mantine-font-family-monospace":t.fontFamilyMonospace,"--mantine-font-family-headings":t.headings.fontFamily,"--mantine-heading-font-weight":t.headings.fontWeight,"--mantine-heading-text-wrap":t.headings.textWrap,"--mantine-radius-default":n,"--mantine-primary-color-filled":`var(--mantine-color-${t.primaryColor}-filled)`,"--mantine-primary-color-filled-hover":`var(--mantine-color-${t.primaryColor}-filled-hover)`,"--mantine-primary-color-light":`var(--mantine-color-${t.primaryColor}-light)`,"--mantine-primary-color-light-hover":`var(--mantine-color-${t.primaryColor}-light-hover)`,"--mantine-primary-color-light-color":`var(--mantine-color-${t.primaryColor}-light-color)`},light:{"--mantine-primary-color-contrast":H0(t,"light"),"--mantine-color-bright":"var(--mantine-color-black)","--mantine-color-text":t.black,"--mantine-color-body":t.white,"--mantine-color-error":"var(--mantine-color-red-6)","--mantine-color-placeholder":"var(--mantine-color-gray-5)","--mantine-color-anchor":`var(--mantine-color-${t.primaryColor}-${e})`,"--mantine-color-default":"var(--mantine-color-white)","--mantine-color-default-hover":"var(--mantine-color-gray-0)","--mantine-color-default-color":"var(--mantine-color-black)","--mantine-color-default-border":"var(--mantine-color-gray-4)","--mantine-color-dimmed":"var(--mantine-color-gray-6)"},dark:{"--mantine-primary-color-contrast":H0(t,"dark"),"--mantine-color-bright":"var(--mantine-color-white)","--mantine-color-text":"var(--mantine-color-dark-0)","--mantine-color-body":"var(--mantine-color-dark-7)","--mantine-color-error":"var(--mantine-color-red-8)","--mantine-color-placeholder":"var(--mantine-color-dark-3)","--mantine-color-anchor":`var(--mantine-color-${t.primaryColor}-4)`,"--mantine-color-default":"var(--mantine-color-dark-6)","--mantine-color-default-hover":"var(--mantine-color-dark-5)","--mantine-color-default-color":"var(--mantine-color-white)","--mantine-color-default-border":"var(--mantine-color-dark-4)","--mantine-color-dimmed":"var(--mantine-color-dark-2)"}};ki(r.variables,t.breakpoints,"breakpoint"),ki(r.variables,t.spacing,"spacing"),ki(r.variables,t.fontSizes,"font-size"),ki(r.variables,t.lineHeights,"line-height"),ki(r.variables,t.shadows,"shadow"),ki(r.variables,t.radius,"radius"),t.colors[t.primaryColor].forEach((s,o)=>{r.variables[`--mantine-primary-color-${o}`]=`var(--mantine-color-${t.primaryColor}-${o})`}),Ze(t.colors).forEach(s=>{const o=t.colors[s];if(bI(o)){Object.assign(r.light,Nl({theme:t,name:o.name,color:o.light,colorScheme:"light",withColorValues:!0})),Object.assign(r.dark,Nl({theme:t,name:o.name,color:o.dark,colorScheme:"dark",withColorValues:!0}));return}o.forEach((a,l)=>{r.variables[`--mantine-color-${s}-${l}`]=a}),Object.assign(r.light,Nl({theme:t,color:s,colorScheme:"light",withColorValues:!1})),Object.assign(r.dark,Nl({theme:t,color:s,colorScheme:"dark",withColorValues:!1}))});const i=t.headings.sizes;return Ze(i).forEach(s=>{r.variables[`--mantine-${s}-font-size`]=i[s].fontSize,r.variables[`--mantine-${s}-line-height`]=i[s].lineHeight,r.variables[`--mantine-${s}-font-weight`]=i[s].fontWeight||t.headings.fontWeight}),r};function AI({theme:t,generator:e}){const n=RE(t),r=e==null?void 0:e(t);return r?U_(n,r):n}const qh=RE(X_);function RI(t){const e={variables:{},light:{},dark:{}};return Ze(t.variables).forEach(n=>{qh.variables[n]!==t.variables[n]&&(e.variables[n]=t.variables[n])}),Ze(t.light).forEach(n=>{qh.light[n]!==t.light[n]&&(e.light[n]=t.light[n])}),Ze(t.dark).forEach(n=>{qh.dark[n]!==t.dark[n]&&(e.dark[n]=t.dark[n])}),e}function xI(t){return`
  ${t}[data-mantine-color-scheme="dark"] { --mantine-color-scheme: dark; }
  ${t}[data-mantine-color-scheme="light"] { --mantine-color-scheme: light; }
`}function xE({cssVariablesSelector:t,deduplicateCssVariables:e}){const n=Kn(),r=W_(),i=rI(),s=AI({theme:n,generator:i}),o=t===":root"&&e,a=o?RI(s):s,l=SI(a,t);return l?$.jsx("style",{"data-mantine-styles":!0,nonce:r==null?void 0:r(),dangerouslySetInnerHTML:{__html:`${l}${o?"":xI(t)}`}}):null}xE.displayName="@mantine/CssVariables";function CI(){const t=console.error;console.error=(...e)=>{e.length>1&&typeof e[0]=="string"&&e[0].toLowerCase().includes("extra attributes from the server")&&typeof e[1]=="string"&&e[1].toLowerCase().includes("data-mantine-color-scheme")||t(...e)}}function Oi(t,e){var r;const n=t!=="auto"?t:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";(r=e())==null||r.setAttribute("data-mantine-color-scheme",n)}function PI({manager:t,defaultColorScheme:e,getRootElement:n,forceColorScheme:r}){const i=M.useRef(),[s,o]=M.useState(()=>t.get(e)),a=r||s,l=M.useCallback(u=>{r||(Oi(u,n),o(u),t.set(u))},[t.set,a,r]),c=M.useCallback(()=>{o(e),Oi(e,n),t.clear()},[t.clear,e]);return M.useEffect(()=>(t.subscribe(l),t.unsubscribe),[t.subscribe,t.unsubscribe]),$a(()=>{Oi(t.get(e),n)},[]),M.useEffect(()=>{var f;if(r)return Oi(r,n),()=>{};r===void 0&&Oi(s,n),i.current=window.matchMedia("(prefers-color-scheme: dark)");const u=h=>{s==="auto"&&Oi(h.matches?"dark":"light",n)};return(f=i.current)==null||f.addEventListener("change",u),()=>{var h;return(h=i.current)==null?void 0:h.removeEventListener("change",u)}},[s,r]),{colorScheme:a,setColorScheme:l,clearColorScheme:c}}function II({respectReducedMotion:t,getRootElement:e}){$a(()=>{var n;t&&((n=e())==null||n.setAttribute("data-respect-reduced-motion","true"))},[t])}CI();function CE({theme:t,children:e,getStyleNonce:n,withStaticClasses:r=!0,withGlobalClasses:i=!0,deduplicateCssVariables:s=!0,withCssVariables:o=!0,cssVariablesSelector:a=":root",classNamesPrefix:l="mantine",colorSchemeManager:c=mI(),defaultColorScheme:u="light",getRootElement:f=()=>document.documentElement,cssVariablesResolver:h,forceColorScheme:d,stylesTransform:g}){const{colorScheme:_,setColorScheme:b,clearColorScheme:m}=PI({defaultColorScheme:u,forceColorScheme:d,manager:c,getRootElement:f});return II({respectReducedMotion:(t==null?void 0:t.respectReducedMotion)||!1,getRootElement:f}),$.jsx(bE.Provider,{value:{colorScheme:_,setColorScheme:b,clearColorScheme:m,getRootElement:f,classNamesPrefix:l,getStyleNonce:n,cssVariablesResolver:h,cssVariablesSelector:a,withStaticClasses:r,stylesTransform:g},children:$.jsxs(AE,{theme:t,children:[o&&$.jsx(xE,{cssVariablesSelector:a,deduplicateCssVariables:s}),i&&$.jsx(wI,{}),e]})})}CE.displayName="@mantine/core/MantineProvider";const MI={always:"mantine-focus-always",auto:"mantine-focus-auto",never:"mantine-focus-never"};function NI({theme:t,options:e,unstyled:n}){return $t((e==null?void 0:e.focusable)&&!n&&(t.focusClassName||MI[t.focusRing]),(e==null?void 0:e.active)&&!n&&t.activeClassName)}function kI({selector:t,stylesCtx:e,options:n,props:r,theme:i}){return j_({theme:i,classNames:n==null?void 0:n.classNames,props:(n==null?void 0:n.props)||r,stylesCtx:e})[t]}function X0({selector:t,stylesCtx:e,theme:n,classNames:r,props:i}){return j_({theme:n,classNames:r,props:i,stylesCtx:e})[t]}function OI({rootSelector:t,selector:e,className:n}){return t===e?n:void 0}function FI({selector:t,classes:e,unstyled:n}){return n?void 0:e[t]}function DI({themeName:t,classNamesPrefix:e,selector:n,withStaticClass:r}){return r===!1?[]:t.map(i=>`${e}-${i}-${n}`)}function BI({themeName:t,theme:e,selector:n,props:r,stylesCtx:i}){return t.map(s=>{var o,a;return(a=j_({theme:e,classNames:(o=e.components[s])==null?void 0:o.classNames,props:r,stylesCtx:i}))==null?void 0:a[n]})}function LI({options:t,classes:e,selector:n,unstyled:r}){return t!=null&&t.variant&&!r?e[`${n}--${t.variant}`]:void 0}function UI({theme:t,options:e,themeName:n,selector:r,classNamesPrefix:i,classNames:s,classes:o,unstyled:a,className:l,rootSelector:c,props:u,stylesCtx:f,withStaticClasses:h,headless:d,transformedStyles:g}){return $t(NI({theme:t,options:e,unstyled:a||d}),BI({theme:t,themeName:n,selector:r,props:u,stylesCtx:f}),LI({options:e,classes:o,selector:r,unstyled:a}),X0({selector:r,stylesCtx:f,theme:t,classNames:s,props:u}),X0({selector:r,stylesCtx:f,theme:t,classNames:g,props:u}),kI({selector:r,stylesCtx:f,options:e,props:u,theme:t}),OI({rootSelector:c,selector:r,className:l}),FI({selector:r,classes:o,unstyled:a||d}),h&&!d&&DI({themeName:n,classNamesPrefix:i,selector:r,withStaticClass:e==null?void 0:e.withStaticClass}),e==null?void 0:e.className)}function zI({theme:t,themeName:e,props:n,stylesCtx:r,selector:i}){return e.map(s=>{var o;return Lp({theme:t,styles:(o=t.components[s])==null?void 0:o.styles,props:n,stylesCtx:r})[i]}).reduce((s,o)=>({...s,...o}),{})}function zp({style:t,theme:e}){return Array.isArray(t)?[...t].reduce((n,r)=>({...n,...zp({style:r,theme:e})}),{}):typeof t=="function"?t(e):t??{}}function $I(t){return t.reduce((e,n)=>(n&&Object.keys(n).forEach(r=>{e[r]={...e[r],...Nf(n[r])}}),e),{})}function VI({vars:t,varsResolver:e,theme:n,props:r,stylesCtx:i,selector:s,themeName:o,headless:a}){var l;return(l=$I([a?{}:e==null?void 0:e(n,r,i),...o.map(c=>{var u,f,h;return(h=(f=(u=n.components)==null?void 0:u[c])==null?void 0:f.vars)==null?void 0:h.call(f,n,r,i)}),t==null?void 0:t(n,r,i)]))==null?void 0:l[s]}function jI({theme:t,themeName:e,selector:n,options:r,props:i,stylesCtx:s,rootSelector:o,styles:a,style:l,vars:c,varsResolver:u,headless:f,withStylesTransform:h}){return{...!h&&zI({theme:t,themeName:e,props:i,stylesCtx:s,selector:n}),...!h&&Lp({theme:t,styles:a,props:i,stylesCtx:s})[n],...!h&&Lp({theme:t,styles:r==null?void 0:r.styles,props:(r==null?void 0:r.props)||i,stylesCtx:s})[n],...VI({theme:t,props:i,stylesCtx:s,vars:c,varsResolver:u,selector:n,themeName:e,headless:f}),...o===n?zp({style:l,theme:t}):null,...zp({style:r==null?void 0:r.style,theme:t})}}function WI({props:t,stylesCtx:e,themeName:n}){var o;const r=Kn(),i=(o=lI())==null?void 0:o();return{getTransformedStyles:a=>i?[...a.map(c=>i(c,{props:t,theme:r,ctx:e})),...n.map(c=>{var u;return i((u=r.components[c])==null?void 0:u.styles,{props:t,theme:r,ctx:e})})].filter(Boolean):[],withStylesTransform:!!i}}function mt({name:t,classes:e,props:n,stylesCtx:r,className:i,style:s,rootSelector:o="root",unstyled:a,classNames:l,styles:c,vars:u,varsResolver:f}){const h=Kn(),d=iI(),g=sI(),_=oI(),b=(Array.isArray(t)?t:[t]).filter(y=>y),{withStylesTransform:m,getTransformedStyles:p}=WI({props:n,stylesCtx:r,themeName:b});return(y,w)=>({className:UI({theme:h,options:w,themeName:b,selector:y,classNamesPrefix:d,classNames:l,classes:e,unstyled:a,className:i,rootSelector:o,props:n,stylesCtx:r,withStaticClasses:g,headless:_,transformedStyles:p([w==null?void 0:w.styles,c])}),style:jI({theme:h,themeName:b,selector:y,options:w,props:n,stylesCtx:r,rootSelector:o,styles:c,style:s,vars:u,varsResolver:f,headless:_,withStylesTransform:m})})}function he(t,e,n){var o;const r=Kn(),i=(o=r.components[t])==null?void 0:o.defaultProps,s=typeof i=="function"?i(r):i;return{...e,...s,...Nf(n)}}function Zh(t){return Ze(t).reduce((e,n)=>t[n]!==void 0?`${e}${R2(n)}:${t[n]};`:e,"").trim()}function HI({selector:t,styles:e,media:n,container:r}){const i=e?Zh(e):"",s=Array.isArray(n)?n.map(a=>`@media${a.query}{${t}{${Zh(a.styles)}}}`):[],o=Array.isArray(r)?r.map(a=>`@container ${a.query}{${t}{${Zh(a.styles)}}}`):[];return`${i?`${t}{${i}}`:""}${s.join("")}${o.join("")}`.trim()}function K_(t){const e=W_();return $.jsx("style",{"data-mantine-styles":"inline",nonce:e==null?void 0:e(),dangerouslySetInnerHTML:{__html:HI(t)}})}function XI(t){const{m:e,mx:n,my:r,mt:i,mb:s,ml:o,mr:a,me:l,ms:c,p:u,px:f,py:h,pt:d,pb:g,pl:_,pr:b,pe:m,ps:p,bd:y,bg:w,c:A,opacity:x,ff:I,fz:O,fw:D,lts:z,ta:H,lh:Y,fs:K,tt:Z,td:Le,w:Cn,miw:xt,maw:V,h:X,mih:q,mah:se,bgsz:ne,bgp:Vt,bgr:We,bga:Ct,pos:He,top:de,left:st,bottom:oe,right:Ie,inset:jt,display:Je,flex:Ur,hiddenFrom:zr,visibleFrom:$r,lightHidden:Pt,darkHidden:Pn,sx:el,...tl}=t;return{styleProps:Nf({m:e,mx:n,my:r,mt:i,mb:s,ml:o,mr:a,me:l,ms:c,p:u,px:f,py:h,pt:d,pb:g,pl:_,pr:b,pe:m,ps:p,bd:y,bg:w,c:A,opacity:x,ff:I,fz:O,fw:D,lts:z,ta:H,lh:Y,fs:K,tt:Z,td:Le,w:Cn,miw:xt,maw:V,h:X,mih:q,mah:se,bgsz:ne,bgp:Vt,bgr:We,bga:Ct,pos:He,top:de,left:st,bottom:oe,right:Ie,inset:jt,display:Je,flex:Ur,hiddenFrom:zr,visibleFrom:$r,lightHidden:Pt,darkHidden:Pn,sx:el}),rest:tl}}const YI={m:{type:"spacing",property:"margin"},mt:{type:"spacing",property:"marginTop"},mb:{type:"spacing",property:"marginBottom"},ml:{type:"spacing",property:"marginLeft"},mr:{type:"spacing",property:"marginRight"},ms:{type:"spacing",property:"marginInlineStart"},me:{type:"spacing",property:"marginInlineEnd"},mx:{type:"spacing",property:"marginInline"},my:{type:"spacing",property:"marginBlock"},p:{type:"spacing",property:"padding"},pt:{type:"spacing",property:"paddingTop"},pb:{type:"spacing",property:"paddingBottom"},pl:{type:"spacing",property:"paddingLeft"},pr:{type:"spacing",property:"paddingRight"},ps:{type:"spacing",property:"paddingInlineStart"},pe:{type:"spacing",property:"paddingInlineEnd"},px:{type:"spacing",property:"paddingInline"},py:{type:"spacing",property:"paddingBlock"},bd:{type:"border",property:"border"},bg:{type:"color",property:"background"},c:{type:"textColor",property:"color"},opacity:{type:"identity",property:"opacity"},ff:{type:"fontFamily",property:"fontFamily"},fz:{type:"fontSize",property:"fontSize"},fw:{type:"identity",property:"fontWeight"},lts:{type:"size",property:"letterSpacing"},ta:{type:"identity",property:"textAlign"},lh:{type:"lineHeight",property:"lineHeight"},fs:{type:"identity",property:"fontStyle"},tt:{type:"identity",property:"textTransform"},td:{type:"identity",property:"textDecoration"},w:{type:"spacing",property:"width"},miw:{type:"spacing",property:"minWidth"},maw:{type:"spacing",property:"maxWidth"},h:{type:"spacing",property:"height"},mih:{type:"spacing",property:"minHeight"},mah:{type:"spacing",property:"maxHeight"},bgsz:{type:"size",property:"backgroundSize"},bgp:{type:"identity",property:"backgroundPosition"},bgr:{type:"identity",property:"backgroundRepeat"},bga:{type:"identity",property:"backgroundAttachment"},pos:{type:"identity",property:"position"},top:{type:"identity",property:"top"},left:{type:"size",property:"left"},bottom:{type:"size",property:"bottom"},right:{type:"size",property:"right"},inset:{type:"size",property:"inset"},display:{type:"identity",property:"display"},flex:{type:"identity",property:"flex"}};function q_(t,e){const n=Va({color:t,theme:e});return n.color==="dimmed"?"var(--mantine-color-dimmed)":n.color==="bright"?"var(--mantine-color-bright)":n.variable?`var(${n.variable})`:n.color}function KI(t,e){const n=Va({color:t,theme:e});return n.isThemeColor&&n.shade===void 0?`var(--mantine-color-${n.color}-text)`:q_(t,e)}function qI(t,e){if(typeof t=="number")return F(t);if(typeof t=="string"){const[n,r,...i]=t.split(" ").filter(o=>o.trim()!=="");let s=`${F(n)}`;return r&&(s+=` ${r}`),i.length>0&&(s+=` ${q_(i.join(" "),e)}`),s.trim()}return t}const Y0={text:"var(--mantine-font-family)",mono:"var(--mantine-font-family-monospace)",monospace:"var(--mantine-font-family-monospace)",heading:"var(--mantine-font-family-headings)",headings:"var(--mantine-font-family-headings)"};function ZI(t){return typeof t=="string"&&t in Y0?Y0[t]:t}const QI=["h1","h2","h3","h4","h5","h6"];function JI(t,e){return typeof t=="string"&&t in e.fontSizes?`var(--mantine-font-size-${t})`:typeof t=="string"&&QI.includes(t)?`var(--mantine-${t}-font-size)`:typeof t=="number"||typeof t=="string"?F(t):t}function GI(t){return t}const eM=["h1","h2","h3","h4","h5","h6"];function tM(t,e){return typeof t=="string"&&t in e.lineHeights?`var(--mantine-line-height-${t})`:typeof t=="string"&&eM.includes(t)?`var(--mantine-${t}-line-height)`:t}function nM(t){return typeof t=="number"?F(t):t}function rM(t,e){if(typeof t=="number")return F(t);if(typeof t=="string"){const n=t.replace("-","");if(!(n in e.spacing))return F(t);const r=`--mantine-spacing-${n}`;return t.startsWith("-")?`calc(var(${r}) * -1)`:`var(${r})`}return t}const Qh={color:q_,textColor:KI,fontSize:JI,spacing:rM,identity:GI,size:nM,lineHeight:tM,fontFamily:ZI,border:qI};function K0(t){return t.replace("(min-width: ","").replace("em)","")}function iM({media:t,...e}){const r=Object.keys(t).sort((i,s)=>Number(K0(i))-Number(K0(s))).map(i=>({query:i,styles:t[i]}));return{...e,media:r}}function sM(t){if(typeof t!="object"||t===null)return!1;const e=Object.keys(t);return!(e.length===1&&e[0]==="base")}function oM(t){return typeof t=="object"&&t!==null?"base"in t?t.base:void 0:t}function aM(t){return typeof t=="object"&&t!==null?Ze(t).filter(e=>e!=="base"):[]}function lM(t,e){return typeof t=="object"&&t!==null&&e in t?t[e]:t}function PE({styleProps:t,data:e,theme:n}){return iM(Ze(t).reduce((r,i)=>{if(i==="hiddenFrom"||i==="visibleFrom"||i==="sx")return r;const s=e[i],o=Array.isArray(s.property)?s.property:[s.property],a=oM(t[i]);if(!sM(t[i]))return o.forEach(c=>{r.inlineStyles[c]=Qh[s.type](a,n)}),r;r.hasResponsiveStyles=!0;const l=aM(t[i]);return o.forEach(c=>{a&&(r.styles[c]=Qh[s.type](a,n)),l.forEach(u=>{const f=`(min-width: ${n.breakpoints[u]})`;r.media[f]={...r.media[f],[c]:Qh[s.type](lM(t[i],u),n)}})}),r},{hasResponsiveStyles:!1,styles:{},inlineStyles:{},media:{}}))}function IE(){return`__m__-${M.useId().replace(/:/g,"")}`}function ME(t){return t.startsWith("data-")?t:`data-${t}`}function cM(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return r===void 0||r===""||r===!1||r===null||(e[ME(n)]=t[n]),e},{})}function NE(t){return t?typeof t=="string"?{[ME(t)]:!0}:Array.isArray(t)?[...t].reduce((e,n)=>({...e,...NE(n)}),{}):cM(t):null}function $p(t,e){return Array.isArray(t)?[...t].reduce((n,r)=>({...n,...$p(r,e)}),{}):typeof t=="function"?t(e):t??{}}function uM({theme:t,style:e,vars:n,styleProps:r}){const i=$p(e,t),s=$p(n,t);return{...i,...s,...r}}const kE=M.forwardRef(({component:t,style:e,__vars:n,className:r,variant:i,mod:s,size:o,hiddenFrom:a,visibleFrom:l,lightHidden:c,darkHidden:u,renderRoot:f,__size:h,...d},g)=>{var O;const _=Kn(),b=t||"div",{styleProps:m,rest:p}=XI(d),y=aI(),w=(O=y==null?void 0:y())==null?void 0:O(m.sx),A=IE(),x=PE({styleProps:m,theme:_,data:YI}),I={ref:g,style:uM({theme:_,style:e,vars:n,styleProps:x.inlineStyles}),className:$t(r,w,{[A]:x.hasResponsiveStyles,"mantine-light-hidden":c,"mantine-dark-hidden":u,[`mantine-hidden-from-${a}`]:a,[`mantine-visible-from-${l}`]:l}),"data-variant":i,"data-size":fE(o)?void 0:o||void 0,size:h,...NE(s),...p};return $.jsxs($.Fragment,{children:[x.hasResponsiveStyles&&$.jsx(K_,{selector:`.${A}`,styles:x.styles,media:x.media}),typeof f=="function"?f(I):$.jsx(b,{...I})]})});kE.displayName="@mantine/core/Box";const Re=kE;function OE(t){return t}function Fe(t){const e=M.forwardRef(t);return e.extend=OE,e.withProps=n=>{const r=M.forwardRef((i,s)=>$.jsx(e,{...n,...i,ref:s}));return r.extend=e.extend,r.displayName=`WithProps(${e.displayName})`,r},e}function Si(t){const e=M.forwardRef(t);return e.withProps=n=>{const r=M.forwardRef((i,s)=>$.jsx(e,{...n,...i,ref:s}));return r.extend=e.extend,r.displayName=`WithProps(${e.displayName})`,r},e.extend=OE,e}const fM=M.createContext({dir:"ltr",toggleDirection:()=>{},setDirection:()=>{}});function hM(){return M.useContext(fM)}var FE={root:"m_87cf2631"};const dM={__staticSelector:"UnstyledButton"},Ff=Si((t,e)=>{const n=he("UnstyledButton",dM,t),{className:r,component:i="button",__staticSelector:s,unstyled:o,classNames:a,styles:l,style:c,...u}=n,f=mt({name:s,props:n,classes:FE,className:r,style:c,classNames:a,styles:l,unstyled:o});return $.jsx(Re,{...f("root",{focusable:!0}),component:i,ref:e,type:i==="button"?"button":void 0,...u})});Ff.classes=FE;Ff.displayName="@mantine/core/UnstyledButton";var DE={root:"m_515a97f8"};const pM={},Z_=Fe((t,e)=>{const n=he("VisuallyHidden",pM,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,...c}=n,u=mt({name:"VisuallyHidden",classes:DE,props:n,className:i,style:s,classNames:r,styles:o,unstyled:a});return $.jsx(Re,{component:"span",ref:e,...u("root"),...c})});Z_.classes=DE;Z_.displayName="@mantine/core/VisuallyHidden";var BE={root:"m_1b7284a3"};const gM={},_M=(t,{radius:e,shadow:n})=>({root:{"--paper-radius":e===void 0?void 0:$_(e),"--paper-shadow":pE(n)}}),Q_=Si((t,e)=>{const n=he("Paper",gM,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,withBorder:l,vars:c,radius:u,shadow:f,variant:h,mod:d,...g}=n,_=mt({name:"Paper",props:n,classes:BE,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:c,varsResolver:_M});return $.jsx(Re,{ref:e,mod:[{"data-with-border":l},d],..._("root"),variant:h,...g})});Q_.classes=BE;Q_.displayName="@mantine/core/Paper";function J_({children:t,active:e=!0,refProp:n="ref",innerRef:r}){const i=K2(e),s=G2(i,r);return C2(t)?M.cloneElement(t,{[n]:s}):t}function LE(t){return $.jsx(Z_,{tabIndex:-1,"data-autofocus":!0,...t})}J_.displayName="@mantine/core/FocusTrap";LE.displayName="@mantine/core/FocusTrapInitialFocus";J_.InitialFocus=LE;function mM(t){const e=document.createElement("div");return e.setAttribute("data-portal","true"),typeof t.className=="string"&&e.classList.add(...t.className.split(" ").filter(Boolean)),typeof t.style=="object"&&Object.assign(e.style,t.style),typeof t.id=="string"&&e.setAttribute("id",t.id),e}const yM={},UE=M.forwardRef((t,e)=>{const{children:n,target:r,...i}=he("Portal",yM,t),[s,o]=M.useState(!1),a=M.useRef(null);return $a(()=>(o(!0),a.current=r?typeof r=="string"?document.querySelector(r):r:mM(i),wE(e,a.current),!r&&a.current&&document.body.appendChild(a.current),()=>{!r&&a.current&&document.body.removeChild(a.current)}),[r]),!s||!a.current?null:Ua.createPortal($.jsx($.Fragment,{children:n}),a.current)});UE.displayName="@mantine/core/Portal";function zE({withinPortal:t=!0,children:e,...n}){return t?$.jsx(UE,{...n,children:e}):$.jsx($.Fragment,{children:e})}zE.displayName="@mantine/core/OptionalPortal";const go=t=>({in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:`scale(.9) translateY(${F(t==="bottom"?10:-10)})`},transitionProperty:"transform, opacity"}),kl={fade:{in:{opacity:1},out:{opacity:0},transitionProperty:"opacity"},"fade-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:`translateY(${F(30)}`},transitionProperty:"opacity, transform"},"fade-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:`translateY(${F(-30)}`},transitionProperty:"opacity, transform"},"fade-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:`translateX(${F(30)}`},transitionProperty:"opacity, transform"},"fade-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:`translateX(${F(-30)}`},transitionProperty:"opacity, transform"},scale:{in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:"scale(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-y":{in:{opacity:1,transform:"scaleY(1)"},out:{opacity:0,transform:"scaleY(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-x":{in:{opacity:1,transform:"scaleX(1)"},out:{opacity:0,transform:"scaleX(0)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"skew-up":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:`translateY(${F(-20)}) skew(-10deg, -5deg)`},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"skew-down":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:`translateY(${F(20)}) skew(-10deg, -5deg)`},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-left":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:`translateY(${F(20)}) rotate(-5deg)`},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-right":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:`translateY(${F(20)}) rotate(5deg)`},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-100%)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(100%)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"slide-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(100%)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"slide-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-100%)"},common:{transformOrigin:"right"},transitionProperty:"transform, opacity"},pop:{...go("bottom"),common:{transformOrigin:"center center"}},"pop-bottom-left":{...go("bottom"),common:{transformOrigin:"bottom left"}},"pop-bottom-right":{...go("bottom"),common:{transformOrigin:"bottom right"}},"pop-top-left":{...go("top"),common:{transformOrigin:"top left"}},"pop-top-right":{...go("top"),common:{transformOrigin:"top right"}}},q0={entering:"in",entered:"in",exiting:"out",exited:"out","pre-exiting":"out","pre-entering":"out"};function vM({transition:t,state:e,duration:n,timingFunction:r}){const i={transitionDuration:`${n}ms`,transitionTimingFunction:r};return typeof t=="string"?t in kl?{transitionProperty:kl[t].transitionProperty,...i,...kl[t].common,...kl[t][q0[e]]}:{}:{transitionProperty:t.transitionProperty,...i,...t.common,...t[q0[e]]}}function TM({duration:t,exitDuration:e,timingFunction:n,mounted:r,onEnter:i,onExit:s,onEntered:o,onExited:a,enterDelay:l,exitDelay:c}){const u=Kn(),f=SE(),h=u.respectReducedMotion?f:!1,[d,g]=M.useState(h?0:t),[_,b]=M.useState(r?"entered":"exited"),m=M.useRef(-1),p=M.useRef(-1),y=M.useRef(-1),w=x=>{const I=x?i:s,O=x?o:a;window.clearTimeout(m.current);const D=h?0:x?t:e;g(D),D===0?(typeof I=="function"&&I(),typeof O=="function"&&O(),b(x?"entered":"exited")):y.current=requestAnimationFrame(()=>{p3.flushSync(()=>{b(x?"pre-entering":"pre-exiting")}),y.current=requestAnimationFrame(()=>{typeof I=="function"&&I(),b(x?"entering":"exiting"),m.current=window.setTimeout(()=>{typeof O=="function"&&O(),b(x?"entered":"exited")},D)})})},A=x=>{if(window.clearTimeout(p.current),typeof(x?l:c)!="number"){w(x);return}p.current=window.setTimeout(()=>{w(x)},x?l:c)};return _E(()=>{A(r)},[r]),M.useEffect(()=>()=>{window.clearTimeout(m.current),cancelAnimationFrame(y.current)},[]),{transitionDuration:d,transitionStatus:_,transitionTimingFunction:n||"ease"}}function G_({keepMounted:t,transition:e="fade",duration:n=250,exitDuration:r=n,mounted:i,children:s,timingFunction:o="ease",onExit:a,onEntered:l,onEnter:c,onExited:u,enterDelay:f,exitDelay:h}){const{transitionDuration:d,transitionStatus:g,transitionTimingFunction:_}=TM({mounted:i,exitDuration:r,duration:n,timingFunction:o,onExit:a,onEntered:l,onEnter:c,onExited:u,enterDelay:f,exitDelay:h});return d===0?i?$.jsx($.Fragment,{children:s({})}):t?s({display:"none"}):null:g==="exited"?t?s({display:"none"}):null:$.jsx($.Fragment,{children:s(vM({transition:e,duration:d,state:g,timingFunction:_}))})}G_.displayName="@mantine/core/Transition";const $E=M.forwardRef(({size:t="var(--cb-icon-size, 70%)",style:e,...n},r)=>$.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...e,width:t,height:t},ref:r,...n,children:$.jsx("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}));$E.displayName="@mantine/core/CloseIcon";var VE={root:"m_86a44da5","root--subtle":"m_220c80f2"};const wM={variant:"subtle"},SM=(t,{size:e,radius:n,iconSize:r})=>({root:{"--cb-size":Rn(e,"cb-size"),"--cb-radius":n===void 0?void 0:$_(n),"--cb-icon-size":F(r)}}),em=Si((t,e)=>{const n=he("CloseButton",wM,t),{iconSize:r,children:i,vars:s,radius:o,className:a,classNames:l,style:c,styles:u,unstyled:f,"data-disabled":h,disabled:d,variant:g,icon:_,mod:b,...m}=n,p=mt({name:"CloseButton",props:n,className:a,style:c,classes:VE,classNames:l,styles:u,unstyled:f,vars:s,varsResolver:SM});return $.jsxs(Ff,{ref:e,...m,unstyled:f,variant:g,disabled:d,mod:[{disabled:d||h},b],...p("root",{variant:g,active:!d&&!h}),children:[_||$.jsx($E,{}),i]})});em.classes=VE;em.displayName="@mantine/core/CloseButton";function EM(t){return M.Children.toArray(t).filter(Boolean)}var jE={root:"m_4081bf90"};const bM={preventGrowOverflow:!0,gap:"md",align:"center",justify:"flex-start",wrap:"wrap"},AM=(t,{grow:e,preventGrowOverflow:n,gap:r,align:i,justify:s,wrap:o},{childWidth:a})=>({root:{"--group-child-width":e&&n?a:void 0,"--group-gap":Of(r),"--group-align":i,"--group-justify":s,"--group-wrap":o}}),ru=Fe((t,e)=>{const n=he("Group",bM,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,children:l,gap:c,align:u,justify:f,wrap:h,grow:d,preventGrowOverflow:g,vars:_,variant:b,__size:m,mod:p,...y}=n,w=EM(l),A=w.length,x=Of(c??"md"),O={childWidth:`calc(${100/A}% - (${x} - ${x} / ${A}))`},D=mt({name:"Group",props:n,stylesCtx:O,className:i,style:s,classes:jE,classNames:r,styles:o,unstyled:a,vars:_,varsResolver:AM});return $.jsx(Re,{...D("root"),ref:e,variant:b,mod:[{grow:d},p],size:m,...y,children:w})});ru.classes=jE;ru.displayName="@mantine/core/Group";var WE={root:"m_9814e45f"};const RM={zIndex:za("modal")},xM=(t,{gradient:e,color:n,backgroundOpacity:r,blur:i,radius:s,zIndex:o})=>({root:{"--overlay-bg":e||(n!==void 0||r!==void 0)&&gn(n||"#000",r??.6)||void 0,"--overlay-filter":i?`blur(${F(i)})`:void 0,"--overlay-radius":s===void 0?void 0:$_(s),"--overlay-z-index":o==null?void 0:o.toString()}}),tm=Si((t,e)=>{const n=he("Overlay",RM,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,fixed:c,center:u,children:f,radius:h,zIndex:d,gradient:g,blur:_,color:b,backgroundOpacity:m,mod:p,...y}=n,w=mt({name:"Overlay",props:n,classes:WE,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:l,varsResolver:xM});return $.jsx(Re,{ref:e,...w("root"),mod:[{center:u,fixed:c},p],...y,children:f})});tm.classes=WE;tm.displayName="@mantine/core/Overlay";const[CM,qn]=z_("ModalBase component was not found in tree");function PM({opened:t,transitionDuration:e}){const[n,r]=M.useState(t),i=M.useRef(),o=SE()?0:e;return M.useEffect(()=>(t?(r(!0),window.clearTimeout(i.current)):o===0?r(!1):i.current=window.setTimeout(()=>r(!1),o),()=>window.clearTimeout(i.current)),[t,o]),n}function IM({id:t,transitionProps:e,opened:n,trapFocus:r,closeOnEscape:i,onClose:s,returnFocus:o}){const a=Q2(t),[l,c]=M.useState(!1),[u,f]=M.useState(!1),h=typeof(e==null?void 0:e.duration)=="number"?e==null?void 0:e.duration:200,d=PM({opened:n,transitionDuration:h});return TE("keydown",g=>{var _;g.key==="Escape"&&i&&n&&((_=g.target)==null?void 0:_.getAttribute("data-mantine-stop-propagation"))!=="true"&&s()},{capture:!0}),$2({opened:n,shouldReturnFocus:r&&o}),{_id:a,titleMounted:l,bodyMounted:u,shouldLockScroll:d,setTitleMounted:c,setBodyMounted:f}}const MM=M.forwardRef(({keepMounted:t,opened:e,onClose:n,id:r,transitionProps:i,trapFocus:s,closeOnEscape:o,returnFocus:a,closeOnClickOutside:l,withinPortal:c,portalProps:u,lockScroll:f,children:h,zIndex:d,shadow:g,padding:_,__vars:b,unstyled:m,removeScrollProps:p,...y},w)=>{const{_id:A,titleMounted:x,bodyMounted:I,shouldLockScroll:O,setTitleMounted:D,setBodyMounted:z}=IM({id:r,transitionProps:i,opened:e,trapFocus:s,closeOnEscape:o,onClose:n,returnFocus:a}),{key:H,...Y}=p||{};return $.jsx(zE,{...u,withinPortal:c,children:$.jsx(CM,{value:{opened:e,onClose:n,closeOnClickOutside:l,transitionProps:{...i,keepMounted:t},getTitleId:()=>`${A}-title`,getBodyId:()=>`${A}-body`,titleMounted:x,bodyMounted:I,setTitleMounted:D,setBodyMounted:z,trapFocus:s,closeOnEscape:o,zIndex:d,unstyled:m},children:$.jsx(L_,{enabled:O&&f,...Y,children:$.jsx(Re,{ref:w,...y,__vars:{...b,"--mb-z-index":(d||za("modal")).toString(),"--mb-shadow":pE(g),"--mb-padding":Of(_)},children:h})},H)})})});function NM(){const t=qn();return M.useEffect(()=>(t.setBodyMounted(!0),()=>t.setBodyMounted(!1)),[]),t.getBodyId()}var Fs={title:"m_615af6c9",header:"m_b5489c3c",inner:"m_60c222c7",content:"m_fd1ab0aa",close:"m_606cb269",body:"m_5df29311"};const HE=M.forwardRef(({className:t,...e},n)=>{const r=NM(),i=qn();return $.jsx(Re,{ref:n,...e,id:r,className:$t({[Fs.body]:!i.unstyled},t)})});HE.displayName="@mantine/core/ModalBaseBody";const XE=M.forwardRef(({className:t,onClick:e,...n},r)=>{const i=qn();return $.jsx(em,{ref:r,...n,onClick:s=>{i.onClose(),e==null||e(s)},className:$t({[Fs.close]:!i.unstyled},t),unstyled:i.unstyled})});XE.displayName="@mantine/core/ModalBaseCloseButton";const kM=M.forwardRef(({transitionProps:t,className:e,innerProps:n,onKeyDown:r,style:i,...s},o)=>{const a=qn();return $.jsx(G_,{mounted:a.opened,transition:"pop",...a.transitionProps,...t,children:l=>$.jsx("div",{...n,className:$t({[Fs.inner]:!a.unstyled},n.className),children:$.jsx(J_,{active:a.opened&&a.trapFocus,innerRef:o,children:$.jsx(Q_,{...s,component:"section",role:"dialog",tabIndex:-1,"aria-modal":!0,"aria-describedby":a.bodyMounted?a.getBodyId():void 0,"aria-labelledby":a.titleMounted?a.getTitleId():void 0,style:[i,l],className:$t({[Fs.content]:!a.unstyled},e),unstyled:a.unstyled,children:s.children})})})})}),YE=M.forwardRef(({className:t,...e},n)=>{const r=qn();return $.jsx(Re,{component:"header",ref:n,className:$t({[Fs.header]:!r.unstyled},t),...e})});YE.displayName="@mantine/core/ModalBaseHeader";const OM={duration:200,timingFunction:"ease",transition:"fade"};function FM(t){const e=qn();return{...OM,...e.transitionProps,...t}}const KE=M.forwardRef(({onClick:t,transitionProps:e,style:n,...r},i)=>{const s=qn(),o=FM(e);return $.jsx(G_,{mounted:s.opened,...o,transition:"fade",children:a=>$.jsx(tm,{ref:i,fixed:!0,style:[n,a],zIndex:s.zIndex,unstyled:s.unstyled,onClick:l=>{t==null||t(l),s.closeOnClickOutside&&s.onClose()},...r})})});KE.displayName="@mantine/core/ModalBaseOverlay";function DM(){const t=qn();return M.useEffect(()=>(t.setTitleMounted(!0),()=>t.setTitleMounted(!1)),[]),t.getTitleId()}const qE=M.forwardRef(({className:t,...e},n)=>{const r=DM(),i=qn();return $.jsx(Re,{component:"h2",ref:n,className:$t({[Fs.title]:!i.unstyled},t),...e,id:r})});qE.displayName="@mantine/core/ModalBaseTitle";function BM({children:t}){return $.jsx($.Fragment,{children:t})}const LM={gap:{type:"spacing",property:"gap"},rowGap:{type:"spacing",property:"rowGap"},columnGap:{type:"spacing",property:"columnGap"},align:{type:"identity",property:"alignItems"},justify:{type:"identity",property:"justifyContent"},wrap:{type:"identity",property:"flexWrap"},direction:{type:"identity",property:"flexDirection"}};var ZE={root:"m_8bffd616"};const UM={},nm=Si((t,e)=>{const n=he("Flex",UM,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,gap:c,rowGap:u,columnGap:f,align:h,justify:d,wrap:g,direction:_,...b}=n,m=mt({name:"Flex",classes:ZE,props:n,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:l}),p=Kn(),y=IE(),w=PE({styleProps:{gap:c,rowGap:u,columnGap:f,align:h,justify:d,wrap:g,direction:_},theme:p,data:LM});return $.jsxs($.Fragment,{children:[w.hasResponsiveStyles&&$.jsx(K_,{selector:`.${y}`,styles:w.styles,media:w.media}),$.jsx(Re,{ref:e,...m("root",{className:y,style:Nf(w.inlineStyles)}),...b})]})});nm.classes=ZE;nm.displayName="@mantine/core/Flex";var QE={root:"m_b6d8b162"};function zM(t){if(t==="start")return"start";if(t==="end"||t)return"end"}const $M={inherit:!1},VM=(t,{variant:e,lineClamp:n,gradient:r,size:i,color:s})=>({root:{"--text-fz":D2(i),"--text-lh":B2(i),"--text-gradient":e==="gradient"?Up(r,t):void 0,"--text-line-clamp":typeof n=="number"?n.toString():void 0,"--text-color":s?ya(s,t):void 0}}),fr=Si((t,e)=>{const n=he("Text",$M,t),{lineClamp:r,truncate:i,inline:s,inherit:o,gradient:a,span:l,__staticSelector:c,vars:u,className:f,style:h,classNames:d,styles:g,unstyled:_,variant:b,mod:m,size:p,...y}=n,w=mt({name:["Text",c],props:n,classes:QE,className:f,style:h,classNames:d,styles:g,unstyled:_,vars:u,varsResolver:VM});return $.jsx(Re,{...w("root",{focusable:!0}),ref:e,component:l?"span":"p",variant:b,mod:[{"data-truncate":zM(i),"data-line-clamp":typeof r=="number","data-inline":s,"data-inherit":o},m],size:p,...y})});fr.classes=QE;fr.displayName="@mantine/core/Text";const[jM,Qs]=z_("AppShell was not found in tree");var Br={root:"m_89ab340",navbar:"m_45252eee",aside:"m_9cdde9a",header:"m_3b16f56b",main:"m_8983817",footer:"m_3840c879",section:"m_6dcfc7c7"};const WM={},rm=Fe((t,e)=>{const n=he("AppShellAside",WM,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,withBorder:c,zIndex:u,mod:f,...h}=n,d=Qs();return d.disabled?null:$.jsx(Re,{component:"aside",ref:e,mod:[{"with-border":c??d.withBorder},f],...d.getStyles("aside",{className:i,classNames:r,styles:o,style:s}),...h,__vars:{"--app-shell-aside-z-index":`calc(${u??d.zIndex} + 1)`}})});rm.classes=Br;rm.displayName="@mantine/core/AppShellAside";const HM={},im=Fe((t,e)=>{var g;const n=he("AppShellFooter",HM,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,withBorder:c,zIndex:u,mod:f,...h}=n,d=Qs();return d.disabled?null:$.jsx(Re,{component:"footer",ref:e,mod:[{"with-border":c??d.withBorder},f],...d.getStyles("footer",{className:$t({[L_.classNames.zeroRight]:d.offsetScrollbars},i),classNames:r,styles:o,style:s}),...h,__vars:{"--app-shell-footer-z-index":(g=u??d.zIndex)==null?void 0:g.toString()}})});im.classes=Br;im.displayName="@mantine/core/AppShellFooter";const XM={},sm=Fe((t,e)=>{var g;const n=he("AppShellHeader",XM,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,withBorder:c,zIndex:u,mod:f,...h}=n,d=Qs();return d.disabled?null:$.jsx(Re,{component:"header",ref:e,mod:[{"with-border":c??d.withBorder},f],...d.getStyles("header",{className:$t({[L_.classNames.zeroRight]:d.offsetScrollbars},i),classNames:r,styles:o,style:s}),...h,__vars:{"--app-shell-header-z-index":(g=u??d.zIndex)==null?void 0:g.toString()}})});sm.classes=Br;sm.displayName="@mantine/core/AppShellHeader";const YM={},om=Fe((t,e)=>{const n=he("AppShellMain",YM,t),{classNames:r,className:i,style:s,styles:o,vars:a,...l}=n,c=Qs();return $.jsx(Re,{component:"main",ref:e,...c.getStyles("main",{className:i,style:s,classNames:r,styles:o}),...l})});om.classes=Br;om.displayName="@mantine/core/AppShellMain";function ja(t){return typeof t=="object"?t.base:t}function Wa(t){const e=typeof t=="object"&&t!==null&&typeof t.base<"u"&&Object.keys(t).length===1;return typeof t=="number"||typeof t=="string"||e}function Ha(t){return!(typeof t!="object"||t===null||Object.keys(t).length===1&&"base"in t)}function KM({baseStyles:t,minMediaStyles:e,maxMediaStyles:n,aside:r,theme:i}){var l,c,u;const s=r==null?void 0:r.width,o="translateX(var(--app-shell-aside-width))",a="translateX(calc(var(--app-shell-aside-width) * -1))";if(r!=null&&r.breakpoint&&!((l=r==null?void 0:r.collapsed)!=null&&l.mobile)&&(n[r==null?void 0:r.breakpoint]=n[r==null?void 0:r.breakpoint]||{},n[r==null?void 0:r.breakpoint]["--app-shell-aside-width"]="100%",n[r==null?void 0:r.breakpoint]["--app-shell-aside-offset"]="0px"),Wa(s)){const f=F(ja(s));t["--app-shell-aside-width"]=f,t["--app-shell-aside-offset"]=f}if(Ha(s)&&(typeof s.base<"u"&&(t["--app-shell-aside-width"]=F(s.base),t["--app-shell-aside-offset"]=F(s.base)),Ze(s).forEach(f=>{f!=="base"&&(e[f]=e[f]||{},e[f]["--app-shell-aside-width"]=F(s[f]),e[f]["--app-shell-aside-offset"]=F(s[f]))})),(c=r==null?void 0:r.collapsed)!=null&&c.desktop){const f=r.breakpoint;e[f]=e[f]||{},e[f]["--app-shell-aside-transform"]=o,e[f]["--app-shell-aside-transform-rtl"]=a,e[f]["--app-shell-aside-offset"]="0px !important"}if((u=r==null?void 0:r.collapsed)!=null&&u.mobile){const f=V_(r.breakpoint,i)-.1;n[f]=n[f]||{},n[f]["--app-shell-aside-width"]="100%",n[f]["--app-shell-aside-offset"]="0px",n[f]["--app-shell-aside-transform"]=o,n[f]["--app-shell-aside-transform-rtl"]=a}}function qM({baseStyles:t,minMediaStyles:e,footer:n}){const r=n==null?void 0:n.height,i="translateY(var(--app-shell-footer-height))",s=(n==null?void 0:n.offset)??!0;if(Wa(r)){const o=F(ja(r));t["--app-shell-footer-height"]=o,s&&(t["--app-shell-footer-offset"]=o)}Ha(r)&&(typeof r.base<"u"&&(t["--app-shell-footer-height"]=F(r.base),s&&(t["--app-shell-footer-offset"]=F(r.base))),Ze(r).forEach(o=>{o!=="base"&&(e[o]=e[o]||{},e[o]["--app-shell-footer-height"]=F(r[o]),s&&(e[o]["--app-shell-footer-offset"]=F(r[o])))})),n!=null&&n.collapsed&&(t["--app-shell-footer-transform"]=i,t["--app-shell-footer-offset"]="0px !important")}function ZM({baseStyles:t,minMediaStyles:e,header:n}){const r=n==null?void 0:n.height,i="translateY(calc(var(--app-shell-header-height) * -1))",s=(n==null?void 0:n.offset)??!0;if(Wa(r)){const o=F(ja(r));t["--app-shell-header-height"]=o,s&&(t["--app-shell-header-offset"]=o)}Ha(r)&&(typeof r.base<"u"&&(t["--app-shell-header-height"]=F(r.base),s&&(t["--app-shell-header-offset"]=F(r.base))),Ze(r).forEach(o=>{o!=="base"&&(e[o]=e[o]||{},e[o]["--app-shell-header-height"]=F(r[o]),s&&(e[o]["--app-shell-header-offset"]=F(r[o])))})),n!=null&&n.collapsed&&(t["--app-shell-header-transform"]=i,t["--app-shell-header-offset"]="0px !important")}function QM({baseStyles:t,minMediaStyles:e,maxMediaStyles:n,navbar:r,theme:i}){var l,c,u;const s=r==null?void 0:r.width,o="translateX(calc(var(--app-shell-navbar-width) * -1))",a="translateX(var(--app-shell-navbar-width))";if(r!=null&&r.breakpoint&&!((l=r==null?void 0:r.collapsed)!=null&&l.mobile)&&(n[r==null?void 0:r.breakpoint]=n[r==null?void 0:r.breakpoint]||{},n[r==null?void 0:r.breakpoint]["--app-shell-navbar-width"]="100%",n[r==null?void 0:r.breakpoint]["--app-shell-navbar-offset"]="0px"),Wa(s)){const f=F(ja(s));t["--app-shell-navbar-width"]=f,t["--app-shell-navbar-offset"]=f}if(Ha(s)&&(typeof s.base<"u"&&(t["--app-shell-navbar-width"]=F(s.base),t["--app-shell-navbar-offset"]=F(s.base)),Ze(s).forEach(f=>{f!=="base"&&(e[f]=e[f]||{},e[f]["--app-shell-navbar-width"]=F(s[f]),e[f]["--app-shell-navbar-offset"]=F(s[f]))})),(c=r==null?void 0:r.collapsed)!=null&&c.desktop){const f=r.breakpoint;e[f]=e[f]||{},e[f]["--app-shell-navbar-transform"]=o,e[f]["--app-shell-navbar-transform-rtl"]=a,e[f]["--app-shell-navbar-offset"]="0px !important"}if((u=r==null?void 0:r.collapsed)!=null&&u.mobile){const f=V_(r.breakpoint,i)-.1;n[f]=n[f]||{},n[f]["--app-shell-navbar-width"]="100%",n[f]["--app-shell-navbar-offset"]="0px",n[f]["--app-shell-navbar-transform"]=o,n[f]["--app-shell-navbar-transform-rtl"]=a}}function Jh(t){return Number(t)===0?"0px":Of(t)}function JM({padding:t,baseStyles:e,minMediaStyles:n}){Wa(t)&&(e["--app-shell-padding"]=Jh(ja(t))),Ha(t)&&(t.base&&(e["--app-shell-padding"]=Jh(t.base)),Ze(t).forEach(r=>{r!=="base"&&(n[r]=n[r]||{},n[r]["--app-shell-padding"]=Jh(t[r]))}))}function GM({navbar:t,header:e,footer:n,aside:r,padding:i,theme:s}){const o={},a={},l={};QM({baseStyles:l,minMediaStyles:o,maxMediaStyles:a,navbar:t,theme:s}),KM({baseStyles:l,minMediaStyles:o,maxMediaStyles:a,aside:r,theme:s}),ZM({baseStyles:l,minMediaStyles:o,header:e}),qM({baseStyles:l,minMediaStyles:o,footer:n}),JM({baseStyles:l,minMediaStyles:o,padding:i});const c=z0(Ze(o),s).map(h=>({query:`(min-width: ${nu(h.px)})`,styles:o[h.value]})),u=z0(Ze(a),s).map(h=>({query:`(max-width: ${nu(h.px)})`,styles:a[h.value]})),f=[...c,...u];return{baseStyles:l,media:f}}function eN({navbar:t,header:e,aside:n,footer:r,padding:i}){const s=Kn(),o=Dr(),{media:a,baseStyles:l}=GM({navbar:t,header:e,footer:r,aside:n,padding:i,theme:s});return $.jsx(K_,{media:a,styles:l,selector:o.cssVariablesSelector})}const tN={},am=Fe((t,e)=>{const n=he("AppShellNavbar",tN,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,withBorder:c,zIndex:u,mod:f,...h}=n,d=Qs();return d.disabled?null:$.jsx(Re,{component:"nav",ref:e,mod:[{"with-border":c??d.withBorder},f],...d.getStyles("navbar",{className:i,classNames:r,styles:o,style:s}),...h,__vars:{"--app-shell-navbar-z-index":`calc(${u??d.zIndex} + 1)`}})});am.classes=Br;am.displayName="@mantine/core/AppShellNavbar";const nN={},lm=Si((t,e)=>{const n=he("AppShellSection",nN,t),{classNames:r,className:i,style:s,styles:o,vars:a,grow:l,mod:c,...u}=n,f=Qs();return $.jsx(Re,{ref:e,mod:[{grow:l},c],...f.getStyles("section",{className:i,style:s,classNames:r,styles:o}),...u})});lm.classes=Br;lm.displayName="@mantine/core/AppShellSection";function rN({transitionDuration:t,disabled:e}){const[n,r]=M.useState(!0),i=M.useRef(),s=M.useRef();return TE("resize",()=>{r(!0),clearTimeout(i.current),i.current=window.setTimeout(()=>r(!1),200)}),$a(()=>{M.startTransition(()=>{r(!0),clearTimeout(s.current),s.current=window.setTimeout(()=>r(!1),t||0)})},[e,t]),n}const iN={withBorder:!0,offsetScrollbars:!0,padding:0,transitionDuration:200,transitionTimingFunction:"ease",zIndex:za("app")},sN=(t,{transitionDuration:e,transitionTimingFunction:n})=>({root:{"--app-shell-transition-duration":`${e}ms`,"--app-shell-transition-timing-function":n}}),tn=Fe((t,e)=>{const n=he("AppShell",iN,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,navbar:c,withBorder:u,padding:f,transitionDuration:h,transitionTimingFunction:d,header:g,zIndex:_,layout:b,disabled:m,aside:p,footer:y,offsetScrollbars:w,mod:A,...x}=n,I=mt({name:"AppShell",classes:Br,props:n,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:l,varsResolver:sN}),O=rN({disabled:m,transitionDuration:h});return $.jsxs(jM,{value:{getStyles:I,withBorder:u,zIndex:_,disabled:m,offsetScrollbars:w},children:[$.jsx(eN,{navbar:c,header:g,aside:p,footer:y,padding:f}),$.jsx(Re,{ref:e,...I("root"),mod:[{resizing:O,layout:b,disabled:m},A],...x})]})});tn.classes=Br;tn.displayName="@mantine/core/AppShell";tn.Navbar=am;tn.Header=sm;tn.Main=om;tn.Aside=rm;tn.Footer=im;tn.Section=lm;var JE={root:"m_fea6bf1a",burger:"m_d4fb9cad"};const oN={},aN=(t,{color:e,size:n,lineSize:r,transitionDuration:i,transitionTimingFunction:s})=>({root:{"--burger-color":e?ya(e,t):void 0,"--burger-size":Rn(n,"burger-size"),"--burger-line-size":r?F(r):void 0,"--burger-transition-duration":i===void 0?void 0:`${i}ms`,"--burger-transition-timing-function":s}}),cm=Fe((t,e)=>{const n=he("Burger",oN,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,opened:c,children:u,transitionDuration:f,transitionTimingFunction:h,lineSize:d,...g}=n,_=mt({name:"Burger",classes:JE,props:n,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:l,varsResolver:aN});return $.jsxs(Ff,{..._("root"),ref:e,...g,children:[$.jsx(Re,{mod:["reduce-motion",{opened:c}],..._("burger")}),u]})});cm.classes=JE;cm.displayName="@mantine/core/Burger";var GE={root:"m_7485cace"};const lN={},cN=(t,{size:e,fluid:n})=>({root:{"--container-size":n?void 0:Rn(e,"container-size")}}),um=Fe((t,e)=>{const n=he("Container",lN,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,fluid:c,mod:u,...f}=n,h=mt({name:"Container",classes:GE,props:n,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:l,varsResolver:cN});return $.jsx(Re,{ref:e,mod:[{fluid:c},u],...h("root"),...f})});um.classes=GE;um.displayName="@mantine/core/Container";var eb={root:"m_3eebeb36",label:"m_9e365f20"};const uN={orientation:"horizontal"},fN=(t,{color:e,variant:n,size:r})=>({root:{"--divider-color":e?ya(e,t):void 0,"--divider-border-style":n,"--divider-size":Rn(r,"divider-size")}}),iu=Fe((t,e)=>{const n=he("Divider",uN,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,color:c,orientation:u,label:f,labelPosition:h,mod:d,...g}=n,_=mt({name:"Divider",classes:eb,props:n,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:l,varsResolver:fN});return $.jsx(Re,{ref:e,mod:[{orientation:u,"with-label":!!f},d],..._("root"),...g,role:"separator",children:f&&$.jsx(Re,{component:"span",mod:{position:h},..._("label"),children:f})})});iu.classes=eb;iu.displayName="@mantine/core/Divider";const[hN,Js]=z_("Drawer component was not found in tree");var Zn={root:"m_f11b401e",header:"m_5a7c2c9",content:"m_b8a05bbd",inner:"m_31cd769a"};const dN={},Df=Fe((t,e)=>{const n=he("DrawerBody",dN,t),{classNames:r,className:i,style:s,styles:o,vars:a,...l}=n,c=Js();return $.jsx(HE,{ref:e,...c.getStyles("body",{classNames:r,style:s,styles:o,className:i}),...l})});Df.classes=Zn;Df.displayName="@mantine/core/DrawerBody";const pN={},Bf=Fe((t,e)=>{const n=he("DrawerCloseButton",pN,t),{classNames:r,className:i,style:s,styles:o,vars:a,...l}=n,c=Js();return $.jsx(XE,{ref:e,...c.getStyles("close",{classNames:r,style:s,styles:o,className:i}),...l})});Bf.classes=Zn;Bf.displayName="@mantine/core/DrawerCloseButton";const gN={},Lf=Fe((t,e)=>{const n=he("DrawerContent",gN,t),{classNames:r,className:i,style:s,styles:o,vars:a,children:l,radius:c,...u}=n,f=Js(),h=f.scrollAreaComponent||BM;return $.jsx(kM,{...f.getStyles("content",{className:i,style:s,styles:o,classNames:r}),innerProps:f.getStyles("inner",{className:i,style:s,styles:o,classNames:r}),ref:e,...u,radius:c||f.radius||0,children:$.jsx(h,{style:{height:"calc(100vh - var(--drawer-offset) * 2)"},children:l})})});Lf.classes=Zn;Lf.displayName="@mantine/core/DrawerContent";const _N={},Uf=Fe((t,e)=>{const n=he("DrawerHeader",_N,t),{classNames:r,className:i,style:s,styles:o,vars:a,...l}=n,c=Js();return $.jsx(YE,{ref:e,...c.getStyles("header",{classNames:r,style:s,styles:o,className:i}),...l})});Uf.classes=Zn;Uf.displayName="@mantine/core/DrawerHeader";const mN={},zf=Fe((t,e)=>{const n=he("DrawerOverlay",mN,t),{classNames:r,className:i,style:s,styles:o,vars:a,...l}=n,c=Js();return $.jsx(KE,{ref:e,...c.getStyles("overlay",{classNames:r,style:s,styles:o,className:i}),...l})});zf.classes=Zn;zf.displayName="@mantine/core/DrawerOverlay";function yN(t){switch(t){case"top":return"flex-start";case"bottom":return"flex-end";default:return}}function vN(t){if(t==="top"||t==="bottom")return"0 0 calc(100% - var(--drawer-offset, 0rem) * 2)"}const TN={top:"slide-down",bottom:"slide-up",left:"slide-right",right:"slide-left"},wN={top:"slide-down",bottom:"slide-up",right:"slide-right",left:"slide-left"},SN={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:za("modal"),position:"left"},EN=(t,{position:e,size:n,offset:r})=>({root:{"--drawer-size":Rn(n,"drawer-size"),"--drawer-flex":vN(e),"--drawer-height":e==="left"||e==="right"?void 0:"var(--drawer-size)","--drawer-align":yN(e),"--drawer-justify":e==="right"?"flex-end":void 0,"--drawer-offset":F(r)}}),$f=Fe((t,e)=>{const n=he("DrawerRoot",SN,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,scrollAreaComponent:c,position:u,transitionProps:f,radius:h,...d}=n,{dir:g}=hM(),_=mt({name:"Drawer",classes:Zn,props:n,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:l,varsResolver:EN}),b=(g==="rtl"?wN:TN)[u];return $.jsx(hN,{value:{scrollAreaComponent:c,getStyles:_,radius:h},children:$.jsx(MM,{ref:e,..._("root"),transitionProps:{transition:b,...f},unstyled:a,...d})})});$f.classes=Zn;$f.displayName="@mantine/core/DrawerRoot";const bN={},Vf=Fe((t,e)=>{const n=he("DrawerTitle",bN,t),{classNames:r,className:i,style:s,styles:o,vars:a,...l}=n,c=Js();return $.jsx(qE,{ref:e,...c.getStyles("title",{classNames:r,style:s,styles:o,className:i}),...l})});Vf.classes=Zn;Vf.displayName="@mantine/core/DrawerTitle";const AN={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:za("modal"),withOverlay:!0,withCloseButton:!0},xn=Fe((t,e)=>{const{title:n,withOverlay:r,overlayProps:i,withCloseButton:s,closeButtonProps:o,children:a,...l}=he("Drawer",AN,t),c=!!n||s;return $.jsxs($f,{ref:e,...l,children:[r&&$.jsx(zf,{...i}),$.jsxs(Lf,{children:[c&&$.jsxs(Uf,{children:[n&&$.jsx(Vf,{children:n}),s&&$.jsx(Bf,{...o})]}),$.jsx(Df,{children:a})]})]})});xn.classes=Zn;xn.displayName="@mantine/core/Drawer";xn.Root=$f;xn.Overlay=zf;xn.Content=Lf;xn.Body=Df;xn.Header=Uf;xn.Title=Vf;xn.CloseButton=Bf;const RN=["h1","h2","h3","h4","h5","h6"];function xN(t,e){const n=e!==void 0?e:`h${t}`;return RN.includes(n)?{fontSize:`var(--mantine-${n}-font-size)`,fontWeight:`var(--mantine-${n}-font-weight)`,lineHeight:`var(--mantine-${n}-line-height)`}:{fontSize:F(n),fontWeight:`var(--mantine-h${t}-font-weight)`,lineHeight:`var(--mantine-h${t}-line-height)`}}var tb={root:"m_8a5d1357"};const CN={order:1},PN=(t,{order:e,size:n,lineClamp:r,textWrap:i})=>{const s=xN(e,n);return{root:{"--title-fw":s.fontWeight,"--title-lh":s.lineHeight,"--title-fz":s.fontSize,"--title-line-clamp":typeof r=="number"?r.toString():void 0,"--title-text-wrap":i}}},fm=Fe((t,e)=>{const n=he("Title",CN,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,order:l,vars:c,size:u,variant:f,lineClamp:h,textWrap:d,mod:g,..._}=n,b=mt({name:"Title",props:n,classes:tb,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:c,varsResolver:PN});return[1,2,3,4,5,6].includes(l)?$.jsx(Re,{...b("root"),component:`h${l}`,variant:f,ref:e,mod:[{order:l,"data-line-clamp":typeof h=="number"},g],size:u,..._}):null});fm.classes=tb;fm.displayName="@mantine/core/Title";const IN=t=>te.createElement(nm,{justify:"space-between",p:"0 2rem",align:"center",bg:"#282c34",c:"white",ff:"Gill Sans",h:"100%"},te.createElement(fr,{size:"xl",p:"0.5rem",fw:"700"},"Walking in Barcelona"),te.createElement(cm,{lineSize:2,size:"xl",opened:t.opened,onClick:t.toggle,"aria-label":"Toggle navigation",color:"white"}));function su(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const hm=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),Z0=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Z0&&parseFloat(Z0[1]);const Ol=globalThis,Fi=globalThis.process||{},MN=globalThis.navigator||{};function nb(t){var r,i;if(typeof window<"u"&&((r=window.process)==null?void 0:r.type)==="renderer"||typeof process<"u"&&((i=process.versions)!=null&&i.electron))return!0;const e=typeof navigator<"u"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Lr(){return!(typeof process=="object"&&String(process)==="[object process]"&&!(process!=null&&process.browser))||nb()}function NN(t){return!t&&!Lr()?"Node":nb(t)?"Electron":(t||MN.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown"}const rb="4.0.7";function kN(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class ON{constructor(e,n,r="sessionStorage"){this.storage=kN(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function FN(t){let e;return t<10?e=`${t.toFixed(2)}ms`:t<100?e=`${t.toFixed(1)}ms`:t<1e3?e=`${t.toFixed(0)}ms`:e=`${(t/1e3).toFixed(2)}s`,e}function DN(t,e=8){const n=Math.max(e-t.length,0);return`${" ".repeat(n)}${t}`}var ou;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(ou||(ou={}));const BN=10;function Q0(t){return typeof t!="string"?t:(t=t.toUpperCase(),ou[t]||ou.WHITE)}function LN(t,e,n){return!Lr&&typeof t=="string"&&(e&&(t=`\x1B[${Q0(e)}m${t}\x1B[39m`),n&&(t=`\x1B[${Q0(n)+BN}m${t}\x1B[49m`)),t}function UN(t,e=["constructor"]){const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const s of r){const o=i[s];typeof o=="function"&&(e.find(a=>s===a)||(i[s]=o.bind(t)))}}function dm(t,e){if(!t)throw new Error(e||"Assertion failed")}function Di(){var e,n,r;let t;if(Lr()&&Ol.performance)t=(n=(e=Ol==null?void 0:Ol.performance)==null?void 0:e.now)==null?void 0:n.call(e);else if("hrtime"in Fi){const i=(r=Fi==null?void 0:Fi.hrtime)==null?void 0:r.call(Fi);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Bi={debug:Lr()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},zN={enabled:!0,level:0};function Li(){}const J0={},G0={once:!0};class Xa{constructor({id:e}={id:""}){this.VERSION=rb,this._startTs=Di(),this._deltaTs=Di(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new ON(`__probe-${this.id}__`,zN),this.timeStamp(`${this.id} started`),UN(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Di()-this._startTs).toPrecision(10))}getDelta(){return Number((Di()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){if(!e)throw new Error(n||"Assertion failed")}warn(e){return this._getLogFunction(0,e,Bi.warn,arguments,G0)}error(e){return this._getLogFunction(0,e,Bi.error,arguments)}deprecated(e,n){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${n}\` instead`)}removed(e,n){return this.error(`\`${e}\` has been removed. Use \`${n}\` instead`)}probe(e,n){return this._getLogFunction(e,n,Bi.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Bi.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,Bi.debug||Bi.info,arguments,G0)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Li,r&&[r],{tag:VN(n)}):Li}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Li)}group(e,n,r={collapsed:!1}){const i=ev({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n,r={}){return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Li)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=ib(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=ev({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,dm(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Di();const o=s.tag||s.message;if(s.once&&o)if(!J0[o])J0[o]=Di();else return Li;return n=$N(this.id,s.message,s),r.bind(console,n,...s.args)}return Li}}Xa.VERSION=rb;function ib(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return dm(Number.isFinite(e)&&e>=0),e}function ev(t){const{logLevel:e,message:n}=t;t.logLevel=ib(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return dm(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function $N(t,e,n){if(typeof e=="string"){const r=n.time?DN(FN(n.total)):"";e=n.time?`${t}: ${r}  ${e}`:`${t}: ${e}`,e=LN(e,n.color,n.background)}return e}function VN(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}function jN(t,e){return sb(t||{},e)}function sb(t,e,n=0){if(n>3)return e;const r={...t};for(const[i,s]of Object.entries(e))s&&typeof s=="object"&&!Array.isArray(s)?r[i]=sb(r[i]||{},e[i],n+1):r[i]=e[i];return r}const WN="latest";function HN(){var t;return(t=globalThis._loadersgl_)!=null&&t.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.2.2"),globalThis._loadersgl_.version}const XN=HN();function Ir(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const ai=typeof process!="object"||String(process)!=="[object process]"||process.browser,YN=typeof window<"u"&&typeof window.orientation<"u",tv=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);tv&&parseFloat(tv[1]);class KN{constructor(e,n){T(this,"name");T(this,"workerThread");T(this,"isRunning",!0);T(this,"result");T(this,"_resolve",()=>{});T(this,"_reject",()=>{});this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){Ir(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Ir(this.isRunning),this.isRunning=!1,this._reject(e)}}class Gh{terminate(){}}const ed=new Map;function qN(t){Ir(t.source&&!t.url||!t.source&&t.url);let e=ed.get(t.source||t.url);return e||(t.url&&(e=ZN(t.url),ed.set(t.url,e)),t.source&&(e=ob(t.source),ed.set(t.source,e))),Ir(e),e}function ZN(t){if(!t.startsWith("http"))return t;const e=QN(t);return ob(e)}function ob(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function QN(t){return`try {
  importScripts('${t}');
} catch (error) {
  console.error(error);
  throw error;
}`}function ab(t,e=!0,n){const r=n||new Set;if(t){if(nv(t))r.add(t);else if(nv(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)ab(t[i],e,r)}}return n===void 0?Array.from(r):[]}function nv(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const td=()=>{};class Vp{constructor(e){T(this,"name");T(this,"source");T(this,"url");T(this,"terminated",!1);T(this,"worker");T(this,"onMessage");T(this,"onError");T(this,"_loadableURL","");const{name:n,source:r,url:i}=e;Ir(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=td,this.onError=s=>console.log(s),this.worker=ai?this._createBrowserWorker():this._createNodeWorker()}static isSupported(){return typeof Worker<"u"&&ai||typeof Gh<"u"&&!ai}destroy(){this.onMessage=td,this.onError=td,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||ab(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+=`worker ${this.name} from ${this.url}. `,e.message&&(n+=`${e.message} in `),e.lineno&&(n+=`:${e.lineno}:${e.colno}`),new Error(n)}_createBrowserWorker(){this._loadableURL=qN({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new Gh(r,{eval:!1})}else if(this.source)e=new Gh(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class JN{constructor(e){T(this,"name","unnamed");T(this,"source");T(this,"url");T(this,"maxConcurrency",1);T(this,"maxMobileConcurrency",1);T(this,"onDebug",()=>{});T(this,"reuseWorkers",!0);T(this,"props",{});T(this,"jobQueue",[]);T(this,"idleQueue",[]);T(this,"count",0);T(this,"isDestroyed",!1);this.source=e.source,this.url=e.url,this.setProps(e)}static isSupported(){return Vp.isSupported()}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,n=(i,s,o)=>i.done(o),r=(i,s)=>i.error(s)){const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new KN(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!ai||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new Vp({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return YN?this.maxMobileConcurrency:this.maxConcurrency}}const GN={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},lr=class lr{constructor(e){T(this,"props");T(this,"workerPools",new Map);this.props={...GN},this.setProps(e),this.workerPools=new Map}static isSupported(){return Vp.isSupported()}static getWorkerFarm(e={}){return lr._workerFarm=lr._workerFarm||new lr({}),lr._workerFarm.setProps(e),lr._workerFarm}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new JN({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}};T(lr,"_workerFarm");let au=lr;function ek(t,e={}){const n=e[t.id]||{},r=ai?`${t.id}-worker.js`:`${t.id}-worker-node.js`;let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(ai?i=`modules/${t.module}/dist/${r}`:i=`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!i){let s=t.version;s==="latest"&&(s=WN);const o=s?`@${s}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${o}/dist/${r}`}return Ir(i),i}function tk(t,e=XN){Ir(t,"no worker provided");const n=t.version;return!(!e||!n)}function nk(t,e){return!au.isSupported()||!ai&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function rk(t,e,n,r,i){const s=t.id,o=ek(t,n),l=au.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const c=await l.startJob("process-on-worker",ik.bind(null,i));return c.postMessage("process",{input:e,options:n,context:r}),await(await c.result).result}async function ik(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:o}=r;try{const a=await t(s,o);e.postMessage("done",{id:i,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:l})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}function sk(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function ok(...t){return ak(t)}function ak(t){const e=t.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),n=e.reduce((s,o)=>s+o.byteLength,0),r=new Uint8Array(n);let i=0;for(const s of e)r.set(s,i),i+=s.byteLength;return r.buffer}async function lk(t){const e=[];for await(const n of t)e.push(n);return ok(...e)}function rv(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class iv{constructor(e,n){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=rv(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(rv()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class jf{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,n="count"){return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let i=this.stats[n];return i||(e instanceof iv?i=e:i=new iv(n,r),this.stats[n]=i),i}}let ck="";const sv={};function uk(t){for(const e in sv)if(t.startsWith(e)){const n=sv[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t=`${ck}${t}`),t}function fk(t){return t&&typeof t=="object"&&t.isBuffer}function lb(t){if(fk(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function cb(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function hk(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const dk=t=>typeof t=="boolean",Wo=t=>typeof t=="function",Ya=t=>t!==null&&typeof t=="object",ov=t=>Ya(t)&&t.constructor==={}.constructor,pk=t=>!!t&&typeof t[Symbol.iterator]=="function",gk=t=>t&&typeof t[Symbol.asyncIterator]=="function",Ei=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,bi=t=>typeof Blob<"u"&&t instanceof Blob,_k=t=>t&&typeof t=="object"&&t.isBuffer,mk=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||Ya(t)&&Wo(t.tee)&&Wo(t.cancel)&&Wo(t.getReader),yk=t=>Ya(t)&&Wo(t.read)&&Wo(t.pipe)&&dk(t.readable),ub=t=>mk(t)||yk(t);class vk extends Error{constructor(n,r){super(n);T(this,"reason");T(this,"url");T(this,"response");this.reason=r.reason,this.url=r.url,this.response=r.response}}const Tk=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,wk=/^([-\w.]+\/[-\w.+]+)/;function av(t,e){return t.toLowerCase()===e.toLowerCase()}function Sk(t){const e=wk.exec(t);return e?e[1]:t}function lv(t){const e=Tk.exec(t);return e?e[1]:""}const fb=/\?.*/;function Ek(t){const e=t.match(fb);return e&&e[0]}function pm(t){return t.replace(fb,"")}function bk(t){if(t.length<50)return t;const e=t.slice(t.length-15);return`${t.substr(0,32)}...${e}`}function Wf(t){return Ei(t)?t.url:bi(t)?t.name||"":typeof t=="string"?t:""}function gm(t){if(Ei(t)){const e=t,n=e.headers.get("content-type")||"",r=pm(e.url);return Sk(n)||lv(r)}return bi(t)?t.type||"":typeof t=="string"?lv(t):""}function Ak(t){return Ei(t)?t.headers["content-length"]||-1:bi(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function hb(t){if(Ei(t))return t;const e={},n=Ak(t);n>=0&&(e["content-length"]=String(n));const r=Wf(t),i=gm(t);i&&(e["content-type"]=i);const s=await Ck(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function Rk(t){if(!t.ok)throw await xk(t)}async function xk(t){const e=bk(t.url);let n=`Failed to fetch resource (${t.status}) ${t.statusText}: ${e}`;n=n.length>100?`${n.slice(0,100)}...`:n;const r={reason:t.statusText,url:t.url,response:t};try{const i=t.headers.get("Content-Type");r.reason=i!=null&&i.includes("application/json")?await t.json():t.text()}catch{}return new vk(n,r)}async function Ck(t){if(typeof t=="string")return`data:,${t.slice(0,5)}`;if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var o;return r((o=s==null?void 0:s.target)==null?void 0:o.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5);return`data:base64,${Pk(n)}`}return null}function Pk(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}function Ik(t){return!Mk(t)&&!Nk(t)}function Mk(t){return t.startsWith("http:")||t.startsWith("https:")}function Nk(t){return t.startsWith("data:")}async function cv(t,e){var n,r;if(typeof t=="string"){const i=uk(t);return Ik(i)&&(n=globalThis.loaders)!=null&&n.fetchNode?(r=globalThis.loaders)==null?void 0:r.fetchNode(i,e):await fetch(i,e)}return await hb(t)}const uv=new Xa({id:"loaders.gl"});class kk{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class Ok{constructor(){T(this,"console");this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const db={fetch:null,mimeType:void 0,nothrow:!1,log:new Ok,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:hm,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},Fk={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function pb(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state||(t._state={}),t._state}function gb(){const t=pb();return t.globalOptions=t.globalOptions||{...db},t.globalOptions}function Dk(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],Bk(t,n),Uk(e,t,r)}function Bk(t,e){fv(t,null,db,Fk,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};fv(r,n.id,i,s,e)}}function fv(t,e,n,r,i){const s=e||"Top level",o=e?`${e}.`:"";for(const a in t){const l=!e&&Ya(t[a]),c=a==="baseUri"&&!e,u=a==="workerUrl"&&e;if(!(a in n)&&!c&&!u){if(a in r)uv.warn(`${s} loader option '${o}${a}' no longer supported, use '${r[a]}'`)();else if(!l){const f=Lk(a,i);uv.warn(`${s} loader option '${o}${a}' not recognized. ${f}`)()}}}}function Lk(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return`Did you mean '${i.id}.${s}'?`;const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||`Did you mean '${i.id}.${s}'?`)}return r}function Uk(t,e,n){const i={...t.options||{}};return zk(i,n),i.log===null&&(i.log=new kk),hv(i,gb()),hv(i,e),i}function hv(t,e){for(const n in e)if(n in e){const r=e[n];ov(r)&&ov(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function zk(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function _m(t){return t?(Array.isArray(t)&&(t=t[0]),Array.isArray(t==null?void 0:t.extensions)):!1}function mm(t){su(t,"null loader"),su(_m(t),"invalid loader");let e;return Array.isArray(t)&&(e=t[1],t=t[0],t={...t,options:{...t.options,...e}}),(t!=null&&t.parseTextSync||t!=null&&t.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const _b=()=>{const t=pb();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function $k(t){const e=_b();t=Array.isArray(t)?t:[t];for(const n of t){const r=mm(n);e.find(i=>r===i)||e.unshift(r)}}function Vk(){return _b()}const jk=new Xa({id:"loaders.gl"}),Wk=/\.([^.]+)$/;async function Hk(t,e=[],n,r){if(!mb(t))return null;let i=dv(t,e,{...n,nothrow:!0},r);if(i)return i;if(bi(t)&&(t=await t.slice(0,10).arrayBuffer(),i=dv(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(yb(t));return i}function dv(t,e=[],n,r){if(!mb(t))return null;if(e&&!Array.isArray(e))return mm(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...Vk()),Yk(i);const s=Xk(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(yb(t));return s}function Xk(t,e,n,r){const i=Wf(t),s=gm(t),o=pm(i)||(r==null?void 0:r.url);let a=null,l="";return n!=null&&n.mimeType&&(a=nd(e,n==null?void 0:n.mimeType),l=`match forced by supplied MIME type ${n==null?void 0:n.mimeType}`),a=a||Kk(e,o),l=l||(a?`matched url ${o}`:""),a=a||nd(e,s),l=l||(a?`matched MIME type ${s}`:""),a=a||Zk(e,t),l=l||(a?`matched initial data ${vb(t)}`:""),n!=null&&n.fallbackMimeType&&(a=a||nd(e,n==null?void 0:n.fallbackMimeType),l=l||(a?`matched fallback MIME type ${s}`:"")),l&&jk.log(1,`selectLoader selected ${a==null?void 0:a.name}: ${l}.`),a}function mb(t){return!(t instanceof Response&&t.status===204)}function yb(t){const e=Wf(t),n=gm(t);let r="No valid loader found (";r+=e?`${cb(e)}, `:"no url provided, ",r+=`MIME type: ${n?`"${n}"`:"not provided"}, `;const i=t?vb(t):"";return r+=i?` first bytes: "${i}"`:"first bytes: not available",r+=")",r}function Yk(t){for(const e of t)mm(e)}function Kk(t,e){const n=e&&Wk.exec(e),r=n&&n[1];return r?qk(t,r):null}function qk(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function nd(t,e){var n;for(const r of t)if((n=r.mimeTypes)!=null&&n.some(i=>av(e,i))||av(e,`application/x.${r.id}`))return r;return null}function Zk(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(Qk(e,n))return n}else if(ArrayBuffer.isView(e)){if(pv(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&pv(e,0,n))return n;return null}function Qk(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function pv(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>Jk(t,e,n,i))}function Jk(t,e,n,r){if(r instanceof ArrayBuffer)return sk(r,t,r.byteLength);switch(typeof r){case"function":return r(t);case"string":const i=jp(t,e,r.length);return r===i;default:return!1}}function vb(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?jp(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?jp(t,0,e):""}function jp(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const Gk=256*1024;function*eO(t,e){const n=(e==null?void 0:e.chunkSize)||Gk;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),o=t.slice(r,r+s);r+=s,yield i.encode(o)}}const tO=256*1024;function*nO(t,e={}){const{chunkSize:n=tO}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),o=new Uint8Array(t,r,i);new Uint8Array(s).set(o),r+=i,yield s}}const rO=1024*1024;async function*iO(t,e){const n=(e==null?void 0:e.chunkSize)||rO;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function gv(t,e){return hm?sO(t,e):oO(t)}async function*sO(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:o}=await i;if(s)return;yield lb(o)}}catch{n.releaseLock()}}async function*oO(t,e){for await(const n of t)yield lb(n)}function aO(t,e){if(typeof t=="string")return eO(t,e);if(t instanceof ArrayBuffer)return nO(t,e);if(bi(t))return iO(t,e);if(ub(t))return gv(t,e);if(Ei(t))return gv(t.body,e);throw new Error("makeIterator")}const Tb="Cannot convert supplied data type";function lO(t,e,n){if(e.text&&typeof t=="string")return t;if(_k(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(Tb)}async function cO(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return lO(t,e);if(bi(t)&&(t=await hb(t)),Ei(t)){const i=t;return await Rk(i),e.binary?await i.arrayBuffer():await i.text()}if(ub(t)&&(t=aO(t,n)),pk(t)||gk(t))return lk(t);throw new Error(Tb)}function wb(t,e){const n=gb(),r=t||n;return typeof r.fetch=="function"?r.fetch:Ya(r.fetch)?i=>cv(i,r.fetch):e!=null&&e.fetch?e==null?void 0:e.fetch:cv}function uO(t,e,n){if(n)return n;const r={fetch:wb(e,t),...t};if(r.url){const i=pm(r.url);r.baseUrl=i,r.queryString=Ek(r.url),r.filename=cb(i),r.baseUrl=hk(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function fO(t,e){if(t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:void 0}async function lu(t,e,n,r){e&&!Array.isArray(e)&&!_m(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=Wf(t),o=fO(e,r),a=await Hk(t,o,n);return a?(n=Dk(n,a,o,i),r=uO({url:i,_parse:lu,loaders:o},n,r||null),await hO(a,t,n,r)):null}async function hO(t,e,n,r){if(tk(t),n=jN(t.options,n),Ei(e)){const s=e,{ok:o,redirected:a,status:l,statusText:c,type:u,url:f}=s,h=Object.fromEntries(s.headers.entries());r.response={headers:h,ok:o,redirected:a,status:l,statusText:c,type:u,url:f}}e=await cO(e,t,n);const i=t;if(i.parseTextSync&&typeof e=="string")return i.parseTextSync(e,n,r);if(nk(t,n))return await rk(t,e,n,r,lu);if(i.parseText&&typeof e=="string")return await i.parseText(e,n,r);if(i.parse)return await i.parse(e,n,r);throw Ir(!i.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}async function cu(t,e,n,r){let i,s;!Array.isArray(e)&&!_m(e)?(i=[],s=e):(i=e,s=n);const o=wb(s);let a=t;return typeof t=="string"&&(a=await o(t)),bi(t)&&(a=await o(t)),Array.isArray(i)?await lu(a,i,s):await lu(a,i,s)}const dO="4.2.2";var vw;const pO=(vw=globalThis.loaders)==null?void 0:vw.parseImageNode,Wp=typeof Image<"u",Hp=typeof ImageBitmap<"u",gO=!!pO,Xp=hm?!0:gO;function _O(t){switch(t){case"auto":return Hp||Wp||Xp;case"imagebitmap":return Hp;case"image":return Wp;case"data":return Xp;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function mO(){if(Hp)return"imagebitmap";if(Wp)return"image";if(Xp)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function yO(t){const e=TO(t);if(!e)throw new Error("Not an image");return e}function vO(t){switch(yO(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function TO(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const wO=/^data:image\/svg\+xml/,SO=/\.svg((\?|#).*)?$/;function ym(t){return t&&(wO.test(t)||SO.test(t))}function EO(t,e){if(ym(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(r)}`}return Sb(t,e)}function Sb(t,e){if(ym(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Eb(t,e,n){const r=EO(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await bO(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function bO(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>{const o=s instanceof Error?s.message:"error";i(new Error(o))}}catch(s){i(s)}})}const AO={};let _v=!0;async function RO(t,e,n){let r;ym(n)?r=await Eb(t,e,n):r=Sb(t,n);const i=e&&e.imagebitmap;return await xO(r,i)}async function xO(t,e=null){if((CO(e)||!_v)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),_v=!1}return await createImageBitmap(t)}function CO(t){for(const e in t||AO)return!1;return!0}function PO(t){return!kO(t,"ftyp",4)||!(t[8]&96)?null:IO(t)}function IO(t){switch(MO(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function MO(t,e,n){return String.fromCharCode(...t.slice(e,n))}function NO(t){return[...t].map(e=>e.charCodeAt(0))}function kO(t,e,n=0){const r=NO(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const vn=!1,Ho=!0;function bb(t){const e=Ka(t);return FO(e)||LO(e)||DO(e)||BO(e)||OO(e)}function OO(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=PO(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function FO(t){const e=Ka(t);return e.byteLength>=24&&e.getUint32(0,vn)===2303741511?{mimeType:"image/png",width:e.getUint32(16,vn),height:e.getUint32(20,vn)}:null}function DO(t){const e=Ka(t);return e.byteLength>=10&&e.getUint32(0,vn)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,Ho),height:e.getUint16(8,Ho)}:null}function BO(t){const e=Ka(t);return e.byteLength>=14&&e.getUint16(0,vn)===16973&&e.getUint32(2,Ho)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,Ho),height:e.getUint32(22,Ho)}:null}function LO(t){const e=Ka(t);if(!(e.byteLength>=3&&e.getUint16(0,vn)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=UO();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,vn);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,vn),width:e.getUint16(s+7,vn)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,vn)}return null}function UO(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Ka(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function zO(t,e){var i;const{mimeType:n}=bb(t)||{},r=(i=globalThis.loaders)==null?void 0:i.parseImageNode;return su(r),await r(t,n)}async function $O(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},o=VO(i);let a;switch(o){case"imagebitmap":a=await RO(t,e,s);break;case"image":a=await Eb(t,e,s);break;case"data":a=await zO(t);break;default:su(!1)}return i==="data"&&(a=vO(a)),a}function VO(t){switch(t){case"auto":case"data":return mO();default:return _O(t),t}}const jO=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],WO=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],HO={image:{type:"auto",decode:!0}},XO={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:dO,mimeTypes:WO,extensions:jO,parse:$O,tests:[t=>!!bb(new DataView(t))],options:HO},YO=new Xa({id:"deck"}),G=YO;let Yp={};function KO(t){Yp=t}function nt(t,e,n,r){G.level>0&&Yp[t]&&Yp[t].call(null,e,n,r)}function qO(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const ZO={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:qO,parseTextSync:JSON.parse};function QO(){const t="9.0.29",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${t}`);return e||(G.log(1,`deck.gl ${t}`)(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:G,_registerLoggers:KO},$k([ZO,[XO,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const JO=QO();function ei(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const rd={number:{type:"number",validate(t,e){return Number.isFinite(t)&&typeof e=="object"&&(e.max===void 0||t<=e.max)&&(e.min===void 0||t>=e.min)}},array:{type:"array",validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function GO(t){const e={};for(const[n,r]of Object.entries(t))e[n]=tF(r);return e}function eF(t,e,n){const r={};for(const[i,s]of Object.entries(e))t&&i in t&&!s.private?(s.validate&&ei(s.validate(t[i],s),`${n}: invalid ${i}`),r[i]=t[i]):r[i]=s.value;return r}function tF(t){let e=mv(t);if(e!=="object")return{value:t,...rd[e],type:e};if(typeof t=="object")return t?t.type!==void 0?{...t,...rd[t.type],type:t.type}:t.value===void 0?{type:"object",value:t}:(e=mv(t.value),{...t,...rd[e],type:e}):{type:"object",value:null};throw new Error("props")}function mv(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const nF=`#ifdef MODULE_LOGDEPTH
logdepth_adjustPosition(gl_Position);
#endif
`,rF=`#ifdef MODULE_MATERIAL
gl_FragColor = material_filterColor(gl_FragColor);
#endif
#ifdef MODULE_LIGHTING
gl_FragColor = lighting_filterColor(gl_FragColor);
#endif
#ifdef MODULE_FOG
gl_FragColor = fog_filterColor(gl_FragColor);
#endif
#ifdef MODULE_PICKING
gl_FragColor = picking_filterHighlightColor(gl_FragColor);
gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif
#ifdef MODULE_LOGDEPTH
logdepth_setFragDepth();
#endif
`,iF={vertex:nF,fragment:rF},yv=/void\s+main\s*\([^)]*\)\s*\{\n?/,vv=/}\n?[^{}]*$/,id=[],Tc="__LUMA_INJECT_DECLARATIONS__";function sF(t){const e={vertex:{},fragment:{}};for(const n in t){let r=t[n];const i=oF(n);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function oF(t){const e=t.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function uu(t,e,n,r=!1){const i=e==="vertex";for(const s in n){const o=n[s];o.sort((l,c)=>l.order-c.order),id.length=o.length;for(let l=0,c=o.length;l<c;++l)id[l]=o[l].injection;const a=`${id.join(`
`)}
`;switch(s){case"vs:#decl":i&&(t=t.replace(Tc,a));break;case"vs:#main-start":i&&(t=t.replace(yv,l=>l+a));break;case"vs:#main-end":i&&(t=t.replace(vv,l=>a+l));break;case"fs:#decl":i||(t=t.replace(Tc,a));break;case"fs:#main-start":i||(t=t.replace(yv,l=>l+a));break;case"fs:#main-end":i||(t=t.replace(vv,l=>a+l));break;default:t=t.replace(s,l=>l+a)}}return t=t.replace(Tc,""),r&&(t=t.replace(/\}\s*$/,s=>s+iF[e])),t}let aF=1;class ti{constructor(e){T(this,"name");T(this,"vs");T(this,"fs");T(this,"getModuleUniforms");T(this,"dependencies");T(this,"deprecations");T(this,"defines");T(this,"injections");T(this,"uniforms",{});T(this,"uniformTypes",{});const{name:n,vs:r,fs:i,dependencies:s=[],uniformTypes:o={},uniformPropTypes:a={},getUniforms:l,deprecations:c=[],defines:u={},inject:f={}}=e;ei(typeof n=="string"),this.name=n,this.vs=r,this.fs=i,this.getModuleUniforms=l,this.dependencies=ti.instantiateModules(s),this.deprecations=this._parseDeprecationDefinitions(c),this.defines=u,this.injections=sF(f),this.uniformTypes=o,a&&(this.uniforms=GO(a))}static instantiateModules(e){return e.map(n=>{if(n instanceof ti)return n;ei(typeof n!="string",`Shader module use by name is deprecated. Import shader module '${JSON.stringify(n)}' and use it directly.`),n.name||(console.warn("shader module has no name"),n.name=`shader-module-${aF++}`);const r=new ti(n);return r.dependencies=ti.instantiateModules(n.dependencies||[]),r})}getModuleSource(e){let n;switch(e){case"vertex":n=this.vs||"";break;case"fragment":n=this.fs||"";break;default:ei(!1)}const r=this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");return`// ----- MODULE ${this.name} ---------------

#define MODULE_${r}
${n}

`}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):eF(e,this.uniforms,this.name)}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{var i;(i=r.regex)!=null&&i.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp(`\\b${n.old}\\(`);break;default:n.regex=new RegExp(`${n.type} ${n.old};`)}}),e}_defaultGetUniforms(e={}){const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&ei(s.validate(e[i],s),`${this.name}: invalid ${i}`),n[i]=e[i]):n[i]=s.value}return n}}function Tv(t){if(t.source&&t.platformInfo.type==="webgpu")return{...t,vs:void 0,fs:void 0};if(!t.vs)throw new Error("no vertex shader");const e=wv(t.platformInfo,t.vs);let n;return t.fs&&(n=wv(t.platformInfo,t.fs)),{...t,vs:e,fs:n}}function wv(t,e){if(typeof e=="string")return e;switch(t.type){case"webgpu":if(e!=null&&e.wgsl)return e.wgsl;throw new Error("WebGPU does not support GLSL shaders");default:if(e!=null&&e.glsl)return e.glsl;throw new Error("WebGL does not support WGSL shaders")}}function Hf(t){const e=ti.instantiateModules(t);return lF(e)}function lF(t){const e={},n={};return Ab({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function Ab(t){const{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&Ab({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function cF(t){switch(t==null?void 0:t.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function uF(t,e){var r;if(Number(((r=t.match(/^#version[ \t]+(\d+)/m))==null?void 0:r[1])||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return t=Sv(t,fF),t;case"fragment":return t=Sv(t,hF),t;default:throw new Error(e)}}const Rb=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],fF=[...Rb,[Kp("attribute"),"in $1"],[Kp("varying"),"out $1"]],hF=[...Rb,[Kp("varying"),"in $1"]];function Sv(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function Kp(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function xb(t,e){let n="";for(const r in t){const i=t[r];if(n+=`void ${i.signature} {
`,i.header&&(n+=`  ${i.header}`),e[r]){const s=e[r];s.sort((o,a)=>o.order-a.order);for(const o of s)n+=`  ${o.injection}
`}i.footer&&(n+=`  ${i.footer}`),n+=`}
`}return n}function Cb(t){const e={vertex:{},fragment:{}};for(const n of t){let r,i;typeof n!="string"?(r=n,i=r.hook):(r={},i=n),i=i.trim();const[s,o]=i.split(":"),a=i.replace(/\(.+/,""),l=Object.assign(r,{signature:o});switch(s){case"vs":e.vertex[a]=l;break;case"fs":e.fragment[a]=l;break;default:throw new Error(s)}}return e}function dF(t,e){return{name:pF(t,e),language:"glsl",version:gF(t)}}function pF(t,e="unnamed"){const r=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(t);return r?r[1]:e}function gF(t){let e=100;const n=t.match(/[^\s]+/g);if(n&&n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}const Pb=`

${Tc}
`,_F=`precision highp float;
`;function mF(t){const e=Hf(t.modules||[]);return{source:qp(t.platformInfo,{...t,source:t.source,stage:"vertex",modules:e}),getUniforms:vm(e)}}function yF(t){const e=Hf(t.modules||[]);return{vs:qp(t.platformInfo,{...t,source:t.vs,stage:"vertex",modules:e}),fs:qp(t.platformInfo,{...t,source:t.fs,stage:"fragment",modules:e}),getUniforms:vm(e)}}function vF(t){const{vs:e,fs:n}=t,r=Hf(t.modules||[]);return{vs:Ev(t.platformInfo,{...t,source:e,stage:"vertex",modules:r}),fs:Ev(t.platformInfo,{...t,source:n,stage:"fragment",modules:r}),getUniforms:vm(r)}}function qp(t,e){const{source:n,stage:r,modules:i,hookFunctions:s=[],inject:o={},log:a}=e;ei(typeof n=="string","shader source must be a string");const l=n;let c="";const u=Cb(s),f={},h={},d={};for(const _ in o){const b=typeof o[_]=="string"?{injection:o[_],order:0}:o[_],m=/^(v|f)s:(#)?([\w-]+)$/.exec(_);if(m){const p=m[2],y=m[3];p?y==="decl"?h[_]=[b]:d[_]=[b]:f[_]=[b]}else d[_]=[b]}const g=t.type!=="webgpu"?i:[];for(const _ of g){a&&_.checkDeprecations(l,a);const b=_.getModuleSource(r,"wgsl");c+=b;const m=_.injections[r];for(const p in m){const y=/^(v|f)s:#([\w-]+)$/.exec(p);if(y){const A=y[2]==="decl"?h:d;A[p]=A[p]||[],A[p].push(m[p])}else f[p]=f[p]||[],f[p].push(m[p])}}return c+=Pb,c=uu(c,r,h),c+=xb(u[r],f),c+=l,c=uu(c,r,d),c}function Ev(t,e){const{id:n,source:r,stage:i,language:s="glsl",modules:o,defines:a={},hookFunctions:l=[],inject:c={},prologue:u=!0,log:f}=e;ei(typeof r=="string","shader source must be a string");const h=s==="glsl"?dF(r).version:-1,d=t.shaderLanguageVersion,g=h===100?"#version 100":"#version 300 es",b=r.split(`
`).slice(1).join(`
`),m={};o.forEach(I=>{Object.assign(m,I.getDefines())}),Object.assign(m,a);let p="";switch(s){case"wgsl":break;case"glsl":p=u?`${g}

// ----- PROLOGUE -------------------------
${TF({id:n,source:r,stage:i})}
${`#define SHADER_TYPE_${i.toUpperCase()}`}
${cF(t)}
${i==="fragment"?_F:""}

// ----- APPLICATION DEFINES -------------------------

${wF(m)}

`:`${g}
`;break}const y=Cb(l),w={},A={},x={};for(const I in c){const O=typeof c[I]=="string"?{injection:c[I],order:0}:c[I],D=/^(v|f)s:(#)?([\w-]+)$/.exec(I);if(D){const z=D[2],H=D[3];z?H==="decl"?A[I]=[O]:x[I]=[O]:w[I]=[O]}else x[I]=[O]}for(const I of o){f&&I.checkDeprecations(b,f);const O=I.getModuleSource(i);p+=O;const D=I.injections[i];for(const z in D){const H=/^(v|f)s:#([\w-]+)$/.exec(z);if(H){const K=H[2]==="decl"?A:x;K[z]=K[z]||[],K[z].push(D[z])}else w[z]=w[z]||[],w[z].push(D[z])}}return p+="// ----- MAIN SHADER SOURCE -------------------------",p+=Pb,p=uu(p,i,A),p+=xb(y[i],w),p+=b,p=uu(p,i,x),s==="glsl"&&h!==d&&(p=uF(p,i)),p.trim()}function vm(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function TF(t){const{id:e,source:n,stage:r}=t;return e&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME ${e}_${r}

`:""}function wF(t={}){let e="";for(const n in t){const r=t[n];(r||Number.isFinite(r))&&(e+=`#define ${n.toUpperCase()} ${t[n]}
`)}return e}const Kr=class Kr{constructor(){T(this,"_hookFunctions",[]);T(this,"_defaultModules",[])}static getDefaultShaderAssembler(){return Kr.defaultShaderAssembler=Kr.defaultShaderAssembler||new Kr,Kr.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(n=>n.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n)}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e)}assembleShader(e){const n=this._getModuleList(e.modules),r=this._hookFunctions,i=Tv(e);return{...mF({platformInfo:e.platformInfo,...i,modules:n,hookFunctions:r}),modules:n}}assembleShaderPair(e){const n=Tv(e),r=this._getModuleList(e.modules),i=this._hookFunctions,{platformInfo:s}=e;return{...e.platformInfo.shaderLanguage==="wgsl"?yF({platformInfo:s,...n,modules:r,hookFunctions:i}):vF({platformInfo:s,...n,modules:r,hookFunctions:i}),modules:r}}_getModuleList(e=[]){const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;n[i++]=a,r[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;r[l]||(n[i++]=a,r[l]=!0)}return n.length=i,ti.instantiateModules(n)}};T(Kr,"defaultShaderAssembler");let fu=Kr;const SF=`out vec4 transform_output;
void main() {
transform_output = vec4(0);
}`,EF=`#version 300 es
${SF}`;function bF(t){const{input:e,inputChannels:n,output:r}=t||{};if(!e)return EF;if(!n)throw new Error("inputChannels");const i=AF(n),s=RF(e,n);return`#version 300 es
in ${i} ${e};
out vec4 ${r};
void main() {
  ${r} = ${s};
}`}function AF(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${t}`)}}function RF(t,e){switch(e){case 1:return`vec4(${t}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${t}, 0.0, 1.0)`;case 3:return`vec4(${t}, 1.0)`;case 4:return t;default:throw new Error(`invalid channels: ${e}`)}}const U=new Xa({id:"luma.gl"});class xF{constructor(){T(this,"stats",new Map)}getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new jf({id:e})),this.stats.get(e)}}const Tm=new xF;function CF(){const t="9.0.27",e="set luma.log.level=1 (or higher) to trace rendering";if(globalThis.luma&&globalThis.luma.VERSION!==t)throw new Error(`luma.gl - multiple VERSIONs detected: ${globalThis.luma.VERSION} vs ${t}`);return globalThis.luma||(Lr()&&U.log(1,`${t} - ${e}`)(),globalThis.luma=globalThis.luma||{VERSION:t,version:t,log:U,stats:Tm}),t}const PF=CF();function IF(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)?t:null}function va(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number"?t:null:IF(t)}const sd={};function Ai(t="id"){sd[t]=sd[t]||1;const e=sd[t]++;return`${t}-${e}`}function hu(t){let e=!0;for(const n in t){e=!1;break}return e}var Fd;let fe=(Fd=class{constructor(e,n,r){T(this,"id");T(this,"props");T(this,"userData",{});T(this,"_device");T(this,"destroyed",!1);T(this,"allocatedBytes",0);T(this,"_attachedResources",new Set);if(!e)throw new Error("no device");this._device=e,this.props=MF(n,r);const i=this.props.id!=="undefined"?this.props.id:Ai(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}(${this.id})`}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),n=this[Symbol.toStringTag];e.get(`${n}s Active`).decrementCount()}trackAllocatedMemory(e,n=this[Symbol.toStringTag]){const r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").addCount(e),r.get(`${n} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").subtractCount(this.allocatedBytes),n.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),n=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${n}s Created`).incrementCount(),e.get(`${n}s Active`).incrementCount()}},T(Fd,"defaultProps",{id:"undefined",handle:void 0,userData:void 0}),Fd);function MF(t,e){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}const Ye=class Ye extends fe{constructor(n,r){const i={...r};(r.usage||0)&Ye.INDEX&&!r.indexType&&(r.data instanceof Uint32Array?i.indexType="uint32":r.data instanceof Uint16Array&&(i.indexType="uint16"));super(n,i,Ye.defaultProps);T(this,"usage");T(this,"indexType");T(this,"updateTimestamp");T(this,"debugData",new ArrayBuffer(0));this.usage=r.usage||0,this.indexType=i.indexType,this.updateTimestamp=n.incrementTimestamp()}get[Symbol.toStringTag](){return"Buffer"}readSyncWebGL(n,r){throw new Error("not implemented")}_setDebugData(n,r,i){const s=ArrayBuffer.isView(n)?n.buffer:n,o=Math.min(n?n.byteLength:i,Ye.DEBUG_DATA_MAX_LENGTH);n===null?this.debugData=new ArrayBuffer(o):r===0&&i===n.byteLength?this.debugData=s.slice(0,o):this.debugData=s.slice(r,r+o)}};T(Ye,"defaultProps",{...fe.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1}),T(Ye,"MAP_READ",1),T(Ye,"MAP_WRITE",2),T(Ye,"COPY_SRC",4),T(Ye,"COPY_DST",8),T(Ye,"INDEX",16),T(Ye,"VERTEX",32),T(Ye,"UNIFORM",64),T(Ye,"STORAGE",128),T(Ye,"INDIRECT",256),T(Ye,"QUERY_RESOLVE",512),T(Ye,"DEBUG_DATA_MAX_LENGTH",32);let Te=Ye;function Ib(t){const e=bv[t],n=NF(e),r=t.includes("norm"),i=!r&&!t.startsWith("float"),s=t.startsWith("s");return{dataType:bv[t],byteLength:n,integer:i,signed:s,normalized:r}}function NF(t){return kF[t]}const bv={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},kF={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4},OF=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],FF=/^(rg?b?a?)([0-9]*)([a-z]*)(-srgb)?(-webgl|-unsized)?$/;function DF(t){return OF.some(e=>t.startsWith(e))}function Mb(t){const e=FF.exec(t);if(e){const[,n,r,i,s,o]=e;if(n){const a=`${i}${r}`,l=Ib(a);return{format:n,components:n.length,srgb:s==="-srgb",unsized:o==="-unsized",webgl:o==="-webgl",...l}}}return LF(t)}const BF={"rgba4unorm-webgl":{format:"rgba",bpp:2},"rgb565unorm-webgl":{format:"rgb",bpp:2},"rgb5a1unorm-webgl":{format:"rgba",bbp:2},rgb9e5ufloat:{format:"rgb",bbp:4},rg11b10ufloat:{format:"rgb",bbp:4},rgb10a2unorm:{format:"rgba",bbp:4},"rgb10a2uint-webgl":{format:"rgba",bbp:4},stencil8:{components:1,bpp:1,a:"stencil"},depth16unorm:{components:1,bpp:2,a:"depth"},depth24plus:{components:1,bpp:3,a:"depth"},depth32float:{components:1,bpp:4,a:"depth"},"depth24plus-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth24unorm-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth32float-stencil8":{components:2,bpp:4,a:"depth-stencil"}};function LF(t){var n;const e=BF[t];if(!e)throw new Error(`Unknown format ${t}`);return{format:e.format||"",components:e.components||((n=e.format)==null?void 0:n.length)||1,byteLength:e.bpp||1,srgb:!1,unsized:!1}}class UF{}class zF{constructor(e=[],n){T(this,"features");T(this,"disabledFeatures");this.features=new Set(e),this.disabledFeatures=n||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures[e]&&this.features.has(e)}}const Zo=class Zo{constructor(e){T(this,"id");T(this,"props");T(this,"userData",{});T(this,"statsManager",Tm);T(this,"_lumaData",{});T(this,"timestamp",0);this.props={...Zo.defaultProps,...e},this.id=this.props.id||Ai(this[Symbol.toStringTag].toLowerCase())}get[Symbol.toStringTag](){return"Device"}isTextureFormatCompressed(e){return DF(e)}loseDevice(){return!1}getCanvasContext(){if(!this.canvasContext)throw new Error("Device has no CanvasContext");return this.canvasContext}createTexture(e){return(e instanceof Promise||typeof e=="string")&&(e={data:e}),this._createTexture(e)}createCommandEncoder(e={}){throw new Error("not implemented")}readPixelsToArrayWebGL(e,n){throw new Error("not implemented")}readPixelsToBufferWebGL(e,n){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,n){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}_getBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const n={...e};return(e.usage||0)&Te.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?n.indexType="uint32":e.data instanceof Uint16Array?n.indexType="uint16":U.warn("indices buffer content must be of integer type")()),n}};T(Zo,"defaultProps",{id:null,canvas:null,container:null,manageState:!0,width:800,height:600,requestMaxLimits:!0,debug:!!U.get("debug"),spector:!!(U.get("spector")||U.get("spectorjs")),break:[],initalizeFeatures:!0,disabledFeatures:{"compilation-status-async-webgl":!0},gl:null,onError:e=>U.error(e.message)}),T(Zo,"VERSION",PF);let Ds=Zo;function ge(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const _o=new Map,cs=class cs{static registerDevices(e){for(const n of e)ge(n.type&&n.isSupported&&n.create),_o.set(n.type,n)}static getAvailableDevices(){return Array.from(_o).map(e=>e.type)}static getSupportedDevices(){return Array.from(_o).filter(e=>e.isSupported()).map(e=>e.type)}static setDefaultDeviceProps(e){Object.assign(Ds.defaultProps,e)}static async attachDevice(e){const n=Av(e.devices)||_o;if(e.handle instanceof WebGL2RenderingContext){const r=n.get("webgl");if(r)return await r.attach(e.handle)}if(e.handle===null){const r=n.get("unknown");if(r)return await r.attach(null)}throw new Error("Failed to attach device. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static async createDevice(e={}){var s,o;e={...cs.defaultProps,...e},e.gl&&(e.type="webgl");const n=Av(e.devices)||_o;let r,i;switch(e.type){case"webgpu":if(r=n.get("webgpu"),r)return await r.create(e);break;case"webgl":if(i=n.get("webgl"),i)return await i.create(e);break;case"unknown":const a=n.get("unknown");if(a)return await a.create(e);break;case"best-available":if(r=n.get("webgpu"),(s=r==null?void 0:r.isSupported)!=null&&s.call(r))return await r.create(e);if(i=n.get("webgl"),(o=i==null?void 0:i.isSupported)!=null&&o.call(i))return await i.create(e);break}throw new Error("No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static enforceWebGL2(e=!0){const n=HTMLCanvasElement.prototype;if(!e&&n.originalGetContext){n.getContext=n.originalGetContext,n.originalGetContext=void 0;return}n.originalGetContext=n.getContext,n.getContext=function(r,i){return r==="webgl"||r==="experimental-webgl"?this.originalGetContext("webgl2",i):this.originalGetContext(r,i)}}};T(cs,"defaultProps",{...Ds.defaultProps,type:"best-available",devices:void 0}),T(cs,"stats",Tm),T(cs,"log",U);let ms=cs;function Av(t){if(!t||(t==null?void 0:t.length)===0)return null;const e=new Map;for(const n of t)e.set(n.type,n);return e}const $F=Lr()&&typeof document<"u",Xf=()=>$F&&document.readyState==="complete",VF={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,colorSpace:"srgb",alphaMode:"opaque"};class wm{constructor(e){T(this,"id");T(this,"props");T(this,"canvas");T(this,"htmlCanvas");T(this,"offscreenCanvas");T(this,"type");T(this,"width",1);T(this,"height",1);T(this,"resizeObserver");T(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1});if(this.props={...VF,...e},e=this.props,!Lr()){this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,this.canvas=null;return}if(e.canvas)typeof e.canvas=="string"?this.canvas=HF(e.canvas):this.canvas=e.canvas;else{const n=XF(e),r=WF((e==null?void 0:e.container)||null);r.insertBefore(n,r.firstChild),this.canvas=n,e!=null&&e.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver(n=>{for(const r of n)r.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}static get isPageLoaded(){return Xf()}getDevicePixelRatio(e){return typeof OffscreenCanvas<"u"&&this.canvas instanceof OffscreenCanvas||(e=e===void 0?this.props.useDevicePixels:e,!e||e<=0)?1:e===!0?typeof window<"u"&&window.devicePixelRatio||1:e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),n=this.canvas;return n.parentElement?[n.clientWidth*e,n.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,n]=this.getPixelSize();return e/n}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),{clientWidth:n}=this._canvasSizeInfo;return n?e/n:1}catch{return 1}}cssToDevicePixels(e,n=!0){const r=this.cssToDeviceRatio(),[i,s]=this.getDrawingBufferSize();return YF(e,r,i,s,n)}setDevicePixelRatio(e,n={}){if(!this.htmlCanvas)return;let r="width"in n?n.width:this.htmlCanvas.clientWidth,i="height"in n?n.height:this.htmlCanvas.clientHeight;(!r||!i)&&(U.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=this.htmlCanvas.width||1,i=this.htmlCanvas.height||1);const s=this._canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),l=Math.floor(i*o);this.htmlCanvas.width=a,this.htmlCanvas.height=l;const[c,u]=this.getDrawingBufferSize();(c!==a||u!==l)&&(o=Math.min(c/r,u/i),this.htmlCanvas.width=Math.floor(r*o),this.htmlCanvas.height=Math.floor(i*o),U.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=r,this._canvasSizeInfo.clientHeight=i,this._canvasSizeInfo.devicePixelRatio=e}}getDrawingBufferSize(){const e=this.device.gl;if(!e)throw new Error("canvas size");return[e.drawingBufferWidth,e.drawingBufferHeight]}_setAutoCreatedCanvasId(e){var n;((n=this.htmlCanvas)==null?void 0:n.id)==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}}T(wm,"pageLoaded",jF());function jF(){return Xf()||typeof window>"u"?Promise.resolve():new Promise(t=>{window.addEventListener("load",()=>t())})}function WF(t){if(typeof t=="string"){const e=document.getElementById(t);if(!e&&!Xf())throw new Error(`Accessing '${t}' before page was loaded`);if(!e)throw new Error(`${t} is not an HTML element`);return e}else if(t)return t;return document.body}function HF(t){const e=document.getElementById(t);if(!e&&!Xf())throw new Error(`Accessing '${t}' before page was loaded`);if(!(e instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return e}function XF(t){const{width:e,height:n}=t,r=document.createElement("canvas");return r.id="lumagl-auto-created-canvas",r.width=e||1,r.height=n||1,r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(n)?`${n}px`:"100%",r}function YF(t,e,n,r,i){const s=t,o=Rv(s[0],e,n);let a=xv(s[1],e,r,i),l=Rv(s[0]+1,e,n);const c=l===n-1?l:l-1;l=xv(s[1]+1,e,r,i);let u;return i?(l=l===0?l:l+1,u=a,a=l):u=l===r-1?l:l-1,{x:o,y:a,width:Math.max(c-o+1,1),height:Math.max(u-a+1,1)}}function Rv(t,e,n){return Math.min(Math.round(t*e),n-1)}function xv(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const Fn=class Fn extends fe{constructor(n,r,i=Fn.defaultProps){super(n,r,i);T(this,"dimension");T(this,"format");T(this,"width");T(this,"height");T(this,"depth");T(this,"updateTimestamp");this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.updateTimestamp=n.incrementTimestamp()}get[Symbol.toStringTag](){return"Texture"}};T(Fn,"defaultProps",{...fe.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!0,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,type:void 0,sampler:{},view:void 0}),T(Fn,"COPY_SRC",1),T(Fn,"COPY_DST",2),T(Fn,"TEXTURE_BINDING",4),T(Fn,"STORAGE_BINDING",8),T(Fn,"RENDER_ATTACHMENT",16);let Ft=Fn;const Ou=class Ou extends fe{get[Symbol.toStringTag](){return"TextureView"}constructor(e,n){super(e,n,Ou.defaultProps)}};T(Ou,"defaultProps",{...fe.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0});let du=Ou;function KF(t,e,n){let r="";const i=e.split(/\r?\n/),s=t.slice().sort((o,a)=>o.lineNum-a.lineNum);switch((n==null?void 0:n.showSourceCode)||"no"){case"all":let o=0;for(let a=1;a<=i.length;a++)for(r+=Nb(i[a-1],a,n);s.length>o&&s[o].lineNum===a;){const l=s[o++];r+=Cv(l,i,l.lineNum,{...n,inlineSource:!1})}return r;case"issues":case"no":for(const a of t)r+=Cv(a,i,a.lineNum,{inlineSource:(n==null?void 0:n.showSourceCode)!=="no"});return r}}function Cv(t,e,n,r){if(r!=null&&r.inlineSource){const i=qF(e,n),s=t.linePos>0?`${" ".repeat(t.linePos+5)}^^^
`:"";return`
${i}${s}${t.type.toUpperCase()}: ${t.message}

`}return r!=null&&r.html?`<div class='luma-compiler-log-error' style="color:red;"><b> ${t.type.toUpperCase()}: ${t.message}</b></div>`:`${t.type.toUpperCase()}: ${t.message}`}function qF(t,e,n){let r="";for(let i=e-2;i<=e;i++){const s=t[i-1];s!==void 0&&(r+=Nb(s,e,n))}return r}function Nb(t,e,n){const r=n!=null&&n.html?QF(t):t;return`${ZF(String(e),4)}: ${r}${n!=null&&n.html?"<br/>":`
`}`}function ZF(t,e){let n="";for(let r=t.length;r<e;++r)n+=" ";return n+t}function QF(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function kb(t,e){return{name:JF(t,e),language:"glsl",version:GF(t)}}function JF(t,e="unnamed"){const r=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(t);return r?r[1]:e}function GF(t){let e=100;const n=t.match(/[^\s]+/g);if(n&&n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const Fu=class Fu extends fe{constructor(n,r){super(n,{id:eD(r),...r},Fu.defaultProps);T(this,"stage");T(this,"source");T(this,"compilationStatus","pending");this.stage=this.props.stage,this.source=this.props.source}get[Symbol.toStringTag](){return"Shader"}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(n=this.props.debug){switch(n){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const r=await this.getCompilationInfo();this.props.debug==="warnings"&&(r==null?void 0:r.length)===0||this._displayShaderLog(r)}_displayShaderLog(n){var c;if(typeof document>"u"||!(document!=null&&document.createElement))return;const r=kb(this.source).name,i=`${this.stage} ${r}`;let s=KF(n,this.source,{showSourceCode:"all",html:!0});const o=this.getTranslatedSource();o&&(s+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${o}</pre></code>`);const a=document.createElement("Button");a.innerHTML=`
<h1>Shader Compilation Error in ${i}</h1><br /><br />
<code style="user-select:text;"><pre>
${s}
</pre></code>`,a.style.top="10px",a.style.left="10px",a.style.position="absolute",a.style.zIndex="9999",a.style.width="100%",a.style.textAlign="left",document.body.appendChild(a);const l=document.getElementsByClassName("luma-compiler-log-error");(c=l[0])!=null&&c.scrollIntoView&&l[0].scrollIntoView(),a.onclick=()=>{const u=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(u)}}};T(Fu,"defaultProps",{...fe.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debug:"errors"});let pu=Fu;function eD(t){return kb(t.source).name||t.id||Ai(`unnamed ${t.stage}-shader`)}const Du=class Du extends fe{get[Symbol.toStringTag](){return"Sampler"}constructor(e,n){super(e,n,Du.defaultProps)}};T(Du,"defaultProps",{...fe.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"nearest",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1});let gu=Du;const Bu=class Bu extends fe{constructor(n,r={}){super(n,r,Bu.defaultProps);T(this,"width");T(this,"height");T(this,"colorAttachments",[]);T(this,"depthStencilAttachment",null);this.width=this.props.width,this.height=this.props.height}get[Symbol.toStringTag](){return"Framebuffer"}resize(n){let r=!n;if(n){const[i,s]=Array.isArray(n)?n:[n.width,n.height];r=r||s!==this.height||i!==this.width,this.width=i,this.height=s}r&&(U.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map(r=>{if(typeof r=="string"){const i=this.createColorTexture(r);return this.attachResource(i),i.view}return r instanceof Ft?r.view:r});const n=this.props.depthStencilAttachment;if(n)if(typeof n=="string"){const r=this.createDepthStencilTexture(n);this.attachResource(r),this.depthStencilAttachment=r.view}else n instanceof Ft?this.depthStencilAttachment=n.view:this.depthStencilAttachment=n}createColorTexture(n){return this.device.createTexture({id:"color-attachment",usage:Ft.RENDER_ATTACHMENT,format:n,width:this.width,height:this.height})}createDepthStencilTexture(n){return this.device.createTexture({id:"depth-stencil-attachment",usage:Ft.RENDER_ATTACHMENT,format:n,width:this.width,height:this.height})}resizeAttachments(n,r){for(let i=0;i<this.colorAttachments.length;++i)if(this.colorAttachments[i]){const s=this.device._createTexture({...this.colorAttachments[i].props,width:n,height:r});this.destroyAttachedResource(this.colorAttachments[i]),this.colorAttachments[i]=s.view,this.attachResource(s.view)}if(this.depthStencilAttachment){const i=this.device._createTexture({...this.depthStencilAttachment.props,width:n,height:r});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=i.view,this.attachResource(i)}}};T(Bu,"defaultProps",{...fe.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null});let _u=Bu;const Lu=class Lu extends fe{constructor(n,r){super(n,r,Lu.defaultProps);T(this,"shaderLayout");T(this,"bufferLayout");T(this,"linkStatus","pending");T(this,"hash","");this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}get[Symbol.toStringTag](){return"RenderPipeline"}setUniformsWebGL(n){throw new Error("Use uniform blocks")}};T(Lu,"defaultProps",{...fe.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}});let Bs=Lu;const Uu=class Uu extends fe{get[Symbol.toStringTag](){return"RenderPass"}constructor(e,n){super(e,n,Uu.defaultProps)}};T(Uu,"defaultProps",{...fe.defaultProps,framebuffer:null,parameters:void 0,clearColor:[0,0,0,0],clearDepth:1,clearStencil:0,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0});let Zp=Uu;const zu=class zu extends fe{constructor(n,r){super(n,r,zu.defaultProps);T(this,"hash","")}get[Symbol.toStringTag](){return"ComputePipeline"}};T(zu,"defaultProps",{...fe.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0});let mu=zu;const $u=class $u extends fe{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,n){super(e,n,$u.defaultProps)}};T($u,"defaultProps",{...fe.defaultProps,measureExecutionTime:void 0});let Qp=$u;const Vu=class Vu extends fe{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,n){super(e,n,Vu.defaultProps)}};T(Vu,"defaultProps",{...fe.defaultProps});let Jp=Vu;function tD(t){const[e,n]=rD[t],r=e==="i32"||e==="u32",i=e!=="u32",s=iD[e]*n,o=nD(e,n);return{dataType:e,components:n,defaultVertexFormat:o,byteLength:s,integer:r,signed:i}}function nD(t,e){let n;switch(t){case"f32":n="float32";break;case"i32":n="sint32";break;case"u32":n="uint32";break;case"f16":return e<=2?"float16x2":"float16x4"}return e===1?n:`${n}x${e}`}const rD={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},iD={f32:4,f16:2,i32:4,u32:4};function Ob(t){let e;t.endsWith("-webgl")&&(t.replace("-webgl",""),e=!0);const[n,r]=t.split("x"),i=n,s=r?parseInt(r):1,o=Ib(i),a={type:i,components:s,byteLength:o.byteLength*s,integer:o.integer,signed:o.signed,normalized:o.normalized};return e&&(a.webglOnly=!0),a}function Fb(t,e){const n={};for(const r of t.attributes)n[r.name]=oD(t,e,r.name);return n}function sD(t,e,n=16){const r=Fb(t,e),i=new Array(n).fill(null);for(const s of Object.values(r))i[s.location]=s;return i}function oD(t,e,n){const r=aD(t,n),i=lD(e,n);if(!r)return null;const s=tD(r.type),o=(i==null?void 0:i.vertexFormat)||s.defaultVertexFormat,a=Ob(o);return{attributeName:(i==null?void 0:i.attributeName)||r.name,bufferName:(i==null?void 0:i.bufferName)||r.name,location:r.location,shaderType:r.type,shaderDataType:s.dataType,shaderComponents:s.components,vertexFormat:o,bufferDataType:a.type,bufferComponents:a.components,normalized:a.normalized,integer:s.integer,stepMode:(i==null?void 0:i.stepMode)||r.stepMode,byteOffset:(i==null?void 0:i.byteOffset)||0,byteStride:(i==null?void 0:i.byteStride)||0}}function aD(t,e){const n=t.attributes.find(r=>r.name===e);return n||U.warn(`shader layout attribute "${e}" not present in shader`),n||null}function lD(t,e){cD(t);let n=uD(t,e);return n||(n=fD(t,e),n)?n:(U.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function cD(t){for(const e of t)(e.attributes&&e.format||!e.attributes&&!e.format)&&U.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function uD(t,e){for(const n of t)if(n.format&&n.name===e)return{attributeName:n.name,bufferName:e,stepMode:n.stepMode,vertexFormat:n.format,byteOffset:0,byteStride:n.byteStride||0};return null}function fD(t,e){var n;for(const r of t){let i=r.byteStride;if(typeof r.byteStride!="number")for(const o of r.attributes||[]){const a=Ob(o.format);i+=a.byteLength}const s=(n=r.attributes)==null?void 0:n.find(o=>o.attribute===e);if(s)return{attributeName:s.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:s.format,byteOffset:s.byteOffset,byteStride:i}}return null}function hD(t,e){const n={...t,attributes:t.attributes.map(r=>({...r}))};for(const r of(e==null?void 0:e.attributes)||[]){const i=n.attributes.find(s=>s.name===r.name);i?(i.type=r.type||i.type,i.stepMode=r.stepMode||i.stepMode):U.warn(`shader layout attribute ${r.name} not present in shader`)}return n}const ju=class ju extends fe{constructor(n,r){super(n,r,ju.defaultProps);T(this,"maxVertexAttributes");T(this,"attributeInfos");T(this,"indexBuffer",null);T(this,"attributes");this.maxVertexAttributes=n.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=sD(r.renderPipeline.shaderLayout,r.renderPipeline.bufferLayout,this.maxVertexAttributes)}get[Symbol.toStringTag](){return"VertexArray"}setConstantWebGL(n,r){throw new Error("constant attributes not supported")}};T(ju,"defaultProps",{...fe.defaultProps,renderPipeline:null});let Gp=ju;const Wu=class Wu extends fe{get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,n){super(e,n,Wu.defaultProps)}};T(Wu,"defaultProps",{...fe.defaultProps,layout:void 0,buffers:{}});let eg=Wu;const Hu=class Hu extends fe{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,n){super(e,n,Hu.defaultProps)}};T(Hu,"defaultProps",{...fe.defaultProps,type:void 0,count:void 0});let tg=Hu;const dD={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function pD(t){const e=dD[t];return ge(t),e}function gD(t,e){switch(e){case 1:return t;case 2:return t+t%2;default:return t+(4-t%4)%4}}let Fl;function Db(t){return(!Fl||Fl.byteLength<t)&&(Fl=new ArrayBuffer(t)),Fl}function _D(t,e){const n=Db(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function mD(t){const{target:e,source:n,start:r=0,count:i=1}=t,s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)e[l++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return t.target}const Pv=1024;class yD{constructor(e){T(this,"layout",{});T(this,"byteLength");let n=0;for(const[i,s]of Object.entries(e)){const o=pD(s),{type:a,components:l}=o;n=gD(n,l);const c=n;n+=l,this.layout[i]={type:a,size:l,offset:c}}n+=(4-n%4)%4;const r=n*4;this.byteLength=Math.max(r,Pv)}getData(e){const n=Math.max(this.byteLength,Pv),r=Db(n),i={i32:new Int32Array(r),u32:new Uint32Array(r),f32:new Float32Array(r),f16:new Uint16Array(r)};for(const[s,o]of Object.entries(e)){const a=this.layout[s];if(!a){U.warn(`Supplied uniform value ${s} not present in uniform block layout`)();continue}const{type:l,size:c,offset:u}=a,f=i[l];if(c===1){if(typeof o!="number"&&typeof o!="boolean"){U.warn(`Supplied value for single component uniform ${s} is not a number: ${o}`)();continue}f[u]=Number(o)}else{const h=va(o);if(!h){U.warn(`Supplied value for multi component / array uniform ${s} is not a numeric array: ${o}`)();continue}f.set(h,u)}}return new Uint8Array(r)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}function vD(t,e,n=16){if(t!==e)return!1;const r=va(t);if(!r)return!1;const i=va(e);if(i&&r.length===i.length){for(let s=0;s<r.length;++s)if(i[s]!==r[s])return!1}return!0}function TD(t){const e=va(t);return e?e.slice():t}class wD{constructor(e){T(this,"name");T(this,"uniforms",{});T(this,"modifiedUniforms",{});T(this,"modified",!0);T(this,"bindingLayout",{});T(this,"needsRedraw","initialized");var n;if(this.name=e==null?void 0:e.name,e!=null&&e.name&&(e!=null&&e.shaderLayout)){const r=(n=e==null?void 0:e.shaderLayout.bindings)==null?void 0:n.find(s=>s.type==="uniform"&&s.name===(e==null?void 0:e.name));if(!r)throw new Error(e==null?void 0:e.name);const i=r;for(const s of i.uniforms||[])this.bindingLayout[s.name]=s}}setUniforms(e){for(const[n,r]of Object.entries(e))this._setUniform(n,r),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${n}=${r}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,n){vD(this.uniforms[e],n)||(this.uniforms[e]=TD(n),this.modifiedUniforms[e]=!0,this.modified=!0)}}class SD{constructor(e){T(this,"uniformBlocks",new Map);T(this,"uniformBufferLayouts",new Map);T(this,"uniformBuffers",new Map);for(const[n,r]of Object.entries(e)){const i=n,s=new yD(r.uniformTypes||{});this.uniformBufferLayouts.set(i,s);const o=new wD({name:n});o.setUniforms(r.defaultUniforms||{}),this.uniformBlocks.set(i,o)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[n,r]of Object.entries(e))this.uniformBlocks.get(n).setUniforms(r);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e).byteLength}getUniformBufferData(e){const n=this.uniformBlocks.get(e).getAllUniforms();return this.uniformBufferLayouts.get(e).getData(n)}createUniformBuffer(e,n,r){r&&this.setUniforms(r);const i=this.getUniformBufferByteLength(n),s=e.createBuffer({usage:Te.UNIFORM|Te.COPY_DST,byteLength:i}),o=this.getUniformBufferData(n);return s.write(o),s}getManagedUniformBuffer(e,n){if(!this.uniformBuffers.get(n)){const r=this.getUniformBufferByteLength(n),i=e.createBuffer({usage:Te.UNIFORM|Te.COPY_DST,byteLength:r});this.uniformBuffers.set(n,i)}return this.uniformBuffers.get(n)}updateUniformBuffers(){let e=!1;for(const n of this.uniformBlocks.keys()){const r=this.updateUniformBuffer(n);e||(e=r)}return e&&U.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const n=this.uniformBlocks.get(e),r=this.uniformBuffers.get(e);let i=!1;if(r&&n.needsRedraw){i||(i=n.needsRedraw);const s=this.getUniformBufferData(e);this.uniformBuffers.get(e).write(s);const a=this.uniformBlocks.get(e).getAllUniforms();U.log(4,`Writing to uniform buffer ${String(e)}`,s,a)()}return i}}function Bb(t){const e=ArrayBuffer.isView(t)?t.constructor:t;switch(e){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(e.constructor.name)}}function Lb(t){switch(t){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(t)}}function ED(t,e,n){if(!e||e>4)throw new Error(`size ${e}`);const r=e;let i=Bb(t);if(i==="uint8"&&n&&r===1)return"unorm8-webgl";if(i==="uint8"&&n&&r===3)return"unorm8x3-webgl";if(i==="uint8"||i==="sint8"){if(r===1||r===3)throw new Error(`size: ${e}`);return n&&(i=i.replace("int","norm")),`${i}x${r}`}if(i==="uint16"||i==="sint16"){if(r===1||r===3)throw new Error(`size: ${e}`);return n&&(i=i.replace("int","norm")),`${i}x${r}`}return r===1?i:`${i}x${r}`}function bD(t){return va(t)!==null||typeof t=="number"||typeof t=="boolean"}function Sm(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach(n=>{const r=t[n];bD(r)?e.uniforms[n]=r:e.bindings[n]=r}),e}function AD(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)if(a in e){const c=r[a]?`${t}.${r[a]}`:"N/A";U.removed(`${t}.${a}`,c)()}for(const a in i)if(a in e){const l=i[a];U.deprecated(`${t}.${a}`,`${t}.${l}`)()}let o=null;for(const[a,l]of Object.entries(s))a in e&&(U.deprecated(`${t}.${a}`,`${t}.${l}`)(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]);return o||e}let RD="";async function xD(t,e){return await new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error(`Could not load image ${t}.`)),i.crossOrigin=(e==null?void 0:e.crossOrigin)||"anonymous",i.src=t.startsWith("http")?t:RD+t}catch(i){r(i)}})}async function Ub(t,e){const n=document.getElementsByTagName("head")[0];if(!n)throw new Error("loadScript");const r=document.createElement("script");return r.setAttribute("type","text/javascript"),r.setAttribute("src",t),e&&(r.id=e),new Promise((i,s)=>{r.onload=i,r.onerror=o=>s(new Error(`Unable to load script '${t}': ${o}`)),n.appendChild(r)})}function ng(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!ng(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!ng(t[s],e[s],n-1))return!1;return!0}return!1}function CD(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function PD(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}class ID{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}let Qn=class{constructor(){}get isAstNode(){return!0}get astNodeType(){return""}evaluate(e){throw new Error("Cannot evaluate node")}evaluateString(e){return this.evaluate(e).toString()}search(e){}searchBlock(e,n){if(e){n(yu.instance);for(const r of e)r instanceof Array?this.searchBlock(r,n):r.search(n);n(vu.instance)}}};class yu extends Qn{}yu.instance=new yu;class vu extends Qn{}vu.instance=new vu;class we extends Qn{constructor(){super()}}class rg extends we{constructor(e,n,r,i,s,o){super(),this.calls=new Set,this.name=e,this.args=n,this.returnType=r,this.body=i,this.startLine=s,this.endLine=o}get astNodeType(){return"function"}search(e){this.searchBlock(this.body,e)}}class MD extends we{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class ND extends we{constructor(e,n){super(),this.condition=e,this.body=n}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class kD extends we{constructor(e){super(),this.body=e}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class OD extends we{constructor(e,n,r,i){super(),this.init=e,this.condition=n,this.increment=r,this.body=i}get astNodeType(){return"for"}search(e){var n,r,i;(n=this.init)===null||n===void 0||n.search(e),(r=this.condition)===null||r===void 0||r.search(e),(i=this.increment)===null||i===void 0||i.search(e),this.searchBlock(this.body,e)}}class Yr extends we{constructor(e,n,r,i,s){super(),this.name=e,this.type=n,this.storage=r,this.access=i,this.value=s}get astNodeType(){return"var"}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}}class zb extends we{constructor(e,n,r){super(),this.name=e,this.type=n,this.value=r}get astNodeType(){return"override"}search(e){var n;(n=this.value)===null||n===void 0||n.search(e)}}class ig extends we{constructor(e,n,r,i,s){super(),this.name=e,this.type=n,this.storage=r,this.access=i,this.value=s}get astNodeType(){return"let"}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}}class Iv extends we{constructor(e,n,r,i,s){super(),this.name=e,this.type=n,this.storage=r,this.access=i,this.value=s}get astNodeType(){return"const"}evaluate(e){return this.value.evaluate(e)}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}}var Ls;(function(t){t.increment="++",t.decrement="--"})(Ls||(Ls={}));(function(t){function e(n){const r=n;if(r=="parse")throw new Error("Invalid value for IncrementOperator");return t[r]}t.parse=e})(Ls||(Ls={}));class FD extends we{constructor(e,n){super(),this.operator=e,this.variable=n}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}var Ta;(function(t){t.assign="=",t.addAssign="+=",t.subtractAssin="-=",t.multiplyAssign="*=",t.divideAssign="/=",t.moduloAssign="%=",t.andAssign="&=",t.orAssign="|=",t.xorAssign="^=",t.shiftLeftAssign="<<=",t.shiftRightAssign=">>="})(Ta||(Ta={}));(function(t){function e(n){const r=n;if(r=="parse")throw new Error("Invalid value for AssignOperator");return r}t.parse=e})(Ta||(Ta={}));class DD extends we{constructor(e,n,r){super(),this.operator=e,this.variable=n,this.value=r}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class $b extends we{constructor(e,n){super(),this.name=e,this.args=n}get astNodeType(){return"call"}search(e){for(const n of this.args)n.search(e);e(this)}}class BD extends we{constructor(e,n){super(),this.body=e,this.continuing=n}get astNodeType(){return"loop"}}class LD extends we{constructor(e,n){super(),this.condition=e,this.body=n}get astNodeType(){return"body"}}class UD extends we{constructor(e,n,r,i){super(),this.condition=e,this.body=n,this.elseif=r,this.else=i}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class zD extends we{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var n;(n=this.value)===null||n===void 0||n.search(e)}}class $D extends we{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class VD extends we{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class jD extends we{constructor(e,n){super(),this.severity=e,this.rule=n}get astNodeType(){return"diagnostic"}}class Vb extends we{constructor(e,n){super(),this.name=e,this.type=n}get astNodeType(){return"alias"}}class WD extends we{constructor(){super()}get astNodeType(){return"discard"}}class HD extends we{constructor(){super()}get astNodeType(){return"break"}}class XD extends we{constructor(){super()}get astNodeType(){return"continue"}}class Ri extends we{constructor(e){super(),this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}}class Xr extends Ri{constructor(e,n,r,i){super(e),this.members=n,this.startLine=r,this.endLine=i}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let n=0;n<this.members.length;n++)if(this.members[n].name==e)return n;return-1}}class jb extends Ri{constructor(e,n,r){super(e),this.format=n,this.access=r}get astNodeType(){return"template"}}class YD extends Ri{constructor(e,n,r,i){super(e),this.storage=n,this.type=r,this.access=i}get astNodeType(){return"pointer"}}class Wb extends Ri{constructor(e,n,r,i){super(e),this.attributes=n,this.format=r,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}}class Po extends Ri{constructor(e,n,r){super(e),this.format=n,this.access=r}get astNodeType(){return"sampler"}}class sn extends Qn{constructor(){super()}}class Mv extends sn{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}evaluateString(){return this.value}}class ns extends sn{constructor(e,n){super(),this.type=e,this.args=n}get astNodeType(){return"createExpr"}search(e){e(this);for(const n of this.args)n.search(e)}}class Hb extends sn{constructor(e,n){super(),this.name=e,this.args=n}get astNodeType(){return"callExpr"}evaluate(e){switch(this.name){case"abs":return Math.abs(this.args[0].evaluate(e));case"acos":return Math.acos(this.args[0].evaluate(e));case"acosh":return Math.acosh(this.args[0].evaluate(e));case"asin":return Math.asin(this.args[0].evaluate(e));case"asinh":return Math.asinh(this.args[0].evaluate(e));case"atan":return Math.atan(this.args[0].evaluate(e));case"atan2":return Math.atan2(this.args[0].evaluate(e),this.args[1].evaluate(e));case"atanh":return Math.atanh(this.args[0].evaluate(e));case"ceil":return Math.ceil(this.args[0].evaluate(e));case"clamp":return Math.min(Math.max(this.args[0].evaluate(e),this.args[1].evaluate(e)),this.args[2].evaluate(e));case"cos":return Math.cos(this.args[0].evaluate(e));case"degrees":return this.args[0].evaluate(e)*180/Math.PI;case"distance":return Math.sqrt(Math.pow(this.args[0].evaluate(e)-this.args[1].evaluate(e),2));case"dot":case"exp":return Math.exp(this.args[0].evaluate(e));case"exp2":return Math.pow(2,this.args[0].evaluate(e));case"floor":return Math.floor(this.args[0].evaluate(e));case"fma":return this.args[0].evaluate(e)*this.args[1].evaluate(e)+this.args[2].evaluate(e);case"fract":return this.args[0].evaluate(e)-Math.floor(this.args[0].evaluate(e));case"inverseSqrt":return 1/Math.sqrt(this.args[0].evaluate(e));case"log":return Math.log(this.args[0].evaluate(e));case"log2":return Math.log2(this.args[0].evaluate(e));case"max":return Math.max(this.args[0].evaluate(e),this.args[1].evaluate(e));case"min":return Math.min(this.args[0].evaluate(e),this.args[1].evaluate(e));case"mix":return this.args[0].evaluate(e)*(1-this.args[2].evaluate(e))+this.args[1].evaluate(e)*this.args[2].evaluate(e);case"modf":return this.args[0].evaluate(e)-Math.floor(this.args[0].evaluate(e));case"pow":return Math.pow(this.args[0].evaluate(e),this.args[1].evaluate(e));case"radians":return this.args[0].evaluate(e)*Math.PI/180;case"round":return Math.round(this.args[0].evaluate(e));case"sign":return Math.sign(this.args[0].evaluate(e));case"sin":return Math.sin(this.args[0].evaluate(e));case"sinh":return Math.sinh(this.args[0].evaluate(e));case"saturate":return Math.min(Math.max(this.args[0].evaluate(e),0),1);case"smoothstep":return this.args[0].evaluate(e)*this.args[0].evaluate(e)*(3-2*this.args[0].evaluate(e));case"sqrt":return Math.sqrt(this.args[0].evaluate(e));case"step":return this.args[0].evaluate(e)<this.args[1].evaluate(e)?0:1;case"tan":return Math.tan(this.args[0].evaluate(e));case"tanh":return Math.tanh(this.args[0].evaluate(e));case"trunc":return Math.trunc(this.args[0].evaluate(e));default:throw new Error("Non const function: "+this.name)}}search(e){for(const n of this.args)n.search(e);e(this)}}class sg extends sn{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}evaluate(e){const n=e.constants.get(this.name);if(!n)throw new Error("Cannot evaluate node");return n.evaluate(e)}}class Nv extends sn{constructor(e,n){super(),this.name=e,this.initializer=n}get astNodeType(){return"constExpr"}evaluate(e){var n,r;if(this.initializer instanceof ns){const i=(n=this.postfix)===null||n===void 0?void 0:n.evaluateString(e),s=(r=this.initializer.type)===null||r===void 0?void 0:r.name,o=e.structs.get(s),a=o==null?void 0:o.getMemberIndex(i);if(a!=-1)return this.initializer.args[a].evaluate(e);console.log(a)}return this.initializer.evaluate(e)}search(e){this.initializer.search(e)}}class kv extends sn{constructor(e){super(),this.value=e}get astNodeType(){return"literalExpr"}evaluate(){return this.value}}class KD extends sn{constructor(e,n){super(),this.type=e,this.value=n}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class qD extends sn{constructor(e,n){super(),this.type=e,this.args=n}get astNodeType(){return"typecastExpr"}evaluate(e){return this.args[0].evaluate(e)}search(e){this.searchBlock(this.args,e)}}class Ov extends sn{constructor(e){super(),this.contents=e}get astNodeType(){return"groupExpr"}evaluate(e){return this.contents[0].evaluate(e)}search(e){this.searchBlock(this.contents,e)}}class ZD extends sn{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class Xb extends sn{constructor(){super()}}class QD extends Xb{constructor(e,n){super(),this.operator=e,this.right=n}get astNodeType(){return"unaryOp"}evaluate(e){switch(this.operator){case"+":return this.right.evaluate(e);case"-":return-this.right.evaluate(e);case"!":return this.right.evaluate(e)?0:1;case"~":return~this.right.evaluate(e);default:throw new Error("Unknown unary operator: "+this.operator)}}search(e){this.right.search(e)}}class cn extends Xb{constructor(e,n,r){super(),this.operator=e,this.left=n,this.right=r}get astNodeType(){return"binaryOp"}evaluate(e){switch(this.operator){case"+":return this.left.evaluate(e)+this.right.evaluate(e);case"-":return this.left.evaluate(e)-this.right.evaluate(e);case"*":return this.left.evaluate(e)*this.right.evaluate(e);case"/":return this.left.evaluate(e)/this.right.evaluate(e);case"%":return this.left.evaluate(e)%this.right.evaluate(e);case"==":return this.left.evaluate(e)==this.right.evaluate(e)?1:0;case"!=":return this.left.evaluate(e)!=this.right.evaluate(e)?1:0;case"<":return this.left.evaluate(e)<this.right.evaluate(e)?1:0;case">":return this.left.evaluate(e)>this.right.evaluate(e)?1:0;case"<=":return this.left.evaluate(e)<=this.right.evaluate(e)?1:0;case">=":return this.left.evaluate(e)>=this.right.evaluate(e)?1:0;case"&&":return this.left.evaluate(e)&&this.right.evaluate(e)?1:0;case"||":return this.left.evaluate(e)||this.right.evaluate(e)?1:0;default:throw new Error(`Unknown operator ${this.operator}`)}}search(e){this.left.search(e),this.right.search(e)}}class Yb extends Qn{constructor(){super()}}class JD extends Yb{constructor(e,n){super(),this.selector=e,this.body=n}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class GD extends Yb{constructor(e){super(),this.body=e}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class e4 extends Qn{constructor(e,n,r){super(),this.name=e,this.type=n,this.attributes=r}get astNodeType(){return"argument"}}class t4 extends Qn{constructor(e,n){super(),this.condition=e,this.body=n}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class n4 extends Qn{constructor(e,n,r){super(),this.name=e,this.type=n,this.attributes=r}get astNodeType(){return"member"}}let r4=class extends Qn{constructor(e,n){super(),this.name=e,this.value=n}get astNodeType(){return"attribute"}};var N,C;(function(t){t[t.token=0]="token",t[t.keyword=1]="keyword",t[t.reserved=2]="reserved"})(C||(C={}));class P{constructor(e,n,r){this.name=e,this.type=n,this.rule=r}toString(){return this.name}}class E{}N=E;E.none=new P("",C.reserved,"");E.eof=new P("EOF",C.token,"");E.reserved={asm:new P("asm",C.reserved,"asm"),bf16:new P("bf16",C.reserved,"bf16"),do:new P("do",C.reserved,"do"),enum:new P("enum",C.reserved,"enum"),f16:new P("f16",C.reserved,"f16"),f64:new P("f64",C.reserved,"f64"),handle:new P("handle",C.reserved,"handle"),i8:new P("i8",C.reserved,"i8"),i16:new P("i16",C.reserved,"i16"),i64:new P("i64",C.reserved,"i64"),mat:new P("mat",C.reserved,"mat"),premerge:new P("premerge",C.reserved,"premerge"),regardless:new P("regardless",C.reserved,"regardless"),typedef:new P("typedef",C.reserved,"typedef"),u8:new P("u8",C.reserved,"u8"),u16:new P("u16",C.reserved,"u16"),u64:new P("u64",C.reserved,"u64"),unless:new P("unless",C.reserved,"unless"),using:new P("using",C.reserved,"using"),vec:new P("vec",C.reserved,"vec"),void:new P("void",C.reserved,"void")};E.keywords={array:new P("array",C.keyword,"array"),atomic:new P("atomic",C.keyword,"atomic"),bool:new P("bool",C.keyword,"bool"),f32:new P("f32",C.keyword,"f32"),i32:new P("i32",C.keyword,"i32"),mat2x2:new P("mat2x2",C.keyword,"mat2x2"),mat2x3:new P("mat2x3",C.keyword,"mat2x3"),mat2x4:new P("mat2x4",C.keyword,"mat2x4"),mat3x2:new P("mat3x2",C.keyword,"mat3x2"),mat3x3:new P("mat3x3",C.keyword,"mat3x3"),mat3x4:new P("mat3x4",C.keyword,"mat3x4"),mat4x2:new P("mat4x2",C.keyword,"mat4x2"),mat4x3:new P("mat4x3",C.keyword,"mat4x3"),mat4x4:new P("mat4x4",C.keyword,"mat4x4"),ptr:new P("ptr",C.keyword,"ptr"),sampler:new P("sampler",C.keyword,"sampler"),sampler_comparison:new P("sampler_comparison",C.keyword,"sampler_comparison"),struct:new P("struct",C.keyword,"struct"),texture_1d:new P("texture_1d",C.keyword,"texture_1d"),texture_2d:new P("texture_2d",C.keyword,"texture_2d"),texture_2d_array:new P("texture_2d_array",C.keyword,"texture_2d_array"),texture_3d:new P("texture_3d",C.keyword,"texture_3d"),texture_cube:new P("texture_cube",C.keyword,"texture_cube"),texture_cube_array:new P("texture_cube_array",C.keyword,"texture_cube_array"),texture_multisampled_2d:new P("texture_multisampled_2d",C.keyword,"texture_multisampled_2d"),texture_storage_1d:new P("texture_storage_1d",C.keyword,"texture_storage_1d"),texture_storage_2d:new P("texture_storage_2d",C.keyword,"texture_storage_2d"),texture_storage_2d_array:new P("texture_storage_2d_array",C.keyword,"texture_storage_2d_array"),texture_storage_3d:new P("texture_storage_3d",C.keyword,"texture_storage_3d"),texture_depth_2d:new P("texture_depth_2d",C.keyword,"texture_depth_2d"),texture_depth_2d_array:new P("texture_depth_2d_array",C.keyword,"texture_depth_2d_array"),texture_depth_cube:new P("texture_depth_cube",C.keyword,"texture_depth_cube"),texture_depth_cube_array:new P("texture_depth_cube_array",C.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new P("texture_depth_multisampled_2d",C.keyword,"texture_depth_multisampled_2d"),texture_external:new P("texture_external",C.keyword,"texture_external"),u32:new P("u32",C.keyword,"u32"),vec2:new P("vec2",C.keyword,"vec2"),vec3:new P("vec3",C.keyword,"vec3"),vec4:new P("vec4",C.keyword,"vec4"),bitcast:new P("bitcast",C.keyword,"bitcast"),block:new P("block",C.keyword,"block"),break:new P("break",C.keyword,"break"),case:new P("case",C.keyword,"case"),continue:new P("continue",C.keyword,"continue"),continuing:new P("continuing",C.keyword,"continuing"),default:new P("default",C.keyword,"default"),diagnostic:new P("diagnostic",C.keyword,"diagnostic"),discard:new P("discard",C.keyword,"discard"),else:new P("else",C.keyword,"else"),enable:new P("enable",C.keyword,"enable"),fallthrough:new P("fallthrough",C.keyword,"fallthrough"),false:new P("false",C.keyword,"false"),fn:new P("fn",C.keyword,"fn"),for:new P("for",C.keyword,"for"),function:new P("function",C.keyword,"function"),if:new P("if",C.keyword,"if"),let:new P("let",C.keyword,"let"),const:new P("const",C.keyword,"const"),loop:new P("loop",C.keyword,"loop"),while:new P("while",C.keyword,"while"),private:new P("private",C.keyword,"private"),read:new P("read",C.keyword,"read"),read_write:new P("read_write",C.keyword,"read_write"),return:new P("return",C.keyword,"return"),requires:new P("requires",C.keyword,"requires"),storage:new P("storage",C.keyword,"storage"),switch:new P("switch",C.keyword,"switch"),true:new P("true",C.keyword,"true"),alias:new P("alias",C.keyword,"alias"),type:new P("type",C.keyword,"type"),uniform:new P("uniform",C.keyword,"uniform"),var:new P("var",C.keyword,"var"),override:new P("override",C.keyword,"override"),workgroup:new P("workgroup",C.keyword,"workgroup"),write:new P("write",C.keyword,"write"),r8unorm:new P("r8unorm",C.keyword,"r8unorm"),r8snorm:new P("r8snorm",C.keyword,"r8snorm"),r8uint:new P("r8uint",C.keyword,"r8uint"),r8sint:new P("r8sint",C.keyword,"r8sint"),r16uint:new P("r16uint",C.keyword,"r16uint"),r16sint:new P("r16sint",C.keyword,"r16sint"),r16float:new P("r16float",C.keyword,"r16float"),rg8unorm:new P("rg8unorm",C.keyword,"rg8unorm"),rg8snorm:new P("rg8snorm",C.keyword,"rg8snorm"),rg8uint:new P("rg8uint",C.keyword,"rg8uint"),rg8sint:new P("rg8sint",C.keyword,"rg8sint"),r32uint:new P("r32uint",C.keyword,"r32uint"),r32sint:new P("r32sint",C.keyword,"r32sint"),r32float:new P("r32float",C.keyword,"r32float"),rg16uint:new P("rg16uint",C.keyword,"rg16uint"),rg16sint:new P("rg16sint",C.keyword,"rg16sint"),rg16float:new P("rg16float",C.keyword,"rg16float"),rgba8unorm:new P("rgba8unorm",C.keyword,"rgba8unorm"),rgba8unorm_srgb:new P("rgba8unorm_srgb",C.keyword,"rgba8unorm_srgb"),rgba8snorm:new P("rgba8snorm",C.keyword,"rgba8snorm"),rgba8uint:new P("rgba8uint",C.keyword,"rgba8uint"),rgba8sint:new P("rgba8sint",C.keyword,"rgba8sint"),bgra8unorm:new P("bgra8unorm",C.keyword,"bgra8unorm"),bgra8unorm_srgb:new P("bgra8unorm_srgb",C.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new P("rgb10a2unorm",C.keyword,"rgb10a2unorm"),rg11b10float:new P("rg11b10float",C.keyword,"rg11b10float"),rg32uint:new P("rg32uint",C.keyword,"rg32uint"),rg32sint:new P("rg32sint",C.keyword,"rg32sint"),rg32float:new P("rg32float",C.keyword,"rg32float"),rgba16uint:new P("rgba16uint",C.keyword,"rgba16uint"),rgba16sint:new P("rgba16sint",C.keyword,"rgba16sint"),rgba16float:new P("rgba16float",C.keyword,"rgba16float"),rgba32uint:new P("rgba32uint",C.keyword,"rgba32uint"),rgba32sint:new P("rgba32sint",C.keyword,"rgba32sint"),rgba32float:new P("rgba32float",C.keyword,"rgba32float"),static_assert:new P("static_assert",C.keyword,"static_assert")};E.tokens={decimal_float_literal:new P("decimal_float_literal",C.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?f?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+f?)|([0-9]+f)/),hex_float_literal:new P("hex_float_literal",C.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+f?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+f?))/),int_literal:new P("int_literal",C.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new P("uint_literal",C.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),ident:new P("ident",C.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new P("and",C.token,"&"),and_and:new P("and_and",C.token,"&&"),arrow:new P("arrow ",C.token,"->"),attr:new P("attr",C.token,"@"),forward_slash:new P("forward_slash",C.token,"/"),bang:new P("bang",C.token,"!"),bracket_left:new P("bracket_left",C.token,"["),bracket_right:new P("bracket_right",C.token,"]"),brace_left:new P("brace_left",C.token,"{"),brace_right:new P("brace_right",C.token,"}"),colon:new P("colon",C.token,":"),comma:new P("comma",C.token,","),equal:new P("equal",C.token,"="),equal_equal:new P("equal_equal",C.token,"=="),not_equal:new P("not_equal",C.token,"!="),greater_than:new P("greater_than",C.token,">"),greater_than_equal:new P("greater_than_equal",C.token,">="),shift_right:new P("shift_right",C.token,">>"),less_than:new P("less_than",C.token,"<"),less_than_equal:new P("less_than_equal",C.token,"<="),shift_left:new P("shift_left",C.token,"<<"),modulo:new P("modulo",C.token,"%"),minus:new P("minus",C.token,"-"),minus_minus:new P("minus_minus",C.token,"--"),period:new P("period",C.token,"."),plus:new P("plus",C.token,"+"),plus_plus:new P("plus_plus",C.token,"++"),or:new P("or",C.token,"|"),or_or:new P("or_or",C.token,"||"),paren_left:new P("paren_left",C.token,"("),paren_right:new P("paren_right",C.token,")"),semicolon:new P("semicolon",C.token,";"),star:new P("star",C.token,"*"),tilde:new P("tilde",C.token,"~"),underscore:new P("underscore",C.token,"_"),xor:new P("xor",C.token,"^"),plus_equal:new P("plus_equal",C.token,"+="),minus_equal:new P("minus_equal",C.token,"-="),times_equal:new P("times_equal",C.token,"*="),division_equal:new P("division_equal",C.token,"/="),modulo_equal:new P("modulo_equal",C.token,"%="),and_equal:new P("and_equal",C.token,"&="),or_equal:new P("or_equal",C.token,"|="),xor_equal:new P("xor_equal",C.token,"^="),shift_right_equal:new P("shift_right_equal",C.token,">>="),shift_left_equal:new P("shift_left_equal",C.token,"<<=")};E.simpleTokens={"@":N.tokens.attr,"{":N.tokens.brace_left,"}":N.tokens.brace_right,":":N.tokens.colon,",":N.tokens.comma,"(":N.tokens.paren_left,")":N.tokens.paren_right,";":N.tokens.semicolon};E.literalTokens={"&":N.tokens.and,"&&":N.tokens.and_and,"->":N.tokens.arrow,"/":N.tokens.forward_slash,"!":N.tokens.bang,"[":N.tokens.bracket_left,"]":N.tokens.bracket_right,"=":N.tokens.equal,"==":N.tokens.equal_equal,"!=":N.tokens.not_equal,">":N.tokens.greater_than,">=":N.tokens.greater_than_equal,">>":N.tokens.shift_right,"<":N.tokens.less_than,"<=":N.tokens.less_than_equal,"<<":N.tokens.shift_left,"%":N.tokens.modulo,"-":N.tokens.minus,"--":N.tokens.minus_minus,".":N.tokens.period,"+":N.tokens.plus,"++":N.tokens.plus_plus,"|":N.tokens.or,"||":N.tokens.or_or,"*":N.tokens.star,"~":N.tokens.tilde,_:N.tokens.underscore,"^":N.tokens.xor,"+=":N.tokens.plus_equal,"-=":N.tokens.minus_equal,"*=":N.tokens.times_equal,"/=":N.tokens.division_equal,"%=":N.tokens.modulo_equal,"&=":N.tokens.and_equal,"|=":N.tokens.or_equal,"^=":N.tokens.xor_equal,">>=":N.tokens.shift_right_equal,"<<=":N.tokens.shift_left_equal};E.regexTokens={decimal_float_literal:N.tokens.decimal_float_literal,hex_float_literal:N.tokens.hex_float_literal,int_literal:N.tokens.int_literal,uint_literal:N.tokens.uint_literal,ident:N.tokens.ident};E.storage_class=[N.keywords.function,N.keywords.private,N.keywords.workgroup,N.keywords.uniform,N.keywords.storage];E.access_mode=[N.keywords.read,N.keywords.write,N.keywords.read_write];E.sampler_type=[N.keywords.sampler,N.keywords.sampler_comparison];E.sampled_texture_type=[N.keywords.texture_1d,N.keywords.texture_2d,N.keywords.texture_2d_array,N.keywords.texture_3d,N.keywords.texture_cube,N.keywords.texture_cube_array];E.multisampled_texture_type=[N.keywords.texture_multisampled_2d];E.storage_texture_type=[N.keywords.texture_storage_1d,N.keywords.texture_storage_2d,N.keywords.texture_storage_2d_array,N.keywords.texture_storage_3d];E.depth_texture_type=[N.keywords.texture_depth_2d,N.keywords.texture_depth_2d_array,N.keywords.texture_depth_cube,N.keywords.texture_depth_cube_array,N.keywords.texture_depth_multisampled_2d];E.texture_external_type=[N.keywords.texture_external];E.any_texture_type=[...N.sampled_texture_type,...N.multisampled_texture_type,...N.storage_texture_type,...N.depth_texture_type,...N.texture_external_type];E.texel_format=[N.keywords.r8unorm,N.keywords.r8snorm,N.keywords.r8uint,N.keywords.r8sint,N.keywords.r16uint,N.keywords.r16sint,N.keywords.r16float,N.keywords.rg8unorm,N.keywords.rg8snorm,N.keywords.rg8uint,N.keywords.rg8sint,N.keywords.r32uint,N.keywords.r32sint,N.keywords.r32float,N.keywords.rg16uint,N.keywords.rg16sint,N.keywords.rg16float,N.keywords.rgba8unorm,N.keywords.rgba8unorm_srgb,N.keywords.rgba8snorm,N.keywords.rgba8uint,N.keywords.rgba8sint,N.keywords.bgra8unorm,N.keywords.bgra8unorm_srgb,N.keywords.rgb10a2unorm,N.keywords.rg11b10float,N.keywords.rg32uint,N.keywords.rg32sint,N.keywords.rg32float,N.keywords.rgba16uint,N.keywords.rgba16sint,N.keywords.rgba16float,N.keywords.rgba32uint,N.keywords.rgba32sint,N.keywords.rgba32float];E.const_literal=[N.tokens.int_literal,N.tokens.uint_literal,N.tokens.decimal_float_literal,N.tokens.hex_float_literal,N.keywords.true,N.keywords.false];E.literal_or_ident=[N.tokens.ident,N.tokens.int_literal,N.tokens.uint_literal,N.tokens.decimal_float_literal,N.tokens.hex_float_literal];E.element_count_expression=[N.tokens.int_literal,N.tokens.uint_literal,N.tokens.ident];E.template_types=[N.keywords.vec2,N.keywords.vec3,N.keywords.vec4,N.keywords.mat2x2,N.keywords.mat2x3,N.keywords.mat2x4,N.keywords.mat3x2,N.keywords.mat3x3,N.keywords.mat3x4,N.keywords.mat4x2,N.keywords.mat4x3,N.keywords.mat4x4,N.keywords.atomic,N.keywords.bitcast,...N.any_texture_type];E.attribute_name=[N.tokens.ident,N.keywords.block,N.keywords.diagnostic];E.assignment_operators=[N.tokens.equal,N.tokens.plus_equal,N.tokens.minus_equal,N.tokens.times_equal,N.tokens.division_equal,N.tokens.modulo_equal,N.tokens.and_equal,N.tokens.or_equal,N.tokens.xor_equal,N.tokens.shift_right_equal,N.tokens.shift_left_equal];E.increment_operators=[N.tokens.plus_plus,N.tokens.minus_minus];class Fv{constructor(e,n,r){this.type=e,this.lexeme=n,this.line=r}toString(){return this.lexeme}isTemplateType(){return E.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==E.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class i4{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new Fv(E.eof,"",this._line)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}else if(this._peekAhead()=="*"){this._advance();let o=1;for(;o>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),o--,o==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),o++)}return!0}}const n=E.simpleTokens[e];if(n)return this._addToken(n),!0;let r=E.none;const i=this._isAlpha(e),s=e==="_";if(this._isAlphaNumeric(e)){let o=this._peekAhead();for(;this._isAlphaNumeric(o);)e+=this._advance(),o=this._peekAhead()}if(i){const o=E.keywords[e];if(o)return this._addToken(o),!0}if(i||s)return this._addToken(E.tokens.ident),!0;for(;;){let o=this._findType(e);const a=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(a=="=")return this._current++,e+=a,this._addToken(E.tokens.minus_equal),!0;if(a=="-")return this._current++,e+=a,this._addToken(E.tokens.minus_minus),!0;const l=this._tokens.length-1;if((E.literal_or_ident.indexOf(this._tokens[l].type)!=-1||this._tokens[l].type==E.tokens.paren_right)&&a!=">")return this._addToken(o),!0}if(e==">"&&(a==">"||a=="=")){let l=!1,c=this._tokens.length-1;for(let u=0;u<5&&c>=0&&E.assignment_operators.indexOf(this._tokens[c].type)===-1;++u,--c)if(this._tokens[c].type===E.tokens.less_than){c>0&&this._tokens[c-1].isArrayOrTemplateType()&&(l=!0);break}if(l)return this._addToken(o),!0}if(o===E.none){let l=e,c=0;const u=2;for(let f=0;f<u;++f)if(l+=this._peekAhead(f),o=this._findType(l),o!==E.none){c=f;break}if(o===E.none)return r===E.none?!1:(this._current--,this._addToken(r),!0);e=l,this._current+=c+1}if(r=o,this._isAtEnd())break;e+=this._advance()}return r===E.none?!1:(this._addToken(r),!0)}_findType(e){for(const r in E.regexTokens){const i=E.regexTokens[r];if(this._match(e,i.rule))return i}const n=E.literalTokens[e];return n||E.none}_match(e,n){const r=n.exec(e);return r&&r.index==0&&r[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}_isAlphaNumeric(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e=="_"||e>="0"&&e<="9"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let n=this._source[this._current];return e=e||0,e++,this._current+=e,n}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const n=this._source.substring(this._start,this._current);this._tokens.push(new Fv(e,n,this._line))}}class s4{constructor(){this._tokens=[],this._current=0,this._currentLine=0,this._context=new ID,this._deferArrayCountEval=[]}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const n=[];for(;!this._isAtEnd();){const r=this._global_decl_or_directive();if(!r)break;n.push(r)}if(this._deferArrayCountEval.length>0){for(const r of this._deferArrayCountEval){const i=r.arrayType,s=r.countNode;if(s instanceof sg){const a=s.name,l=this._context.constants.get(a);if(l)try{const c=l.evaluate(this._context);i.count=c}catch{}}}this._deferArrayCountEval.length=0}return n}_initialize(e){if(e)if(typeof e=="string"){const n=new i4(e);this._tokens=n.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_error(e,n){return{token:e,message:n,toString:function(){return`${n}`}}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==E.eof}_match(e){if(e instanceof P)return this._check(e)?(this._advance(),!0):!1;for(let n=0,r=e.length;n<r;++n){const i=e[n];if(this._check(i))return this._advance(),!0}return!1}_consume(e,n){if(this._check(e))return this._advance();throw this._error(this._peek(),n)}_check(e){if(this._isAtEnd())return!1;const n=this._peek();if(e instanceof Array){const r=n.type;return e.indexOf(r)!=-1}return n.type==e}_advance(){var e,n;return this._currentLine=(n=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&n!==void 0?n:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(E.tokens.semicolon)&&!this._isAtEnd(););if(this._match(E.keywords.alias)){const n=this._type_alias();return this._consume(E.tokens.semicolon,"Expected ';'"),n}if(this._match(E.keywords.diagnostic)){const n=this._diagnostic();return this._consume(E.tokens.semicolon,"Expected ';'"),n}if(this._match(E.keywords.requires)){const n=this._requires_directive();return this._consume(E.tokens.semicolon,"Expected ';'"),n}if(this._match(E.keywords.enable)){const n=this._enable_directive();return this._consume(E.tokens.semicolon,"Expected ';'"),n}const e=this._attribute();if(this._check(E.keywords.var)){const n=this._global_variable_decl();return n!=null&&(n.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),n}if(this._check(E.keywords.override)){const n=this._override_variable_decl();return n!=null&&(n.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),n}if(this._check(E.keywords.let)){const n=this._global_let_decl();return n!=null&&(n.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),n}if(this._check(E.keywords.const)){const n=this._global_const_decl();return n!=null&&(n.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),n}if(this._check(E.keywords.struct)){const n=this._struct_decl();return n!=null&&(n.attributes=e),n}if(this._check(E.keywords.fn)){const n=this._function_decl();return n!=null&&(n.attributes=e),n}return null}_function_decl(){if(!this._match(E.keywords.fn))return null;const e=this._currentLine,n=this._consume(E.tokens.ident,"Expected function name.").toString();this._consume(E.tokens.paren_left,"Expected '(' for function arguments.");const r=[];if(!this._check(E.tokens.paren_right))do{if(this._check(E.tokens.paren_right))break;const a=this._attribute(),l=this._consume(E.tokens.ident,"Expected argument name.").toString();this._consume(E.tokens.colon,"Expected ':' for argument type.");const c=this._attribute(),u=this._type_decl();u!=null&&(u.attributes=c,r.push(new e4(l,u,a)))}while(this._match(E.tokens.comma));this._consume(E.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(E.tokens.arrow)){const a=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=a)}const s=this._compound_statement(),o=this._currentLine;return new rg(n,r,i,s,e,o)}_compound_statement(){const e=[];for(this._consume(E.tokens.brace_left,"Expected '{' for block.");!this._check(E.tokens.brace_right);){const n=this._statement();n!==null&&e.push(n)}return this._consume(E.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(E.tokens.semicolon)&&!this._isAtEnd(););if(this._check(E.tokens.attr)&&this._attribute(),this._check(E.keywords.if))return this._if_statement();if(this._check(E.keywords.switch))return this._switch_statement();if(this._check(E.keywords.loop))return this._loop_statement();if(this._check(E.keywords.for))return this._for_statement();if(this._check(E.keywords.while))return this._while_statement();if(this._check(E.keywords.continuing))return this._continuing_statement();if(this._check(E.keywords.static_assert))return this._static_assert_statement();if(this._check(E.tokens.brace_left))return this._compound_statement();let e=null;return this._check(E.keywords.return)?e=this._return_statement():this._check([E.keywords.var,E.keywords.let,E.keywords.const])?e=this._variable_statement():this._match(E.keywords.discard)?e=new WD:this._match(E.keywords.break)?e=new HD:this._match(E.keywords.continue)?e=new XD:e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement(),e!=null&&this._consume(E.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(E.keywords.static_assert))return null;const e=this._optional_paren_expression();return new MD(e)}_while_statement(){if(!this._match(E.keywords.while))return null;const e=this._optional_paren_expression();this._check(E.tokens.attr)&&this._attribute();const n=this._compound_statement();return new ND(e,n)}_continuing_statement(){if(!this._match(E.keywords.continuing))return null;const e=this._compound_statement();return new kD(e)}_for_statement(){if(!this._match(E.keywords.for))return null;this._consume(E.tokens.paren_left,"Expected '('.");const e=this._check(E.tokens.semicolon)?null:this._for_init();this._consume(E.tokens.semicolon,"Expected ';'.");const n=this._check(E.tokens.semicolon)?null:this._short_circuit_or_expression();this._consume(E.tokens.semicolon,"Expected ';'.");const r=this._check(E.tokens.paren_right)?null:this._for_increment();this._consume(E.tokens.paren_right,"Expected ')'."),this._check(E.tokens.attr)&&this._attribute();const i=this._compound_statement();return new OD(e,n,r,i)}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(E.keywords.var)){const e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let n=null;return this._match(E.tokens.equal)&&(n=this._short_circuit_or_expression()),new Yr(e.name,e.type,e.storage,e.access,n)}if(this._match(E.keywords.let)){const e=this._consume(E.tokens.ident,"Expected name for let.").toString();let n=null;if(this._match(E.tokens.colon)){const i=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=i)}this._consume(E.tokens.equal,"Expected '=' for let.");const r=this._short_circuit_or_expression();return new ig(e,n,null,null,r)}if(this._match(E.keywords.const)){const e=this._consume(E.tokens.ident,"Expected name for const.").toString();let n=null;if(this._match(E.tokens.colon)){const i=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=i)}this._consume(E.tokens.equal,"Expected '=' for const.");const r=this._short_circuit_or_expression();return new Iv(e,n,null,null,r)}return null}_increment_decrement_statement(){const e=this._current,n=this._unary_expression();if(n==null)return null;if(!this._check(E.increment_operators))return this._current=e,null;const r=this._consume(E.increment_operators,"Expected increment operator");return new FD(r.type===E.tokens.plus_plus?Ls.increment:Ls.decrement,n)}_assignment_statement(){let e=null;if(this._check(E.tokens.brace_right))return null;let n=this._match(E.tokens.underscore);if(n||(e=this._unary_expression()),!n&&e==null)return null;const r=this._consume(E.assignment_operators,"Expected assignment operator."),i=this._short_circuit_or_expression();return new DD(Ta.parse(r.lexeme),e,i)}_func_call_statement(){if(!this._check(E.tokens.ident))return null;const e=this._current,n=this._consume(E.tokens.ident,"Expected function name."),r=this._argument_expression_list();return r===null?(this._current=e,null):new $b(n.lexeme,r)}_loop_statement(){if(!this._match(E.keywords.loop))return null;this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Expected '{' for loop.");const e=[];let n=this._statement();for(;n!==null;){if(Array.isArray(n))for(let i of n)e.push(i);else e.push(n);n=this._statement()}let r=null;return this._match(E.keywords.continuing)&&(r=this._compound_statement()),this._consume(E.tokens.brace_right,"Expected '}' for loop."),new BD(e,r)}_switch_statement(){if(!this._match(E.keywords.switch))return null;const e=this._optional_paren_expression();this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Expected '{' for switch.");const n=this._switch_body();if(n==null||n.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(E.tokens.brace_right,"Expected '}' for switch."),new LD(e,n)}_switch_body(){const e=[];if(this._match(E.keywords.case)){const n=this._case_selectors();this._match(E.tokens.colon),this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Exected '{' for switch case.");const r=this._case_body();this._consume(E.tokens.brace_right,"Exected '}' for switch case."),e.push(new JD(n,r))}if(this._match(E.keywords.default)){this._match(E.tokens.colon),this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Exected '{' for switch default.");const n=this._case_body();this._consume(E.tokens.brace_right,"Exected '}' for switch default."),e.push(new GD(n))}if(this._check([E.keywords.default,E.keywords.case])){const n=this._switch_body();e.push(n[0])}return e}_case_selectors(){const e=[this._shift_expression()];for(;this._match(E.tokens.comma);)e.push(this._shift_expression());return e}_case_body(){if(this._match(E.keywords.fallthrough))return this._consume(E.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);const n=this._case_body();return n.length==0?e:[...e,n[0]]}_if_statement(){if(!this._match(E.keywords.if))return null;const e=this._optional_paren_expression();this._check(E.tokens.attr)&&this._attribute();const n=this._compound_statement();let r=[];this._match_elseif()&&(this._check(E.tokens.attr)&&this._attribute(),r=this._elseif_statement(r));let i=null;return this._match(E.keywords.else)&&(this._check(E.tokens.attr)&&this._attribute(),i=this._compound_statement()),new UD(e,n,r,i)}_match_elseif(){return this._tokens[this._current].type===E.keywords.else&&this._tokens[this._current+1].type===E.keywords.if?(this._advance(),this._advance(),!0):!1}_elseif_statement(e=[]){const n=this._optional_paren_expression(),r=this._compound_statement();return e.push(new t4(n,r)),this._match_elseif()&&(this._check(E.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(E.keywords.return))return null;const e=this._short_circuit_or_expression();return new zD(e)}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(E.tokens.or_or);)e=new cn(this._previous().toString(),e,this._short_circuit_and_expr());return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(E.tokens.and_and);)e=new cn(this._previous().toString(),e,this._inclusive_or_expression());return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(E.tokens.or);)e=new cn(this._previous().toString(),e,this._exclusive_or_expression());return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(E.tokens.xor);)e=new cn(this._previous().toString(),e,this._and_expression());return e}_and_expression(){let e=this._equality_expression();for(;this._match(E.tokens.and);)e=new cn(this._previous().toString(),e,this._equality_expression());return e}_equality_expression(){const e=this._relational_expression();return this._match([E.tokens.equal_equal,E.tokens.not_equal])?new cn(this._previous().toString(),e,this._relational_expression()):e}_relational_expression(){let e=this._shift_expression();for(;this._match([E.tokens.less_than,E.tokens.greater_than,E.tokens.less_than_equal,E.tokens.greater_than_equal]);)e=new cn(this._previous().toString(),e,this._shift_expression());return e}_shift_expression(){let e=this._additive_expression();for(;this._match([E.tokens.shift_left,E.tokens.shift_right]);)e=new cn(this._previous().toString(),e,this._additive_expression());return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([E.tokens.plus,E.tokens.minus]);)e=new cn(this._previous().toString(),e,this._multiplicative_expression());return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([E.tokens.star,E.tokens.forward_slash,E.tokens.modulo]);)e=new cn(this._previous().toString(),e,this._unary_expression());return e}_unary_expression(){return this._match([E.tokens.minus,E.tokens.bang,E.tokens.tilde,E.tokens.star,E.tokens.and])?new QD(this._previous().toString(),this._unary_expression()):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),n=this._postfix_expression();return n&&(e.postfix=n),e}_postfix_expression(){if(this._match(E.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(E.tokens.bracket_right,"Expected ']'.");const n=new ZD(e),r=this._postfix_expression();return r&&(n.postfix=r),n}if(this._match(E.tokens.period)){const e=this._consume(E.tokens.ident,"Expected member name."),n=this._postfix_expression(),r=new Mv(e.lexeme);return n&&(r.postfix=n),r}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_primary_expression(){if(this._match(E.tokens.ident)){const r=this._previous().toString();if(this._check(E.tokens.paren_left)){const i=this._argument_expression_list(),s=this._getStruct(r);return s!=null?new ns(s,i):new Hb(r,i)}if(this._context.constants.has(r)){const i=this._context.constants.get(r);return new Nv(r,i.value)}return new sg(r)}if(this._match(E.const_literal))return new kv(parseFloat(this._previous().toString()));if(this._check(E.tokens.paren_left))return this._paren_expression();if(this._match(E.keywords.bitcast)){this._consume(E.tokens.less_than,"Expected '<'.");const r=this._type_decl();this._consume(E.tokens.greater_than,"Expected '>'.");const i=this._paren_expression();return new KD(r,i)}const e=this._type_decl(),n=this._argument_expression_list();return new qD(e,n)}_argument_expression_list(){if(!this._match(E.tokens.paren_left))return null;const e=[];do{if(this._check(E.tokens.paren_right))break;const n=this._short_circuit_or_expression();e.push(n)}while(this._match(E.tokens.comma));return this._consume(E.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(E.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(E.tokens.paren_right),new Ov([e])}_paren_expression(){this._consume(E.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(E.tokens.paren_right,"Expected ')'."),new Ov([e])}_struct_decl(){if(!this._match(E.keywords.struct))return null;const e=this._currentLine,n=this._consume(E.tokens.ident,"Expected name for struct.").toString();this._consume(E.tokens.brace_left,"Expected '{' for struct body.");const r=[];for(;!this._check(E.tokens.brace_right);){const o=this._attribute(),a=this._consume(E.tokens.ident,"Expected variable name.").toString();this._consume(E.tokens.colon,"Expected ':' for struct member type.");const l=this._attribute(),c=this._type_decl();c!=null&&(c.attributes=l),this._check(E.tokens.brace_right)?this._match(E.tokens.comma):this._consume(E.tokens.comma,"Expected ',' for struct member."),r.push(new n4(a,c,o))}this._consume(E.tokens.brace_right,"Expected '}' after struct body.");const i=this._currentLine,s=new Xr(n,r,e,i);return this._context.structs.set(n,s),s}_global_variable_decl(){const e=this._variable_decl();return e&&this._match(E.tokens.equal)&&(e.value=this._const_expression()),e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(E.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){if(!this._match(E.keywords.const))return null;const e=this._consume(E.tokens.ident,"Expected variable name");let n=null;if(this._match(E.tokens.colon)){const s=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=s)}let r=null;if(this._match(E.tokens.equal)){const s=this._short_circuit_or_expression();if(s instanceof ns)r=s;else if(s instanceof Nv&&s.initializer instanceof ns)r=s.initializer;else try{const o=s.evaluate(this._context);r=new kv(o)}catch{r=s}}const i=new Iv(e.toString(),n,"","",r);return this._context.constants.set(i.name,i),i}_global_let_decl(){if(!this._match(E.keywords.let))return null;const e=this._consume(E.tokens.ident,"Expected variable name");let n=null;if(this._match(E.tokens.colon)){const i=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=i)}let r=null;return this._match(E.tokens.equal)&&(r=this._const_expression()),new ig(e.toString(),n,"","",r)}_const_expression(){if(this._match(E.const_literal))return new Mv(this._previous().toString());const e=this._type_decl();this._consume(E.tokens.paren_left,"Expected '('.");let n=[];for(;!this._check(E.tokens.paren_right)&&(n.push(this._const_expression()),!!this._check(E.tokens.comma));)this._advance();return this._consume(E.tokens.paren_right,"Expected ')'."),new ns(e,n)}_variable_decl(){if(!this._match(E.keywords.var))return null;let e="",n="";this._match(E.tokens.less_than)&&(e=this._consume(E.storage_class,"Expected storage_class.").toString(),this._match(E.tokens.comma)&&(n=this._consume(E.access_mode,"Expected access_mode.").toString()),this._consume(E.tokens.greater_than,"Expected '>'."));const r=this._consume(E.tokens.ident,"Expected variable name");let i=null;if(this._match(E.tokens.colon)){const s=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=s)}return new Yr(r.toString(),i,e,n,null)}_override_decl(){if(!this._match(E.keywords.override))return null;const e=this._consume(E.tokens.ident,"Expected variable name");let n=null;if(this._match(E.tokens.colon)){const r=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=r)}return new zb(e.toString(),n,null)}_diagnostic(){this._consume(E.tokens.paren_left,"Expected '('");const e=this._consume(E.tokens.ident,"Expected severity control name.");this._consume(E.tokens.comma,"Expected ','");const n=this._consume(E.tokens.ident,"Expected diagnostic rule name.");return this._consume(E.tokens.paren_right,"Expected ')'"),new jD(e.toString(),n.toString())}_enable_directive(){const e=this._consume(E.tokens.ident,"identity expected.");return new $D(e.toString())}_requires_directive(){const e=[this._consume(E.tokens.ident,"identity expected.").toString()];for(;this._match(E.tokens.comma);){const n=this._consume(E.tokens.ident,"identity expected.");e.push(n.toString())}return new VD(e)}_type_alias(){const e=this._consume(E.tokens.ident,"identity expected.");this._consume(E.tokens.equal,"Expected '=' for type alias.");let n=this._type_decl();if(n===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);const r=new Vb(e.toString(),n);return this._context.aliases.set(r.name,r),r}_type_decl(){if(this._check([E.tokens.ident,...E.texel_format,E.keywords.bool,E.keywords.f32,E.keywords.i32,E.keywords.u32])){const r=this._advance(),i=r.toString();return this._context.structs.has(i)?this._context.structs.get(i):this._context.aliases.has(i)?this._context.aliases.get(i).type:new Ri(r.toString())}let e=this._texture_sampler_types();if(e)return e;if(this._check(E.template_types)){let r=this._advance().toString(),i=null,s=null;return this._match(E.tokens.less_than)&&(i=this._type_decl(),s=null,this._match(E.tokens.comma)&&(s=this._consume(E.access_mode,"Expected access_mode for pointer").toString()),this._consume(E.tokens.greater_than,"Expected '>' for type.")),new jb(r,i,s)}if(this._match(E.keywords.ptr)){let r=this._previous().toString();this._consume(E.tokens.less_than,"Expected '<' for pointer.");const i=this._consume(E.storage_class,"Expected storage_class for pointer");this._consume(E.tokens.comma,"Expected ',' for pointer.");const s=this._type_decl();let o=null;return this._match(E.tokens.comma)&&(o=this._consume(E.access_mode,"Expected access_mode for pointer").toString()),this._consume(E.tokens.greater_than,"Expected '>' for pointer."),new YD(r,i.toString(),s,o)}const n=this._attribute();if(this._match(E.keywords.array)){let r=null,i=-1;const s=this._previous();let o=null;if(this._match(E.tokens.less_than)){r=this._type_decl(),this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);let l="";if(this._match(E.tokens.comma)){o=this._shift_expression();try{l=o.evaluate(this._context).toString(),o=null}catch{l="1"}}this._consume(E.tokens.greater_than,"Expected '>' for array."),i=l?parseInt(l):0}const a=new Wb(s.toString(),n,r,i);return o&&this._deferArrayCountEval.push({arrayType:a,countNode:o}),a}return null}_texture_sampler_types(){if(this._match(E.sampler_type))return new Po(this._previous().toString(),null,null);if(this._match(E.depth_texture_type))return new Po(this._previous().toString(),null,null);if(this._match(E.sampled_texture_type)||this._match(E.multisampled_texture_type)){const e=this._previous();this._consume(E.tokens.less_than,"Expected '<' for sampler type.");const n=this._type_decl();return this._consume(E.tokens.greater_than,"Expected '>' for sampler type."),new Po(e.toString(),n,null)}if(this._match(E.storage_texture_type)){const e=this._previous();this._consume(E.tokens.less_than,"Expected '<' for sampler type.");const n=this._consume(E.texel_format,"Invalid texel format.").toString();this._consume(E.tokens.comma,"Expected ',' after texel format.");const r=this._consume(E.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(E.tokens.greater_than,"Expected '>' for sampler type."),new Po(e.toString(),n,r)}return null}_attribute(){let e=[];for(;this._match(E.tokens.attr);){const n=this._consume(E.attribute_name,"Expected attribute name"),r=new r4(n.toString(),null);if(this._match(E.tokens.paren_left)){if(r.value=this._consume(E.literal_or_ident,"Expected attribute value").toString(),this._check(E.tokens.comma)){this._advance();do{const i=this._consume(E.literal_or_ident,"Expected attribute value").toString();r.value instanceof Array||(r.value=[r.value]),r.value.push(i)}while(this._match(E.tokens.comma))}this._consume(E.tokens.paren_right,"Expected ')'")}e.push(r)}return e.length==0?null:e}}class ys{constructor(e,n){this.name=e,this.attributes=n,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}}class Dv{constructor(e,n,r){this.name=e,this.type=n,this.attributes=r,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class Dl extends ys{constructor(e,n){super(e,n),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class od extends ys{constructor(e,n){super(e,n),this.count=0,this.stride=0}get isArray(){return!0}}class Bv extends ys{constructor(e,n,r,i){super(e,r),this.format=n,this.access=i}get isTemplate(){return!0}}var ar;(function(t){t[t.Uniform=0]="Uniform",t[t.Storage=1]="Storage",t[t.Texture=2]="Texture",t[t.Sampler=3]="Sampler",t[t.StorageTexture=4]="StorageTexture"})(ar||(ar={}));class Bl{constructor(e,n,r,i,s,o,a){this.name=e,this.type=n,this.group=r,this.binding=i,this.attributes=s,this.resourceType=o,this.access=a}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class o4{constructor(e,n){this.name=e,this.type=n}}class Ll{constructor(e,n){this.align=e,this.size=n}}class a4{constructor(e,n,r,i){this.name=e,this.type=n,this.locationType=r,this.location=i,this.interpolation=null}}class Lv{constructor(e,n,r,i){this.name=e,this.type=n,this.locationType=r,this.location=i}}class l4{constructor(e,n=null){this.stage=null,this.inputs=[],this.outputs=[],this.resources=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=n}}class c4{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}class u4{constructor(e,n,r,i){this.name=e,this.type=n,this.attributes=r,this.id=i}}class f4{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class zn{constructor(e){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new c4,this.functions=[],this._types=new Map,this._functions=new Map,e&&this.update(e)}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}update(e){const r=new s4().parse(e);for(const i of r)i instanceof rg&&this._functions.set(i.name,new f4(i));for(const i of r)if(i instanceof Xr){const s=this._getTypeInfo(i,null);s instanceof Dl&&this.structs.push(s)}for(const i of r){if(i instanceof Vb){this.aliases.push(this._getAliasInfo(i));continue}if(i instanceof zb){const s=i,o=this._getAttributeNum(s.attributes,"id",0),a=s.type!=null?this._getTypeInfo(s.type,s.attributes):null;this.overrides.push(new u4(s.name,a,s.attributes,o));continue}if(this._isUniformVar(i)){const s=i,o=this._getAttributeNum(s.attributes,"group",0),a=this._getAttributeNum(s.attributes,"binding",0),l=this._getTypeInfo(s.type,s.attributes),c=new Bl(s.name,l,o,a,s.attributes,ar.Uniform,s.access);this.uniforms.push(c);continue}if(this._isStorageVar(i)){const s=i,o=this._getAttributeNum(s.attributes,"group",0),a=this._getAttributeNum(s.attributes,"binding",0),l=this._getTypeInfo(s.type,s.attributes),c=this._isStorageTexture(l),u=new Bl(s.name,l,o,a,s.attributes,c?ar.StorageTexture:ar.Storage,s.access);this.storage.push(u);continue}if(this._isTextureVar(i)){const s=i,o=this._getAttributeNum(s.attributes,"group",0),a=this._getAttributeNum(s.attributes,"binding",0),l=this._getTypeInfo(s.type,s.attributes),c=this._isStorageTexture(l),u=new Bl(s.name,l,o,a,s.attributes,c?ar.StorageTexture:ar.Texture,s.access);c?this.storage.push(u):this.textures.push(u);continue}if(this._isSamplerVar(i)){const s=i,o=this._getAttributeNum(s.attributes,"group",0),a=this._getAttributeNum(s.attributes,"binding",0),l=this._getTypeInfo(s.type,s.attributes),c=new Bl(s.name,l,o,a,s.attributes,ar.Sampler,s.access);this.samplers.push(c);continue}if(i instanceof rg){const s=this._getAttribute(i,"vertex"),o=this._getAttribute(i,"fragment"),a=this._getAttribute(i,"compute"),l=s||o||a,c=new l4(i.name,l==null?void 0:l.name);c.startLine=i.startLine,c.endLine=i.endLine,this.functions.push(c),this._functions.get(i.name).info=c,l&&(this._functions.get(i.name).inUse=!0,c.inUse=!0,c.resources=this._findResources(i,!!l),c.inputs=this._getInputs(i.args),c.outputs=this._getOutputs(i.returnType),this.entry[l.name].push(c));continue}}for(const i of this._functions.values())i.info&&(i.info.inUse=i.inUse,this._addCalls(i.node,i.info.calls));for(const i of this.uniforms)this._markStructsInUse(i.type);for(const i of this.storage)this._markStructsInUse(i.type)}_markStructsInUse(e){if(e.isStruct){e.inUse=!0;for(const n of e.members)this._markStructsInUse(n.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)this._markStructsInUse(e.format);else{const n=this._getAlias(e.name);n&&this._markStructsInUse(n)}}_addCalls(e,n){var r;for(const i of e.calls){const s=(r=this._functions.get(i.name))===null||r===void 0?void 0:r.info;s&&n.add(s)}}findResource(e,n){for(const r of this.uniforms)if(r.group==e&&r.binding==n)return r;for(const r of this.storage)if(r.group==e&&r.binding==n)return r;for(const r of this.textures)if(r.group==e&&r.binding==n)return r;for(const r of this.samplers)if(r.group==e&&r.binding==n)return r;return null}_findResource(e){for(const n of this.uniforms)if(n.name==e)return n;for(const n of this.storage)if(n.name==e)return n;for(const n of this.textures)if(n.name==e)return n;for(const n of this.samplers)if(n.name==e)return n;return null}_markStructsFromAST(e){const n=this._getTypeInfo(e,null);this._markStructsInUse(n)}_findResources(e,n){const r=[],i=this,s=[];return e.search(o=>{if(o instanceof yu)s.push({});else if(o instanceof vu)s.pop();else if(o instanceof Yr){const a=o;n&&a.type!==null&&this._markStructsFromAST(a.type),s.length>0&&(s[s.length-1][a.name]=a)}else if(o instanceof ns){const a=o;n&&a.type!==null&&this._markStructsFromAST(a.type)}else if(o instanceof ig){const a=o;n&&a.type!==null&&this._markStructsFromAST(a.type),s.length>0&&(s[s.length-1][a.name]=a)}else if(o instanceof sg){const a=o;if(s.length>0&&s[s.length-1][a.name])return;const l=i._findResource(a.name);l&&r.push(l)}else if(o instanceof Hb){const a=o,l=i._functions.get(a.name);l&&(n&&(l.inUse=!0),e.calls.add(l.node),l.resources===null&&(l.resources=i._findResources(l.node,n)),r.push(...l.resources))}else if(o instanceof $b){const a=o,l=i._functions.get(a.name);l&&(n&&(l.inUse=!0),e.calls.add(l.node),l.resources===null&&(l.resources=i._findResources(l.node,n)),r.push(...l.resources))}}),[...new Map(r.map(o=>[o.name,o])).values()]}getBindGroups(){const e=[];function n(r,i){r>=e.length&&(e.length=r+1),e[r]===void 0&&(e[r]=[]),i>=e[r].length&&(e[r].length=i+1)}for(const r of this.uniforms){n(r.group,r.binding);const i=e[r.group];i[r.binding]=r}for(const r of this.storage){n(r.group,r.binding);const i=e[r.group];i[r.binding]=r}for(const r of this.textures){n(r.group,r.binding);const i=e[r.group];i[r.binding]=r}for(const r of this.samplers){n(r.group,r.binding);const i=e[r.group];i[r.binding]=r}return e}_getOutputs(e,n=void 0){if(n===void 0&&(n=[]),e instanceof Xr)this._getStructOutputs(e,n);else{const r=this._getOutputInfo(e);r!==null&&n.push(r)}return n}_getStructOutputs(e,n){for(const r of e.members)if(r.type instanceof Xr)this._getStructOutputs(r.type,n);else{const i=this._getAttribute(r,"location")||this._getAttribute(r,"builtin");if(i!==null){const s=this._getTypeInfo(r.type,r.type.attributes),o=this._parseInt(i.value),a=new Lv(r.name,s,i.name,o);n.push(a)}}}_getOutputInfo(e){const n=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(n!==null){const r=this._getTypeInfo(e,e.attributes),i=this._parseInt(n.value);return new Lv("",r,n.name,i)}return null}_getInputs(e,n=void 0){n===void 0&&(n=[]);for(const r of e)if(r.type instanceof Xr)this._getStructInputs(r.type,n);else{const i=this._getInputInfo(r);i!==null&&n.push(i)}return n}_getStructInputs(e,n){for(const r of e.members)if(r.type instanceof Xr)this._getStructInputs(r.type,n);else{const i=this._getInputInfo(r);i!==null&&n.push(i)}}_getInputInfo(e){const n=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(n!==null){const r=this._getAttribute(e,"interpolation"),i=this._getTypeInfo(e.type,e.attributes),s=this._parseInt(n.value),o=new a4(e.name,i,n.name,s);return r!==null&&(o.interpolation=this._parseString(r.value)),o}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const n=parseInt(e);return isNaN(n)?e:n}_getAlias(e){for(const n of this.aliases)if(n.name==e)return n.type;return null}_getAliasInfo(e){return new o4(e.name,this._getTypeInfo(e.type,null))}_getTypeInfo(e,n){if(this._types.has(e))return this._types.get(e);if(e instanceof Wb){const i=e,s=this._getTypeInfo(i.format,i.attributes),o=new od(i.name,n);return o.format=s,o.count=i.count,this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof Xr){const i=e,s=new Dl(i.name,n);s.startLine=i.startLine,s.endLine=i.endLine;for(const o of i.members){const a=this._getTypeInfo(o.type,o.attributes);s.members.push(new Dv(o.name,a,o.attributes))}return this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof Po){const i=e,s=i.format instanceof Ri,o=i.format?s?this._getTypeInfo(i.format,null):new ys(i.format,null):null,a=new Bv(i.name,o,n,i.access);return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof jb){const i=e,s=i.format?this._getTypeInfo(i.format,null):null,o=new Bv(i.name,s,n,i.access);return this._types.set(e,o),this._updateTypeInfo(o),o}const r=new ys(e.name,n);return this._types.set(e,r),this._updateTypeInfo(r),r}_updateTypeInfo(e){var n,r;const i=this._getTypeSize(e);if(e.size=(n=i==null?void 0:i.size)!==null&&n!==void 0?n:0,e instanceof od){const s=this._getTypeSize(e.format);e.stride=(r=s==null?void 0:s.size)!==null&&r!==void 0?r:0,this._updateTypeInfo(e.format)}e instanceof Dl&&this._updateStructInfo(e)}_updateStructInfo(e){var n;let r=0,i=0,s=0,o=0;for(let a=0,l=e.members.length;a<l;++a){const c=e.members[a],u=this._getTypeSize(c);if(!u)continue;(n=this._getAlias(c.type.name))!==null&&n!==void 0||c.type;const f=u.align,h=u.size;r=this._roundUp(f,r+i),i=h,s=r,o=Math.max(o,f),c.offset=r,c.size=h,this._updateTypeInfo(c.type)}e.size=this._roundUp(o,s+i),e.align=o}_getTypeSize(e){var n,r;if(e==null)return null;const i=this._getAttributeNum(e.attributes,"size",0),s=this._getAttributeNum(e.attributes,"align",0);if(e instanceof Dv&&(e=e.type),e instanceof ys){const o=this._getAlias(e.name);o!==null&&(e=o)}{const o=zn._typeInfo[e.name];if(o!==void 0){const a=((n=e.format)===null||n===void 0?void 0:n.name)==="f16"?2:1;return new Ll(Math.max(s,o.align/a),Math.max(i,o.size/a))}}{const o=zn._typeInfo[e.name.substring(0,e.name.length-1)];if(o){const a=e.name[e.name.length-1]==="h"?2:1;return new Ll(Math.max(s,o.align/a),Math.max(i,o.size/a))}}if(e instanceof od){let o=e,a=8,l=8;const c=this._getTypeSize(o.format);c!==null&&(l=c.size,a=c.align);const u=o.count,f=this._getAttributeNum((r=e==null?void 0:e.attributes)!==null&&r!==void 0?r:null,"stride",this._roundUp(a,l));return l=u*f,i&&(l=i),new Ll(Math.max(s,a),Math.max(i,l))}if(e instanceof Dl){let o=0,a=0,l=0,c=0,u=0;for(const f of e.members){const h=this._getTypeSize(f.type);h!==null&&(o=Math.max(h.align,o),l=this._roundUp(h.align,l+c),c=h.size,u=l)}return a=this._roundUp(o,u+c),new Ll(Math.max(s,o),Math.max(i,a))}return null}_isUniformVar(e){return e instanceof Yr&&e.storage=="uniform"}_isStorageVar(e){return e instanceof Yr&&e.storage=="storage"}_isTextureVar(e){return e instanceof Yr&&e.type!==null&&zn._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof Yr&&e.type!==null&&zn._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,n){const r=e;if(!r||!r.attributes)return null;const i=r.attributes;for(let s of i)if(s.name==n)return s;return null}_getAttributeNum(e,n,r){if(e===null)return r;for(let i of e)if(i.name==n){let s=i!==null&&i.value!==null?i.value:r;return s instanceof Array&&(s=s[0]),typeof s=="number"?s:typeof s=="string"?parseInt(s):r}return r}_roundUp(e,n){return Math.ceil(n/e)*e}}zn._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}};zn._textureTypes=E.any_texture_type.map(t=>t.name);zn._samplerTypes=E.sampler_type.map(t=>t.name);function h4(t){var s;const e={attributes:[],bindings:[]};let n;try{n=d4(t)}catch(o){return U.error(o.message)(),e}for(const o of n.uniforms){const a=[];for(const l of((s=o.type)==null?void 0:s.members)||[])a.push({name:l.name,type:Uv(l.type)});e.bindings.push({type:"uniform",name:o.name,location:o.binding,group:o.group,members:a})}const r=n.entry.vertex[0],i=(r==null?void 0:r.inputs.length)||0;for(let o=0;o<i;o++){const a=r.inputs[o];if(a.locationType==="location"){const l=Uv(a.type);e.attributes.push({name:a.name,location:Number(a.location),type:l})}}return e}function Uv(t){return t.format?`${t.name}<${t.format.name}>`:t.name}function d4(t){try{return new zn(t)}catch(e){if(e instanceof Error)throw e;let n="WGSL parse error";throw typeof e=="object"&&(e!=null&&e.message)&&(n+=`: ${e.message} `),typeof e=="object"&&(e!=null&&e.token)&&(n+=e.token.line||""),new Error(n,{cause:e})}}const p4=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;
const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;
const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;
const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;
float sin_taylor_fp32(float a) {
float r, s, t, x;
if (a == 0.0) {
return 0.0;
}
x = -a * a;
s = a;
r = a;
r = r * x;
t = r * INVERSE_FACTORIAL_3;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_5;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_7;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_9;
s = s + t;
return s;
}
void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
if (a == 0.0) {
sin_t = 0.0;
cos_t = 1.0;
}
sin_t = sin_taylor_fp32(a);
cos_t = sqrt(1.0 - sin_t * sin_t);
}
float tan_taylor_fp32(float a) {
float sin_a;
float cos_a;
if (a == 0.0) {
return 0.0;
}
float z = floor(a / TWO_PI);
float r = a - TWO_PI * z;
float t;
float q = floor(r / PI_2 + 0.5);
int j = int(q);
if (j < -2 || j > 2) {
return 1.0 / 0.0;
}
t = r - PI_2 * q;
q = floor(t / PI_16 + 0.5);
int k = int(q);
int abs_k = int(abs(float(k)));
if (abs_k > 4) {
return 1.0 / 0.0;
} else {
t = t - PI_16 * q;
}
float u = 0.0;
float v = 0.0;
float sin_t, cos_t;
float s, c;
sincos_taylor_fp32(t, sin_t, cos_t);
if (k == 0) {
s = sin_t;
c = cos_t;
} else {
if (abs(float(abs_k) - 1.0) < 0.5) {
u = COS_TABLE_0;
v = SIN_TABLE_0;
} else if (abs(float(abs_k) - 2.0) < 0.5) {
u = COS_TABLE_1;
v = SIN_TABLE_1;
} else if (abs(float(abs_k) - 3.0) < 0.5) {
u = COS_TABLE_2;
v = SIN_TABLE_2;
} else if (abs(float(abs_k) - 4.0) < 0.5) {
u = COS_TABLE_3;
v = SIN_TABLE_3;
}
if (k > 0) {
s = u * sin_t + v * cos_t;
c = u * cos_t - v * sin_t;
} else {
s = u * sin_t - v * cos_t;
c = u * cos_t + v * sin_t;
}
}
if (j == 0) {
sin_a = s;
cos_a = c;
} else if (j == 1) {
sin_a = c;
cos_a = -s;
} else if (j == -1) {
sin_a = -c;
cos_a = s;
} else {
sin_a = -s;
cos_a = -c;
}
return sin_a / cos_a;
}
#endif
float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
return tan_taylor_fp32(a);
#else
return tan(a);
#endif
}
`,g4={name:"fp32",vs:p4},_4=[0,1,1,1],m4=`uniform pickingUniforms {
float isActive;
float isAttribute;
float isHighlightActive;
float useFloatColors;
vec3 highlightedObjectColor;
vec4 highlightColor;
} picking;
out vec4 picking_vRGBcolor_Avalid;
vec3 picking_normalizeColor(vec3 color) {
return picking.useFloatColors > 0.5 ? color : color / 255.0;
}
vec4 picking_normalizeColor(vec4 color) {
return picking.useFloatColors > 0.5 ? color : color / 255.0;
}
bool picking_isColorZero(vec3 color) {
return dot(color, vec3(1.0)) < 0.00001;
}
bool picking_isColorValid(vec3 color) {
return dot(color, vec3(1.0)) > 0.00001;
}
bool isVertexHighlighted(vec3 vertexColor) {
vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
return
bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}
void picking_setPickingColor(vec3 pickingColor) {
pickingColor = picking_normalizeColor(pickingColor);
if (bool(picking.isActive)) {
picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));
if (!bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rgb = pickingColor;
}
} else {
picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
}
}
void picking_setPickingAttribute(float value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.r = value;
}
}
void picking_setPickingAttribute(vec2 value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rg = value;
}
}
void picking_setPickingAttribute(vec3 value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rgb = value;
}
}
`,y4=`uniform pickingUniforms {
float isActive;
float isAttribute;
float isHighlightActive;
float useFloatColors;
vec3 highlightedObjectColor;
vec4 highlightColor;
} picking;
in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
if (picking.isActive > 0.5) {
return color;
}
bool selected = bool(picking_vRGBcolor_Avalid.a);
if (selected) {
float highLightAlpha = picking.highlightColor.a;
float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
float highLightRatio = highLightAlpha / blendedAlpha;
vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
return vec4(blendedRGB, blendedAlpha);
} else {
return color;
}
}
vec4 picking_filterPickingColor(vec4 color) {
if (bool(picking.isActive)) {
if (picking_vRGBcolor_Avalid.a == 0.0) {
discard;
}
return picking_vRGBcolor_Avalid;
}
return color;
}
vec4 picking_filterColor(vec4 color) {
vec4 highlightColor = picking_filterHighlightColor(color);
return picking_filterPickingColor(highlightColor);
}
`,zv={name:"picking",vs:m4,fs:y4,uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:_4},getUniforms:v4};function v4(t={},e){const n={};if(t.highlightedObjectColor!==void 0)if(t.highlightedObjectColor===null)n.isHighlightActive=!1;else{n.isHighlightActive=!0;const r=t.highlightedObjectColor.slice(0,3);n.highlightedObjectColor=r}if(t.highlightColor){const r=Array.from(t.highlightColor,i=>i/255);Number.isFinite(r[3])||(r[3]=1),n.highlightColor=r}return t.isActive!==void 0&&(n.isActive=!!t.isActive,n.isAttribute=!!t.isAttribute),t.useFloatColors!==void 0&&(n.useFloatColors=!!t.useFloatColors),n}function Kb(t,e=[],n=0){const r=Math.fround(t),i=t-r;return e[n]=r,e[n+1]=i,e}function T4(t){return t-Math.fround(t)}function w4(t){const e=new Float32Array(32);for(let n=0;n<4;++n)for(let r=0;r<4;++r){const i=n*4+r;Kb(t[r*4+n],e,i*2)}return e}const S4=`uniform float ONE;
vec2 split(float a) {
const float SPLIT = 4097.0;
float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float a_hi = t * ONE - (t - a);
float a_lo = a * ONE - a_hi;
#else
float a_hi = t - (t - a);
float a_lo = a - a_hi;
#endif
return vec2(a_hi, a_lo);
}
vec2 split2(vec2 a) {
vec2 b = split(a.x);
b.y += a.y;
return b;
}
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float sum = (a + b) * ONE;
float err = b - (sum - a) * ONE;
#else
float sum = a + b;
float err = b - (sum - a);
#endif
return vec2(sum, err);
}
vec2 twoSum(float a, float b) {
float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float v = (s * ONE - a) * ONE;
float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);
#else
float v = s - a;
float err = (a - (s - v)) + (b - v);
#endif
return vec2(s, err);
}
vec2 twoSub(float a, float b) {
float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float v = (s * ONE - a) * ONE;
float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);
#else
float v = s - a;
float err = (a - (s - v)) - (b + v);
#endif
return vec2(s, err);
}
vec2 twoSqr(float a) {
float prod = a * a;
vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *
a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;
#else
float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
return vec2(prod, err);
}
vec2 twoProd(float a, float b) {
float prod = a * b;
vec2 a_fp64 = split(a);
vec2 b_fp64 = split(b);
float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
return vec2(prod, err);
}
vec2 sum_fp64(vec2 a, vec2 b) {
vec2 s, t;
s = twoSum(a.x, b.x);
t = twoSum(a.y, b.y);
s.y += t.x;
s = quickTwoSum(s.x, s.y);
s.y += t.y;
s = quickTwoSum(s.x, s.y);
return s;
}
vec2 sub_fp64(vec2 a, vec2 b) {
vec2 s, t;
s = twoSub(a.x, b.x);
t = twoSub(a.y, b.y);
s.y += t.x;
s = quickTwoSum(s.x, s.y);
s.y += t.y;
s = quickTwoSum(s.x, s.y);
return s;
}
vec2 mul_fp64(vec2 a, vec2 b) {
vec2 prod = twoProd(a.x, b.x);
prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
prod = split2(prod);
#endif
prod = quickTwoSum(prod.x, prod.y);
prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
prod = split2(prod);
#endif
prod = quickTwoSum(prod.x, prod.y);
return prod;
}
vec2 div_fp64(vec2 a, vec2 b) {
float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
vec2 yn = a * xn;
#endif
float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
vec2 prod = twoProd(xn, diff);
return sum_fp64(yn, prod);
}
vec2 sqrt_fp64(vec2 a) {
if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);
float x = 1.0 / sqrt(a.x);
float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
vec2 yn_sqr = twoSqr(yn) * ONE;
#else
vec2 yn_sqr = twoSqr(yn);
#endif
float diff = sub_fp64(a, yn_sqr).x;
vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
return sum_fp64(split(yn), prod);
#else
return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,E4={ONE:1};function b4(){return E4}const A4={name:"fp64-arithmetic",vs:S4,getUniforms:b4,fp64ify:Kb,fp64LowPart:T4,fp64ifyMatrix4:w4},R4={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...R4}};const St=globalThis.mathgl.config;function x4(t,{precision:e=St.precision}={}){return t=C4(t),`${parseFloat(t.toPrecision(e))}`}function Us(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function pr(t,e,n){return I4(t,r=>Math.max(e,Math.min(n,r)))}function Tu(t,e,n){return Us(t)?t.map((r,i)=>Tu(r,e[i],n)):n*e+(1-n)*t}function wa(t,e,n){const r=St.EPSILON;n&&(St.EPSILON=n);try{if(t===e)return!0;if(Us(t)&&Us(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!wa(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=St.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{St.EPSILON=r}}function C4(t){return Math.round(t/St.EPSILON)*St.EPSILON}function P4(t){return t.clone?t.clone():new Array(t.length)}function I4(t,e,n){if(Us(t)){const r=t;n=n||P4(r);for(let i=0;i<n.length&&i<r.length;++i){const s=typeof t=="number"?t:t[i];n[i]=e(s,i,n)}return n}return e(t)}class qb extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Us(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(St)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+x4(this[r],e);return`${e.printTypes?this.constructor.name:""}[${n}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!wa(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i],o=typeof n=="number"?n:n[i];this[i]=s+r*(o-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(St.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function M4(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Tt(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function ad(t,e,n=""){if(St.debug&&!M4(t,e))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return t}function $v(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}class N4 extends qb{get x(){return this[0]}set x(e){this[0]=Tt(e)}get y(){return this[1]}set y(e){this[1]=Tt(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return Tt(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Tt(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return $v(e>=0&&e<this.ELEMENTS,"index is out of range"),Tt(this[e])}setComponent(e,n){return $v(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}const wc=1e-6;let zs=typeof Float32Array<"u"?Float32Array:Array;function k4(){const t=new zs(2);return zs!=Float32Array&&(t[0]=0,t[1]=0),t}function Vv(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function O4(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Zb(t,e,n,r){const i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function F4(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){const t=k4();return function(e,n,r,i,s,o){let a,l;for(n||(n=2),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function D4(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function Qb(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}function B4(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function L4(){const t=new zs(3);return zs!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function U4(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function z4(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function $4(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function V4(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2];return t[0]=i*l-s*a,t[1]=s*o-r*l,t[2]=r*a-i*o,t}function Jb(t,e,n){const r=e[0],i=e[1],s=e[2];let o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function j4(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function W4(t,e,n){const r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],l=e[1],c=e[2];let u=i*c-s*l,f=s*a-r*c,h=r*l-i*a,d=i*h-s*f,g=s*u-r*h,_=r*f-i*u;const b=o*2;return u*=b,f*=b,h*=b,d*=2,g*=2,_*=2,t[0]=a+u+d,t[1]=l+f+g,t[2]=c+h+_,t}function H4(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function X4(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Y4(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function K4(t,e){const n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],l=Math.sqrt((n*n+r*r+i*i)*(s*s+o*o+a*a)),c=l&&$4(t,e)/l;return Math.acos(Math.min(Math.max(c,-1),1))}const q4=U4;(function(){const t=L4();return function(e,n,r,i,s,o){let a,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const ld=[0,0,0];let Ul;class bn extends N4{static get ZERO(){return Ul||(Ul=new bn(0,0,0),Object.freeze(Ul)),Ul}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&Us(e)?this.copy(e):(St.debug&&(Tt(e),Tt(n),Tt(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return St.debug&&(Tt(e.x),Tt(e.y),Tt(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Tt(e)}angle(e){return K4(this,e)}cross(e){return V4(this,this,e),this.check()}rotateX({radians:e,origin:n=ld}){return H4(this,this,n,e),this.check()}rotateY({radians:e,origin:n=ld}){return X4(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=ld}){return Y4(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Jb(this,this,e),this.check()}transformAsVector(e){return Qb(this,this,e),this.check()}transformByMatrix3(e){return j4(this,this,e),this.check()}transformByMatrix2(e){return B4(this,this,e),this.check()}transformByQuaternion(e){return W4(this,this,e),this.check()}}class Z4 extends qb{toString(){let e="[";if(St.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=` ${this[r*this.RANK+n]}`}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=` ${this[n]}`}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Tt(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function Q4(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function J4(t,e){if(t===e){const n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function og(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],f=e[9],h=e[10],d=e[11],g=e[12],_=e[13],b=e[14],m=e[15],p=n*a-r*o,y=n*l-i*o,w=n*c-s*o,A=r*l-i*a,x=r*c-s*a,I=i*c-s*l,O=u*_-f*g,D=u*b-h*g,z=u*m-d*g,H=f*b-h*_,Y=f*m-d*_,K=h*m-d*b;let Z=p*K-y*Y+w*H+A*z-x*D+I*O;return Z?(Z=1/Z,t[0]=(a*K-l*Y+c*H)*Z,t[1]=(i*Y-r*K-s*H)*Z,t[2]=(_*I-b*x+m*A)*Z,t[3]=(h*x-f*I-d*A)*Z,t[4]=(l*z-o*K-c*D)*Z,t[5]=(n*K-i*z+s*D)*Z,t[6]=(b*w-g*I-m*y)*Z,t[7]=(u*I-h*w+d*y)*Z,t[8]=(o*Y-a*z+c*O)*Z,t[9]=(r*z-n*Y-s*O)*Z,t[10]=(g*x-_*w+m*p)*Z,t[11]=(f*w-u*x-d*p)*Z,t[12]=(a*D-o*H-l*O)*Z,t[13]=(n*H-r*D+i*O)*Z,t[14]=(_*y-g*A-b*p)*Z,t[15]=(u*A-f*y+h*p)*Z,t):null}function G4(t){const e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],f=t[10],h=t[11],d=t[12],g=t[13],_=t[14],b=t[15],m=e*o-n*s,p=e*a-r*s,y=n*a-r*o,w=c*g-u*d,A=c*_-f*d,x=u*_-f*g,I=e*x-n*A+r*w,O=s*x-o*A+a*w,D=c*y-u*p+f*m,z=d*y-g*p+_*m;return l*I-i*O+b*D-h*z}function li(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],f=e[8],h=e[9],d=e[10],g=e[11],_=e[12],b=e[13],m=e[14],p=e[15];let y=n[0],w=n[1],A=n[2],x=n[3];return t[0]=y*r+w*a+A*f+x*_,t[1]=y*i+w*l+A*h+x*b,t[2]=y*s+w*c+A*d+x*m,t[3]=y*o+w*u+A*g+x*p,y=n[4],w=n[5],A=n[6],x=n[7],t[4]=y*r+w*a+A*f+x*_,t[5]=y*i+w*l+A*h+x*b,t[6]=y*s+w*c+A*d+x*m,t[7]=y*o+w*u+A*g+x*p,y=n[8],w=n[9],A=n[10],x=n[11],t[8]=y*r+w*a+A*f+x*_,t[9]=y*i+w*l+A*h+x*b,t[10]=y*s+w*c+A*d+x*m,t[11]=y*o+w*u+A*g+x*p,y=n[12],w=n[13],A=n[14],x=n[15],t[12]=y*r+w*a+A*f+x*_,t[13]=y*i+w*l+A*h+x*b,t[14]=y*s+w*c+A*d+x*m,t[15]=y*o+w*u+A*g+x*p,t}function wu(t,e,n){const r=n[0],i=n[1],s=n[2];let o,a,l,c,u,f,h,d,g,_,b,m;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(o=e[0],a=e[1],l=e[2],c=e[3],u=e[4],f=e[5],h=e[6],d=e[7],g=e[8],_=e[9],b=e[10],m=e[11],t[0]=o,t[1]=a,t[2]=l,t[3]=c,t[4]=u,t[5]=f,t[6]=h,t[7]=d,t[8]=g,t[9]=_,t[10]=b,t[11]=m,t[12]=o*r+u*i+g*s+e[12],t[13]=a*r+f*i+_*s+e[13],t[14]=l*r+h*i+b*s+e[14],t[15]=c*r+d*i+m*s+e[15]),t}function Em(t,e,n){const r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function eB(t,e,n,r){let i=r[0],s=r[1],o=r[2],a=Math.sqrt(i*i+s*s+o*o),l,c,u,f,h,d,g,_,b,m,p,y,w,A,x,I,O,D,z,H,Y,K,Z,Le;return a<wc?null:(a=1/a,i*=a,s*=a,o*=a,c=Math.sin(n),l=Math.cos(n),u=1-l,f=e[0],h=e[1],d=e[2],g=e[3],_=e[4],b=e[5],m=e[6],p=e[7],y=e[8],w=e[9],A=e[10],x=e[11],I=i*i*u+l,O=s*i*u+o*c,D=o*i*u-s*c,z=i*s*u-o*c,H=s*s*u+l,Y=o*s*u+i*c,K=i*o*u+s*c,Z=s*o*u-i*c,Le=o*o*u+l,t[0]=f*I+_*O+y*D,t[1]=h*I+b*O+w*D,t[2]=d*I+m*O+A*D,t[3]=g*I+p*O+x*D,t[4]=f*z+_*H+y*Y,t[5]=h*z+b*H+w*Y,t[6]=d*z+m*H+A*Y,t[7]=g*z+p*H+x*Y,t[8]=f*K+_*Z+y*Le,t[9]=h*K+b*Z+w*Le,t[10]=d*K+m*Z+A*Le,t[11]=g*K+p*Z+x*Le,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Gb(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+c*r,t[5]=o*i+u*r,t[6]=a*i+f*r,t[7]=l*i+h*r,t[8]=c*i-s*r,t[9]=u*i-o*r,t[10]=f*i-a*r,t[11]=h*i-l*r,t}function tB(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-c*r,t[1]=o*i-u*r,t[2]=a*i-f*r,t[3]=l*i-h*r,t[8]=s*r+c*i,t[9]=o*r+u*i,t[10]=a*r+f*i,t[11]=l*r+h*i,t}function eA(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+c*r,t[1]=o*i+u*r,t[2]=a*i+f*r,t[3]=l*i+h*r,t[4]=c*i-s*r,t[5]=u*i-o*r,t[6]=f*i-a*r,t[7]=h*i-l*r,t}function nB(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,f=r*a,h=i*o,d=i*a,g=i*l,_=s*o,b=s*a,m=s*l;return t[0]=1-f-g,t[1]=u+m,t[2]=h-b,t[3]=0,t[4]=u-m,t[5]=1-c-g,t[6]=d+_,t[7]=0,t[8]=h+b,t[9]=d-_,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function rB(t,e,n,r,i,s,o){const a=1/(n-e),l=1/(i-r),c=1/(s-o);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(o+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*c,t[15]=0,t}function iB(t,e,n,r,i){const s=1/Math.tan(e/2);if(t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0){const o=1/(r-i);t[10]=(i+r)*o,t[14]=2*i*r*o}else t[10]=-1,t[14]=-2*r;return t}const sB=iB;function oB(t,e,n,r,i,s,o){const a=1/(e-n),l=1/(r-i),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(o+s)*c,t[15]=1,t}const aB=oB;function lB(t,e,n,r){let i,s,o,a,l,c,u,f,h,d;const g=e[0],_=e[1],b=e[2],m=r[0],p=r[1],y=r[2],w=n[0],A=n[1],x=n[2];return Math.abs(g-w)<wc&&Math.abs(_-A)<wc&&Math.abs(b-x)<wc?Q4(t):(f=g-w,h=_-A,d=b-x,i=1/Math.sqrt(f*f+h*h+d*d),f*=i,h*=i,d*=i,s=p*d-y*h,o=y*f-m*d,a=m*h-p*f,i=Math.sqrt(s*s+o*o+a*a),i?(i=1/i,s*=i,o*=i,a*=i):(s=0,o=0,a=0),l=h*a-d*o,c=d*s-f*a,u=f*o-h*s,i=Math.sqrt(l*l+c*c+u*u),i?(i=1/i,l*=i,c*=i,u*=i):(l=0,c=0,u=0),t[0]=s,t[1]=l,t[2]=f,t[3]=0,t[4]=o,t[5]=c,t[6]=h,t[7]=0,t[8]=a,t[9]=u,t[10]=d,t[11]=0,t[12]=-(s*g+o*_+a*b),t[13]=-(l*g+c*_+u*b),t[14]=-(f*g+h*_+d*b),t[15]=1,t)}function cB(){const t=new zs(4);return zs!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function uB(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function qa(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}(function(){const t=cB();return function(e,n,r,i,s,o){let a,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var ag;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(ag||(ag={}));const fB=45*Math.PI/180,hB=1,cd=.1,ud=500,dB=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class An extends Z4{static get IDENTITY(){return gB()}static get ZERO(){return pB()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return ag}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,o,a,l,c,u,f,h,d,g,_,b){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=u,this[10]=f,this[11]=h,this[12]=d,this[13]=g,this[14]=_,this[15]=b,this.check()}setRowMajor(e,n,r,i,s,o,a,l,c,u,f,h,d,g,_,b){return this[0]=e,this[1]=s,this[2]=c,this[3]=d,this[4]=n,this[5]=o,this[6]=u,this[7]=g,this[8]=r,this[9]=a,this[10]=f,this[11]=_,this[12]=i,this[13]=l,this[14]=h,this[15]=b,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(dB)}fromObject(e){return this.check()}fromQuaternion(e){return nB(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:o=cd,far:a=ud}=e;return a===1/0?_B(this,n,r,i,s,o):rB(this,n,r,i,s,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return lB(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:o=cd,far:a=ud}=e;return aB(this,n,r,i,s,o,a),this.check()}orthographic(e){const{fovy:n=fB,aspect:r=hB,focalDistance:i=1,near:s=cd,far:o=ud}=e;jv(n);const a=n/2,l=i*Math.tan(a),c=l*r;return this.ortho({left:-c,right:c,bottom:-l,top:l,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return jv(n),sB(this,n,r,i,s),this.check()}determinant(){return G4(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return J4(this,this),this.check()}invert(){return og(this,this),this.check()}multiplyLeft(e){return li(this,e,this),this.check()}multiplyRight(e){return li(this,this,e),this.check()}rotateX(e){return Gb(this,this,e),this.check()}rotateY(e){return tB(this,this,e),this.check()}rotateZ(e){return eA(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return eB(this,this,e,n),this.check()}scale(e){return Em(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return wu(this,this,e),this.check()}transform(e,n){return e.length===4?(n=qa(n||[-0,-0,-0,-0],e,this),ad(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=F4(n||[-0,-0],e,this);break;case 3:i=Jb(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return ad(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=D4(n||[-0,-0],e,this);break;case 3:r=Qb(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return ad(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let zl,$l;function pB(){return zl||(zl=new An([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(zl)),zl}function gB(){return $l||($l=new An,Object.freeze($l)),$l}function jv(t){if(t>Math.PI*2)throw Error("expected radians")}function _B(t,e,n,r,i,s){const o=2*s/(n-e),a=2*s/(i-r),l=(n+e)/(n-e),c=(i+r)/(i-r),u=-1,f=-1,h=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=c,t[10]=u,t[11]=f,t[12]=0,t[13]=0,t[14]=h,t[15]=0,t}const Wv=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
vec3 color;
};
struct PointLight {
vec3 color;
vec3 position;
vec3 attenuation;
};
struct DirectionalLight {
vec3 color;
vec3 direction;
};
uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;
uniform bool lighting_uEnabled;
float getPointLightAttenuation(PointLight pointLight, float distance) {
return pointLight.attenuation.x
+ pointLight.attenuation.y * distance
+ pointLight.attenuation.z * distance * distance;
}
#endif
`,mB={lightSources:{}};function fd(t={}){const{color:e=[0,0,0],intensity:n=1}=t;return e.map(r=>r*n/255)}function yB({ambientLight:t,pointLights:e=[],directionalLights:n=[]}){const r={};return t?r["lighting_uAmbientLight.color"]=fd(t):r["lighting_uAmbientLight.color"]=[0,0,0],e.forEach((i,s)=>{r[`lighting_uPointLight[${s}].color`]=fd(i),r[`lighting_uPointLight[${s}].position`]=i.position,r[`lighting_uPointLight[${s}].attenuation`]=i.attenuation||[1,0,0]}),r.lighting_uPointLightCount=e.length,n.forEach((i,s)=>{r[`lighting_uDirectionalLight[${s}].color`]=fd(i),r[`lighting_uDirectionalLight[${s}].direction`]=i.direction}),r.lighting_uDirectionalLightCount=n.length,r}function tA(t=mB){var e,n;if("lightSources"in t){const{ambientLight:r,pointLights:i,directionalLights:s}=t.lightSources||{};return r||i&&i.length>0||s&&s.length>0?Object.assign({},yB({ambientLight:r,pointLights:i,directionalLights:s}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const r={pointLights:[],directionalLights:[]};for(const i of t.lights||[])switch(i.type){case"ambient":r.ambientLight=i;break;case"directional":(e=r.directionalLights)==null||e.push(i);break;case"point":(n=r.pointLights)==null||n.push(i);break}return tA({lightSources:r})}return{}}const vB={name:"lights",vs:Wv,fs:Wv,getUniforms:tA,defines:{MAX_LIGHTS:3}},TB=`uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;
vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
vec3 halfway_direction = normalize(light_direction + view_direction);
float lambertian = dot(light_direction, normal_worldspace);
float specular = 0.0;
if (lambertian > 0.0) {
float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
specular = pow(specular_angle, lighting_uShininess);
}
lambertian = max(lambertian, 0.0);
return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}
vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
vec3 lightColor = surfaceColor;
if (lighting_uEnabled) {
vec3 view_direction = normalize(cameraPosition - position_worldspace);
lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uPointLightCount) {
break;
}
PointLight pointLight = lighting_uPointLight[i];
vec3 light_position_worldspace = pointLight.position;
vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
}
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uDirectionalLightCount) {
break;
}
DirectionalLight directionalLight = lighting_uDirectionalLight[i];
lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
}
}
return lightColor;
}
vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
vec3 lightColor = vec3(0, 0, 0);
vec3 surfaceColor = vec3(0, 0, 0);
if (lighting_uEnabled) {
vec3 view_direction = normalize(cameraPosition - position_worldspace);
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uPointLightCount) {
break;
}
PointLight pointLight = lighting_uPointLight[i];
vec3 light_position_worldspace = pointLight.position;
vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
}
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uDirectionalLightCount) {
break;
}
DirectionalLight directionalLight = lighting_uDirectionalLight[i];
lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
}
}
return lightColor;
}
`,wB={};function SB(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function EB(t=wB){if(!("material"in t))return{};const{material:e}=t;return e?SB(e):{lighting_uEnabled:!1}}const bB={name:"gouraud-lighting",dependencies:[vB],vs:TB,defines:{LIGHTING_VERTEX:1},getUniforms:EB},nA="#define SMOOTH_EDGE_RADIUS 0.5",AB=`
${nA}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,RB=`
${nA}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,xB={name:"geometry",vs:AB,fs:RB},ie={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(ie,"IDENTITY",{get:()=>(G.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Tn={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},gi={common:0,meters:1,pixels:2},lg={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},CB=Object.keys(ie).map(t=>`const int COORDINATE_SYSTEM_${t} = ${ie[t]};`).join(""),PB=Object.keys(Tn).map(t=>`const int PROJECTION_MODE_${t} = ${Tn[t]};`).join(""),IB=Object.keys(gi).map(t=>`const int UNIT_${t.toUpperCase()} = ${gi[t]};`).join(""),MB=`${CB}
${PB}
${IB}
uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project_uPseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project_uCommonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project_uCommonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project_uCommonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project_uWrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project_uModelMatrix * position;
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project_uCoordinateOrigin;
}
}
if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
(project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project_uCoordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
return offset * project_uFocalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project_uScale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project_uScale;
}
`;function NB(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function Za(t){let e={},n;return r=>{for(const i in r)if(!NB(r[i],e[i])){n=t(r),e=r;break}return n}}const Hv=[0,0,0,0],kB=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],rA=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],OB=[0,0,0],iA=[0,0,0],FB=Za(LB);function sA(t,e,n=iA){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===ie.LNGLAT_OFFSETS||e===ie.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Tn.WEB_MERCATOR:(e===ie.LNGLAT||e===ie.CARTESIAN)&&(i=[0,0,0],s=!1);break;case Tn.WEB_MERCATOR_AUTO_OFFSET:e===ie.LNGLAT?r=i:e===ie.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case Tn.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case Tn.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function DB(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=Hv,l=Hv,c=t.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:f,offsetMode:h}=sA(t,e,n);return h&&(l=t.projectPosition(u||f),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=qa([],l,o),s=r||s,o=li([],i,s),o=li([],o,kB)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:f,geospatialOrigin:u}}function BB({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=ie.DEFAULT,coordinateOrigin:i=iA,autoWrapLongitude:s=!1}){r===ie.DEFAULT&&(r=t.isGeospatial?ie.LNGLAT:ie.CARTESIAN);const o=FB({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.project_uWrapLongitude=s,o.project_uModelMatrix=n||rA,o}function LB({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=DB(t,n,r),u=t.getDistanceScales(),f=[t.width*e,t.height*e],h=qa([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,d={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:f,project_uDevicePixelRatio:e,project_uFocalDistance:h,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:OB,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:rA,project_uCameraPosition:a};if(c){const g=t.getDistanceScales(c);switch(n){case ie.METER_OFFSETS:d.project_uCommonUnitsPerWorldUnit=g.unitsPerMeter,d.project_uCommonUnitsPerWorldUnit2=g.unitsPerMeter2;break;case ie.LNGLAT:case ie.LNGLAT_OFFSETS:t._pseudoMeters||(d.project_uCommonUnitsPerMeter=g.unitsPerMeter),d.project_uCommonUnitsPerWorldUnit=g.unitsPerDegree,d.project_uCommonUnitsPerWorldUnit2=g.unitsPerDegree2;break;case ie.CARTESIAN:d.project_uCommonUnitsPerWorldUnit=[1,1,g.unitsPerMeter[2]],d.project_uCommonUnitsPerWorldUnit2=[0,0,g.unitsPerMeter2[2]];break}}return d}const UB={};function zB(t=UB){return"viewport"in t?BB(t):{}}const bm={name:"project",dependencies:[g4,xB],vs:MB,getUniforms:zB},$B=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Qa={name:"project32",dependencies:[bm],vs:$B};function VB(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function vs(t,e){const n=qa([],e,t);return uB(n,n,1/n[3]),n}function Xv(t,e){const n=t%e;return n<0?e+n:n}function cg(t,e,n){return t<e?e:t>n?n:t}function jB(t){return Math.log(t)*Math.LOG2E}const Am=Math.log2||jB;function Xn(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const qt=Math.PI,oA=qt/4,Bt=qt/180,ug=180/qt,$s=512,Su=4003e4,Vl=85.051129,WB=1.5;function HB(t){return Am(t)}function Sa(t){const[e,n]=t;Xn(Number.isFinite(e)),Xn(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*Bt,i=n*Bt,s=$s*(r+qt)/(2*qt),o=$s*(qt+Math.log(Math.tan(oA+i*.5)))/(2*qt);return[s,o]}function Vs(t){const[e,n]=t,r=e/$s*(2*qt)-qt,i=2*(Math.atan(Math.exp(n/$s*(2*qt)-qt))-oA);return[r*ug,i*ug]}function XB(t){const{latitude:e}=t;Xn(Number.isFinite(e));const n=Math.cos(e*Bt);return HB(Su*n)-9}function Sc(t){const e=Math.cos(t*Bt);return $s/Su/e}function fg(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;Xn(Number.isFinite(e)&&Number.isFinite(n));const i=$s,s=Math.cos(e*Bt),o=i/360,a=o/s,l=i/Su/s,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[1/o,1/a,1/l]};if(r){const u=Bt*Math.tan(e*Bt)/s,f=o*u/2,h=i/Su*u,d=h/a*l;c.unitsPerDegree2=[0,f,h],c.unitsPerMeter2=[d,0,d]}return c}function aA(t,e){const[n,r,i]=t,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=fg({longitude:n,latitude:r,highPrecision:!0}),u=Sa(t);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const f=Vs(u),h=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[f[0],f[1],h]:f}function YB(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:o}=t,a=VB();wu(a,a,[0,0,-i]),Gb(a,a,-n*Bt),eA(a,a,r*Bt);const l=s/e;return Em(a,a,[l,l,l]),o&&wu(a,a,z4([],o)),a}function KB(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=t;let{fovy:u=Eu(WB)}=t;r!==void 0&&(u=Eu(r));const f=u*Bt,h=i*Bt,d=lA(u);let g=d;o&&(g+=o[2]*a/Math.cos(h)/n);const _=f*(.5+(s?s[1]:0)/n),b=Math.sin(_)*g/Math.sin(cg(Math.PI/2-h-_,.01,Math.PI-.01)),m=Math.sin(h)*b+g,p=g*10,y=Math.min(m*c,p);return{fov:f,aspect:e/n,focalDistance:d,near:l,far:y}}function Eu(t){return 2*Math.atan(.5/t)*ug}function lA(t){return .5/Math.tan(.5*t*Bt)}function cA(t,e){const[n,r,i=0]=t;return Xn(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),vs(e,[n,r,i,1])}function Rm(t,e,n=0){const[r,i,s]=t;if(Xn(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return vs(e,[r,i,s,1]);const o=vs(e,[r,i,0,1]),a=vs(e,[r,i,1,1]),l=o[2],c=a[2],u=l===c?0:((n||0)-l)/(c-l);return Zb([],o,a,u)}function qB(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,l],[c,u]]=r,f=ZB(t.padding),h=Sa([a,cg(u,-Vl,Vl)]),d=Sa([c,cg(l,-Vl,Vl)]),g=[Math.max(Math.abs(d[0]-h[0]),i),Math.max(Math.abs(d[1]-h[1]),i)],_=[e-f.left-f.right-Math.abs(o[0])*2,n-f.top-f.bottom-Math.abs(o[1])*2];Xn(_[0]>0&&_[1]>0);const b=_[0]/g[0],m=_[1]/g[1],p=(f.right-f.left)/2/b,y=(f.top-f.bottom)/2/m,w=[(d[0]+h[0])/2+p,(d[1]+h[1])/2+y],A=Vs(w),x=Math.min(s,Am(Math.abs(Math.min(b,m))));return Xn(Number.isFinite(x)),{longitude:A[0],latitude:A[1],zoom:x}}function ZB(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Xn(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const Yv=Math.PI/180;function QB(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},o=i([0,r],s),a=i([n,r],s);let l,c;const u=t.fovy?.5*t.fovy*Yv:Math.atan(.5/t.altitude),f=(90-t.pitch)*Yv;return u>f-.01?(l=Kv(t,0,e),c=Kv(t,n,e)):(l=i([0,0],s),c=i([n,0],s)),[o,a,c,l]}function Kv(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=vs(r,[e,0,1,1]),s=vs(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),l=Zb([],i,s,a),c=Vs(l);return c.push(n),c}const qv=512;function JB(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=t;(i<-180||i>180)&&(i=Xv(i+180,360)-180),(a<-180||a>180)&&(a=Xv(a+180,360)-180);const l=Am(n/qv);if(o<=l)o=l,s=0;else{const c=n/2/Math.pow(2,o),u=Vs([0,c])[1];if(s<u)s=u;else{const f=Vs([0,qv-c])[1];s>f&&(s=f)}}return{width:e,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}const GB=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,e6=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,t6=Za(o6),n6=Za(a6),r6=[0,0,0,1],i6=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function s6(t,e){const[n,r,i]=t,s=Rm([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function o6({viewport:t,center:e}){return new An(t.viewProjectionMatrix).invert().transform(e)}function a6({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>s6(o,r));for(const o of e){const a=o.clone().translate(new bn(t.center).negate()),l=s.map(u=>a.transform(u)),c=new An().ortho({left:Math.min(...l.map(u=>u[0])),right:Math.max(...l.map(u=>u[0])),bottom:Math.min(...l.map(u=>u[1])),top:Math.max(...l.map(u=>u[1])),near:Math.min(...l.map(u=>-u[2])),far:Math.max(...l.map(u=>-u[2]))});n.push(c.multiplyRight(o))}return n}function l6(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||r6,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=t6({viewport:t.viewport,center:e.project_uCenter}),s=[],o=n6({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const l=o[a],c=l.clone().translate(new bn(t.viewport.center).negate());e.project_uCoordinateSystem===ie.LNGLAT&&e.project_uProjectionMode===Tn.WEB_MERCATOR?(o[a]=c,s[a]=i):(o[a]=l.clone().multiplyRight(i6),s[a]=c.transform(i))}for(let a=0;a<o.length;a++)r[`shadow_uViewProjectionMatrices[${a}]`]=o[a],r[`shadow_uProjectCenters[${a}]`]=s[a];for(let a=0;a<2;a++)r[`shadow_uShadowMap${a}`]=t.shadowMaps&&t.shadowMaps[a]||t.dummyShadowMap;return r}const Zv={name:"shadow",dependencies:[bm],vs:GB,fs:e6,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?l6(t,e):{}},Ja={...zv,defaultUniforms:{...zv.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},c6=[bm],u6=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function f6(){const t=fu.getDefaultShaderAssembler();for(const e of c6)t.addDefaultModule(e);for(const e of u6)t.addShaderHook(e);return t}const h6=[255,255,255],d6=1;let p6=0;class g6{constructor(e={}){this.type="ambient";const{color:n=h6}=e,{intensity:r=d6}=e;this.id=e.id||`ambient-${p6++}`,this.color=n,this.intensity=r}}const _6=[255,255,255],m6=1,y6=[0,0,-1];let v6=0;class Qv{constructor(e={}){this.type="directional";const{color:n=_6}=e,{intensity:r=m6}=e,{direction:i=y6}=e,{_shadow:s=!1}=e;this.id=e.id||`directional-${v6++}`,this.color=n,this.intensity=r,this.type="directional",this.direction=new bn(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class T6{constructor(e,n={id:"pass"}){const{id:r}=n;this.id=r,this.device=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class xm extends T6{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[n,r]=this.device.canvasContext.getDrawingBufferSize(),i=e.clearCanvas??!0,s=e.clearColor??(i?[0,0,0,0]:!1),o=i?1:!1,a=i?0:!1,l=e.colorMask??15,c={viewport:[0,0,n,r]};e.colorMask&&(c.colorMask=l),e.scissorRect&&(c.scissorRect=e.scissorRect);const u=this.device.beginRenderPass({framebuffer:e.target,parameters:c,clearColor:s,clearDepth:o,clearStencil:a});try{return this._drawLayers(u,e)}finally{u.end()}}_drawLayers(e,n){const{target:r,moduleParameters:i,viewports:s,views:o,onViewportActive:a,clearStack:l=!0}=n;n.pass=n.pass||"unknown",l&&(this._lastRenderIndex=-1);const c=[];for(const u of s){const f=o&&o[u.id];a==null||a(u);const h=this._getDrawLayerParams(u,n),d=u.subViewports||[u];for(const g of d){const _=this._drawLayersInViewport(e,{target:r,moduleParameters:i,viewport:g,view:f,pass:n.pass,layers:n.layers},h);c.push(_)}}return c}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:o,effects:a,moduleParameters:l},c=!1){var g;const u=[],f=uA(this._lastRenderIndex+1),h={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:o},d={};for(let _=0;_<n.length;_++){const b=n[_],m=this._shouldDrawLayer(b,h,s,d),p={shouldDrawLayer:m};m&&!c&&(p.layerRenderIndex=f(b,m),p.moduleParameters=this._getModuleParameters(b,a,r,l),p.layerParameters={...(g=b.context.deck)==null?void 0:g.props.parameters,...this.getLayerParameters(b,_,e)}),u[_]=p}return u}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:o,view:a},l){const c=w6(this.device,{moduleParameters:r,target:s,viewport:o});if(a&&a.props.clear){const f=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;this.device.withParametersWebGL({scissorTest:!0,scissor:c},()=>this.device.clearWebGL(f))}const u={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:c});for(let f=0;f<n.length;f++){const h=n[f],{shouldDrawLayer:d,layerRenderIndex:g,moduleParameters:_,layerParameters:b}=l[f];if(d&&h.props.pickable&&u.pickableCount++,h.isComposite)u.compositeCount++;else if(d){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,g),_.viewport=o,h.context.renderPass=e;try{h._drawLayer({renderPass:e,moduleParameters:_,uniforms:{layerIndex:g},parameters:b})}catch(m){h.raiseError(m,`drawing ${h} to ${i}`)}}}return u}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(r){const a=n.layer.id;if(a in i||(i[a]=r(n)),!i[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var a,l;const s=this.device.canvasContext.cssToDeviceRatio(),o=Object.assign(Object.create(((a=e.internalState)==null?void 0:a.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,picking:{isActive:0},devicePixelRatio:s});if(n)for(const c of n)Object.assign(o,(l=c.getModuleParameters)==null?void 0:l.call(c,e));return Object.assign(o,this.getModuleParameters(e,n),i)}}function uA(t=0,e={}){const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,l=i.parent&&i.parent.id;let c;if(l&&!(l in e)&&r(i.parent,!1),l in n){const u=n[l]=n[l]||uA(e[l],e);c=u(i,s),n[a]=u}else Number.isFinite(o)?(c=o+(e[l]||0),n[a]=null):c=t;return s&&c>=t&&(t=c+1),e[a]=c,c};return r}function w6(t,{moduleParameters:e,target:n,viewport:r}){const i=e&&e.devicePixelRatio||t.canvasContext.cssToDeviceRatio(),[,s]=t.canvasContext.getDrawingBufferSize(),o=n?n.height:s,a=r;return[a.x*i,o-(a.y+a.height)*i,a.width*i,a.height*i]}class S6 extends xm{constructor(e,n){super(e,n),this.shadowMap=e.createTexture({width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),this.depthBuffer=e.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1,dataFormat:6402,type:5125}),this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[this.shadowMap],depthStencilAttachment:this.depthBuffer})}render(e){const n=this.fbo,r=this.device.canvasContext.cssToDeviceRatio(),i=e.viewports[0],s=i.width*r,o=i.height*r,a=[1,1,1,1];(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,clearColor:a,target:n,pass:"shadow"})}getLayerParameters(e,n,r){return{...e.props.parameters,blend:!1,depthRange:[0,1],depthTest:!0}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null),this.shadowMap&&(this.shadowMap.destroy(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.destroy(),this.depthBuffer=null)}}const E6={color:[255,255,255],intensity:1},Jv=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],b6=[0,0,0,200/255];class fA{constructor(e={}){this.id="lighting-effect",this.shadowColor=b6,this.shadow=!1,this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:n,deck:r}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(n),r._addDefaultShaderModule(Zv),this.dummyShadowMap=n.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:s}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let o=0;o<this.shadowPasses.length;o++)this.shadowPasses[o].render({layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:s,moduleParameters:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(e){for(const n of this.shadowPasses)n.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(Zv))}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new An().lookAt({eye:new bn(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new S6(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new g6(E6),this.directionalLights.push(new Qv(Jv[0]),new Qv(Jv[1])))}}class A6{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=i||e&&e.constructor||Float32Array,u=n*r+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let f=1/0;l&&(f=l*r+s);const h=this._allocate(c,u,a,f);return e&&o?h.set(e):a||h.fill(0,0,4),this._release(e),h}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return r&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(o=>o.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const js=new A6;function Io(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function R6(t){return[t[12],t[13],t[14]]}function x6(t){return{left:Ui(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Ui(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Ui(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Ui(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Ui(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Ui(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const Gv=new bn;function Ui(t,e,n,r){Gv.set(t,e,n);const i=Gv.len();return{distance:r/i,normal:new bn(-t/i,-e/i,-n/i)}}function C6(t){return t-Math.fround(t)}let mo;function hd(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;mo=js.allocate(mo,s,{type:Float32Array,size:n*2});let o=r,a=0;for(;o<i;){for(let l=0;l<n;l++){const c=t[o++];mo[a+l]=c,mo[a+l+n]=C6(c)}a+=n*2}return mo.subarray(0,s*n*2)}function P6(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const I6=Math.PI/180,M6=Io(),eT=[0,0,0],N6={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function k6({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:o,far:a}){const l=t/e,c=n?new An().orthographic({fovy:r,aspect:l,focalDistance:i,near:o,far:a}):new An().perspective({fovy:r,aspect:l,near:o,far:a});if(s){const{left:u=0,right:f=0,top:h=0,bottom:d=0}=s,g=pr((u+t-f)/2,0,t)-t/2,_=pr((h+e-d)/2,0,e)-e/2;c[8]-=g*2/t,c[9]+=_*2/e}return c}const Xu=class Xu{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||N6,this.focalDistance=e.focalDistance||1,this.position=e.position||eT,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Tn.WEB_MERCATOR:Tn.WEB_MERCATOR_AUTO_OFFSET:Tn.IDENTITY}equals(e){return e instanceof Xu?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&wa(e.projectionMatrix,this.projectionMatrix)&&wa(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=cA(r,this.pixelProjectionMatrix),[s,o]=i,a=n?o:this.height-o;return e.length===2?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,l=r&&r*this.distanceScales.unitsPerMeter[2],c=Rm([i,a,o],this.pixelUnprojectionMatrix,l),[u,f,h]=this.unprojectPosition(c);return Number.isFinite(o)?[u,f,h]:Number.isFinite(r)?[u,f,r]:[u,f]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=Sa(e);return n[1]=pr(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?Vs(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}getDistanceScales(e){return e?fg({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,x6(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=XB({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||fg({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:o}=e;let a=eT;if(s&&(a=o?new An(o).transformAsVector(s,[]):s),this.isGeospatial){const l=this.projectPosition([n,r,0]);this.center=new bn(a).scale(this.distanceScales.unitsPerMeter).add(l)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=M6,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,padding:c=null,focalDistance:u=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new An().multiplyRight(n).translate(new bn(this.center).negate()),this.projectionMatrix=r||k6({width:this.width,height:this.height,orthographic:i,fovyRadians:s||o*I6,focalDistance:u,padding:c,near:a,far:l});const f=Io();li(f,f,this.projectionMatrix),li(f,f,this.viewMatrix),this.viewProjectionMatrix=f,this.viewMatrixInverse=og([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=R6(this.viewMatrixInverse);const h=Io(),d=Io();Em(h,h,[this.width/2,-this.height/2,1]),wu(h,h,[1,-1,0]),li(d,h,this.viewProjectionMatrix),this.pixelProjectionMatrix=d,this.pixelUnprojectionMatrix=og(Io(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||G.warn("Pixel project matrix not invertible")()}};Xu.displayName="Viewport";let bu=Xu;const Qo=class Qo extends bu{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:l=1.01,nearZ:c,farZ:u,orthographic:f=!1,projectionMatrix:h,repeat:d=!1,worldOffset:g=0,position:_,padding:b,legacyMeterSizes:m=!1}=e;let{width:p,height:y,altitude:w=1.5}=e;const A=Math.pow(2,i);p=p||1,y=y||1;let x,I=null;if(h)w=h[5]/2,x=Eu(w);else{e.fovy?(x=e.fovy,w=lA(x)):x=Eu(w);let D;if(b){const{top:z=0,bottom:H=0}=b;D=[0,pr((z+y-H)/2,0,y)-y/2]}I=KB({width:p,height:y,scale:A,center:_&&[0,0,_[2]*Sc(n)],offset:D,pitch:s,fovy:x,nearZMultiplier:a,farZMultiplier:l}),Number.isFinite(c)&&(I.near=c),Number.isFinite(u)&&(I.far=u)}let O=YB({height:y,pitch:s,bearing:o,scale:A,altitude:w});g&&(O=new An().translate([512*g,0,0]).multiplyLeft(O)),super({...e,width:p,height:y,viewMatrix:O,longitude:r,latitude:n,zoom:i,...I,fovy:x,focalDistance:w}),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=w,this.fovy=x,this.orthographic=f,this._subViewports=d?[]:null,this._pseudoMeters=m,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new Qo({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*Sc(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/Sc(r);return[n,r,i]}addMetersToLngLat(e,n){return aA(e,n)}panByPosition(e,n){const r=Rm(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=Vv([],i,O4([],r)),o=Vv([],this.center,s),[a,l]=this.unprojectFlat(o);return{longitude:a,latitude:l}}getBounds(e={}){const n=QB(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=qB({width:r,height:i,bounds:e,...n});return new Qo({width:r,height:i,longitude:s,latitude:o,zoom:a})}};Qo.displayName="WebMercatorViewport";let Ea=Qo;const tT=[0,0,0];function dd(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof Ea){const[i,s,o=0]=t,a=e.getDistanceScales([i,s]);r[2]=o*a.unitsPerMeter[2]}return r}function O6(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return i===ie.DEFAULT&&(i=e.isGeospatial?ie.LNGLAT:ie.CARTESIAN),s===void 0&&(s=i),o===void 0&&(o=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function hA(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,l=0]=t;switch(n&&([o,a,l]=qa([],[o,a,l,1],n)),r){case ie.LNGLAT:return dd([o,a,l],e,s);case ie.LNGLAT_OFFSETS:return dd([o+i[0],a+i[1],l+(i[2]||0)],e,s);case ie.METER_OFFSETS:return dd(aA(i,[o,a,l]),e,s);case ie.CARTESIAN:default:return e.isGeospatial?[o+i[0],a+i[1],l+i[2]]:e.projectPosition([o,a,l])}}function F6(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=O6(e),{autoOffset:l=!0}=e,{geospatialOrigin:c=tT,shaderCoordinateOrigin:u=tT,offsetMode:f=!1}=l?sA(n,r,i):{},h=hA(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:f});if(f){const d=n.projectPosition(c||u);q4(h,h,d)}return h}let D6=1,B6=1;class dA{constructor(){T(this,"time",0);T(this,"channels",new Map);T(this,"animations",new Map);T(this,"playing",!1);T(this,"lastEngineTime",-1)}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,o=D6++,a={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:o}=i;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=B6++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}let L6=0;const U6={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:t=>console.error(t),stats:ms.stats.get(`animation-loop-${L6++}`),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class z6{constructor(e){T(this,"device",null);T(this,"canvas",null);T(this,"props");T(this,"animationProps",null);T(this,"timeline",null);T(this,"stats");T(this,"cpuTime");T(this,"gpuTime");T(this,"frameRate");T(this,"display");T(this,"needsRedraw","initialized");T(this,"_initialized",!1);T(this,"_running",!1);T(this,"_animationFrameId",null);T(this,"_nextFramePromise",null);T(this,"_resolveNextFrame",null);T(this,"_cpuStartTime",0);if(this.props={...U6,...e},e=this.props,!e.device)throw new Error("No device provided");const{useDevicePixels:n=!0}=this.props;this.stats=e.stats||new jf({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:n}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const n=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(n),n}}stop(){return this._running&&(this.animationProps&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){var e;return(e=this.device)!=null&&e.isLost?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=CD(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(PD(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),this.device.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){var e,n;if(!this.device)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:(n=(e=this.device)==null?void 0:e.canvasContext)==null?void 0:n.canvas,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){var e;if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=((e=this.device.canvasContext)==null?void 0:e.canvas)||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){var s,o,a,l;if(!this.device)return{width:1,height:1,aspect:1};const[e,n]=((o=(s=this.device)==null?void 0:s.canvasContext)==null?void 0:o.getPixelSize())||[1,1];let r=1;const i=(l=(a=this.device)==null?void 0:a.canvasContext)==null?void 0:l.canvas;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){var e,n;this.props.autoResizeDrawingBuffer&&((n=(e=this.device)==null?void 0:e.canvasContext)==null||n.resize({useDevicePixels:this.props.useDevicePixels}))}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}class nT{constructor(e){T(this,"id");T(this,"userData",{});T(this,"topology");T(this,"bufferLayout",[]);T(this,"vertexCount");T(this,"indices");T(this,"attributes");this.id=e.id||Ai("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&ge(this.indices.usage===Te.INDEX)}destroy(){var e;(e=this.indices)==null||e.destroy();for(const n of Object.values(this.attributes))n.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices}_calculateVertexCount(e){return e.byteLength/12}}function $6(t,e){if(e instanceof nT)return e;const n=V6(t,e),{attributes:r,bufferLayout:i}=j6(t,e);return new nT({topology:e.topology||"triangle-list",bufferLayout:i,vertexCount:e.vertexCount,indices:n,attributes:r})}function V6(t,e){if(!e.indices)return;const n=e.indices.value;return t.createBuffer({usage:Te.INDEX,data:n})}function j6(t,e){const n=[],r={};for(const[s,o]of Object.entries(e.attributes)){let a=s;switch(s){case"POSITION":a="positions";break;case"NORMAL":a="normals";break;case"TEXCOORD_0":a="texCoords";break;case"COLOR_0":a="colors";break}r[a]=t.createBuffer({data:o.value,id:`${s}-buffer`});const{value:l,size:c,normalized:u}=o;n.push({name:a,format:ED(l,c,u)})}const i=e._calculateVertexCount(e.attributes,e.indices);return{attributes:r,bufferLayout:n,vertexCount:i}}class W6{constructor(e){T(this,"modules");T(this,"moduleUniforms");T(this,"moduleBindings");T(this,"moduleUniformsChanged");const n=Hf(Object.values(e).filter(r=>r.dependencies));for(const r of n)e[r.name]=r;U.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[r,i]of Object.entries(e)){const s=r;this.moduleUniforms[s]=i.defaultUniforms||{},this.moduleBindings[s]={}}}destroy(){}setProps(e){var n;for(const r of Object.keys(e)){const i=r,s=e[i],o=this.modules[i];if(!o){U.warn(`Module ${r} not found`)();continue}const a=this.moduleUniforms[i],l=this.moduleBindings[i],c=((n=o.getUniforms)==null?void 0:n.call(o,s,a))||s,{uniforms:u,bindings:f}=Sm(c);this.moduleUniforms[i]={...a,...u},this.moduleBindings[i]={...l,...f}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindings(){const e={};for(const n of Object.values(this.moduleBindings))Object.assign(e,n);return e}getDebugTable(){var n;const e={};for(const[r,i]of Object.entries(this.moduleUniforms))for(const[s,o]of Object.entries(i))e[`${r}.${s}`]={type:(n=this.modules[r].uniformTypes)==null?void 0:n[s],value:String(o)};return e}}const Yu=class Yu{constructor(e){T(this,"device");T(this,"_hashCounter",0);T(this,"_hashes",{});T(this,"_renderPipelineCache",{});T(this,"_computePipelineCache",{});this.device=e}static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new Yu(e),e._lumaData.defaultPipelineFactory}createRenderPipeline(e){const n={...Bs.defaultProps,...e},r=this._hashRenderPipeline(n);if(!this._renderPipelineCache[r]){const i=this.device.createRenderPipeline({...n,id:n.id?`${n.id}-cached`:void 0});i.hash=r,this._renderPipelineCache[r]={pipeline:i,useCount:0}}return this._renderPipelineCache[r].useCount++,this._renderPipelineCache[r].pipeline}createComputePipeline(e){const n={...mu.defaultProps,...e},r=this._hashComputePipeline(n);if(!this._computePipelineCache[r]){const i=this.device.createComputePipeline({...n,id:n.id?`${n.id}-cached`:void 0});i.hash=r,this._computePipelineCache[r]={pipeline:i,useCount:0}}return this._computePipelineCache[r].useCount++,this._computePipelineCache[r].pipeline}release(e){const n=e.hash,r=e instanceof mu?this._computePipelineCache:this._renderPipelineCache;r[n].useCount--,r[n].useCount===0&&(r[n].pipeline.destroy(),delete r[n])}_hashComputePipeline(e){return`${this._getHash(e.shader.source)}`}_hashRenderPipeline(e){const n=this._getHash(e.vs.source),r=e.fs?this._getHash(e.fs.source):0,i="-",s=this._getHash(JSON.stringify(e.bufferLayout));switch(this.device.type){case"webgl":return`${n}/${r}V${i}BL${s}`;default:const o=this._getHash(JSON.stringify(e.parameters));return`${n}/${r}V${i}T${e.topology}P${o}BL${s}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}};T(Yu,"defaultProps",{...Bs.defaultProps});let hg=Yu;const Ku=class Ku{constructor(e){T(this,"device");T(this,"_cache",{});this.device=e}static getDefaultShaderFactory(e){var n;return(n=e._lumaData).defaultShaderFactory||(n.defaultShaderFactory=new Ku(e)),e._lumaData.defaultShaderFactory}createShader(e){const n=this._hashShader(e);let r=this._cache[n];if(!r){const i=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[n]=r={shader:i,useCount:0}}return r.useCount++,r.shader}release(e){const n=this._hashShader(e),r=this._cache[n];r&&(r.useCount--,r.useCount===0&&(delete this._cache[n],r.shader.destroy()))}_hashShader(e){return`${e.stage}:${e.source}`}};T(Ku,"defaultProps",{...pu.defaultProps});let dg=Ku;function H6(t,e){var i;const n={},r="Values";if(t.attributes.length===0&&!((i=t.varyings)!=null&&i.length))return{"No attributes or varyings":{[r]:"N/A"}};for(const s of t.attributes)if(s){const o=`${s.location} ${s.name}: ${s.type}`;n[`in ${o}`]={[r]:s.stepMode||"vertex"}}for(const s of t.varyings||[]){const o=`${s.location} ${s.name}`;n[`out ${o}`]={[r]:JSON.stringify(s.accessor)}}return n}let ze=null,pd=null;function X6(t,{id:e,minimap:n,opaque:r,top:i="0",left:s="0",rgbaScale:o=1}){ze||(ze=document.createElement("canvas"),ze.id=e,ze.title=e,ze.style.zIndex="100",ze.style.position="absolute",ze.style.top=i,ze.style.left=s,ze.style.border="blue 1px solid",ze.style.transform="scaleY(-1)",document.body.appendChild(ze),pd=ze.getContext("2d")),(ze.width!==t.width||ze.height!==t.height)&&(ze.width=t.width/2,ze.height=t.height/2,ze.style.width="400px",ze.style.height="400px");const a=t.device.readPixelsToArrayWebGL(t),l=pd.createImageData(t.width,t.height),c=0;for(let u=0;u<a.length;u+=4)l.data[c+u+0]=a[u+0]*o,l.data[c+u+1]=a[u+1]*o,l.data[c+u+2]=a[u+2]*o,l.data[c+u+3]=r?255:a[u+3]*o;pd.putImageData(l,0,0)}const zi=2,Y6=1e4,qu=class qu{constructor(e,n){T(this,"device");T(this,"id");T(this,"source");T(this,"vs");T(this,"fs");T(this,"pipelineFactory");T(this,"shaderFactory");T(this,"userData",{});T(this,"parameters");T(this,"topology");T(this,"bufferLayout");T(this,"isInstanced");T(this,"instanceCount",0);T(this,"vertexCount");T(this,"indexBuffer",null);T(this,"bufferAttributes",{});T(this,"constantAttributes",{});T(this,"bindings",{});T(this,"uniforms",{});T(this,"vertexArray");T(this,"transformFeedback",null);T(this,"pipeline");T(this,"shaderInputs");T(this,"_uniformStore");T(this,"_attributeInfos",{});T(this,"_gpuGeometry",null);T(this,"_getModuleUniforms");T(this,"props");T(this,"_pipelineNeedsUpdate","newly created");T(this,"_needsRedraw","initializing");T(this,"_destroyed",!1);T(this,"_lastDrawTimestamp",-1);T(this,"_lastLogTime",0);T(this,"_logOpen",!1);T(this,"_drawCount",0);var a,l,c,u;this.props={...qu.defaultProps,...n},n=this.props,this.id=n.id||Ai("model"),this.device=e,Object.assign(this.userData,n.userData);const r=Object.fromEntries(((a=this.props.modules)==null?void 0:a.map(f=>[f.name,f]))||[]);this.setShaderInputs(n.shaderInputs||new W6(r));const i=K6(e),s=(((l=this.props.modules)==null?void 0:l.length)>0?this.props.modules:(c=this.shaderInputs)==null?void 0:c.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){(u=this.props).shaderLayout||(u.shaderLayout=h4(this.props.source));const{source:f,getUniforms:h}=this.props.shaderAssembler.assembleShader({platformInfo:i,...this.props,modules:s});this.source=f,this._getModuleUniforms=h}else{const{vs:f,fs:h,getUniforms:d}=this.props.shaderAssembler.assembleShaderPair({platformInfo:i,...this.props,modules:s});this.vs=f,this.fs=h,this._getModuleUniforms=d}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,n.geometry&&this.setGeometry(n.geometry),this.pipelineFactory=n.pipelineFactory||hg.getDefaultPipelineFactory(this.device),this.shaderFactory=n.shaderFactory||dg.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in n&&(this.isInstanced=n.isInstanced),n.instanceCount&&this.setInstanceCount(n.instanceCount),n.vertexCount&&this.setVertexCount(n.vertexCount),n.indexBuffer&&this.setIndexBuffer(n.indexBuffer),n.attributes&&this.setAttributes(n.attributes),n.constantAttributes&&this.setConstantAttributes(n.constantAttributes),n.bindings&&this.setBindings(n.bindings),n.uniforms&&this.setUniforms(n.uniforms),n.moduleSettings&&this.updateModuleSettings(n.moduleSettings),n.transformFeedback&&(this.transformFeedback=n.transformFeedback),Object.seal(this)}destroy(){var e;this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),(e=this._gpuGeometry)==null||e.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||(this._needsRedraw=e)}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){this.predraw();let n;try{this._logDrawCallStart(),this.pipeline=this._updatePipeline(),this.pipeline.setBindings(this.bindings,{disableWarnings:this.props.disableWarnings}),hu(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:r}=this.vertexArray,i=r?r.byteLength/(r.indexType==="uint32"?4:2):void 0;n=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:i,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{this._logDrawCallEnd()}return this._logFramebuffer(e),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(e){var r;(r=this._gpuGeometry)==null||r.destroy();const n=e&&$6(this.device,e);n&&(this.setTopology(n.topology||"triangle-list"),this.bufferLayout=rT(n.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(n)),this._gpuGeometry=n}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){this.bufferLayout=this._gpuGeometry?rT(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){ng(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new SD(this.shaderInputs.modules);for(const n of Object.keys(this.shaderInputs.modules)){const r=this._uniformStore.getManagedUniformBuffer(this.device,n);this.bindings[`${n}Uniforms`]=r}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindings()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,n){e.indices&&U.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)();for(const[r,i]of Object.entries(e)){const s=this.bufferLayout.find(l=>iT(l).includes(r));if(!s){U.warn(`Model(${this.id}): Missing layout for buffer "${r}".`)();continue}const o=iT(s);let a=!1;for(const l of o){const c=this._attributeInfos[l];c&&(this.vertexArray.setBuffer(c.location,i),a=!0)}!a&&!((n==null?void 0:n.disableWarnings)??this.props.disableWarnings)&&U.warn(`Model(${this.id}): Ignoring buffer "${i.id}" for unknown attribute "${r}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,n){for(const[r,i]of Object.entries(e)){const s=this._attributeInfos[r];s?this.vertexArray.setConstantWebGL(s.location,i):((n==null?void 0:n.disableWarnings)??this.props.disableWarnings)||U.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${r}"`)()}this.setNeedsRedraw("constants")}setUniforms(e){hu(e)||(this.pipeline.setUniformsWebGL(e),Object.assign(this.uniforms,e)),this.setNeedsRedraw("uniforms")}updateModuleSettings(e){const{bindings:n,uniforms:r}=Sm(this._getModuleUniforms(e));Object.assign(this.bindings,n),Object.assign(this.uniforms,r),this.setNeedsRedraw("moduleSettings")}_getBindingsUpdateTimestamp(){let e=0;for(const n of Object.values(this.bindings))n instanceof du?e=Math.max(e,n.texture.updateTimestamp):n instanceof Te||n instanceof Ft?e=Math.max(e,n.updateTimestamp):n instanceof gu||(e=Math.max(e,n.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const n={...e.attributes};for(const[r]of Object.entries(n))!this.pipeline.shaderLayout.attributes.find(i=>i.name===r)&&r!=="positions"&&delete n[r];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(n,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||(this._pipelineNeedsUpdate=e),this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,n=null;this.pipeline&&(U.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,n=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const r=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debug:this.props.debugShaders});let i=null;this.source?i=r:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debug:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,vs:r,fs:i}),this._attributeInfos=Fb(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),n&&this.shaderFactory.release(n)}return this.pipeline}_logDrawCallStart(){const e=U.level>3?0:Y6;U.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,U.group(zi,`>>> DRAWING MODEL ${this.id}`,{collapsed:U.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=H6(this.pipeline.shaderLayout,this.id);U.table(zi,e)();const n=this.shaderInputs.getDebugTable();for(const[i,s]of Object.entries(this.uniforms))n[i]={value:s};U.table(zi,n)();const r=this._getAttributeDebugTable();U.table(zi,this._attributeInfos)(),U.table(zi,r)(),U.groupEnd(zi)(),this._logOpen=!1}}_logFramebuffer(e){const n=U.get("framebuffer");if(this._drawCount++,!n||this._drawCount++>3&&this._drawCount%60)return;const r=e.props.framebuffer;r&&X6(r,{id:r.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[n,r]of Object.entries(this._attributeInfos))e[r.location]={name:n,type:r.shaderType,values:this._getBufferOrConstantValues(this.vertexArray.attributes[r.location],r.bufferDataType)};if(this.vertexArray.indexBuffer){const{indexBuffer:n}=this.vertexArray,r=n.indexType==="uint32"?new Uint32Array(n.debugData):new Uint16Array(n.debugData);e.indices={name:"indices",type:n.indexType,values:r.toString()}}return e}_getBufferOrConstantValues(e,n){const r=Lb(n);return(e instanceof Te?new r(e.debugData):e).toString()}};T(qu,"defaultProps",{...Bs.defaultProps,source:null,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:fu.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0});let nn=qu;function rT(t,e){const n=[...t];for(const r of e){const i=n.findIndex(s=>s.name===r.name);i<0?n.push(r):n[i]=r}return n}function K6(t){return{type:t.type,shaderLanguage:t.info.shadingLanguage,shaderLanguageVersion:t.info.shadingLanguageVersion,gpu:t.info.gpu,features:t.features}}function iT(t){var e;return t.attributes?(e=t.attributes)==null?void 0:e.map(n=>n.attribute):[t.name]}class ba{constructor(e,n=nn.defaultProps){T(this,"device");T(this,"model");T(this,"transformFeedback");ge(ba.isSupported(e),"BufferTransform not yet implemented on WebGPU"),this.device=e,this.model=new nn(this.device,{id:n.id||"buffer-transform-model",fs:n.fs||bF(),topology:n.topology||"point-list",...n}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:n.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}static isSupported(e){var n;return((n=e==null?void 0:e.info)==null?void 0:n.type)==="webgl"}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){const n=this.device.beginRenderPass(e);this.model.draw(n),n.end()}update(...e){console.warn("TextureTransform#update() not implemented")}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const n=this.getBuffer(e);if(n instanceof Te)return n.readAsync();const{buffer:r,byteOffset:i=0,byteLength:s=r.byteLength}=n;return r.readAsync(i,s)}}class Ws{constructor(e){T(this,"id");T(this,"topology");T(this,"vertexCount");T(this,"indices");T(this,"attributes");T(this,"userData",{});const{attributes:n={},indices:r=null,vertexCount:i=null}=e;this.id=e.id||Ai("geometry"),this.topology=e.topology,r&&(this.indices=ArrayBuffer.isView(r)?{value:r,size:1}:r),this.attributes={};for(const[s,o]of Object.entries(n)){const a=ArrayBuffer.isView(o)?{value:o}:o;ge(ArrayBuffer.isView(a.value),`${this._print(s)}: must be typed array or object with value as typed array`),(s==="POSITION"||s==="positions")&&!a.size&&(a.size=3),s==="indices"?(ge(!this.indices),this.indices=a):this.attributes[s]=a}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=i||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,n){return this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i of Object.values(e)){const{value:s,size:o,constant:a}=i;!a&&s&&o>=1&&(r=Math.min(r,s.length/o))}return ge(Number.isFinite(r)),r}}const q6={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class pA extends xm{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},cullRect:f,effects:h,pass:d="picking",pickZ:g,moduleParameters:_}){this.pickZ=g;const b=this._resetColorEncoder(g),m=[a,l,c,u],p=super.render({target:o,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:f,effects:h==null?void 0:h.filter(w=>w.useInPicking),pass:d,isPicking:!0,moduleParameters:_,clearColor:[0,0,0,0],colorMask:15,scissorRect:m});return this._colorEncoderState=null,{decodePickingColor:b&&Q6.bind(null,b),stats:p}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{picking:{isActive:1,isAttribute:this.pickZ},lightSources:{}}}getLayerParameters(e,n,r){const i={depthMask:!0,depthTest:!0,depthRange:[0,1],...e.props.parameters},{pickable:s,operation:o}=e.props;return!this._colorEncoderState||o.includes("terrain")?i.blend=!1:s&&o.includes("draw")&&(Object.assign(i,q6),i.blend=!0,i.blendColor=Z6(this._colorEncoderState,e,r)),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function Z6(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,o=r.get(e);return o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},r.set(e,o),i[s]=o):(G.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function Q6(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const Vi={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Au=Symbol.for("component"),Rr=Symbol.for("propTypes"),gd=Symbol.for("deprecatedProps"),Ts=Symbol.for("asyncPropDefaults"),_i=Symbol.for("asyncPropOriginal"),gr=Symbol.for("asyncPropResolved");function Hs(t,e=()=>!0){return Array.isArray(t)?gA(t,e,[]):e(t)?[t]:[]}function gA(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?gA(i,e,n):e(i)&&n.push(i)}return n}function J6({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}class G6{constructor(e,n,r){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=cu(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class eL{constructor(e){var n;this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:(n=e.device)==null?void 0:n.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new G6(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,o=s[e]=s[e]||{};let a=o[n];const l=a&&a.resourceId&&this._resources[a.resourceId];l&&(l.unsubscribe(a),this.prune()),r&&(a?(a.onChange=i,a.resourceId=r.id):a={onChange:i,resourceId:r.id},o[n]=a,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const tL="layerManager.setLayers",nL="layerManager.activateViewport";class rL{constructor(e,n){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=a=>{nt(nL,this,a),a&&(this.context.viewport=a)};const{deck:r,stats:i,viewport:s,timeline:o}=n||{};this.layers=[],this.resourceManager=new eL({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e==null?void 0:e.gl,deck:r,shaderAssembler:f6(),defaultShaderModules:[],renderPass:void 0,stats:i||new jf({id:"deck.gl"}),viewport:s||new bu({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new dA,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){nt(tL,this,n,e),this._lastRenderedLayers=e;const r=Hs(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:n}=this.context;n.find(r=>r.name===e.name)||(n.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:n}=this.context,r=n.findIndex(i=>i.name===e.name);r>=0&&(n.splice(r,1),this._defaultShaderModulesChanged=!0)}_handleError(e,n,r){r.raiseError(n,`${e} of ${r}`)}_updateLayers(e,n){const r={};for(const o of e)r[o.id]?G.warn(`Multiple old layers with same id ${o.id}`)():r[o.id]=o;if(this._defaultShaderModulesChanged){for(const o of e)o.setNeedsUpdate(),o.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const o of i)if(o.hasUniformTransition()){s=`Uniform transition in ${o}`;break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&G.warn(`Multiple new layers with same id ${i.id}`)(),n[i.id]=null;let o=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}o&&this._updateSublayersRecursively(o,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Vi.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=Vi.MATCHED,n!==e&&(e.lifecycle=Vi.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=Vi.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Vi.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function Zt(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Zt(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!Zt(t[s],e[s],n-1))return!1;return!0}return!1}class iL{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const o=r[s];if(o.containsPixel(i)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=Hs(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Zt(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):G.warn("missing `viewState` or `initialViewState`")()}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return(o=this.getView(e.id))==null?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const o={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let l=n[s.id];const c=!!s.controller;c&&!l&&(r=!0),(r||!c)&&l&&(l.finalize(),l=null),this.controllers[s.id]=this._updateController(s,o,a,l),a&&this._viewports.unshift(a)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const sL=/([0-9]+\.?[0-9]*)(%|px)/;function er(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=sL.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error(`Could not parse position string ${t}`)}}function tr(t,e){return t.relative?Math.round(t.position*e):t.position}class oL{constructor(e){const{id:n,x:r=0,y:i=0,width:s="100%",height:o="100%",padding:a=null}=e;this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=er(r),this._y=er(i),this._width=er(s),this._height=er(o),this._padding=a&&{left:er(a.left||0),right:er(a.right||0),top:er(a.top||0),bottom:er(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.ViewportType===e.ViewportType&&Zt(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:tr(this._x,e),y:tr(this._y,n),width:tr(this._width,e),height:tr(this._height,n)};return this._padding&&(r.padding={left:tr(this._padding.left,e),top:tr(this._padding.top,n),right:tr(this._padding.right,e),bottom:tr(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class Yf{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(r=(n=this.settings).onStart)==null||r.call(n,this)}end(){var e,n;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(n=(e=this.settings).onEnd)==null||n.call(e,this))}cancel(){var e,n;this._inProgress&&((n=(e=this.settings).onInterrupt)==null||n.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(n=(e=this.settings).onUpdate)==null||n.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const sT=()=>{},pg={BREAK:1,SNAP_TO_END:2,IGNORE:3},aL=t=>t,lL=pg.BREAK;class cL{constructor(e){this._onTransitionUpdate=n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:o,duration:a,easing:l}}=n,c=l(r/a),u=i.interpolateProps(s,o,c);this.propsInTransition=this.getControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Yf(e.timeline),this.onViewStateChange=e.onViewStateChange||sT,this.onStateChange=e.onStateChange||sT}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;i={...r,...s===pg.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===pg.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=s.initializeProps(e,i);this.propsInTransition={};const l={duration:o,easing:n.transitionEasing||aL,interpolator:s,interruption:n.transitionInterruption||lL,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}function ke(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class uL{constructor(e){const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!wa(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];ke(Number.isFinite(r)||Array.isArray(r),`${n} is required for transition`)})}}const fL=["longitude","latitude","zoom","bearing","pitch"],hL=["longitude","latitude","zoom"];class _A extends uL{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:fL,required:hL},super(r.transitionProps),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const o=i(e),a=i(n),l=o.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(l),aroundPosition:l,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=Tu(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,Tu(e.around,n.around,r)))}return i}}const nr={transitionDuration:0},dL=300,jl=t=>1-(1-t)*(1-t),$i={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},jr={};class pL{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new cL({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){var e;for(const n in this._events)this._events[n]&&((e=this.eventManager)==null||e.off(n,this.handleEvent));this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?dL:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,u=!!this.onViewStateChange;this.toggleEvents($i.WHEEL,u&&r),this.toggleEvents($i.PAN,u),this.toggleEvents($i.PINCH,u&&(a||l)),this.toggleEvents($i.TRIPLE_PAN,u&&l),this.toggleEvents($i.DOUBLE_TAP,u&&o),this.toggleEvents($i.KEYBOARD,u&&c),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:o,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,nr,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,nr,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:jl},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,nr,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:jl},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*r)));s<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,nr,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,nr,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:jl},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return jr._startPinchRotation=e.rotation,jr._lastPinchEvent=e,this.updateViewport(r,nr,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:jr._startPinchRotation-r})}return this.updateViewport(n,nr,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),jr._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=jr;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),l=Math.pow(2,o+a*n/2);s=s.zoom({pos:i,scale:l}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:jl},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return jr._startPinchRotation=null,jr._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),c.isZooming=!0;break;case"Equal":l=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),c.isZooming=!0;break;case"ArrowLeft":n?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(i),c.isPanning=!0);break;case"ArrowRight":n?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(i),c.isPanning=!0);break;case"ArrowUp":n?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(i),c.isPanning=!0);break;case"ArrowDown":n?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(i),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?nr:e?{...n,transitionInterpolator:new _A({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class gL{constructor(e,n){this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const oT=5,_L=1.2;class mL extends gL{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,position:u=[0,0,0],maxZoom:f=20,minZoom:h=0,maxPitch:d=60,minPitch:g=0,startPanLngLat:_,startZoomLngLat:b,startRotatePos:m,startBearing:p,startPitch:y,startZoom:w,normalize:A=!0}=e;ke(Number.isFinite(s)),ke(Number.isFinite(i)),ke(Number.isFinite(o)),super({width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:f,minZoom:h,maxPitch:d,minPitch:g,normalize:A,position:u},{startPanLngLat:_,startZoomLngLat:b,startRotatePos:m,startBearing:p,startPitch:y,startZoom:w}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,i,o,s):a={bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let l=i+Math.log2(r);l=pr(l,a,o);const c=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...c.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=pr(i,r,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=pr(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,JB(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],l=n[1],{width:c,height:u}=this.getViewportProps(),f=s/c;let h=0;o>0?Math.abs(u-l)>oT&&(h=o/(l-u)*_L):o<0&&l>oT&&(h=1-a/l),h=pr(h,-1,1);const{minPitch:d,maxPitch:g}=this.getViewportProps(),_=i+180*f;let b=r;return h>0?b=r+h*(g-r):h<0&&(b=r-h*(d-r)),{pitch:b,bearing:_}}}class yL extends pL{constructor(){super(...arguments),this.ControllerState=mL,this.transition={transitionDuration:300,transitionInterpolator:new _A({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}const Dm=class Dm extends oL{constructor(e={}){super(e)}get ViewportType(){return Ea}get ControllerType(){return yL}};Dm.displayName="MapView";let Ru=Dm;const vL=new fA;function TL(t,e){const n=t.order??1/0,r=e.order??1/0;return n-r}class wL{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>TL(i,e)>0);r<0?n.push(e):n.splice(r,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Zt(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];let o=i;s&&s!==i?s.setProps?(s.setProps(i.props),o=s):s.cleanup(this._context):s||i.setup(this._context),r.push(o),delete n[i.id]}for(const i in n)n[i].cleanup(this._context);this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof fA)||this._resolvedEffects.push(vL),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class SL extends xm{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const EL="deckRenderer.renderLayers";class bL{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new SL(e),this.pickLayersPass=new pA(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target;this.lastPostProcessEffect&&(r.clearColor=[0,0,0,0],r.clearCanvas=!0);const s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,nt(EL,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,n=this.device.canvasContext.getDrawingBufferSize();e.length===0&&[0,1].map(r=>{const i=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${r}`,colorAttachments:[i]}))});for(const r of e)r.resize(n)}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1]};for(const s of e)if(s.postRender){i.target=s.id===this.lastPostProcessEffect?n.target:void 0;const o=s.postRender(i);i.inputBuffer=o,i.swapBuffer=o===r[0]?r[1]:r[0]}}}const AL={pickedColor:null,pickedObjectIndex:-1};function RL({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:o,y:a,width:l,height:c}=s;let u=i*i,f=-1,h=0;for(let d=0;d<c;d++){const g=d+a-r,_=g*g;if(_>u)h+=4*l;else for(let b=0;b<l;b++){if(t[h+3]-1>=0){const p=b+o-n,y=p*p+_;y<=u&&(u=y,f=h)}h+=4}}if(f>=0){const d=t.slice(f,f+4),g=e(d);if(g){const _=Math.floor(f/4/l),b=f/4-_*l;return{...g,pickedColor:d,pickedX:o+b,pickedY:a+_}}G.error("Picked non-existent layer. Is picking buffer corrupt?")()}return AL}function xL({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):G.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function mA({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let o=e[0];e.length>1&&(o=PL((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let a;if(o){const l=[r-o.x,i-o.y];s!==void 0&&(l[2]=s),a=o.unproject(l)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function CL(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if(r==="hover"){const f=n.index,h=n.layerId,d=o?o.props.id:null;if(d!==h||a!==f){if(d!==h){const g=i.find(_=>_.props.id===h);g&&l.unshift(g)}n.layerId=d,n.index=a,n.info=null}}const c=mA(t),u=new Map;return u.set(null,c),l.forEach(f=>{let h={...c};f===o&&(h.color=s,h.index=a,h.picked=!0),h=yA({layer:f,info:h,mode:r});const d=h.layer;f===o&&r==="hover"&&(n.info=h),u.set(d.id,h),r==="hover"&&d.updateAutoHighlight(h)}),u}function yA({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function PL(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class IL{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new pA(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?r.find(h=>h.id===o):null,c=a&&i.find(h=>h.id===a)||i[0],u=c&&c.unproject([e-c.x,n-c.y]);return{...s,...{x:e,y:n,viewport:c,coordinate:u,layer:l}}}_resizeBuffer(){var n,r;if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const i=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=i}const{canvas:e}=this.device.getCanvasContext();(n=this.pickingFBO)==null||n.resize({width:e.width,height:e.height}),(r=this.depthFBO)==null||r.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u,effects:f}){const h=this.device.canvasContext.cssToDeviceRatio(),d=this._getPickable(e);if(!d||r.length===0)return{result:[],emptyInfo:mA({viewports:r,x:i,y:s,pixelRatio:h})};this._resizeBuffer();const g=this.device.canvasContext.cssToDevicePixels([i,s],!0),_=[g.x+Math.floor(g.width/2),g.y+Math.floor(g.height/2)],b=Math.round(o*h),{width:m,height:p}=this.pickingFBO,y=this._getPickingRect({deviceX:_[0],deviceY:_[1],deviceRadius:b,deviceWidth:m,deviceHeight:p}),w={x:i-o,y:s-o,width:o*2+1,height:o*2+1};let A;const x=[],I=new Set;for(let O=0;O<a;O++){let D;if(y){const H=this._drawAndSample({layers:d,views:n,viewports:r,onViewportActive:u,deviceRect:y,cullRect:w,effects:f,pass:`picking:${l}`});D=RL({...H,deviceX:_[0],deviceY:_[1],deviceRadius:b,deviceRect:y})}else D={pickedColor:null,pickedObjectIndex:-1};let z;if(D.pickedLayer&&c&&this.depthFBO){const{pickedColors:H}=this._drawAndSample({layers:[D.pickedLayer],views:n,viewports:r,onViewportActive:u,deviceRect:{x:D.pickedX,y:D.pickedY,width:1,height:1},cullRect:w,effects:f,pass:`picking:${l}:z`},!0);H[3]&&(z=H[0])}D.pickedLayer&&O+1<a&&(I.add(D.pickedLayer),D.pickedLayer.disablePickingIndex(D.pickedObjectIndex)),A=CL({pickInfo:D,lastPickedInfo:this.lastPickedInfo,mode:l,layers:d,viewports:r,x:i,y:s,z,pixelRatio:h});for(const H of A.values())H.layer&&x.push(H);if(!D.pickedColor)break}for(const O of I)O.restorePickingColors();return{result:x,emptyInfo:A.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u,effects:f}){const h=this._getPickable(e);if(!h||r.length===0)return[];this._resizeBuffer();const d=this.device.canvasContext.cssToDeviceRatio(),g=this.device.canvasContext.cssToDevicePixels([i,s],!0),_=g.x,b=g.y+g.height,m=this.device.canvasContext.cssToDevicePixels([i+o,s+a],!0),p=m.x+m.width,y=m.y,w={x:_,y,width:p-_,height:b-y},A=this._drawAndSample({layers:h,views:n,viewports:r,onViewportActive:u,deviceRect:w,cullRect:{x:i,y:s,width:o,height:a},effects:f,pass:`picking:${l}`}),x=xL(A),I=new Map,O=[],D=Number.isFinite(c);for(let z=0;z<x.length&&!(D&&O.length>=c);z++){const H=x[z];let Y={color:H.pickedColor,layer:null,index:H.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:d};Y=yA({layer:H.pickedLayer,info:Y,mode:l});const K=Y.layer.id;I.has(K)||I.set(K,new Set);const Z=I.get(K),Le=Y.object??Y.index;Z.has(Le)||(Z.add(Le),O.push(Y))}return O}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:l},c=!1){const u=c?this.depthFBO:this.pickingFBO,f={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:c,preRenderStats:{}};for(const p of a)p.useInPicking&&(f.preRenderStats[p.id]=p.preRender(f));const{decodePickingColor:h}=this.pickLayersPass.render(f),{x:d,y:g,width:_,height:b}=s,m=new(c?Float32Array:Uint8Array)(_*b*4);return this.device.readPixelsToArrayWebGL(u,{sourceX:d,sourceY:g,sourceWidth:_,sourceHeight:b,target:m}),{pickedColors:m,decodePickingColor:h}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const o=Math.max(0,e-r),a=Math.max(0,n-r),l=Math.min(i,e+r+1)-o,c=Math.min(s,n+r+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const ML={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},NL="top-left",aT="__root";class kL{constructor({deck:e,parentElement:n}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,this.parentElement=n}getWidgets(){return this.resolvedWidgets}setProps(e){e.widgets&&!Zt(e.widgets,this.widgets,1)&&this._setWidgets(e.widgets)}finalize(){for(const e of this.getWidgets())this._remove(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(n=>n.id===e.id)||(this._add(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}_setWidgets(e){const n={};for(const r of this.resolvedWidgets)n[r.id]=r;this.resolvedWidgets.length=0;for(const r of this.defaultWidgets)n[r.id]=null,this.resolvedWidgets.push(r);for(let r of e){const i=n[r.id];i?i.viewId!==r.viewId||i.placement!==r.placement?(this._remove(i),this._add(r)):r!==i&&(i.setProps(r.props),r=i):this._add(r),n[r.id]=null,this.resolvedWidgets.push(r)}for(const r in n){const i=n[r];i&&this._remove(i)}this.widgets=e}_add(e){const{viewId:n=null,placement:r=NL}=e,i=e.onAdd({deck:this.deck,viewId:n});i&&this._getContainer(n,r).append(i),e._element=i}_remove(e){e.onRemove(),e._element&&e._element.remove(),e._element=void 0}_getContainer(e,n){var o;const r=e||aT;let i=this.containers[r];i||(i=document.createElement("div"),i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",(o=this.parentElement)==null||o.append(i),this.containers[r]=i);let s=i.querySelector(`.${n}`);return s||(s=document.createElement("div"),s.className=n,s.style.position="absolute",s.style.zIndex="2",Object.assign(s.style,ML[n]),i.append(s)),s}_updateContainers(){const e=this.deck.width,n=this.deck.height;for(const r in this.containers){const i=this.lastViewports[r]||null,s=r===aT||i,o=this.containers[r];s?(o.style.display="block",o.style.left=`${i?i.x:0}px`,o.style.top=`${i?i.y:0}px`,o.style.width=`${i?i.width:e}px`,o.style.height=`${i?i.height:n}px`):o.style.display="none"}}onRedraw({viewports:e,layers:n}){var s,o;const r=e.reduce((a,l)=>(a[l.id]=l,a),{}),{lastViewports:i}=this;for(const a of this.getWidgets()){const{viewId:l}=a;if(l){const c=r[l];c&&(a.onViewportChange&&!c.equals(i[l])&&a.onViewportChange(c),(s=a.onRedraw)==null||s.call(a,{viewports:[c],layers:n}))}else{if(a.onViewportChange)for(const c of e)c.equals(i[c.id])||a.onViewportChange(c);(o=a.onRedraw)==null||o.call(a,{viewports:e,layers:n})}}this.lastViewports=r,this._updateContainers()}onHover(e,n){var r,i;for(const s of this.getWidgets()){const{viewId:o}=s;(!o||o===((r=e.viewport)==null?void 0:r.id))&&((i=s.onHover)==null||i.call(s,e,n))}}onEvent(e,n){var i,s;const r=lg[n.type];if(r)for(const o of this.getWidgets()){const{viewId:a}=o;(!a||a===((i=e.viewport)==null?void 0:i.id))&&((s=o[r.handler])==null||s.call(o,e,n))}}}const OL={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class FL{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:e}){const n=document.createElement("div");return n.className="deck-tooltip",Object.assign(n.style,OL),this.deck=e,this.element=n,n}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(e){var n;this.isVisible&&e.id===((n=this.lastViewport)==null?void 0:n.id)&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:n}=this,r=n&&n.props.getTooltip;if(!r)return;const i=r(e);this.lastViewport=e.viewport,this.setTooltip(i,e.x,e.y)}setTooltip(e,n,r){const i=this.element;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform=`translate(${n}px, ${r}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}}var rs;(function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.CULL_FACE=2884]="CULL_FACE",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.BLEND=3042]="BLEND",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DOUBLE=5130]="DOUBLE",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",t[t.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.READ_BUFFER=3074]="READ_BUFFER",t[t.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",t[t.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",t[t.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",t[t.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",t[t.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",t[t.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",t[t.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",t[t.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",t[t.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",t[t.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",t[t.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",t[t.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",t[t.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",t[t.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",t[t.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",t[t.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",t[t.RED=6403]="RED",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB10_A2=32857]="RGB10_A2",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.RGBA32F=34836]="RGBA32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.RGB16F=34843]="RGB16F",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R16F=33325]="R16F",t[t.R32F=33326]="R32F",t[t.RG16F=33327]="RG16F",t[t.RG32F=33328]="RG32F",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",t[t.CURRENT_QUERY=34917]="CURRENT_QUERY",t[t.QUERY_RESULT=34918]="QUERY_RESULT",t[t.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",t[t.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",t[t.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",t[t.DRAW_BUFFER0=34853]="DRAW_BUFFER0",t[t.DRAW_BUFFER1=34854]="DRAW_BUFFER1",t[t.DRAW_BUFFER2=34855]="DRAW_BUFFER2",t[t.DRAW_BUFFER3=34856]="DRAW_BUFFER3",t[t.DRAW_BUFFER4=34857]="DRAW_BUFFER4",t[t.DRAW_BUFFER5=34858]="DRAW_BUFFER5",t[t.DRAW_BUFFER6=34859]="DRAW_BUFFER6",t[t.DRAW_BUFFER7=34860]="DRAW_BUFFER7",t[t.DRAW_BUFFER8=34861]="DRAW_BUFFER8",t[t.DRAW_BUFFER9=34862]="DRAW_BUFFER9",t[t.DRAW_BUFFER10=34863]="DRAW_BUFFER10",t[t.DRAW_BUFFER11=34864]="DRAW_BUFFER11",t[t.DRAW_BUFFER12=34865]="DRAW_BUFFER12",t[t.DRAW_BUFFER13=34866]="DRAW_BUFFER13",t[t.DRAW_BUFFER14=34867]="DRAW_BUFFER14",t[t.DRAW_BUFFER15=34868]="DRAW_BUFFER15",t[t.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.MAX_SAMPLES=36183]="MAX_SAMPLES",t[t.SAMPLER_BINDING=35097]="SAMPLER_BINDING",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",t[t.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",t[t.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",t[t.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",t[t.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",t[t.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",t[t.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",t[t.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",t[t.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",t[t.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",t[t.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",t[t.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",t[t.UNIFORM_TYPE=35383]="UNIFORM_TYPE",t[t.UNIFORM_SIZE=35384]="UNIFORM_SIZE",t[t.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",t[t.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",t[t.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",t[t.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",t[t.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",t[t.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS",t[t.SYNC_FENCE=37142]="SYNC_FENCE",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED",t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED",t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STREAM_COPY=35042]="STREAM_COPY",t[t.STATIC_READ=35045]="STATIC_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.INVALID_INDEX=4294967295]="INVALID_INDEX",t[t.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",t[t.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",t[t.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",t[t.R16_EXT=33322]="R16_EXT",t[t.RG16_EXT=33324]="RG16_EXT",t[t.RGB16_EXT=32852]="RGB16_EXT",t[t.RGBA16_EXT=32859]="RGBA16_EXT",t[t.R16_SNORM_EXT=36760]="R16_SNORM_EXT",t[t.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",t[t.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",t[t.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",t[t.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",t[t.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",t[t.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",t[t.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",t[t.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",t[t.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",t[t.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",t[t.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",t[t.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",t[t.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",t[t.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",t[t.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",t[t.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",t[t.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",t[t.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",t[t.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",t[t.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",t[t.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",t[t.LINE_WEBGL=6913]="LINE_WEBGL",t[t.FILL_WEBGL=6914]="FILL_WEBGL",t[t.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",t[t.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",t[t.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",t[t.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",t[t.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",t[t.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",t[t.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",t[t.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",t[t.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",t[t.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",t[t.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",t[t.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",t[t.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",t[t.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",t[t.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",t[t.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",t[t.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",t[t.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",t[t.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",t[t.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",t[t.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",t[t.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",t[t.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",t[t.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(rs||(rs={}));const Cm={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Me=(t,e,n)=>e?t.enable(n):t.disable(n),lT=(t,e,n)=>t.hint(n,e),yt=(t,e,n)=>t.pixelStorei(n,e),cT=(t,e,n)=>{const r=n===36006?36009:36008;return t.bindFramebuffer(r,e)},yo=(t,e,n)=>{const i={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[n];t.bindBuffer(i,e)};function _d(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}const DL={3042:Me,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:Me,2885:(t,e)=>t.cullFace(e),2929:Me,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:Me,35723:lT,35725:(t,e)=>t.useProgram(e),36007:(t,e)=>t.bindRenderbuffer(36161,e),36389:(t,e)=>{var n;return(n=t.bindTransformFeedback)==null?void 0:n.call(t,36386,e)},34229:(t,e)=>t.bindVertexArray(e),36006:cT,36010:cT,34964:yo,36662:yo,36663:yo,35053:yo,35055:yo,2886:(t,e)=>t.frontFace(e),33170:lT,2849:(t,e)=>t.lineWidth(e),32823:Me,32824:"polygonOffset",10752:"polygonOffset",35977:Me,32926:Me,32928:Me,32938:"sampleCoverage",32939:"sampleCoverage",3089:Me,3088:(t,e)=>t.scissor(...e),2960:Me,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),34383:Me,10754:Me,12288:Me,12289:Me,12290:Me,12291:Me,12292:Me,12293:Me,12294:Me,12295:Me,3333:yt,3317:yt,37440:yt,37441:yt,37443:yt,3330:yt,3332:yt,3331:yt,3314:yt,32878:yt,3316:yt,3315:yt,32877:yt,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{const n=typeof e=="number"?[e,e]:e;t.blendEquationSeparate(...n)},blendFunc:(t,e)=>{const n=(e==null?void 0:e.length)===2?[...e,...e]:e;t.blendFuncSeparate(...n)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=_d(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=_d(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=_d(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function xe(t,e,n){return e[t]!==void 0?e[t]:n[t]}const BL={blendEquation:(t,e,n)=>t.blendEquationSeparate(xe(32777,e,n),xe(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(xe(32969,e,n),xe(32968,e,n),xe(32971,e,n),xe(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(xe(32824,e,n),xe(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(xe(32938,e,n),xe(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,xe(2962,e,n),xe(2967,e,n),xe(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,xe(34816,e,n),xe(36003,e,n),xe(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,xe(2964,e,n),xe(2965,e,n),xe(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,xe(34817,e,n),xe(34818,e,n),xe(34819,e,n))},uT={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),useProgram:(t,e)=>t({35725:e}),bindRenderbuffer:(t,e,n)=>t({36007:n}),bindTransformFeedback:(t,e,n)=>t({36389:n}),bindVertexArray:(t,e)=>t({34229:e}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},bindBuffer:(t,e,n)=>{const r={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return r?t({[r]:n}):{valueChanged:!0}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},un=(t,e)=>t.isEnabled(e),fT={3042:un,2884:un,2929:un,3024:un,32823:un,32926:un,32928:un,3089:un,2960:un,35977:un},LL=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function Gs(t,e){if(zL(e))return;const n={};for(const i in e){const s=Number(i),o=DL[i];o&&(typeof o=="string"?n[o]=!0:o(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=BL[i];s(t,e,r)}}function vA(t,e=Cm){if(typeof e=="number"){const i=e,s=fT[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=fT[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function UL(t){Gs(t,Cm)}function zL(t){for(const e in t)return!1;return!0}function $L(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}class VL{constructor(e,{copyState:n=!1,log:r=()=>{}}={}){T(this,"gl");T(this,"program",null);T(this,"stateStack",[]);T(this,"enable",!0);T(this,"cache");T(this,"log");this.gl=e,this.cache=n?vA(e):Object.assign({},Cm),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){ge(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];Gs(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const s in e){ge(s!==void 0);const o=e[s],a=this.cache[s];$L(o,a)||(n=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:r}}}function mi(t){return t.state}function TA(t,e){const{enable:n=!0,copyState:r}=e;if(ge(r!==void 0),!t.state){t.state=new VL(t,{copyState:r}),WL(t);for(const s in uT){const o=uT[s];jL(t,s,o)}hT(t,"getParameter"),hT(t,"isEnabled")}const i=mi(t);return i.enable=n,t}function Kf(t){let e=mi(t);e||(TA(t,{copyState:!1}),e=mi(t)),e.push()}function Aa(t){const e=mi(t);ge(e),e.pop()}function hT(t,e){const n=t[e].bind(t);t[e]=function(i){if(i===void 0||LL.has(i))return n(i);const s=mi(t);return i in s.cache||(s.cache[i]=n(i)),s.enable?s.cache[i]:n(i)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function jL(t,e,n){if(!t[e])return;const r=t[e].bind(t);t[e]=function(...s){const o=mi(t),{valueChanged:a,oldValue:l}=n(o._updateCache,...s);return a&&r(...s),l},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}function WL(t){const e=t.useProgram.bind(t);t.useProgram=function(r){const i=mi(t);i.program!==r&&(e(r),i.program=r)}}const HL={powerPreference:"high-performance",onContextLost:()=>console.error("WebGL context lost"),onContextRestored:()=>console.info("WebGL context restored")};function XL(t,e){e={...HL,...e};let n=null;const r=s=>n=s.statusMessage||n;t.addEventListener("webglcontextcreationerror",r,!1);let i=null;if(i||(i=t.getContext("webgl2",e)),t.removeEventListener("webglcontextcreationerror",r,!1),!i)throw new Error(`Failed to create WebGL context: ${n||"Unknown error"}`);if(e.onContextLost){const{onContextLost:s}=e;t.addEventListener("webglcontextlost",o=>s(o),!1)}if(e.onContextRestored){const{onContextRestored:s}=e;t.addEventListener("webglcontextrestored",o=>s(o),!1)}return i}function Mr(t,e,n){return n[e]===void 0&&(n[e]=t.getExtension(e)||null),n[e]}function YL(t,e){const n=t.getParameter(7936),r=t.getParameter(7937);Mr(t,"WEBGL_debug_renderer_info",e);const i=e.WEBGL_debug_renderer_info,s=t.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936),o=t.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937),a=s||n,l=o||r,c=t.getParameter(7938),u=wA(a,l),f=KL(a,l),h=qL(a,l);return{type:"webgl",gpu:u,gpuType:h,gpuBackend:f,vendor:a,renderer:l,version:c,shadingLanguage:"glsl",shadingLanguageVersion:300}}function wA(t,e){return/NVIDIA/i.exec(t)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(t)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(t)||/Apple/i.exec(e)?"apple":/AMD/i.exec(t)||/AMD/i.exec(e)||/ATI/i.exec(t)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e)?"software":"unknown"}function KL(t,e){return/Metal/i.exec(t)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(t)||/ANGLE/i.exec(e)?"opengl":"unknown"}function qL(t,e){if(/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e))return"cpu";switch(wA(t,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function SA(t){switch(t){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(t))}const tt="texture-compression-bc",ce="texture-compression-astc",fn="texture-compression-etc2",ZL="texture-compression-etc1-webgl",Wl="texture-compression-pvrtc-webgl",md="texture-compression-atc-webgl",vo="float32-renderable-webgl",yd="float16-renderable-webgl",QL="rgb9e5ufloat_renderable-webgl",vd="snorm8-renderable-webgl",To="norm16-renderable-webgl",Td="snorm16-renderable-webgl",Hl="float32-filterable",dT="float16-filterable-webgl",Mo="WEBGL_compressed_texture_s3tc",No="WEBGL_compressed_texture_s3tc_srgb",is="EXT_texture_compression_rgtc",ss="EXT_texture_compression_bptc",JL="WEBGL_compressed_texture_etc",GL="WEBGL_compressed_texture_astc",eU="WEBGL_compressed_texture_etc1",tU="WEBGL_compressed_texture_pvrtc",nU="WEBGL_compressed_texture_atc",pT="EXT_texture_norm16",gT="EXT_render_snorm",rU="EXT_color_buffer_float",Pm={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat_renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[gT],"norm16-renderable-webgl":[pT],"snorm16-renderable-webgl":[pT,gT],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[Mo,No,is,ss],"texture-compression-bc5-webgl":[is],"texture-compression-bc7-webgl":[ss],"texture-compression-etc2":[JL],"texture-compression-astc":[GL],"texture-compression-etc1-webgl":[eU],"texture-compression-pvrtc-webgl":[tU],"texture-compression-atc-webgl":[nU]};function iU(t){return t in Pm}function sU(t,e,n){return(Pm[e]||[]).every(i=>Mr(t,i,n))}const qf={"rgb8unorm-unsized":{gl:6407,b:4,c:2,bpp:4,dataFormat:6407,types:[5121,33635]},"rgba8unorm-unsized":{gl:6408,b:4,c:2,bpp:4,dataFormat:6408,types:[5121,32819,32820]},r8unorm:{gl:33321,b:1,c:1,rb:!0},r8snorm:{gl:36756,b:1,c:1,render:vd},r8uint:{gl:33330,b:1,c:1,rb:!0},r8sint:{gl:33329,b:1,c:1,rb:!0},rg8unorm:{gl:33323,b:2,c:2,rb:!0},rg8snorm:{gl:36757,b:2,c:2,render:vd},rg8uint:{gl:33336,b:2,c:2,rb:!0},rg8sint:{gl:33335,b:2,c:2,rb:!0},r16uint:{gl:33332,b:2,c:1,rb:!0},r16sint:{gl:33331,b:2,c:1,rb:!0},r16float:{gl:33325,b:2,c:1,render:yd,filter:"float16-filterable-webgl",rb:!0},"r16unorm-webgl":{gl:33322,b:2,c:1,f:To,rb:!0},"r16snorm-webgl":{gl:36760,b:2,c:1,f:Td},"rgba4unorm-webgl":{gl:32854,b:2,c:4,wgpu:!1,rb:!0},"rgb565unorm-webgl":{gl:36194,b:2,c:4,wgpu:!1,rb:!0},"rgb5a1unorm-webgl":{gl:32855,b:2,c:4,wgpu:!1,rb:!0},"rgb8unorm-webgl":{gl:32849,b:3,c:3,wgpu:!1},"rgb8snorm-webgl":{gl:36758,b:3,c:3,wgpu:!1},rgba8unorm:{gl:32856,b:4,c:2,bpp:4},"rgba8unorm-srgb":{gl:35907,b:4,c:4,bpp:4},rgba8snorm:{gl:36759,b:4,c:4,render:vd},rgba8uint:{gl:36220,b:4,c:4,bpp:4},rgba8sint:{gl:36238,b:4,c:4,bpp:4},bgra8unorm:{b:4,c:4},"bgra8unorm-srgb":{b:4,c:4},rg16uint:{gl:33338,b:4,c:1,bpp:4},rg16sint:{gl:33337,b:4,c:2,bpp:4},rg16float:{gl:33327,bpp:4,b:4,c:2,render:yd,filter:dT,rb:!0},"rg16unorm-webgl":{gl:33324,b:2,c:2,render:To},"rg16snorm-webgl":{gl:36761,b:2,c:2,render:Td},r32uint:{gl:33334,b:4,c:1,bpp:4,rb:!0},r32sint:{gl:33333,b:4,c:1,bpp:4,rb:!0},r32float:{gl:33326,bpp:4,b:4,c:1,render:vo,filter:Hl},rgb9e5ufloat:{gl:35901,b:4,c:3,p:1,render:QL},rg11b10ufloat:{gl:35898,b:4,c:3,p:1,render:vo,rb:!0},rgb10a2unorm:{gl:32857,b:4,c:4,p:1,rb:!0},"rgb10a2uint-webgl":{b:4,c:4,gl:36975,p:1,wgpu:!1,bpp:4,rb:!0},"rgb16unorm-webgl":{gl:32852,b:2,c:3,f:To},"rgb16snorm-webgl":{gl:36762,b:2,c:3,f:To},rg32uint:{gl:33340,b:8,c:2,rb:!0},rg32sint:{gl:33339,b:8,c:2,rb:!0},rg32float:{gl:33328,b:8,c:2,render:vo,filter:Hl,rb:!0},rgba16uint:{gl:36214,b:8,c:4,rb:!0},rgba16sint:{gl:36232,b:8,c:4,rb:!0},rgba16float:{gl:34842,b:8,c:4,render:yd,filter:dT},"rgba16unorm-webgl":{gl:32859,b:2,c:4,render:To,rb:!0},"rgba16snorm-webgl":{gl:36763,b:2,c:4,render:Td},"rgb32float-webgl":{gl:34837,render:vo,filter:Hl,gl2ext:rU,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,b:16,c:4,rb:!0},rgba32sint:{gl:36226,b:16,c:4,rb:!0},rgba32float:{gl:34836,b:16,c:4,render:vo,filter:Hl,rb:!0},stencil8:{gl:36168,b:1,c:1,attachment:36128,rb:!0},depth16unorm:{gl:33189,b:2,c:1,attachment:36096,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,b:3,c:1,attachment:36096,dataFormat:6402,types:[5125]},depth32float:{gl:36012,b:4,c:1,attachment:36096,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth24unorm-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,dataFormat:34041,types:[34042],rb:!0},"depth32float-stencil8":{gl:36013,b:5,c:2,p:1,attachment:33306,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:Mo,f:tt},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:No,f:tt},"bc1-rgba-unorm":{gl:33777,x:Mo,f:tt},"bc1-rgba-unorm-srgb":{gl:35916,x:No,f:tt},"bc2-rgba-unorm":{gl:33778,x:Mo,f:tt},"bc2-rgba-unorm-srgb":{gl:35918,x:No,f:tt},"bc3-rgba-unorm":{gl:33779,x:Mo,f:tt},"bc3-rgba-unorm-srgb":{gl:35919,x:No,f:tt},"bc4-r-unorm":{gl:36283,x:is,f:tt},"bc4-r-snorm":{gl:36284,x:is,f:tt},"bc5-rg-unorm":{gl:36285,x:is,f:tt},"bc5-rg-snorm":{gl:36286,x:is,f:tt},"bc6h-rgb-ufloat":{gl:36495,x:ss,f:tt},"bc6h-rgb-float":{gl:36494,x:ss,f:tt},"bc7-rgba-unorm":{gl:36492,x:ss,f:tt},"bc7-rgba-unorm-srgb":{gl:36493,x:ss,f:tt},"etc2-rgb8unorm":{gl:37492,f:fn},"etc2-rgb8unorm-srgb":{gl:37494,f:fn},"etc2-rgb8a1unorm":{gl:37496,f:fn},"etc2-rgb8a1unorm-srgb":{gl:37497,f:fn},"etc2-rgba8unorm":{gl:37493,f:fn},"etc2-rgba8unorm-srgb":{gl:37495,f:fn},"eac-r11unorm":{gl:37488,f:fn},"eac-r11snorm":{gl:37489,f:fn},"eac-rg11unorm":{gl:37490,f:fn},"eac-rg11snorm":{gl:37491,f:fn},"astc-4x4-unorm":{gl:37808,f:ce},"astc-4x4-unorm-srgb":{gl:37840,f:ce},"astc-5x4-unorm":{gl:37809,f:ce},"astc-5x4-unorm-srgb":{gl:37841,f:ce},"astc-5x5-unorm":{gl:37810,f:ce},"astc-5x5-unorm-srgb":{gl:37842,f:ce},"astc-6x5-unorm":{gl:37811,f:ce},"astc-6x5-unorm-srgb":{gl:37843,f:ce},"astc-6x6-unorm":{gl:37812,f:ce},"astc-6x6-unorm-srgb":{gl:37844,f:ce},"astc-8x5-unorm":{gl:37813,f:ce},"astc-8x5-unorm-srgb":{gl:37845,f:ce},"astc-8x6-unorm":{gl:37814,f:ce},"astc-8x6-unorm-srgb":{gl:37846,f:ce},"astc-8x8-unorm":{gl:37815,f:ce},"astc-8x8-unorm-srgb":{gl:37847,f:ce},"astc-10x5-unorm":{gl:37819,f:ce},"astc-10x5-unorm-srgb":{gl:37851,f:ce},"astc-10x6-unorm":{gl:37817,f:ce},"astc-10x6-unorm-srgb":{gl:37849,f:ce},"astc-10x8-unorm":{gl:37818,f:ce},"astc-10x8-unorm-srgb":{gl:37850,f:ce},"astc-10x10-unorm":{gl:37819,f:ce},"astc-10x10-unorm-srgb":{gl:37851,f:ce},"astc-12x10-unorm":{gl:37820,f:ce},"astc-12x10-unorm-srgb":{gl:37852,f:ce},"astc-12x12-unorm":{gl:37821,f:ce},"astc-12x12-unorm-srgb":{gl:37853,f:ce},"pvrtc-rgb4unorm-webgl":{gl:35840,f:Wl},"pvrtc-rgba4unorm-webgl":{gl:35842,f:Wl},"pvrtc-rbg2unorm-webgl":{gl:35841,f:Wl},"pvrtc-rgba2unorm-webgl":{gl:35843,f:Wl},"etc1-rbg-unorm-webgl":{gl:36196,f:ZL},"atc-rgb-unorm-webgl":{gl:35986,f:md},"atc-rgba-unorm-webgl":{gl:35986,f:md},"atc-rgbai-unorm-webgl":{gl:34798,f:md}},oU={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},aU={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function Im(t,e,n){const r=qf[e];if(!r||r.gl===void 0)return!1;const i=r.x||r.gl2ext;return i?!!Mr(t,i,n):!0}function EA(t){const e=qf[t],n=e==null?void 0:e.gl;if(n===void 0)throw new Error(`Unsupported texture format ${t}`);return n}function lU(t,e,n){if(!Im(t,e,n)||e.startsWith("depth")||e.startsWith("stencil"))return!1;try{if(Mb(e).signed)return!1}catch{return!1}return e.endsWith("32float")?!!Mr(t,"OES_texture_float_linear, extensions",n):e.endsWith("16float")?!!Mr(t,"OES_texture_half_float_linear, extensions",n):!0}function cU(t,e,n){return!(!Im(t,e,n)||typeof e=="number")}function xu(t){var i;const e=qf[t],n=EA(t),r=Mb(t);return{format:n,dataFormat:(e==null?void 0:e.dataFormat)||fU(r.format,r.integer,r.normalized,n),type:r.dataType?SA(r.dataType):((i=e==null?void 0:e.types)==null?void 0:i[0])||5121,compressed:r.compressed}}function uU(t){const e=qf[t];if(!(e!=null&&e.attachment))throw new Error(`${t} is not a depth stencil format`);return e.attachment}function _T(t){const e=xu(t),n=oU[e.dataFormat]||4,r=aU[e.type]||1;return n*r}function fU(t,e,n,r){if(r===6408||r===6407)return r;switch(t){case"r":return e&&!n?36244:6403;case"rg":return e&&!n?33320:33319;case"rgb":return e&&!n?36248:6407;case"rgba":return e&&!n?36249:6408;default:return 6408}}const mT={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class hU extends zF{constructor(n,r,i){super([],i);T(this,"gl");T(this,"extensions");T(this,"testedFeatures",new Set);this.gl=n,this.extensions=r,Mr(n,"EXT_color_buffer_float",r)}*[Symbol.iterator](){const n=this.getFeatures();for(const r of n)this.has(r)&&(yield r);return[]}has(n){return this.disabledFeatures[n]?!1:(this.testedFeatures.has(n)||(this.testedFeatures.add(n),iU(n)&&sU(this.gl,n,this.extensions)&&this.features.add(n),this.getWebGLFeature(n)&&this.features.add(n)),this.features.has(n))}initializeFeatures(){const n=this.getFeatures().filter(r=>r!=="polygon-mode-webgl");for(const r of n)this.has(r)}getFeatures(){return[...Object.keys(mT),...Object.keys(Pm)]}getWebGLFeature(n){const r=mT[n];return typeof r=="string"?!!Mr(this.gl,r,this.extensions):!!r}}class dU extends UF{constructor(n){super();T(this,"gl");T(this,"limits",{});this.gl=n}get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}getParameter(n){return this.limits[n]===void 0&&(this.limits[n]=this.gl.getParameter(n)),this.limits[n]}}function _r(t,e,n){if(pU(e))return n(t);const{nocatch:r=!0}=e;Kf(t),Gs(t,e);let i;if(r)i=n(t),Aa(t);else try{i=n(t)}finally{Aa(t)}return i}function pU(t){for(const e in t)return!1;return!0}function gU(t,e,n,r){if(hu(e))return r(t);const i=t;Kf(i.gl);try{return _U(t,e),Gs(i.gl,n),r(t)}finally{Aa(i.gl)}}function _U(t,e){const n=t,{gl:r}=n;if(e.cullMode)switch(e.cullMode){case"none":r.disable(2884);break;case"front":r.enable(2884),r.cullFace(1028);break;case"back":r.enable(2884),r.cullFace(1029);break}if(e.frontFace&&r.frontFace(ci("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&t.features.has("depth-clip-control")&&r.enable(34383),e.depthBias!==void 0&&(r.enable(32823),r.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&t.features.has("provoking-vertex-webgl")){const s=n.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,o=ci("provokingVertex",e.provokingVertex,{first:36429,last:36430});s==null||s.provokingVertexWEBGL(o)}if((e.polygonMode||e.polygonOffsetLine)&&t.features.has("polygon-mode-webgl")){if(e.polygonMode){const s=n.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,o=ci("polygonMode",e.polygonMode,{fill:6914,line:6913});s==null||s.polygonModeWEBGL(1028,o),s==null||s.polygonModeWEBGL(1029,o)}e.polygonOffsetLine&&r.enable(10754)}if(t.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&r.enable(12288),e.clipDistance1&&r.enable(12289),e.clipDistance2&&r.enable(12290),e.clipDistance3&&r.enable(12291),e.clipDistance4&&r.enable(12292),e.clipDistance5&&r.enable(12293),e.clipDistance6&&r.enable(12294),e.clipDistance7&&r.enable(12295)),e.depthWriteEnabled!==void 0&&r.depthMask(yU("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?r.enable(2929):r.disable(2929),r.depthFunc(gg("depthCompare",e.depthCompare))),e.stencilWriteMask){const i=e.stencilWriteMask;r.stencilMaskSeparate(1028,i),r.stencilMaskSeparate(1029,i)}if(e.stencilReadMask&&U.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const i=e.stencilReadMask||4294967295,s=gg("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?r.enable(2960):r.disable(2960),r.stencilFuncSeparate(1028,s,0,i),r.stencilFuncSeparate(1029,s,0,i)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const i=wd("stencilPassOperation",e.stencilPassOperation),s=wd("stencilFailOperation",e.stencilFailOperation),o=wd("stencilDepthFailOperation",e.stencilDepthFailOperation);r.stencilOpSeparate(1028,s,o,i),r.stencilOpSeparate(1029,s,o,i)}if(e.blendColorOperation||e.blendAlphaOperation){r.enable(3042);const i=yT("blendColorOperation",e.blendColorOperation||"add"),s=yT("blendAlphaOperation",e.blendAlphaOperation||"add");r.blendEquationSeparate(i,s);const o=Xl("blendColorSrcFactor",e.blendColorSrcFactor||"one"),a=Xl("blendColorDstFactor",e.blendColorDstFactor||"zero"),l=Xl("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),c=Xl("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");r.blendFuncSeparate(o,a,l,c)}}function gg(t,e){return ci(t,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function wd(t,e){return ci(t,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function yT(t,e){return ci(t,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function Xl(t,e){return ci(t,e,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function mU(t,e){return`Illegal parameter ${e} for ${t}`}function ci(t,e,n){if(!(e in n))throw new Error(mU(t,e));return n[e]}function yU(t,e){return e}function bA(t){const e={};return t.addressModeU&&(e[10242]=Sd(t.addressModeU)),t.addressModeV&&(e[10243]=Sd(t.addressModeV)),t.addressModeW&&(e[32882]=Sd(t.addressModeW)),t.magFilter&&(e[10240]=AA(t.magFilter)),(t.minFilter||t.mipmapFilter)&&(e[10241]=vU(t.minFilter||"linear",t.mipmapFilter)),t.lodMinClamp!==void 0&&(e[33082]=t.lodMinClamp),t.lodMaxClamp!==void 0&&(e[33083]=t.lodMaxClamp),t.type==="comparison-sampler"&&(e[34892]=34894),t.compare&&(e[34893]=gg("compare",t.compare)),t.maxAnisotropy&&(e[34046]=t.maxAnisotropy),e}function Sd(t){switch(t){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function AA(t){switch(t){case"nearest":return 9728;case"linear":return 9729}}function vU(t,e){if(!e)return AA(t);switch(t){case"nearest":return e==="nearest"?9984:9986;case"linear":return e==="nearest"?9985:9987}}class xr extends Te{constructor(n,r={}){super(n,r);T(this,"device");T(this,"gl");T(this,"handle");T(this,"glTarget");T(this,"glUsage");T(this,"glIndexType",5123);T(this,"byteLength");T(this,"bytesUsed");this.device=n,this.gl=this.device.gl;const i=typeof r=="object"?r.handle:void 0;this.handle=i||this.gl.createBuffer(),n.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=TU(this.props.usage),this.glUsage=wU(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,r.data?this._initWithData(r.data,r.byteOffset,r.byteLength):this._initWithByteLength(r.byteLength||0)}_initWithData(n,r=0,i=n.byteLength+r){const s=this.glTarget;this.gl.bindBuffer(s,this.handle),this.gl.bufferData(s,i,this.glUsage),this.gl.bufferSubData(s,r,n),this.gl.bindBuffer(s,null),this.bytesUsed=i,this.byteLength=i,this._setDebugData(n,r,i),this.trackAllocatedMemory(i)}_initWithByteLength(n){ge(n>=0);let r=n;n===0&&(r=new Float32Array(0));const i=this.glTarget;return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.glUsage),this.gl.bindBuffer(i,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(null,0,n),this.trackAllocatedMemory(n),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(n,r=0){this.gl.bindBuffer(36663,this.handle),this.gl.bufferSubData(36663,r,n),this.gl.bindBuffer(36663,null),this._setDebugData(n,r,n.byteLength)}async readAsync(n=0,r){return this.readSyncWebGL(n,r)}readSyncWebGL(n=0,r){r=r??this.byteLength-n;const i=new Uint8Array(r),s=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,i,s,r),this.gl.bindBuffer(36662,null),this._setDebugData(i,n,r),i}}function TU(t){return t&Te.INDEX?34963:t&Te.VERTEX?34962:t&Te.UNIFORM?35345:34962}function wU(t){return t&Te.INDEX||t&Te.VERTEX?35044:t&Te.UNIFORM?35048:35044}class _g extends gu{constructor(n,r){super(n,r);T(this,"device");T(this,"handle");T(this,"parameters");this.device=n,this.parameters=bA(r),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(n){for(const[r,i]of Object.entries(n)){const s=Number(r);switch(s){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,s,i);break;default:this.device.gl.samplerParameteri(this.handle,s,i);break}}}}class os extends du{constructor(n,r){super(n,{...Ft.defaultProps,...r});T(this,"device");T(this,"gl");T(this,"handle");T(this,"texture");this.device=n,this.gl=this.device.gl,this.handle=null,this.texture=r.texture}}const SU={parameters:{},pixelStore:{},pixels:null,border:0,dataFormat:void 0,textureUnit:void 0,target:void 0},Jo=class Jo extends Ft{constructor(n,r){var i;super(n,{...SU,format:"rgba8unorm",...r});T(this,"MAX_ATTRIBUTES");T(this,"device");T(this,"gl");T(this,"handle");T(this,"sampler");T(this,"view");T(this,"glFormat");T(this,"type");T(this,"dataFormat");T(this,"mipmaps");T(this,"target");T(this,"textureUnit");T(this,"loaded",!1);T(this,"_video");this.device=n,this.gl=this.device.gl,this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glFormat=6408,this.target=EU(this.props),this.loaded=!1,typeof((i=this.props)==null?void 0:i.data)=="string"&&Object.assign(this.props,{data:xD(this.props.data)}),this.initialize(this.props),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}toString(){return`Texture(${this.id},${this.width}x${this.height})`}createView(n){return new os(this.device,{...n,texture:this})}initialize(n={}){if(this.props.dimension==="cube")return this.initializeCube(n);let r=n.data;if(r instanceof Promise)return r.then(m=>this.initialize(Object.assign({},n,{pixels:m,data:m}))),this;const i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement;if(i&&r.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,r.addEventListener("loadeddata",()=>this.initialize(n)),this;const{parameters:s={}}=n,{pixels:o=null,pixelStore:a={},textureUnit:l=void 0,mipmaps:c=!0}=n;r||(r=o);let{width:u,height:f,dataFormat:h,type:d,compressed:g=!1}=n;const{depth:_=0}=n,b=EA(n.format);return{width:u,height:f,compressed:g,dataFormat:h,type:d}=this._deduceParameters({format:n.format,type:d,dataFormat:h,compressed:g,data:r,width:u,height:f}),this.width=u,this.height=f,this.glFormat=b,this.type=d,this.dataFormat=h,this.textureUnit=l,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),this.mipmaps=c,this.setImageData({data:r,width:u,height:f,depth:_,format:n.format,type:d,dataFormat:h,parameters:a,compressed:g}),this.setSampler(n.sampler),this._setSamplerParameters(s),this.view=this.createView({...this.props,mipLevelCount:1,arrayLayerCount:1}),c&&this.device.isTextureFormatFilterable(n.format)&&this.generateMipmap(),i&&(this._video={video:r,parameters:s,lastTime:r.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?r.currentTime:-1}),this}initializeCube(n){const{mipmaps:r=!0,parameters:i={}}=n;return this.setCubeMapImageData(n).then(()=>{this.loaded=!0,r&&this.generateMipmap(n),this.setSampler(n.sampler),this._setSamplerParameters(i)}),this}setSampler(n={}){let r;n instanceof _g?(this.sampler=n,r=n.props):(this.sampler=new _g(this.device,n),r=n);const i=bA(r);return this._setSamplerParameters(i),this}resize(n){const{height:r,width:i,mipmaps:s=!1}=n;return i!==this.width||r!==this.height?this.initialize({width:i,height:r,format:this.format,type:this.type,dataFormat:this.dataFormat,mipmaps:s}):this}update(){if(this._video){const{video:n,parameters:r,lastTime:i}=this._video;if(i===n.currentTime||n.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:n,parameters:r}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=n.currentTime}}generateMipmap(n={}){return this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),_r(this.gl,n,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this}setImageData(n){if(this.props.dimension==="3d"||this.props.dimension==="2d-array")return this.setImageData3D(n);this.trackDeallocatedMemory("Texture");const{target:r=this.target,pixels:i=null,level:s=0,glFormat:o=this.glFormat,offset:a=0,parameters:l={}}=n;let{data:c=null,type:u=this.type,width:f=this.width,height:h=this.height,dataFormat:d=this.dataFormat,compressed:g=!1}=n;c||(c=i),{type:u,dataFormat:d,compressed:g,width:f,height:h}=this._deduceParameters({format:this.props.format,type:u,dataFormat:d,compressed:g,data:c,width:f,height:h});const{gl:_}=this;_.bindTexture(this.target,this.handle);let b=null;if({data:c,dataType:b}=this._getDataType({data:c,compressed:g}),_r(this.gl,l,()=>{switch(b){case"null":_.texImage2D(r,s,o,f,h,0,d,u,c);break;case"typed-array":_.texImage2D(r,s,o,f,h,0,d,u,c,a);break;case"buffer":this.device.gl.bindBuffer(35052,c.handle||c),this.device.gl.texImage2D(r,s,o,f,h,0,d,u,a),this.device.gl.bindBuffer(35052,null);break;case"browser-object":_.texImage2D(r,s,o,f,h,0,d,u,c);break;case"compressed":for(const[m,p]of c.entries())_.compressedTexImage2D(r,m,p.format,p.width,p.height,0,p.data);break;default:ge(!1,"Unknown image data type")}}),c&&c.byteLength)this.trackAllocatedMemory(c.byteLength,"Texture");else{const m=_T(this.props.format);this.trackAllocatedMemory(this.width*this.height*m,"Texture")}return this.loaded=!0,this}setSubImageData({target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:o=0,width:a=this.width,height:l=this.height,level:c=0,glFormat:u=this.glFormat,type:f=this.type,dataFormat:h=this.dataFormat,compressed:d=!1,offset:g=0,parameters:_={}}){if({type:f,dataFormat:h,compressed:d,width:a,height:l}=this._deduceParameters({format:this.props.format,type:f,dataFormat:h,compressed:d,data:i,width:a,height:l}),ge(this.depth===1,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const b=i;i=b.data,a=b.shape[0],l=b.shape[1]}i instanceof xr&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),_r(this.gl,_,()=>{d?this.gl.compressedTexSubImage2D(n,c,s,o,a,l,u,i):i===null?this.gl.texSubImage2D(n,c,s,o,a,l,h,f,null):ArrayBuffer.isView(i)?this.gl.texSubImage2D(n,c,s,o,a,l,h,f,i,g):typeof WebGLBuffer<"u"&&i instanceof WebGLBuffer?(this.device.gl.bindBuffer(35052,i),this.device.gl.texSubImage2D(n,c,s,o,a,l,h,f,g),this.device.gl.bindBuffer(35052,null)):this.device.gl.texSubImage2D(n,c,s,o,a,l,h,f,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(n={}){return U.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(n=this.textureUnit){const{gl:r}=this;return n!==void 0&&(this.textureUnit=n,r.activeTexture(33984+n)),r.bindTexture(this.target,this.handle),n}unbind(n=this.textureUnit){const{gl:r}=this;return n!==void 0&&(this.textureUnit=n,r.activeTexture(33984+n)),r.bindTexture(this.target,null),n}_getDataType({data:n,compressed:r=!1}){return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof xr?{data:n.handle,dataType:"buffer"}:typeof WebGLBuffer<"u"&&n instanceof WebGLBuffer?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(n){const{format:r,data:i}=n;let{width:s,height:o,dataFormat:a,type:l,compressed:c}=n;const u=xu(r);return a=a||u.dataFormat,l=l||u.type,c=c||u.compressed,{width:s,height:o}=this._deduceImageSize(i,s,o),{dataFormat:a,type:l,compressed:c,width:s,height:o,format:r,data:i}}_deduceImageSize(n,r,i){let s;return typeof ImageData<"u"&&n instanceof ImageData?s={width:n.width,height:n.height}:typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement?s={width:n.naturalWidth,height:n.naturalHeight}:typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement?s={width:n.width,height:n.height}:typeof ImageBitmap<"u"&&n instanceof ImageBitmap?s={width:n.width,height:n.height}:typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement?s={width:n.videoWidth,height:n.videoHeight}:n?s={width:r,height:i}:s={width:r>=0?r:1,height:i>=0?i:1},ge(s,"Could not deduced texture size"),ge(r===void 0||s.width===r,"Deduced texture width does not match supplied width"),ge(i===void 0||s.height===i,"Deduced texture height does not match supplied height"),s}async setCubeMapImageData(n){const{gl:r}=this,{width:i,height:s,pixels:o,data:a,format:l=6408,type:c=5121}=n,u=o||a,f=await Promise.all(Jo.FACES.map(h=>{const d=u[h];return Promise.all(Array.isArray(d)?d:[d])}));this.bind(),Jo.FACES.forEach((h,d)=>{f[d].length>1&&this.props.mipmaps!==!1&&U.warn(`${this.id} has mipmap and multiple LODs.`)(),f[d].forEach((g,_)=>{i&&s?r.texImage2D(h,_,l,i,s,0,l,c,g):r.texImage2D(h,_,l,l,c,g)})}),this.unbind()}setImageDataForFace(n){const{face:r,width:i,height:s,pixels:o,data:a,format:l=6408,type:c=5121}=n,{gl:u}=this,f=o||a;return this.bind(),f instanceof Promise?f.then(h=>this.setImageDataForFace(Object.assign({},n,{face:r,data:h,pixels:h}))):this.width||this.height?u.texImage2D(r,0,l,i,s,0,l,c,f):u.texImage2D(r,0,l,l,c,f),this}setImageData3D(n){const{level:r=0,dataFormat:i,format:s,type:o,width:a,height:l,depth:c=1,offset:u=0,data:f,parameters:h={}}=n;this.trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle);const d=xu(s);if(_r(this.gl,h,()=>{ArrayBuffer.isView(f)&&this.gl.texImage3D(this.target,r,d.format,a,l,c,0,d.dataFormat,d.type,f),f instanceof xr&&(this.gl.bindBuffer(35052,f.handle),this.gl.texImage3D(this.target,r,i,a,l,c,0,s,o,u))}),f&&f.byteLength)this.trackAllocatedMemory(f.byteLength,"Texture");else{const g=_T(this.props.format);this.trackAllocatedMemory(this.width*this.height*this.depth*g,"Texture")}return this.loaded=!0,this}_setSamplerParameters(n){if(!hu(n)){bU(n),this.gl.bindTexture(this.target,this.handle);for(const[r,i]of Object.entries(n)){const s=Number(r),o=i;switch(s){case 33082:case 33083:this.gl.texParameterf(this.target,s,o);break;default:this.gl.texParameteri(this.target,s,o);break}}this.gl.bindTexture(this.target,null)}}};T(Jo,"FACES",[34069,34070,34071,34072,34073,34074]);let wn=Jo;function EU(t){switch(t.dimension){case"2d":return 3553;case"cube":return 34067;case"2d-array":return 35866;case"3d":return 32879;case"1d":case"cube-array":default:throw new Error(t.dimension)}}function bU(t){U.log(1,"texture sampler parameters",t)()}class Xo extends _u{constructor(n,r){super(n,r);T(this,"device");T(this,"gl");T(this,"handle");const i=r.handle===null;if(this.device=n,this.gl=n.gl,this.handle=this.props.handle||i?this.props.handle:this.gl.createFramebuffer(),!i){n.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures();const s=this.gl.bindFramebuffer(36160,this.handle);for(let o=0;o<this.colorAttachments.length;++o){const a=this.colorAttachments[o],l=36064+o;a&&this._attachOne(l,a)}if(this.depthStencilAttachment&&this._attachOne(uU(this.depthStencilAttachment.props.format),this.depthStencilAttachment),r.check!==!1){const o=this.gl.checkFramebufferStatus(36160);if(o!==36053)throw new Error(`Framebuffer ${RU(o)}`)}this.gl.bindFramebuffer(36160,s)}}get texture(){return this.colorAttachments[0]}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}createDepthStencilTexture(n){return new wn(this.device,{id:`${this.id}-depth-stencil`,format:n,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(n,r){if(this.handle===null)return this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight);for(const i of this.colorAttachments)i.texture.resize({width:n,height:r});return this.depthStencilAttachment&&this.depthStencilAttachment.texture.resize({width:n,height:r}),this}_attachOne(n,r){if(Array.isArray(r)){const[i,s=0,o=0]=r;return this._attachTexture(n,i,s,o),i}if(r instanceof wn)return this._attachTexture(n,r,0,0),r;if(r instanceof os){const i=r;return this._attachTexture(n,i.texture,i.props.baseMipLevel,i.props.baseArrayLayer),r.texture}throw new Error("attach")}_attachTexture(n,r,i,s){const{gl:o}=this.device;switch(o.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:o.framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const a=AU(i);o.framebufferTexture2D(36160,n,a,r.handle,s);break;case 3553:o.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:ge(!1,"Illegal texture type")}o.bindTexture(r.target,null)}}function AU(t){return t<34069?t+34069:t}function RU(t){switch(t){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${t}`}}class xU extends wm{constructor(n,r){super(r);T(this,"device");T(this,"presentationSize");T(this,"_framebuffer",null);this.device=n,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new Xo(this.device,{handle:null}),this._framebuffer}update(){const n=this.getPixelSize();(n[0]!==this.presentationSize[0]||n[1]!==this.presentationSize[1])&&(this.presentationSize=n,this.resize())}resize(n){if(this.device.gl&&this.canvas){const r=this.getDevicePixelRatio(n==null?void 0:n.useDevicePixels);this.setDevicePixelRatio(r,n);return}}commit(){}}const CU={spector:U.get("spector")||U.get("spectorjs")},PU="https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",IU=1;let ue=null,vT=!1;async function MU(t){if(!globalThis.SPECTOR)try{await Ub(PU)}catch(e){U.warn(String(e))}}function NU(t){if(t={...CU,...t},!(t!=null&&t.spector)||(!ue&&globalThis.SPECTOR&&(U.probe(IU,"SPECTOR found and initialized")(),ue=new globalThis.SPECTOR.Spector,globalThis.luma&&(globalThis.luma.spector=ue)),!ue))return null;if(vT||(vT=!0,ue.spyCanvases(),ue==null||ue.onCaptureStarted.add(e=>U.info("Spector capture started:",e)()),ue==null||ue.onCapture.add(e=>{U.info("Spector capture complete:",e)(),ue==null||ue.getResultUI(),ue==null||ue.resultView.display(),ue==null||ue.resultView.addCapture(e)})),t!=null&&t.canvas){if(typeof t.spector=="string"&&t.spector!==t.canvas.id)return ue;ue==null||ue.startCapture(t==null?void 0:t.canvas,500),new Promise(e=>setTimeout(e,2e3)).then(e=>{U.info("Spector capture stopped after 2 seconds")(),ue==null||ue.stopCapture()})}return ue}const kU="https://unpkg.com/webgl-debug@2.0.1/index.js";function RA(t){return t.luma=t.luma||{},t.luma}async function OU(){Lr()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await Ub(kU))}function FU(t,e={}){return t?e.debug?BU(t,e):DU(t):null}function DU(t){const e=RA(t);return e.realContext?e.realContext:t}function BU(t,e){if(!globalThis.WebGLDebugUtils)return U.warn("webgl-debug not loaded")(),t;const n=RA(t);if(n.debugContext)return n.debugContext;globalThis.WebGLDebugUtils.init({...rs,...t});const r=globalThis.WebGLDebugUtils.makeDebugContext(t,LU.bind(null,e),UU.bind(null,e));for(const o in rs)!(o in r)&&typeof rs[o]=="number"&&(r[o]=rs[o]);class i{}Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.setPrototypeOf(i,r);const s=Object.create(i);return n.realContext=t,n.debugContext=s,s.debug=!0,s}function Ed(t,e){e=Array.from(e).map(r=>r===void 0?"undefined":r);let n=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,e);return n=`${n.slice(0,100)}${n.length>100?"...":""}`,`gl.${t}(${n})`}function LU(t,e,n,r){r=Array.from(r).map(a=>a===void 0?"undefined":a);const i=globalThis.WebGLDebugUtils.glEnumToString(e),s=globalThis.WebGLDebugUtils.glFunctionArgsToString(n,r),o=`${i} in gl.${n}(${s})`;U.error(o)();debugger;if(t.throwOnError)throw new Error(o)}function UU(t,e,n){let r="";if(U.level>=1&&(r=Ed(e,n),U.log(1,r)()),t.break&&t.break.length>0&&(r=r||Ed(e,n),t.break.every(s=>r.indexOf(s)!==-1)))debugger;for(const i of n)if(i===void 0){if(r=r||Ed(e,n),t.throwOnError)throw new Error(`Undefined argument: ${r}`);U.error(`Undefined argument: ${r}`)();debugger}}function zU(t){const e=t.split(/\r?\n/),n=[];for(const r of e){if(r.length<=1)continue;const i=r.split(":");if(i.length===2){const[f,h]=i;n.push({message:h.trim(),type:TT(f),lineNum:0,linePos:0});continue}const[s,o,a,...l]=i;let c=parseInt(a,10);isNaN(c)&&(c=0);let u=parseInt(o,10);isNaN(u)&&(u=0),n.push({message:l.join(":").trim(),type:TT(s),lineNum:c,linePos:u})}return n}function TT(t){const e=["warning","error","info"],n=t.toLowerCase();return e.includes(n)?n:"info"}class $U extends pu{constructor(n,r){super(n,r);T(this,"device");T(this,"handle");switch(this.device=n,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const n=this.device.gl.getShaderInfoLog(this.handle);return zU(n)}getTranslatedSource(){const r=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return r==null?void 0:r.getTranslatedShaderSource(this.handle)}async _compile(n){n=(s=>s.startsWith("#version ")?s:`#version 100
${s}`)(n);const{gl:i}=this.device;if(i.shaderSource(this.handle,n),i.compileShader(this.handle),U.level===0){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}U.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),U.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const n=async s=>await new Promise(o=>setTimeout(o,s));if(!this.device.features.has("compilation-status-async-webgl")){await n(10);return}const{gl:i}=this.device;for(;;){if(i.getShaderParameter(this.handle,37297))return;await n(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}const VU=256,jU=1024,WU=16384,bd=6144,HU=[1,2,4,8];class XU extends Zp{constructor(n,r){super(n,r);T(this,"device");T(this,"glParameters");this.device=n,Kf(this.device.gl),this.setParameters(this.props.parameters),this.clear()}end(){Aa(this.device.gl)}pushDebugGroup(n){}popDebugGroup(){}insertDebugMarker(n){}setParameters(n={}){const r={...this.glParameters};this.props.framebuffer&&(r.framebuffer=this.props.framebuffer),this.props.depthReadOnly&&(r.depthMask=!this.props.depthReadOnly),r.stencilMask=this.props.stencilReadOnly?0:1,r[35977]=this.props.discard,n.viewport&&(n.viewport.length>=6?(r.viewport=n.viewport.slice(0,4),r.depthRange=[n.viewport[4],n.viewport[5]]):r.viewport=n.viewport),n.scissorRect&&(r.scissorTest=!0,r.scissor=n.scissorRect),n.blendConstant&&(r.blendColor=n.blendConstant),n.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),n[2967]=n.stencilReference),n.colorMask&&(r.colorMask=HU.map(i=>!!(i&n.colorMask))),this.glParameters=r,Gs(this.device.gl,r)}beginOcclusionQuery(n){const r=this.props.occlusionQuerySet;r==null||r.beginOcclusionQuery()}endOcclusionQuery(){const n=this.props.occlusionQuerySet;n==null||n.endOcclusionQuery()}clear(){const n={...this.glParameters};let r=0;this.props.clearColor!==!1&&(r|=WU,n.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(r|=VU,n.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(r|=jU,n.clearStencil=this.props.clearStencil),r!==0&&_r(this.device.gl,n,()=>{this.device.gl.clear(r)})}clearColorBuffer(n=0,r=[0,0,0,0]){_r(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(r.constructor){case Int32Array:this.device.gl.clearBufferiv(bd,n,r);break;case Uint32Array:this.device.gl.clearBufferuiv(bd,n,r);break;case Float32Array:default:this.device.gl.clearBufferfv(bd,n,r);break}})}}const YU="Failed to deduce GL constant from typed array";function KU(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(YU)}}function mg(t,e){const{clamped:n=!0}=e||{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}const qU={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},ZU={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Yo{constructor(...e){T(this,"offset");T(this,"stride");T(this,"type");T(this,"size");T(this,"divisor");T(this,"normalized");T(this,"integer");T(this,"buffer");T(this,"index");e.forEach(n=>this._assign(n)),Object.freeze(this)}static getBytesPerElement(e){return mg(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return ge(e.size),mg(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new Yo(qU,...e)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Yo.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Yo.getBytesPerVertex(this)}_assign(e={}){return e=AD("Accessor",e,ZU),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalize!==void 0&&(this.normalized=e.normalize),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this.offset===void 0&&delete this.offset,this.stride===void 0&&delete this.stride,this.type===void 0&&delete this.type,this.size===void 0&&delete this.size,this.divisor===void 0&&delete this.divisor,this.normalized===void 0&&delete this.normalized,this.integer===void 0&&delete this.integer,this.buffer===void 0&&delete this.buffer,this.index===void 0&&delete this.index,this}}function QU(t){return JU.includes(t)}const JU=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],xA={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function CA(t){const e=xA[t];if(!e)throw new Error("uniform");const[n,r,,i]=e;return{format:i,components:r,glType:n}}function GU(t){const e=xA[t];if(!e)throw new Error("attribute");const[,n,,r,i]=e;return{attributeType:r,vertexFormat:i,components:n}}function e5(t,e){const n={attributes:[],bindings:[]};n.attributes=t5(t,e);const r=i5(t,e);for(const a of r){const l=a.uniforms.map(c=>({name:c.name,format:c.format,byteOffset:c.byteOffset,byteStride:c.byteStride,arrayLength:c.arrayLength}));n.bindings.push({type:"uniform",name:a.name,location:a.location,visibility:(a.vertex?1:0)&(a.fragment?2:0),minBindingSize:a.byteLength,uniforms:l})}const i=r5(t,e);let s=0;for(const a of i)if(QU(a.type)){const{viewDimension:l,sampleType:c}=o5(a.type);n.bindings.push({type:"texture",name:a.name,location:s,viewDimension:l,sampleType:c}),a.textureUnit=s,s+=1}i.length&&(n.uniforms=i);const o=n5(t,e);return o!=null&&o.length&&(n.varyings=o),n}function t5(t,e){const n=[],r=t.getProgramParameter(e,35721);for(let i=0;i<r;i++){const s=t.getActiveAttrib(e,i);if(!s)throw new Error("activeInfo");const{name:o,type:a}=s,l=t.getAttribLocation(e,o);if(l>=0){const{attributeType:c}=GU(a),u=/instance/i.test(o)?"instance":"vertex";n.push({name:o,location:l,stepMode:u,type:c})}}return n.sort((i,s)=>i.location-s.location),n}function n5(t,e){const n=[],r=t.getProgramParameter(e,35971);for(let i=0;i<r;i++){const s=t.getTransformFeedbackVarying(e,i);if(!s)throw new Error("activeInfo");const{name:o,type:a,size:l}=s,{glType:c,components:u}=CA(a),f=new Yo({type:c,size:l*u}),h={location:i,name:o,accessor:f};n.push(h)}return n.sort((i,s)=>i.location-s.location),n}function r5(t,e){const n=[],r=t.getProgramParameter(e,35718);for(let i=0;i<r;i++){const s=t.getActiveUniform(e,i);if(!s)throw new Error("activeInfo");const{name:o,size:a,type:l}=s,{name:c,isArray:u}=a5(o);let f=t.getUniformLocation(e,c);const h={location:f,name:c,size:a,type:l,isArray:u};if(n.push(h),h.size>1)for(let d=0;d<h.size;d++){const g=`${c}[${d}]`;f=t.getUniformLocation(e,g);const _={...h,name:g,location:f};n.push(_)}}return n}function i5(t,e){const n=(s,o)=>t.getActiveUniformBlockParameter(e,s,o),r=[],i=t.getProgramParameter(e,35382);for(let s=0;s<i;s++){const o={name:t.getActiveUniformBlockName(e,s)||"",location:n(s,35391),byteLength:n(s,35392),vertex:n(s,35396),fragment:n(s,35398),uniformCount:n(s,35394),uniforms:[]},a=n(s,35395)||[],l=t.getActiveUniforms(e,a,35383),c=t.getActiveUniforms(e,a,35384),u=t.getActiveUniforms(e,a,35387),f=t.getActiveUniforms(e,a,35388);for(let h=0;h<o.uniformCount;++h){const d=t.getActiveUniform(e,a[h]);if(!d)throw new Error("activeInfo");o.uniforms.push({name:d.name,format:CA(l[h]).format,type:l[h],arrayLength:c[h],byteOffset:u[h],byteStride:f[h]})}r.push(o)}return r.sort((s,o)=>s.location-o.location),r}const s5={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function o5(t){const e=s5[t];if(!e)throw new Error("sampler");const[n,r]=e;return{viewDimension:n,sampleType:r}}function a5(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const n=/([^[]*)(\[[0-9]+\])?/.exec(t);if(!n||n.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:n[1],length:n[2]?1:0,isArray:!!n[2]}}function l5(t,e,n,r){const i=t;let s=r;s===!0&&(s=1),s===!1&&(s=0);const o=typeof s=="number"?[s]:s;switch(n){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof r!="number")throw new Error("samplers must be set to integers");return t.uniform1i(e,r);case 5126:return t.uniform1fv(e,o);case 35664:return t.uniform2fv(e,o);case 35665:return t.uniform3fv(e,o);case 35666:return t.uniform4fv(e,o);case 5124:return t.uniform1iv(e,o);case 35667:return t.uniform2iv(e,o);case 35668:return t.uniform3iv(e,o);case 35669:return t.uniform4iv(e,o);case 35670:return t.uniform1iv(e,o);case 35671:return t.uniform2iv(e,o);case 35672:return t.uniform3iv(e,o);case 35673:return t.uniform4iv(e,o);case 5125:return i.uniform1uiv(e,o,1);case 36294:return i.uniform2uiv(e,o,2);case 36295:return i.uniform3uiv(e,o,3);case 36296:return i.uniform4uiv(e,o,4);case 35674:return t.uniformMatrix2fv(e,!1,o);case 35675:return t.uniformMatrix3fv(e,!1,o);case 35676:return t.uniformMatrix4fv(e,!1,o);case 35685:return i.uniformMatrix2x3fv(e,!1,o);case 35686:return i.uniformMatrix2x4fv(e,!1,o);case 35687:return i.uniformMatrix3x2fv(e,!1,o);case 35688:return i.uniformMatrix3x4fv(e,!1,o);case 35689:return i.uniformMatrix4x2fv(e,!1,o);case 35690:return i.uniformMatrix4x3fv(e,!1,o)}throw new Error("Illegal uniform")}function c5(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"line-loop-webgl":return 2;case"triangle-list":return 4;case"triangle-strip":return 5;case"triangle-fan-webgl":return 6;default:throw new Error(t)}}function u5(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"line-loop-webgl":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;case"triangle-fan-webgl":return 4;default:throw new Error(t)}}const wT=4;class f5 extends Bs{constructor(n,r){super(n,r);T(this,"device");T(this,"handle");T(this,"vs");T(this,"fs");T(this,"introspectedLayout");T(this,"uniforms",{});T(this,"bindings",{});T(this,"varyings",null);T(this,"_uniformCount",0);T(this,"_uniformSetters",{});this.device=n,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=r.vs,this.fs=r.fs;const{varyings:i,bufferMode:s=35981}=r;switch(i&&i.length>0&&(this.varyings=i,this.device.gl.transformFeedbackVaryings(this.handle,i,s)),this._linkShaders(),U.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=e5(this.device.gl,this.handle),U.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=hD(this.introspectedLayout,r.shaderLayout),this.props.topology){case"triangle-fan-webgl":case"line-loop-webgl":U.warn(`Primitive topology ${this.props.topology} is deprecated and will be removed in v9.1`);break}}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(n,r){for(const[i,s]of Object.entries(n)){const o=this.shaderLayout.bindings.find(a=>a.name===i)||this.shaderLayout.bindings.find(a=>a.name===`${i}Uniforms`);if(!o){const a=this.shaderLayout.bindings.map(l=>`"${l.name}"`).join(", ");r!=null&&r.disableWarnings||U.warn(`Unknown binding "${i}" in render pipeline "${this.id}", expected one of ${a}`)();continue}switch(s||U.warn(`Unsetting binding "${i}" in render pipeline "${this.id}"`)(),o.type){case"uniform":if(!(s instanceof xr)&&!(s.buffer instanceof xr))throw new Error("buffer value");break;case"texture":if(!(s instanceof os||s instanceof wn||s instanceof Xo))throw new Error("texture value");break;case"sampler":U.warn(`Ignoring sampler ${i}`)();break;default:throw new Error(o.type)}this.bindings[i]=s}}draw(n){var b;const{renderPass:r,parameters:i=this.props.parameters,topology:s=this.props.topology,vertexArray:o,vertexCount:a,instanceCount:l,isInstanced:c=!1,firstVertex:u=0,transformFeedback:f}=n,h=c5(s),d=!!o.indexBuffer,g=(b=o.indexBuffer)==null?void 0:b.glIndexType;if(this.linkStatus!=="success")return U.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable()||a===0)return U.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;if(a===0)return U.info(2,`RenderPipeline:${this.id}.draw() aborted - no vertices to draw`)(),!0;this.device.gl.useProgram(this.handle),o.bindBeforeRender(r),f&&f.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const _=r;return gU(this.device,i,_.glParameters,()=>{d&&c?this.device.gl.drawElementsInstanced(h,a||0,g,u,l||0):d?this.device.gl.drawElements(h,a||0,g,u):c?this.device.gl.drawArraysInstanced(h,u,a||0,l||0):this.device.gl.drawArrays(h,u,a||0),f&&f.end()}),o.unbindAfterRender(r),!0}setUniformsWebGL(n){const{bindings:r}=Sm(n);Object.keys(r).forEach(i=>{U.warn(`Unsupported value "${JSON.stringify(r[i])}" used in setUniforms() for key ${i}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,n)}async _linkShaders(){const{gl:n}=this.device;if(n.attachShader(this.handle,this.vs.handle),n.attachShader(this.handle,this.fs.handle),U.time(wT,`linkProgram for ${this.id}`)(),n.linkProgram(this.handle),U.timeEnd(wT,`linkProgram for ${this.id}`)(),U.level,!this.device.features.has("compilation-status-async-webgl")){const i=this._getLinkStatus();this._reportLinkStatus(i);return}U.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),U.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const r=this._getLinkStatus();this._reportLinkStatus(r)}_reportLinkStatus(n){var r;switch(n){case"success":return;default:throw this.vs.compilationStatus==="error"?(this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`)):((r=this.fs)==null?void 0:r.compilationStatus)==="error"?(this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`)):new Error(`Error during ${n}: ${this.device.gl.getProgramInfoLog(this.handle)}`)}}_getLinkStatus(){const{gl:n}=this.device;return n.getProgramParameter(this.handle,35714)?(n.validateProgram(this.handle),n.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")):(this.linkStatus="error","linking")}async _waitForLinkComplete(){const n=async s=>await new Promise(o=>setTimeout(o,s));if(!this.device.features.has("compilation-status-async-webgl")){await n(10);return}const{gl:i}=this.device;for(;;){if(i.getProgramParameter(this.handle,37297))return;await n(10)}}_areTexturesRenderable(){let n=!0;for(const[,r]of Object.entries(this.bindings))r instanceof wn&&(r.update(),n=n&&r.loaded);return n}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:n}=this.device;n.useProgram(this.handle);let r=0,i=0;for(const s of this.shaderLayout.bindings){const o=this.bindings[s.name]||this.bindings[s.name.replace(/Uniforms$/,"")];if(!o)throw new Error(`No value for binding ${s.name} in ${this.id}`);switch(s.type){case"uniform":const{name:a}=s,l=n.getUniformBlockIndex(this.handle,a);if(l===4294967295)throw new Error(`Invalid uniform block name ${a}`);n.uniformBlockBinding(this.handle,i,l),o instanceof xr?n.bindBufferBase(35345,i,o.handle):n.bindBufferRange(35345,i,o.buffer.handle,o.offset||0,o.size||o.buffer.byteLength-o.offset),i+=1;break;case"texture":if(!(o instanceof os||o instanceof wn||o instanceof Xo))throw new Error("texture");let c;if(o instanceof os)c=o.texture;else if(o instanceof wn)c=o;else if(o instanceof Xo&&o.colorAttachments[0]instanceof os)U.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),c=o.colorAttachments[0].texture;else throw new Error("No texture");n.activeTexture(33984+r),n.bindTexture(c.target,c.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${s.type}' not supported in WebGL`)}}}_applyUniforms(){for(const n of this.shaderLayout.uniforms||[]){const{name:r,location:i,type:s,textureUnit:o}=n,a=this.uniforms[r]??o;a!==void 0&&l5(this.device.gl,i,s,a)}}}class h5 extends Jp{constructor(n){super(n,{});T(this,"device");T(this,"commands",[]);this.device=n}submitCommands(n=this.commands){for(const r of n)switch(r.name){case"copy-buffer-to-buffer":d5(this.device,r.options);break;case"copy-buffer-to-texture":p5(this.device,r.options);break;case"copy-texture-to-buffer":g5(this.device,r.options);break;case"copy-texture-to-texture":_5(this.device,r.options);break}}}function d5(t,e){const n=e.source,r=e.destination;t.gl.bindBuffer(36662,n.handle),t.gl.bindBuffer(36663,r.handle),t.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),t.gl.bindBuffer(36662,null),t.gl.bindBuffer(36663,null)}function p5(t,e){throw new Error("Not implemented")}function g5(t,e){const{source:n,mipLevel:r=0,aspect:i="all",width:s=e.source.width,height:o=e.source.height,depthOrArrayLayers:a=0,origin:l=[0,0],destination:c,byteOffset:u=0,bytesPerRow:f,rowsPerImage:h}=e;if(i!=="all")throw new Error("not supported");if(r!==0||a!==0||f||h)throw new Error("not implemented");const{framebuffer:d,destroyFramebuffer:g}=PA(n);let _;try{const b=c,m=s||d.width,p=o||d.height,y=xu(d.texture.props.format),w=y.dataFormat,A=y.type;t.gl.bindBuffer(35051,b.handle),_=t.gl.bindFramebuffer(36160,d.handle),t.gl.readPixels(l[0],l[1],m,p,w,A,u)}finally{t.gl.bindBuffer(35051,null),_!==void 0&&t.gl.bindFramebuffer(36160,_),g&&d.destroy()}}function _5(t,e){const{source:n,destinationMipLevel:r=0,origin:i=[0,0],destinationOrigin:s=[0,0],destination:o}=e;let{width:a=e.destination.width,height:l=e.destination.height}=e;const{framebuffer:c,destroyFramebuffer:u}=PA(n),[f,h]=i,[d,g,_]=s,b=t.gl.bindFramebuffer(36160,c.handle);let m=null,p;if(o instanceof wn)m=o,a=Number.isFinite(a)?a:m.width,l=Number.isFinite(l)?l:m.height,m.bind(0),p=m.target;else throw new Error("invalid destination");switch(p){case 3553:case 34067:t.gl.copyTexSubImage2D(p,r,d,g,f,h,a,l);break;case 35866:case 32879:t.gl.copyTexSubImage3D(p,r,d,g,_,f,h,a,l);break}m&&m.unbind(),t.gl.bindFramebuffer(36160,b),u&&c.destroy()}function PA(t){if(t instanceof Ft){const{width:e,height:n,id:r}=t;return{framebuffer:t.device.createFramebuffer({id:`framebuffer-for-${r}`,width:e,height:n,colorAttachments:[t]}),destroyFramebuffer:!0}}return{framebuffer:t,destroyFramebuffer:!1}}class m5 extends Qp{constructor(n,r){super(n,r);T(this,"device");T(this,"commandBuffer");this.device=n,this.commandBuffer=new h5(n)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(n){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:n})}copyBufferToTexture(n){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:n})}copyTextureToBuffer(n){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:n})}copyTextureToTexture(n){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:n})}pushDebugGroup(n){}popDebugGroup(){}insertDebugMarker(n){}resolveQuerySet(n,r,i){}}class Mm extends Gp{constructor(n,r){super(n,r);T(this,"device");T(this,"handle");T(this,"buffer",null);T(this,"bufferValue",null);this.device=n,this.handle=this.device.gl.createVertexArray()}get[Symbol.toStringTag](){return"VertexArray"}static isConstantAttributeZeroSupported(n){return NN()==="Chrome"}destroy(){var n;super.destroy(),this.buffer&&((n=this.buffer)==null||n.destroy()),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(n){const r=n;if(r&&r.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,r?r.handle:null),this.indexBuffer=r,this.device.gl.bindVertexArray(null)}setBuffer(n,r){const i=r;if(i.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:s,type:o,stride:a,offset:l,normalized:c,integer:u,divisor:f}=this._getAccessor(n);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,i.handle),u?this.device.gl.vertexAttribIPointer(n,s,o,a,l):this.device.gl.vertexAttribPointer(n,s,o,c,a,l),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(n),this.device.gl.vertexAttribDivisor(n,f||0),this.attributes[n]=i,this.device.gl.bindVertexArray(null)}setConstantWebGL(n,r){this._enable(n,!1),this.attributes[n]=r}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let n=0;n<this.maxVertexAttributes;++n){const r=this.attributes[n];ArrayBuffer.isView(r)&&this.device.setConstantAttributeWebGL(n,r)}}_getAccessor(n){const r=this.attributeInfos[n];if(!r)throw new Error(`Unknown attribute location ${n}`);const i=SA(r.bufferDataType);return{size:r.bufferComponents,type:i,stride:r.byteStride,offset:r.byteOffset,normalized:r.normalized,integer:r.integer,divisor:r.stepMode==="instance"?1:0}}_enable(n,r=!0){const s=Mm.isConstantAttributeZeroSupported(this.device)||n!==0;(r||s)&&(n=Number(n),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(n):this.device.gl.disableVertexAttribArray(n),this.device.gl.bindVertexArray(null))}getConstantBuffer(n,r){const i=y5(r),s=i.byteLength*n,o=i.length*n;if(this.buffer&&s!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${s} !== ${this.buffer.byteLength}.`);let a=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:s}),a=a||!v5(i,this.bufferValue),a){const l=_D(r.constructor,o);mD({target:l,source:i,start:0,count:o}),this.buffer.write(l),this.bufferValue=r}return this.buffer}}function y5(t){return Array.isArray(t)?new Float32Array(t):t}function v5(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}class T5 extends eg{constructor(n,r){super(n,r);T(this,"device");T(this,"gl");T(this,"handle");T(this,"layout");T(this,"buffers",{});T(this,"unusedBuffers",{});T(this,"bindOnUse",!0);T(this,"_bound",!1);this.device=n,this.gl=n.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,r.buffers&&this.setBuffers(r.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(n="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(u5(n))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(n){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const r in n)this.setBuffer(r,n[r])})}setBuffer(n,r){const i=this._getVaryingIndex(n),{buffer:s,byteLength:o,byteOffset:a}=this._getBufferRange(r);if(i<0){this.unusedBuffers[n]=s,U.warn(`${this.id} unusedBuffers varying buffer ${n}`)();return}this.buffers[i]={buffer:s,byteLength:o,byteOffset:a},this.bindOnUse||this._bindBuffer(i,s,a,o)}getBuffer(n){if(ST(n))return this.buffers[n]||null;const r=this._getVaryingIndex(n);return r>=0?this.buffers[r]:null}bind(n=this.handle){if(typeof n!="function")return this.gl.bindTransformFeedback(36386,n),this;let r;return this._bound?r=n():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,r=n(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),r}unbind(){this.bind(null)}_getBufferRange(n){if(n instanceof xr)return{buffer:n,byteOffset:0,byteLength:n.byteLength};const{buffer:r,byteOffset:i=0,byteLength:s=n.buffer.byteLength}=n;return{buffer:r,byteOffset:i,byteLength:s}}_getVaryingIndex(n){if(ST(n))return Number(n);for(const r of this.layout.varyings)if(n===r.name)return r.location;return-1}_bindBuffers(){for(const n in this.buffers){const{buffer:r,byteLength:i,byteOffset:s}=this._getBufferRange(this.buffers[n]);this._bindBuffer(Number(n),r,s,i)}}_unbindBuffers(){for(const n in this.buffers)this.gl.bindBufferBase(35982,Number(n),null)}_bindBuffer(n,r,i=0,s){const o=r&&r.handle;!o||s===void 0?this.gl.bindBufferBase(35982,n,o):this.gl.bindBufferRange(35982,n,o,i,s)}}function ST(t){return typeof t=="number"?Number.isInteger(t):/^\d+$/.test(t)}class w5 extends tg{constructor(n,r){super(n,r);T(this,"device");T(this,"handle");T(this,"target",null);T(this,"_queryPending",!1);T(this,"_pollingPromise",null);if(this.device=n,r.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}get[Symbol.toStringTag](){return"Query"}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(n){return this._begin(n!=null&&n.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(n){this._queryPending||(this.target=n,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const n=this.device.gl.getQueryParameter(this.handle,34919);return n&&(this._queryPending=!1),n}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(n=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let r=0;return this._pollingPromise=new Promise((i,s)=>{const o=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):r++>n?(s("Timed out"),this._pollingPromise=null):requestAnimationFrame(o)};requestAnimationFrame(o)}),this._pollingPromise}}function IA(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return ge(!1),0}}function S5(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return ge(!1),0}}function E5(t,e){var b,m;const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408,sourceAttachment:s=36064}=e||{};let{target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e||{};const{framebuffer:u,deleteFramebuffer:f}=MA(t);ge(u);const{gl:h,handle:d}=u;a=a||u.width,l=l||u.height;const g=s-36064;c=c||((m=(b=u.colorAttachments[g])==null?void 0:b.texture)==null?void 0:m.type)||5121,o=R5(o,c,i,a,l),c=c||KU(o);const _=h.bindFramebuffer(36160,d);return h.readPixels(n,r,a,l,i,c,o),h.bindFramebuffer(36160,_||null),f&&u.destroy(),o}function b5(t,e){const{target:n,sourceX:r=0,sourceY:i=0,sourceFormat:s=6408,targetByteOffset:o=0}=e||{};let{sourceWidth:a,sourceHeight:l,sourceType:c}=e||{};const{framebuffer:u,deleteFramebuffer:f}=MA(t);ge(u),a=a||u.width,l=l||u.height;const h=u;c=c||5121;let d=n;if(!d){const _=IA(s),b=S5(c),m=o+a*l*_*b;d=h.device.createBuffer({byteLength:m})}const g=t.device.createCommandEncoder();return g.copyTextureToBuffer({source:t,width:a,height:l,origin:[r,i],destination:d,byteOffset:o}),g.destroy(),f&&u.destroy(),d}function MA(t){return t instanceof _u?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:A5(t),deleteFramebuffer:!0}}function A5(t,e){const{device:n,width:r,height:i,id:s}=t;return n.createFramebuffer({...e,id:`framebuffer-for-${s}`,width:r,height:i,colorAttachments:[t]})}function R5(t,e,n,r,i){if(t)return t;e=e||5121;const s=mg(e,{clamped:!1}),o=IA(n);return new s(r*i*o)}const x5=256,C5=1024,P5=16384,I5="clear: bad arguments";function M5(t,e){const{framebuffer:n=null,color:r=null,depth:i=null,stencil:s=null}=e||{},o={};n&&(o.framebuffer=n);let a=0;r&&(a|=P5,r!==!0&&(o.clearColor=r)),i&&(a|=x5,i!==!0&&(o.clearDepth=i)),s&&(a|=C5,i!==!0&&(o.clearStencil=i)),ge(a!==0,I5);const l=t.gl;_r(l,o,()=>{l.clear(a)})}const wo=1,qr=class qr extends Ds{constructor(n){var l,c;super({...n,id:n.id||Ai("webgl-device")});T(this,"type","webgl");T(this,"handle");T(this,"features");T(this,"limits");T(this,"info");T(this,"canvasContext");T(this,"lost");T(this,"_resolveContextLost");T(this,"renderPass",null);T(this,"gl");T(this,"debug",!1);T(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1});T(this,"_extensions",{});T(this,"_polyfilled",!1);T(this,"spectorJS");T(this,"_constants");const r=(l=n.gl)==null?void 0:l.device;if(r)throw new Error(`WebGL context already attached to device ${r.id}`);const i=((c=n.gl)==null?void 0:c.canvas)||n.canvas;this.canvasContext=new xU(this,{...n,canvas:i}),this.lost=new Promise(u=>{this._resolveContextLost=u});let s=n.gl||null;if(s||(s=XL(this.canvasContext.canvas,{...n,onContextLost:u=>{var f;return(f=this._resolveContextLost)==null?void 0:f.call(this,{reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."})}})),!s)throw new Error("WebGL context creation failed");this.handle=s,this.gl=s,this.gl.device=this,this.gl._version=2,n.spector&&(this.spectorJS=NU({...this.props,canvas:this.handle.canvas})),this.info=YL(this.gl,this._extensions),this.limits=new dU(this.gl),this.features=new hU(this.gl,this._extensions,this.props.disabledFeatures),this.props.initalizeFeatures&&this.features.initializeFeatures(),this.canvasContext.resize();const{enable:o=!0,copyState:a=!1}=n;TA(this.gl,{enable:o,copyState:a,log:(...u)=>U.log(1,...u)()}),n.debug&&(this.gl=FU(this.gl,{...n,throwOnError:!0}),this.debug=!0,U.level=Math.max(U.level,1),U.warn("WebGL debug mode activated. Performance reduced.")())}static isSupported(){return typeof WebGL2RenderingContext<"u"}static attach(n){if(n instanceof qr)return n;if((n==null?void 0:n.device)instanceof Ds)return n.device;if(!N5(n))throw new Error("Invalid WebGL2RenderingContext");return new qr({gl:n})}static async create(n={}){var a;U.groupCollapsed(wo,"WebGLDevice created")();const r=[];n.debug&&r.push(OU()),n.spector&&r.push(MU()),typeof n.canvas=="string"&&r.push(wm.pageLoaded);const i=await Promise.allSettled(r);for(const l of i)l.status==="rejected"&&U.error(`Failed to initialize debug libraries ${l.reason}`)();if(U.probe(wo+1,"DOM is loaded")(),(a=n.gl)!=null&&a.device)return U.warn("reattaching existing device")(),qr.attach(n.gl);const s=new qr(n),o=`Created ${s.type}${s.debug?" debug":""} context: ${s.info.vendor}, ${s.info.renderer} for canvas: ${s.canvasContext.id}`;return U.probe(wo,o)(),U.table(wo,s.info)(),U.groupEnd(wo)(),s}destroy(){}get isLost(){return this.gl.isContextLost()}getSize(){return[this.gl.drawingBufferWidth,this.gl.drawingBufferHeight]}isTextureFormatSupported(n){return Im(this.gl,n,this._extensions)}isTextureFormatFilterable(n){return lU(this.gl,n,this._extensions)}isTextureFormatRenderable(n){return cU(this.gl,n,this._extensions)}createCanvasContext(n){throw new Error("WebGL only supports a single canvas")}createBuffer(n){const r=this._getBufferProps(n);return new xr(this,r)}_createTexture(n){return new wn(this,n)}createExternalTexture(n){throw new Error("createExternalTexture() not implemented")}createSampler(n){return new _g(this,n)}createShader(n){return new $U(this,n)}createFramebuffer(n){return new Xo(this,n)}createVertexArray(n){return new Mm(this,n)}createTransformFeedback(n){return new T5(this,n)}createQuerySet(n){return new w5(this,n)}createRenderPipeline(n){return new f5(this,n)}beginRenderPass(n){return new XU(this,n)}createComputePipeline(n){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(n){throw new Error("ComputePass not supported in WebGL")}createCommandEncoder(n){return new m5(this,n)}submit(){var n;(n=this.renderPass)==null||n.end(),this.renderPass=null}readPixelsToArrayWebGL(n,r){return E5(n,r)}readPixelsToBufferWebGL(n,r){return b5(n,r)}setParametersWebGL(n){Gs(this.gl,n)}getParametersWebGL(n){return vA(this.gl,n)}withParametersWebGL(n,r){return _r(this.gl,n,r)}clearWebGL(n){M5(this,n)}resetWebGL(){U.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),UL(this.gl)}loseDevice(){var s;let n=!1;const i=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return i&&(n=!0,i.loseContext()),(s=this._resolveContextLost)==null||s.call(this,{reason:"destroyed",message:"Application triggered context loss"}),n}pushState(){Kf(this.gl)}popState(){Aa(this.gl)}setSpectorMetadata(n,r){n.__SPECTOR_Metadata=r}getGLKey(n,r){r=r||this.gl2||this.gl;const i=Number(n);for(const s in r)if(r[s]===i)return`GL.${s}`;return String(n)}setConstantAttributeWebGL(n,r){const i=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(i).fill(null);const s=this._constants[n];switch(s&&D5(s,r)&&U.info(1,`setConstantAttributeWebGL(${n}) could have been skipped, value unchanged`)(),this._constants[n]=r,r.constructor){case Float32Array:k5(this,n,r);break;case Int32Array:O5(this,n,r);break;case Uint32Array:F5(this,n,r);break;default:ge(!1)}}getExtension(n){return Mr(this.gl,n,this._extensions),this._extensions}};T(qr,"type","webgl");let Ko=qr;function N5(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function k5(t,e,n){switch(n.length){case 1:t.gl.vertexAttrib1fv(e,n);break;case 2:t.gl.vertexAttrib2fv(e,n);break;case 3:t.gl.vertexAttrib3fv(e,n);break;case 4:t.gl.vertexAttrib4fv(e,n);break;default:ge(!1)}}function O5(t,e,n){t.gl.vertexAttribI4iv(e,n)}function F5(t,e,n){t.gl.vertexAttribI4uiv(e,n)}function D5(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}var NA={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),a="function",l=Math.round,c=Math.abs,u=Date.now;function f(v,S,R){return setTimeout(y(v,R),S)}function h(v,S,R){return Array.isArray(v)?(d(v,R[S],R),!0):!1}function d(v,S,R){var k;if(v)if(v.forEach)v.forEach(S,R);else if(v.length!==i)for(k=0;k<v.length;)S.call(R,v[k],k,v),k++;else for(k in v)v.hasOwnProperty(k)&&S.call(R,v[k],k,v)}function g(v,S,R){var k="DEPRECATED METHOD: "+S+`
`+R+` AT 
`;return function(){var B=new Error("get-stack-trace"),j=B&&B.stack?B.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",J=e.console&&(e.console.warn||e.console.log);return J&&J.call(e.console,k,j),v.apply(this,arguments)}}var _;typeof Object.assign!="function"?_=function(S){if(S===i||S===null)throw new TypeError("Cannot convert undefined or null to object");for(var R=Object(S),k=1;k<arguments.length;k++){var B=arguments[k];if(B!==i&&B!==null)for(var j in B)B.hasOwnProperty(j)&&(R[j]=B[j])}return R}:_=Object.assign;var b=g(function(S,R,k){for(var B=Object.keys(R),j=0;j<B.length;)(!k||k&&S[B[j]]===i)&&(S[B[j]]=R[B[j]]),j++;return S},"extend","Use `assign`."),m=g(function(S,R){return b(S,R,!0)},"merge","Use `assign`.");function p(v,S,R){var k=S.prototype,B;B=v.prototype=Object.create(k),B.constructor=v,B._super=k,R&&_(B,R)}function y(v,S){return function(){return v.apply(S,arguments)}}function w(v,S){return typeof v==a?v.apply(S&&S[0]||i,S):v}function A(v,S){return v===i?S:v}function x(v,S,R){d(z(S),function(k){v.addEventListener(k,R,!1)})}function I(v,S,R){d(z(S),function(k){v.removeEventListener(k,R,!1)})}function O(v,S){for(;v;){if(v==S)return!0;v=v.parentNode}return!1}function D(v,S){return v.indexOf(S)>-1}function z(v){return v.trim().split(/\s+/g)}function H(v,S,R){if(v.indexOf&&!R)return v.indexOf(S);for(var k=0;k<v.length;){if(R&&v[k][R]==S||!R&&v[k]===S)return k;k++}return-1}function Y(v){return Array.prototype.slice.call(v,0)}function K(v,S,R){for(var k=[],B=[],j=0;j<v.length;){var J=S?v[j][S]:v[j];H(B,J)<0&&k.push(v[j]),B[j]=J,j++}return R&&(S?k=k.sort(function(Xe,ot){return Xe[S]>ot[S]}):k=k.sort()),k}function Z(v,S){for(var R,k,B=S[0].toUpperCase()+S.slice(1),j=0;j<s.length;){if(R=s[j],k=R?R+B:S,k in v)return k;j++}return i}var Le=1;function Cn(){return Le++}function xt(v){var S=v.ownerDocument||v;return S.defaultView||S.parentWindow||e}var V=/mobile|tablet|ip(ad|hone|od)|android/i,X="ontouchstart"in e,q=Z(e,"PointerEvent")!==i,se=X&&V.test(navigator.userAgent),ne="touch",Vt="pen",We="mouse",Ct="kinect",He=25,de=1,st=2,oe=4,Ie=8,jt=1,Je=2,Ur=4,zr=8,$r=16,Pt=Je|Ur,Pn=zr|$r,el=Pt|Pn,tl=["x","y"],eo=["clientX","clientY"];function It(v,S){var R=this;this.manager=v,this.callback=S,this.element=v.element,this.target=v.options.inputTarget,this.domHandler=function(k){w(v.options.enable,[v])&&R.handler(k)},this.init()}It.prototype={handler:function(){},init:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(xt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&I(this.element,this.evEl,this.domHandler),this.evTarget&&I(this.target,this.evTarget,this.domHandler),this.evWin&&I(xt(this.element),this.evWin,this.domHandler)}};function mR(v){var S,R=v.options.inputClass;return R?S=R:q?S=th:se?S=il:X?S=nh:S=rl,new S(v,yR)}function yR(v,S,R){var k=R.pointers.length,B=R.changedPointers.length,j=S&de&&k-B===0,J=S&(oe|Ie)&&k-B===0;R.isFirst=!!j,R.isFinal=!!J,j&&(v.session={}),R.eventType=S,vR(v,R),v.emit("hammer.input",R),v.recognize(R),v.session.prevInput=R}function vR(v,S){var R=v.session,k=S.pointers,B=k.length;R.firstInput||(R.firstInput=Lm(S)),B>1&&!R.firstMultiple?R.firstMultiple=Lm(S):B===1&&(R.firstMultiple=!1);var j=R.firstInput,J=R.firstMultiple,Ue=J?J.center:j.center,Xe=S.center=Um(k);S.timeStamp=u(),S.deltaTime=S.timeStamp-j.timeStamp,S.angle=eh(Ue,Xe),S.distance=nl(Ue,Xe),TR(R,S),S.offsetDirection=$m(S.deltaX,S.deltaY);var ot=zm(S.deltaTime,S.deltaX,S.deltaY);S.overallVelocityX=ot.x,S.overallVelocityY=ot.y,S.overallVelocity=c(ot.x)>c(ot.y)?ot.x:ot.y,S.scale=J?ER(J.pointers,k):1,S.rotation=J?SR(J.pointers,k):0,S.maxPointers=R.prevInput?S.pointers.length>R.prevInput.maxPointers?S.pointers.length:R.prevInput.maxPointers:S.pointers.length,wR(R,S);var an=v.element;O(S.srcEvent.target,an)&&(an=S.srcEvent.target),S.target=an}function TR(v,S){var R=S.center,k=v.offsetDelta||{},B=v.prevDelta||{},j=v.prevInput||{};(S.eventType===de||j.eventType===oe)&&(B=v.prevDelta={x:j.deltaX||0,y:j.deltaY||0},k=v.offsetDelta={x:R.x,y:R.y}),S.deltaX=B.x+(R.x-k.x),S.deltaY=B.y+(R.y-k.y)}function wR(v,S){var R=v.lastInterval||S,k=S.timeStamp-R.timeStamp,B,j,J,Ue;if(S.eventType!=Ie&&(k>He||R.velocity===i)){var Xe=S.deltaX-R.deltaX,ot=S.deltaY-R.deltaY,an=zm(k,Xe,ot);j=an.x,J=an.y,B=c(an.x)>c(an.y)?an.x:an.y,Ue=$m(Xe,ot),v.lastInterval=S}else B=R.velocity,j=R.velocityX,J=R.velocityY,Ue=R.direction;S.velocity=B,S.velocityX=j,S.velocityY=J,S.direction=Ue}function Lm(v){for(var S=[],R=0;R<v.pointers.length;)S[R]={clientX:l(v.pointers[R].clientX),clientY:l(v.pointers[R].clientY)},R++;return{timeStamp:u(),pointers:S,center:Um(S),deltaX:v.deltaX,deltaY:v.deltaY}}function Um(v){var S=v.length;if(S===1)return{x:l(v[0].clientX),y:l(v[0].clientY)};for(var R=0,k=0,B=0;B<S;)R+=v[B].clientX,k+=v[B].clientY,B++;return{x:l(R/S),y:l(k/S)}}function zm(v,S,R){return{x:S/v||0,y:R/v||0}}function $m(v,S){return v===S?jt:c(v)>=c(S)?v<0?Je:Ur:S<0?zr:$r}function nl(v,S,R){R||(R=tl);var k=S[R[0]]-v[R[0]],B=S[R[1]]-v[R[1]];return Math.sqrt(k*k+B*B)}function eh(v,S,R){R||(R=tl);var k=S[R[0]]-v[R[0]],B=S[R[1]]-v[R[1]];return Math.atan2(B,k)*180/Math.PI}function SR(v,S){return eh(S[1],S[0],eo)+eh(v[1],v[0],eo)}function ER(v,S){return nl(S[0],S[1],eo)/nl(v[0],v[1],eo)}var bR={mousedown:de,mousemove:st,mouseup:oe},AR="mousedown",RR="mousemove mouseup";function rl(){this.evEl=AR,this.evWin=RR,this.pressed=!1,It.apply(this,arguments)}p(rl,It,{handler:function(S){var R=bR[S.type];R&de&&S.button===0&&(this.pressed=!0),R&st&&S.which!==1&&(R=oe),this.pressed&&(R&oe&&(this.pressed=!1),this.callback(this.manager,R,{pointers:[S],changedPointers:[S],pointerType:We,srcEvent:S}))}});var xR={pointerdown:de,pointermove:st,pointerup:oe,pointercancel:Ie,pointerout:Ie},CR={2:ne,3:Vt,4:We,5:Ct},Vm="pointerdown",jm="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Vm="MSPointerDown",jm="MSPointerMove MSPointerUp MSPointerCancel");function th(){this.evEl=Vm,this.evWin=jm,It.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}p(th,It,{handler:function(S){var R=this.store,k=!1,B=S.type.toLowerCase().replace("ms",""),j=xR[B],J=CR[S.pointerType]||S.pointerType,Ue=J==ne,Xe=H(R,S.pointerId,"pointerId");j&de&&(S.button===0||Ue)?Xe<0&&(R.push(S),Xe=R.length-1):j&(oe|Ie)&&(k=!0),!(Xe<0)&&(R[Xe]=S,this.callback(this.manager,j,{pointers:R,changedPointers:[S],pointerType:J,srcEvent:S}),k&&R.splice(Xe,1))}});var PR={touchstart:de,touchmove:st,touchend:oe,touchcancel:Ie},IR="touchstart",MR="touchstart touchmove touchend touchcancel";function Wm(){this.evTarget=IR,this.evWin=MR,this.started=!1,It.apply(this,arguments)}p(Wm,It,{handler:function(S){var R=PR[S.type];if(R===de&&(this.started=!0),!!this.started){var k=NR.call(this,S,R);R&(oe|Ie)&&k[0].length-k[1].length===0&&(this.started=!1),this.callback(this.manager,R,{pointers:k[0],changedPointers:k[1],pointerType:ne,srcEvent:S})}}});function NR(v,S){var R=Y(v.touches),k=Y(v.changedTouches);return S&(oe|Ie)&&(R=K(R.concat(k),"identifier",!0)),[R,k]}var kR={touchstart:de,touchmove:st,touchend:oe,touchcancel:Ie},OR="touchstart touchmove touchend touchcancel";function il(){this.evTarget=OR,this.targetIds={},It.apply(this,arguments)}p(il,It,{handler:function(S){var R=kR[S.type],k=FR.call(this,S,R);k&&this.callback(this.manager,R,{pointers:k[0],changedPointers:k[1],pointerType:ne,srcEvent:S})}});function FR(v,S){var R=Y(v.touches),k=this.targetIds;if(S&(de|st)&&R.length===1)return k[R[0].identifier]=!0,[R,R];var B,j,J=Y(v.changedTouches),Ue=[],Xe=this.target;if(j=R.filter(function(ot){return O(ot.target,Xe)}),S===de)for(B=0;B<j.length;)k[j[B].identifier]=!0,B++;for(B=0;B<J.length;)k[J[B].identifier]&&Ue.push(J[B]),S&(oe|Ie)&&delete k[J[B].identifier],B++;if(Ue.length)return[K(j.concat(Ue),"identifier",!0),Ue]}var DR=2500,Hm=25;function nh(){It.apply(this,arguments);var v=y(this.handler,this);this.touch=new il(this.manager,v),this.mouse=new rl(this.manager,v),this.primaryTouch=null,this.lastTouches=[]}p(nh,It,{handler:function(S,R,k){var B=k.pointerType==ne,j=k.pointerType==We;if(!(j&&k.sourceCapabilities&&k.sourceCapabilities.firesTouchEvents)){if(B)BR.call(this,R,k);else if(j&&LR.call(this,k))return;this.callback(S,R,k)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function BR(v,S){v&de?(this.primaryTouch=S.changedPointers[0].identifier,Xm.call(this,S)):v&(oe|Ie)&&Xm.call(this,S)}function Xm(v){var S=v.changedPointers[0];if(S.identifier===this.primaryTouch){var R={x:S.clientX,y:S.clientY};this.lastTouches.push(R);var k=this.lastTouches,B=function(){var j=k.indexOf(R);j>-1&&k.splice(j,1)};setTimeout(B,DR)}}function LR(v){for(var S=v.srcEvent.clientX,R=v.srcEvent.clientY,k=0;k<this.lastTouches.length;k++){var B=this.lastTouches[k],j=Math.abs(S-B.x),J=Math.abs(R-B.y);if(j<=Hm&&J<=Hm)return!0}return!1}var Ym=Z(o.style,"touchAction"),Km=Ym!==i,qm="compute",Zm="auto",rh="manipulation",Vr="none",to="pan-x",no="pan-y",sl=zR();function ih(v,S){this.manager=v,this.set(S)}ih.prototype={set:function(v){v==qm&&(v=this.compute()),Km&&this.manager.element.style&&sl[v]&&(this.manager.element.style[Ym]=v),this.actions=v.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var v=[];return d(this.manager.recognizers,function(S){w(S.options.enable,[S])&&(v=v.concat(S.getTouchAction()))}),UR(v.join(" "))},preventDefaults:function(v){var S=v.srcEvent,R=v.offsetDirection;if(this.manager.session.prevented){S.preventDefault();return}var k=this.actions,B=D(k,Vr)&&!sl[Vr],j=D(k,no)&&!sl[no],J=D(k,to)&&!sl[to];if(B){var Ue=v.pointers.length===1,Xe=v.distance<2,ot=v.deltaTime<250;if(Ue&&Xe&&ot)return}if(!(J&&j)&&(B||j&&R&Pt||J&&R&Pn))return this.preventSrc(S)},preventSrc:function(v){this.manager.session.prevented=!0,v.preventDefault()}};function UR(v){if(D(v,Vr))return Vr;var S=D(v,to),R=D(v,no);return S&&R?Vr:S||R?S?to:no:D(v,rh)?rh:Zm}function zR(){if(!Km)return!1;var v={},S=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(R){v[R]=S?e.CSS.supports("touch-action",R):!0}),v}var ol=1,Mt=2,xi=4,Jn=8,In=Jn,ro=16,on=32;function Mn(v){this.options=_({},this.defaults,v||{}),this.id=Cn(),this.manager=null,this.options.enable=A(this.options.enable,!0),this.state=ol,this.simultaneous={},this.requireFail=[]}Mn.prototype={defaults:{},set:function(v){return _(this.options,v),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(v){if(h(v,"recognizeWith",this))return this;var S=this.simultaneous;return v=al(v,this),S[v.id]||(S[v.id]=v,v.recognizeWith(this)),this},dropRecognizeWith:function(v){return h(v,"dropRecognizeWith",this)?this:(v=al(v,this),delete this.simultaneous[v.id],this)},requireFailure:function(v){if(h(v,"requireFailure",this))return this;var S=this.requireFail;return v=al(v,this),H(S,v)===-1&&(S.push(v),v.requireFailure(this)),this},dropRequireFailure:function(v){if(h(v,"dropRequireFailure",this))return this;v=al(v,this);var S=H(this.requireFail,v);return S>-1&&this.requireFail.splice(S,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(v){return!!this.simultaneous[v.id]},emit:function(v){var S=this,R=this.state;function k(B){S.manager.emit(B,v)}R<Jn&&k(S.options.event+Qm(R)),k(S.options.event),v.additionalEvent&&k(v.additionalEvent),R>=Jn&&k(S.options.event+Qm(R))},tryEmit:function(v){if(this.canEmit())return this.emit(v);this.state=on},canEmit:function(){for(var v=0;v<this.requireFail.length;){if(!(this.requireFail[v].state&(on|ol)))return!1;v++}return!0},recognize:function(v){var S=_({},v);if(!w(this.options.enable,[this,S])){this.reset(),this.state=on;return}this.state&(In|ro|on)&&(this.state=ol),this.state=this.process(S),this.state&(Mt|xi|Jn|ro)&&this.tryEmit(S)},process:function(v){},getTouchAction:function(){},reset:function(){}};function Qm(v){return v&ro?"cancel":v&Jn?"end":v&xi?"move":v&Mt?"start":""}function Jm(v){return v==$r?"down":v==zr?"up":v==Je?"left":v==Ur?"right":""}function al(v,S){var R=S.manager;return R?R.get(v):v}function Wt(){Mn.apply(this,arguments)}p(Wt,Mn,{defaults:{pointers:1},attrTest:function(v){var S=this.options.pointers;return S===0||v.pointers.length===S},process:function(v){var S=this.state,R=v.eventType,k=S&(Mt|xi),B=this.attrTest(v);return k&&(R&Ie||!B)?S|ro:k||B?R&oe?S|Jn:S&Mt?S|xi:Mt:on}});function ll(){Wt.apply(this,arguments),this.pX=null,this.pY=null}p(ll,Wt,{defaults:{event:"pan",threshold:10,pointers:1,direction:el},getTouchAction:function(){var v=this.options.direction,S=[];return v&Pt&&S.push(no),v&Pn&&S.push(to),S},directionTest:function(v){var S=this.options,R=!0,k=v.distance,B=v.direction,j=v.deltaX,J=v.deltaY;return B&S.direction||(S.direction&Pt?(B=j===0?jt:j<0?Je:Ur,R=j!=this.pX,k=Math.abs(v.deltaX)):(B=J===0?jt:J<0?zr:$r,R=J!=this.pY,k=Math.abs(v.deltaY))),v.direction=B,R&&k>S.threshold&&B&S.direction},attrTest:function(v){return Wt.prototype.attrTest.call(this,v)&&(this.state&Mt||!(this.state&Mt)&&this.directionTest(v))},emit:function(v){this.pX=v.deltaX,this.pY=v.deltaY;var S=Jm(v.direction);S&&(v.additionalEvent=this.options.event+S),this._super.emit.call(this,v)}});function sh(){Wt.apply(this,arguments)}p(sh,Wt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Vr]},attrTest:function(v){return this._super.attrTest.call(this,v)&&(Math.abs(v.scale-1)>this.options.threshold||this.state&Mt)},emit:function(v){if(v.scale!==1){var S=v.scale<1?"in":"out";v.additionalEvent=this.options.event+S}this._super.emit.call(this,v)}});function oh(){Mn.apply(this,arguments),this._timer=null,this._input=null}p(oh,Mn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Zm]},process:function(v){var S=this.options,R=v.pointers.length===S.pointers,k=v.distance<S.threshold,B=v.deltaTime>S.time;if(this._input=v,!k||!R||v.eventType&(oe|Ie)&&!B)this.reset();else if(v.eventType&de)this.reset(),this._timer=f(function(){this.state=In,this.tryEmit()},S.time,this);else if(v.eventType&oe)return In;return on},reset:function(){clearTimeout(this._timer)},emit:function(v){this.state===In&&(v&&v.eventType&oe?this.manager.emit(this.options.event+"up",v):(this._input.timeStamp=u(),this.manager.emit(this.options.event,this._input)))}});function ah(){Wt.apply(this,arguments)}p(ah,Wt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Vr]},attrTest:function(v){return this._super.attrTest.call(this,v)&&(Math.abs(v.rotation)>this.options.threshold||this.state&Mt)}});function lh(){Wt.apply(this,arguments)}p(lh,Wt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Pt|Pn,pointers:1},getTouchAction:function(){return ll.prototype.getTouchAction.call(this)},attrTest:function(v){var S=this.options.direction,R;return S&(Pt|Pn)?R=v.overallVelocity:S&Pt?R=v.overallVelocityX:S&Pn&&(R=v.overallVelocityY),this._super.attrTest.call(this,v)&&S&v.offsetDirection&&v.distance>this.options.threshold&&v.maxPointers==this.options.pointers&&c(R)>this.options.velocity&&v.eventType&oe},emit:function(v){var S=Jm(v.offsetDirection);S&&this.manager.emit(this.options.event+S,v),this.manager.emit(this.options.event,v)}});function cl(){Mn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}p(cl,Mn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[rh]},process:function(v){var S=this.options,R=v.pointers.length===S.pointers,k=v.distance<S.threshold,B=v.deltaTime<S.time;if(this.reset(),v.eventType&de&&this.count===0)return this.failTimeout();if(k&&B&&R){if(v.eventType!=oe)return this.failTimeout();var j=this.pTime?v.timeStamp-this.pTime<S.interval:!0,J=!this.pCenter||nl(this.pCenter,v.center)<S.posThreshold;this.pTime=v.timeStamp,this.pCenter=v.center,!J||!j?this.count=1:this.count+=1,this._input=v;var Ue=this.count%S.taps;if(Ue===0)return this.hasRequireFailures()?(this._timer=f(function(){this.state=In,this.tryEmit()},S.interval,this),Mt):In}return on},failTimeout:function(){return this._timer=f(function(){this.state=on},this.options.interval,this),on},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==In&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Nn(v,S){return S=S||{},S.recognizers=A(S.recognizers,Nn.defaults.preset),new ch(v,S)}Nn.VERSION="2.0.7",Nn.defaults={domEvents:!1,touchAction:qm,enable:!0,inputTarget:null,inputClass:null,preset:[[ah,{enable:!1}],[sh,{enable:!1},["rotate"]],[lh,{direction:Pt}],[ll,{direction:Pt},["swipe"]],[cl],[cl,{event:"doubletap",taps:2},["tap"]],[oh]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var $R=1,Gm=2;function ch(v,S){this.options=_({},Nn.defaults,S||{}),this.options.inputTarget=this.options.inputTarget||v,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=v,this.input=mR(this),this.touchAction=new ih(this,this.options.touchAction),ey(this,!0),d(this.options.recognizers,function(R){var k=this.add(new R[0](R[1]));R[2]&&k.recognizeWith(R[2]),R[3]&&k.requireFailure(R[3])},this)}ch.prototype={set:function(v){return _(this.options,v),v.touchAction&&this.touchAction.update(),v.inputTarget&&(this.input.destroy(),this.input.target=v.inputTarget,this.input.init()),this},stop:function(v){this.session.stopped=v?Gm:$R},recognize:function(v){var S=this.session;if(!S.stopped){this.touchAction.preventDefaults(v);var R,k=this.recognizers,B=S.curRecognizer;(!B||B&&B.state&In)&&(B=S.curRecognizer=null);for(var j=0;j<k.length;)R=k[j],S.stopped!==Gm&&(!B||R==B||R.canRecognizeWith(B))?R.recognize(v):R.reset(),!B&&R.state&(Mt|xi|Jn)&&(B=S.curRecognizer=R),j++}},get:function(v){if(v instanceof Mn)return v;for(var S=this.recognizers,R=0;R<S.length;R++)if(S[R].options.event==v)return S[R];return null},add:function(v){if(h(v,"add",this))return this;var S=this.get(v.options.event);return S&&this.remove(S),this.recognizers.push(v),v.manager=this,this.touchAction.update(),v},remove:function(v){if(h(v,"remove",this))return this;if(v=this.get(v),v){var S=this.recognizers,R=H(S,v);R!==-1&&(S.splice(R,1),this.touchAction.update())}return this},on:function(v,S){if(v!==i&&S!==i){var R=this.handlers;return d(z(v),function(k){R[k]=R[k]||[],R[k].push(S)}),this}},off:function(v,S){if(v!==i){var R=this.handlers;return d(z(v),function(k){S?R[k]&&R[k].splice(H(R[k],S),1):delete R[k]}),this}},emit:function(v,S){this.options.domEvents&&VR(v,S);var R=this.handlers[v]&&this.handlers[v].slice();if(!(!R||!R.length)){S.type=v,S.preventDefault=function(){S.srcEvent.preventDefault()};for(var k=0;k<R.length;)R[k](S),k++}},destroy:function(){this.element&&ey(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function ey(v,S){var R=v.element;if(R.style){var k;d(v.options.cssProps,function(B,j){k=Z(R.style,j),S?(v.oldCssProps[k]=R.style[k],R.style[k]=B):R.style[k]=v.oldCssProps[k]||""}),S||(v.oldCssProps={})}}function VR(v,S){var R=n.createEvent("Event");R.initEvent(v,!0,!0),R.gesture=S,S.target.dispatchEvent(R)}_(Nn,{INPUT_START:de,INPUT_MOVE:st,INPUT_END:oe,INPUT_CANCEL:Ie,STATE_POSSIBLE:ol,STATE_BEGAN:Mt,STATE_CHANGED:xi,STATE_ENDED:Jn,STATE_RECOGNIZED:In,STATE_CANCELLED:ro,STATE_FAILED:on,DIRECTION_NONE:jt,DIRECTION_LEFT:Je,DIRECTION_RIGHT:Ur,DIRECTION_UP:zr,DIRECTION_DOWN:$r,DIRECTION_HORIZONTAL:Pt,DIRECTION_VERTICAL:Pn,DIRECTION_ALL:el,Manager:ch,Input:It,TouchAction:ih,TouchInput:il,MouseInput:rl,PointerEventInput:th,TouchMouseInput:nh,SingleTouchInput:Wm,Recognizer:Mn,AttrRecognizer:Wt,Tap:cl,Pan:ll,Swipe:lh,Pinch:sh,Rotate:ah,Press:oh,on:x,off:I,each:d,merge:m,extend:b,assign:_,inherit:p,bindFn:y,prefixed:Z});var jR=typeof e<"u"?e:typeof self<"u"?self:{};jR.Hammer=Nn,typeof i=="function"&&i.amd?i(function(){return Nn}):t.exports?t.exports=Nn:e[r]=Nn})(window,document,"Hammer")})(NA);var Ga=NA.exports;const B5=lf(Ga),hn=XR({__proto__:null,default:B5},[Ga]),kA=1,OA=2,yg=4,L5={mousedown:kA,mousemove:OA,mouseup:yg};function U5(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function z5(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(U5(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function $5(t){t.prototype.handler=function(n){let r=L5[n.type];r&kA&&n.button>=0&&(this.pressed=!0),r&OA&&n.buttons===0&&(r=yg),this.pressed&&(r&yg&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}z5(Ga.PointerEventInput);$5(Ga.MouseInput);const V5=Ga.Manager;class Zf{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const j5=hn?[[hn.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[hn.Rotate,{enable:!1}],[hn.Pinch,{enable:!1}],[hn.Swipe,{enable:!1}],[hn.Pan,{threshold:0,enable:!1}],[hn.Press,{enable:!1}],[hn.Tap,{event:"doubletap",taps:2,enable:!1}],[hn.Tap,{event:"anytap",enable:!1}],[hn.Tap,{enable:!1}]]:null,ET={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},W5={doubletap:["tap"]},H5={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Nm={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},X5={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},bT={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},Y5=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",as=typeof window<"u"?window:global;let vg=!1;try{const t={get passive(){return vg=!0,!0}};as.addEventListener("test",null,t),as.removeEventListener("test",null)}catch{vg=!1}const K5=Y5.indexOf("firefox")!==-1,{WHEEL_EVENTS:q5}=Nm,AT="wheel",RT=4.000244140625,Z5=40,Q5=.25;class J5 extends Zf{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;as.WheelEvent&&(K5&&i.deltaMode===as.WheelEvent.DOM_DELTA_PIXEL&&(s/=as.devicePixelRatio),i.deltaMode===as.WheelEvent.DOM_DELTA_LINE&&(s*=Z5)),s!==0&&s%RT===0&&(s=Math.floor(s/RT)),i.shiftKey&&s&&(s=s*Q5),this.callback({type:AT,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(q5),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,vg?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===AT&&(this.options.enable=n)}}const{MOUSE_EVENTS:G5}=Nm,xT="pointermove",CT="pointerover",PT="pointerout",IT="pointerenter",MT="pointerleave";class e8 extends Zf{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(G5),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===xT&&(this.enableMoveEvent=n),e===CT&&(this.enableOverEvent=n),e===PT&&(this.enableOutEvent=n),e===IT&&(this.enableEnterEvent=n),e===MT&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(CT,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(PT,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(IT,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(MT,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit(xT,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:t8}=Nm,NT="keydown",kT="keyup";class n8 extends Zf{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:NT,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:kT,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(t8),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===NT&&(this.enableDownEvent=n),e===kT&&(this.enableUpEvent=n)}}const OT="contextmenu";class r8 extends Zf{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:OT,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===OT&&(this.options.enable=n)}}const FT=1,Tg=2,DT=4,i8={pointerdown:FT,pointermove:Tg,pointerup:DT,mousedown:FT,mousemove:Tg,mouseup:DT},s8=0,o8=1,a8=2,l8=1,c8=2,u8=4;function f8(t){const e=i8[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r}=t.srcEvent;let i=!1,s=!1,o=!1;return e===Tg?(i=!!(n&l8),s=!!(n&u8),o=!!(n&c8)):(i=r===s8,s=r===o8,o=r===a8),{leftButton:i,middleButton:s,rightButton:o}}function h8(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,o={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:o}}const Ad={srcElement:"root",priority:0};class d8{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let l=Ad;typeof r=="string"||r&&r.addEventListener?l={...Ad,srcElement:r}:r&&(l={...Ad,...r});let c=a.get(l.srcElement);c||(c=[],a.set(l.srcElement,c));const u={type:e,handler:n,srcElement:l.srcElement,priority:l.priority};i&&(u.once=!0),s&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let f=c.length-1;for(;f>=0&&!(c[f].priority>=u.priority);)f--;c.splice(f+1,0,u)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.type===e&&o.handler===n){r.splice(s,1);const a=i.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&i.delete(o.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,i=!0},a=[];for(let l=0;l<r.length;l++){const{type:c,handler:u,once:f}=r[l];if(u({...e,type:c,stopPropagation:s,stopImmediatePropagation:o}),f&&a.push(r[l]),i)break}for(let l=0;l<a.length;l++){const{type:c,handler:u}=a[l];this.remove(c,u)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...f8(e),...h8(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const p8={events:null,recognizers:null,recognizerOptions:{},Manager:V5,touchAction:"none",tabIndex:0};class g8{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,o=H5[s.type];o&&this.manager.emit(o,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...p8,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||j5}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(ET).forEach(i=>{const s=this.manager.get(i);s&&ET[i].forEach(o=>{s.recognizeWith(o)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const o=n.recognizerOptions[i];delete o.enable,s.set(o)}}this.wheelInput=new J5(e,this._onOtherEvent,{enable:!1}),this.moveInput=new e8(e,this._onOtherEvent,{enable:!1}),this.keyInput=new n8(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new r8(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=W5[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=r.get(o);n?(a.requireFailure(e),i.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const u in e)this._addEventHandler(u,e[u],r,i,s);return}const{manager:o,events:a}=this,l=bT[e]||e;let c=a.get(l);c||(c=new d8(this),a.set(l,c),c.recognizerName=X5[l]||l,o&&o.on(l,c.handleEvent)),c.add(e,n,r,i,s),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:r}=this,i=bT[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of r.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function rr(){}const _8=({isDragging:t})=>t?"grabbing":"grab",BT={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{type:"webgl"},gl:null,glOptions:{},canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:rr,onWebGLInitialized:rr,onResize:rr,onViewStateChange:rr,onInteractionStateChange:rr,onBeforeRender:rr,onAfterRender:rr,onLoad:rr,onError:t=>G.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:_8,getTooltip:null,debug:!1,drawPickingColors:!1},Zu=class Zu{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new jf({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=r=>{const{_pickRequest:i}=this;if(r.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(r.leftButton||r.rightButton)return;{const s=r.offsetCenter;if(!s)return;i.x=s.x,i.y=s.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=r},this._onEvent=r=>{const i=lg[r.type],s=r.offsetCenter;if(!i||!s||!this.layerManager)return;const o=this.layerManager.getLayers(),a=this.deckPicker.getLastPickedObject({x:s.x,y:s.y,layers:o,viewports:this.getViewports(s)},this._lastPointerDownInfo),{layer:l}=a,c=l&&(l[i.handler]||l.props[i.handler]),u=this.props[i.handler];let f=!1;c&&(f=c.call(l,a,r)),f||(u==null||u(a,r),this.widgetManager.onEvent(a,r))},this._onPointerDown=r=>{const i=r.offsetCenter,s=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=s.result[0]||s.emptyInfo},this.props={...BT,...e},e=this.props,e.viewState&&e.initialViewState&&G.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device?this.device=e.device:e.gl&&(e.gl instanceof WebGLRenderingContext&&G.error("WebGL1 context not supported.")(),this.device=Ko.attach(e.gl));let n=this.device;n||(ms.registerDevices([Ko]),n=ms.createDevice({...e.deviceProps,canvas:this._createCanvas(e)})),this.animationLoop=this._createAnimationLoop(n,e),this.setProps(e),e._typedArrayManagerProps&&js.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,o,a,l,c,u;(e=this.animationLoop)==null||e.stop(),(n=this.animationLoop)==null||n.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,(r=this.layerManager)==null||r.finalize(),this.layerManager=null,(i=this.viewManager)==null||i.finalize(),this.viewManager=null,(s=this.effectManager)==null||s.finalize(),this.effectManager=null,(o=this.deckRenderer)==null||o.finalize(),this.deckRenderer=null,(a=this.deckPicker)==null||a.finalize(),this.deckPicker=null,(l=this.eventManager)==null||l.destroy(),this.eventManager=null,(c=this.widgetManager)==null||c.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&((u=this.canvas.parentElement)==null||u.removeChild(this.canvas),this.canvas=null)}setProps(e){var r;this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&G.removed("onLayerHover","onHover")(),"onLayerClick"in e&&G.removed("onLayerClick","onClick")(),e.initialViewState&&!Zt(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),(r=this.animationLoop)==null||r.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n),this.widgetManager.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return ke(this.viewManager),this.viewManager.views}getViewports(e){return ke(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){var n;(n=this.layerManager)==null||n.removeDefaultShaderModule(e)}_pick(e,n,r){ke(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),ke(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){var i;if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?`${n}px`:n;this.canvas.style.width=s}if(r||r===0){const s=Number.isFinite(r)?`${r}px`:r;this.canvas.style.position=((i=e.style)==null?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var i,s;const{canvas:e}=this;if(!e)return;const n=e.clientWidth??e.width,r=e.clientHeight??e.height;(n!==this.width||r!==this.height)&&(this.width=n,this.height=r,(i=this.viewManager)==null||i.setProps({width:n,height:r}),(s=this.layerManager)==null||s.activateViewport(this.getViewports()[0]),this.props.onResize({width:n,height:r}))}_createAnimationLoop(e,n){const{gl:r,onError:i,useDevicePixels:s}=n;return new z6({device:e,useDevicePixels:s,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,onInitialize:o=>this._setDevice(o.device),onRender:this._onRenderFrame.bind(this),onError:i})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,n=Array.isArray(e)?e:e?[e]:[new Ru({id:"default-view"})];return n.length&&this.props.controller&&(n[0].props.controller=this.props.controller),n}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){var n,r,i;const{_pickRequest:e}=this;if(e.event){const{result:s,emptyInfo:o}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=s.length>0;let a=o,l=!1;for(const c of s)a=c,l=((n=c.layer)==null?void 0:n.onHover(c,e.event))||l;l||((i=(r=this.props).onHover)==null||i.call(r,a,e.event),this.widgetManager.onHover(a,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){var i,s;if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=(i=this.device.canvasContext)==null?void 0:i.canvas),this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device instanceof Ko&&this.props.onWebGLInitialized(this.device.gl);const n=new dA;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new g8(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const o in lg)this.eventManager.on(o,this._onEvent);this.viewManager=new iL({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new rL(this.device,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new wL({deck:this,device:this.device}),this.deckRenderer=new bL(this.device),this.deckPicker=new IL(this.device),this.widgetManager=new kL({deck:this,parentElement:(s=this.canvas)==null?void 0:s.parentElement}),this.widgetManager.addDefault(new FL),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){var o;const{device:r,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:r,gl:i});const s={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n};(o=this.deckRenderer)==null||o.renderLayers(s),s.pass==="screen"&&this.widgetManager.onRedraw({viewports:s.viewports,layers:s.layers}),this.props.onAfterRender({device:r,gl:i})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),G.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=ms.stats.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}};Zu.defaultProps=BT,Zu.VERSION=JO;let Ra=Zu;function m8(t){switch(t){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return Lb(t)}}const y8=Bb;function Yl(t,e){return{attribute:t,format:e.size>1?`${e.type}x${e.size}`:e.type,byteOffset:e.offset||0}}function ni(t){return t.stride||t.size*t.bytesPerElement}function v8(t,e){return t.type===e.type&&t.size===e.size&&ni(t)===ni(e)&&(t.offset||0)===(e.offset||0)}function wg(t,e){e.offset&&G.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=ni(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function T8(t,e){const n=wg(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class w8{constructor(e,n,r){this._buffer=null,this.device=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i==="float64";let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a="float32":!i&&n.isIndexed?a="uint32":a=i||"float32";let l=m8(i||a);this.doublePrecision=s,s&&n.fp64===!1&&(l=Float32Array),this.value=null,this.settings={...n,defaultType:l,defaultValue:o,logicalType:i,type:a,normalized:a.includes("norm"),size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*ni(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),js.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,n=null){const r={};if(this.state.constant){const i=this.value;if(n){const s=wg(this.getAccessor(),n),o=s.offset/i.BYTES_PER_ELEMENT,a=s.size||this.size;r[e]=i.subarray(o,o+a)}else r[e]=i}else r[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?r[`${e}64Low`]=r[e]:r[`${e}64Low`]=new Float32Array(this.size)),r}_getBufferLayout(e=this.id,n=null){const r=this.getAccessor(),i=[],s={name:this.id,byteStride:ni(r),attributes:i};if(this.doublePrecision){const o=T8(r,n||{});i.push(Yl(e,{...r,...o.high}),Yl(`${e}64Low`,{...r,...o.low}))}else if(n){const o=wg(r,n);i.push(Yl(e,{...r,...o}))}else i.push(Yl(e,r));return s}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const o=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let l=0;l<s;)for(let c=0;c<i;c++){const u=n[l++];u<o[c]&&(o[c]=u),u>a[c]&&(a[c]=u)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof Te?r={buffer:e}:r=e;const i={...this.settings,...r};if(ArrayBuffer.isView(r.value)){if(!r.type)if(this.doublePrecision&&r.value instanceof Float64Array)i.type="float32";else{const o=y8(r.value);i.type=i.normalized?o.replace("int","norm"):o}i.bytesPerElement=r.value.BYTES_PER_ELEMENT,i.stride=ni(i)}if(n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=ArrayBuffer.isView(s)?s:new Float32Array(s)}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s;let{buffer:o}=this;const a=ni(i),l=(i.vertexOffset||0)*a;if(this.doublePrecision&&s instanceof Float64Array&&(s=hd(s,i)),this.settings.isIndexed){const u=this.settings.defaultType;s.constructor!==u&&(s=new u(s))}const c=s.byteLength+l+a*2;(!o||o.byteLength<c)&&(o=this._createBuffer(c)),o.write(s,l)}return this.setAccessor(i),!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.write(this.doublePrecision&&n instanceof Float64Array?hd(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),r*n.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=js.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{byteOffset:o}=this;let{buffer:a}=this;return(!a||a.byteLength<s.byteLength+o)&&(a=this._createBuffer(s.byteLength+o),n&&i&&a.write(i instanceof Float64Array?hd(i,this):i,o)),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error(`Attribute ${this.id} value is not TypedArray`);const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${n.constructor.name}`);!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&G.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(n=>(n+128)/255*2-1);case"snorm16":return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(n=>n/255);case"unorm16":return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let o=s;for(;--o>=0;)n[r+o]=i[o];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=s;for(;--o>=0;)n[r+o]=Number.isFinite(e[o])?e[o]:i[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}_createBuffer(e){var i;this._buffer&&this._buffer.destroy();const{isIndexed:n,type:r}=this.settings;return this._buffer=this.device.createBuffer({...(i=this._buffer)==null?void 0:i.props,id:this.id,usage:n?Te.INDEX:Te.VERTEX,indexType:n?r:void 0,byteLength:e}),this._buffer}}const LT=[],UT=[];function Qf(t,e=0,n=1/0){let r=LT;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(UT.length=t.length,r=UT):r=LT,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function FA(t){return t&&t[Symbol.asyncIterator]}function DA(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,l=r?r/a:n,c=i?i/a:0,u=Math.floor((t.length-c)/l);return(f,{index:h,target:d})=>{if(!s){const m=h*l+c;for(let p=0;p<n;p++)d[p]=t[m+p];return d}const g=s[h],_=s[h+1]||u;let b;if(o){b=new Array(_-g);for(let m=g;m<_;m++){const p=m*l+c;d=new Array(n);for(let y=0;y<n;y++)d[y]=t[p+y];b[m-g]=d}}else if(l===n)b=t.subarray(g*n+c,_*n+c);else{b=new t.constructor((_-g)*n);let m=0;for(let p=g;p<_;p++){const y=p*l+c;for(let w=0;w<n;w++)b[m++]=t[y+w]}}return b}}const S8=[],Ec=[[0,1/0]];function E8(t,e){if(t===Ec||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const o=t[s];o[1]<e[0]?(n.push(o),i=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(i,0,e),n}const b8={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function BA(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...b8[n],...e,...t,type:n}}class LA extends w8{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:Ec}),this.constant=!1,this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var n;(n=this.state).layoutChanged||(n.layoutChanged=!v8(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return BA(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=E8(this.state.updateRanges,[r,i])}else this.state.updateRanges=Ec}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=S8}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==Ec),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,u]of s)o.call(i,this,{data:n,startRow:c,endRow:u,props:r,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[c,u]of s){const f=Number.isFinite(c)?this.getVertexOffset(c):0,h=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:f,endOffset:h})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;ke(ArrayBuffer.isView(o.value),`invalid ${i.accessor}`);const a=!!o.size&&o.size!==this.size;return r.binaryAccessor=DA(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,n=super.getValue();if(!e)return n;for(const r in e)Object.assign(n,super.getValue(r,e[r]));return n}getBufferLayout(e){this.state.layoutChanged=!1;const n=this.settings.shaderAttributes,r=super._getBufferLayout(),{stepMode:i}=this.settings;if(i==="dynamic"?r.stepMode=e?e.isInstanced?"instance":"vertex":"instance":r.stepMode=i??"vertex",!n)return r;for(const s in n){const o=super._getBufferLayout(s,n[s]);r.attributes.push(...o.attributes)}return r}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:f}=e,{accessor:h,transform:d}=a,g=l.binaryAccessor||(typeof h=="function"?h:s[h]);ke(typeof g=="function",`accessor "${h}" is not a function`);let _=e.getVertexOffset(r);const{iterable:b,objectInfo:m}=Qf(n,r,i);for(const p of b){m.index++;let y=g(p,m);if(d&&(y=d.call(this,y)),f){const w=(m.index<f.length-1?f[m.index+1]:o)-f[m.index];if(y&&Array.isArray(y[0])){let A=_;for(const x of y)e._normalizeValue(x,c,A),A+=u}else y&&y.length>u?c.set(y,_):(e._normalizeValue(y,m.target,0),J6({target:c,source:m.target,start:_,count:w}));_+=w*u}else e._normalizeValue(y,c,_),_+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function Rd(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,o=t.end||n.length,a=e.length,l=o-r;if(a>l){n.set(e.subarray(0,l),r);return}if(n.set(e,r),!s)return;let c=a;for(;c<l;){const u=s(c,e);for(let f=0;f<i;f++)n[r+c]=u[f]||0,c++}}function A8({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!i||!s)return Rd({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const l=r&&((u,f)=>r(u+a,f)),c=Math.min(i.length,s.length);for(let u=1;u<c;u++){const f=i[u]*n,h=s[u]*n;Rd({source:t.subarray(o,f),target:e,start:a,end:h,size:n,getData:l}),o=f,a=h}return a<e.length&&Rd({source:[],target:e,start:a,size:n,getData:l}),e}function R8(t){const{device:e,settings:n,value:r}=t,i=new LA(e,n);return i.setData({value:r instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:n.normalized}),i}function UA(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${t}"`)}}function zA(t){switch(t){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function $A(t){t.push(t.shift())}function x8(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,o=n&&i instanceof Float64Array?2:1;let a=0;const{shaderAttributes:l}=t.settings;if(l)for(const c of Object.values(l))a=Math.max(a,c.vertexOffset??0);return(r.noAlloc?i.length:(e+a)*s)*o}function VA({device:t,source:e,target:n}){return(!n||n.byteLength<e.byteLength)&&(n==null||n.destroy(),n=t.createBuffer({byteLength:e.byteLength,usage:e.usage})),n}function jA({device:t,buffer:e,attribute:n,fromLength:r,toLength:i,fromStartIndices:s,getData:o=a=>a}){const a=n.doublePrecision&&n.value instanceof Float64Array?2:1,l=n.size*a,c=n.byteOffset,u=n.settings.bytesPerElement<4?c/n.settings.bytesPerElement*4:c,f=n.startIndices,h=s&&f,d=n.isConstant;if(!h&&e&&r>=i)return e;const g=n.value instanceof Float64Array?Float32Array:n.value.constructor,_=d?n.value:new g(n.getBuffer().readSyncWebGL(c,i*g.BYTES_PER_ELEMENT).buffer);if(n.settings.normalized&&!d){const y=o;o=(w,A)=>n.normalizeConstant(y(w,A))}const b=d?(y,w)=>o(_,w):(y,w)=>o(_.subarray(y+c,y+c+l),w),m=e?new Float32Array(e.readSyncWebGL(u,r*4).buffer):new Float32Array(0),p=new Float32Array(i);return A8({source:m,target:p,sourceStartIndices:s,targetStartIndices:f,size:l,getData:b}),(!e||e.byteLength<p.byteLength+u)&&(e==null||e.destroy(),e=t.createBuffer({byteLength:p.byteLength+u,usage:35050})),e.write(p,u),e}class WA{constructor({device:e,attribute:n,timeline:r}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new Yf(r),this.attribute=n,this.attributeInTransition=R8(n),this.currentStartIndices=n.startIndices}get inProgress(){return this.transition.inProgress}start(e,n,r=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=x8(this.attribute,n),this.transition.start({...e,duration:r})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}class C8 extends WA{constructor({device:e,attribute:n,timeline:r}){super({device:e,attribute:n,timeline:r}),this.type="interpolation",this.transform=M8(e,n)}start(e,n){const r=this.currentLength,i=this.currentStartIndices;if(super.start(e,n,e.duration),e.duration<=0){this.transition.cancel();return}const{buffers:s,attribute:o}=this;$A(s),s[0]=jA({device:this.device,buffer:s[0],attribute:o,fromLength:r,toLength:this.currentLength,fromStartIndices:i,getData:e.enter}),s[1]=VA({device:this.device,source:s[0],target:s[1]}),this.setBuffer(s[1]);const{transform:a}=this,l=a.model;let c=Math.floor(this.currentLength/o.size);HA(o)&&(c/=2),l.setVertexCount(c),o.isConstant?(l.setAttributes({aFrom:s[0]}),l.setConstantAttributes({aTo:o.value})):l.setAttributes({aFrom:s[0],aTo:o.getBuffer()}),a.transformFeedback.setBuffers({vCurrent:s[1]})}onUpdate(){const{duration:e,easing:n}=this.settings,{time:r}=this.transition;let i=r/e;n&&(i=n(i));const{model:s}=this.transform;s.setUniforms({time:i}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const P8=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`,I8=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function HA(t){return t.doublePrecision&&t.value instanceof Float64Array}function M8(t,e){const n=e.size,r=UA(n),i=zA(n),s=e.getBufferLayout();return HA(e)?new ba(t,{vs:I8,bufferLayout:[{name:"aFrom",byteStride:8*n,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*n}]},{name:"aTo",byteStride:8*n,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*n}]}],modules:[A4],defines:{ATTRIBUTE_TYPE:r,ATTRIBUTE_SIZE:n},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new ba(t,{vs:P8,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:s.attributes[0].format}],defines:{ATTRIBUTE_TYPE:r},varyings:["vCurrent"],disableWarnings:!0})}class N8 extends WA{constructor({device:e,attribute:n,timeline:r}){super({device:e,attribute:n,timeline:r}),this.type="spring",this.texture=D8(e),this.framebuffer=B8(e,this.texture),this.transform=F8(e,n)}start(e,n){const r=this.currentLength,i=this.currentStartIndices;super.start(e,n);const{buffers:s,attribute:o}=this;for(let l=0;l<2;l++)s[l]=jA({device:this.device,buffer:s[l],attribute:o,fromLength:r,toLength:this.currentLength,fromStartIndices:i,getData:e.enter});s[2]=VA({device:this.device,source:s[0],target:s[2]}),this.setBuffer(s[1]);const{model:a}=this.transform;a.setVertexCount(Math.floor(this.currentLength/o.size)),o.isConstant?a.setConstantAttributes({aTo:o.value}):a.setAttributes({aTo:o.getBuffer()})}onUpdate(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this,s=this.settings;n.model.setAttributes({aPrev:e[0],aCur:e[1]}),n.transformFeedback.setBuffers({vNext:e[2]}),n.model.setUniforms({stiffness:s.stiffness,damping:s.damping}),n.run({framebuffer:r,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),$A(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(r)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const k8=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,O8=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function F8(t,e){const n=UA(e.size),r=zA(e.size);return new ba(t,{vs:k8,fs:O8,bufferLayout:[{name:"aPrev",format:r},{name:"aCur",format:r},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],defines:{ATTRIBUTE_TYPE:n},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function D8(t){return t.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}function B8(t,e){return t.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}const L8={interpolation:C8,spring:N8};class U8{constructor(e,{id:n,timeline:r}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=n,this.device=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],o=s.getTransitionSetting(n);o&&this._updateAttribute(i,s,o)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){i&&this._removeTransition(e);const o=L8[r.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,device:this.device}):(G.error(`unsupported transition type '${r.type}'`)(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const zT="attributeManager.invalidate",z8="attributeManager.updateStart",$8="attributeManager.updateEnd",V8="attribute.updateStart",j8="attribute.allocate",W8="attribute.updateEnd";class H8{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){this.mergeBoundsMemoized=Za(P6),this.id=n,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new U8(e,{id:`${n}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);nt(zT,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);nt(zT,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}){let l=!1;nt(z8,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const u=this.attributes[c],f=u.settings.accessor;u.startIndices=r,u.numInstances=n,s[c]&&G.removed(`props.${c}`,`data.attributes.${c}`)(),u.setExternalBuffer(o[c])||u.setBinaryValue(typeof f=="string"?o[f]:void 0,e.startIndices)||typeof f=="string"&&!o[f]&&u.setConstantValue(s[f])||u.needsUpdate()&&(l=!0,this._updateAttribute({attribute:u,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||u.needsRedraw()}l&&nt($8,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])==null?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=o)}return i}getBufferLayouts(e){return Object.values(this.getAttributes()).map(n=>n.getBufferLayout(e))}_add(e,n){for(const r in e){const i=e[r],s={...i,id:r,size:i.isIndexed&&1||i.size||1,...n};this.attributes[r]=new LA(this.device,s)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(nt(V8,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&nt(j8,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,nt(W8,n,r))}}class X8 extends Yf{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,o=s(e/i);this._value=Tu(n,r,o)}}const $T=1e-5;function VT(t,e,n,r,i){const s=e-t,a=(n-e)*i,l=-s*r;return a+l+s+e}function Y8(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=VT(t[o],e[o],n[o],r,i);return s}return VT(t,e,n,r,i)}function jT(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class K8 extends Yf{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=Y8(s,o,n,r,i);const l=jT(a,n),c=jT(a,o);l<$T&&c<$T&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const q8={interpolation:X8,spring:K8};class Z8{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;n=c,this.remove(e)}if(i=BA(i),!i)return;const o=q8[i.type];if(!o){G.error(`unsupported transition type '${i.type}'`)();return}const a=new o(this.timeline);a.start({...i,fromValue:n,toValue:r}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function Q8(t){const e=t[Rr];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error(`Invalid prop ${n}: ${t[n]}`)}}function J8(t,e){const n=XA({newProps:t,oldProps:e,propTypes:t[Rr],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=ez(t,e);let i=!1;return r||(i=tz(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:nz(t,e),transitionsChanged:G8(t,e)}}function G8(t,e){if(!t.transitions)return!1;const n={},r=t[Rr];let i=!1;for(const s in t.transitions){const o=r[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&Sg(t[s],e[s],o)&&(n[s]=!0,i=!0)}return i?n:!1}function XA({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null)return`${i} changed shallowly`;if(typeof e!="object"||e===null)return`${i} changed shallowly`;for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return`${i}.${s} added`;const o=Sg(t[s],e[s],r[s]);if(o)return`${i}.${s} ${o}`}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return`${i}.${s} dropped`;if(!Object.hasOwnProperty.call(t,s)){const o=Sg(t[s],e[s],r[s]);if(o)return`${i}.${s} ${o}`}}return!1}function Sg(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function ez(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function tz(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&WT(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&WT(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function nz(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function WT(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},XA({oldProps:i,newProps:r,triggerName:n})}const rz="count(): argument not an object",iz="count(): argument not a container";function sz(t){if(!az(t))throw new Error(rz);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(oz(t))return Object.keys(t).length;throw new Error(iz)}function oz(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function az(t){return t!==null&&typeof t=="object"}function HT(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const lz={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},Eg={};function cz(t,e,n,r){if(n instanceof Ft)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={minFilter:"linear",mipmapFilter:n.data.length>1?"nearest":"linear"});const s=e.createTexture({...n,sampler:{...lz,...i,...r}});return Eg[s.id]=t,s}function uz(t,e){!e||!(e instanceof Ft)||Eg[e.id]===t&&(e.delete(),delete Eg[e.id])}const fz={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||bg(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Zt(t,e,1)}},accessor:{validate(t,e){const n=Cu(t);return n==="function"||n===Cu(e.value)},equal(t,e,n){return typeof e=="function"?!0:Zt(t,e,1)}},array:{validate(t,e){return e.optional&&!t||bg(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Zt(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Zt(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{if(!t)return t;const{dataTransform:r}=n.props;return r?r(t):typeof t.shape=="string"&&t.shape.endsWith("-table")&&Array.isArray(t.data)?t.data:t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.device?null:cz(n.id,r.device,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{uz(n.id,t)}}};function hz(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const o=s==null?void 0:s.deprecatedFor;if(o)r[i]=Array.isArray(o)?o:[o];else{const a=dz(i,s);e[i]=a,n[i]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function dz(t,e){switch(Cu(e)){case"object":return So(t,e);case"array":return So(t,{type:"array",value:e,compare:!1});case"boolean":return So(t,{type:"boolean",value:e});case"number":return So(t,{type:"number",value:e});case"function":return So(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function So(t,e){return"type"in e?{name:t,...fz[e.type],...e}:"value"in e?{name:t,type:Cu(e.value),...e}:{name:t,type:"object",value:e}}function bg(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Cu(t){return bg(t)?"array":t===null?"null":typeof t}function pz(t,e){let n;for(let s=e.length-1;s>=0;s--){const o=e[s];"extensions"in o&&(n=o.extensions)}const r=Ag(t.constructor,n),i=Object.create(r);i[Au]=t,i[_i]={},i[gr]={};for(let s=0;s<e.length;++s){const o=e[s];for(const a in o)i[a]=o[a]}return Object.freeze(i),i}const gz="_mergedDefaultProps";function Ag(t,e){let n=gz;if(e)for(const i of e){const s=i.constructor;s&&(n+=`:${s.extensionName||s.name}`)}const r=YA(t,n);return r||(t[n]=_z(t,e||[]))}function _z(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=Ag(r),s=YA(t,"defaultProps")||{},o=hz(s),a=Object.assign(Object.create(null),i,o.defaultProps),l=Object.assign(Object.create(null),i==null?void 0:i[Rr],o.propTypes),c=Object.assign(Object.create(null),i==null?void 0:i[gd],o.deprecatedProps);for(const u of e){const f=Ag(u.constructor);f&&(Object.assign(a,f),Object.assign(l,f[Rr]),Object.assign(c,f[gd]))}return mz(a,t),vz(a,l),yz(a,c),a[Rr]=l,a[gd]=c,e.length===0&&!km(t,"_propTypes")&&(t._propTypes=l),a}function mz(t,e){const n=wz(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function yz(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i=`${this.id}: ${n}`;for(const s of e[n])km(this,s)||(this[s]=r);G.deprecated(i,e[n].join("/"))()}})}function vz(t,e){const n={},r={};for(const i in e){const s=e[i],{name:o,value:a}=s;s.async&&(n[o]=a,r[o]=Tz(o))}t[Ts]=n,t[_i]={},Object.defineProperties(t,r)}function Tz(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||FA(e)?this[_i][t]=e:this[gr][t]=e},get(){if(this[gr]){if(t in this[gr])return this[gr][t]||this[Ts][t];if(t in this[_i]){const e=this[Au]&&this[Au].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[Ts][t]}}return this[Ts][t]}}}function km(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function YA(t,e){return km(t,e)&&t[e]}function wz(t){const e=t.componentName;return e||G.warn(`${t.name}.componentName not specified`)(),e||t.name}let Sz=0;const Qu=class Qu{constructor(...e){this.props=pz(this,e),this.id=this.props.id,this.count=Sz++}clone(e){const{props:n}=this,r={};for(const i in n[Ts])i in n[gr]?r[i]=n[gr][i]:i in n[_i]&&(r[i]=n[_i][i]);return new this.constructor({...n,...r,...e})}};Qu.componentName="Component",Qu.defaultProps={};let Rg=Qu;const Ez=Object.freeze({});class bz{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||Ez}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[Au]||this.component;const n=e[gr]||{},r=e[_i]||e,i=e[Ts]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in r){const o=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(FA(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],o=0;for await(const a of n){if(!this.component)return;const{dataTransform:l}=this.component.props;l?s=l(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[Rr];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class Az extends bz{constructor({attributeManager:e,layer:n}){super(n),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,`loading ${e} of ${this.layer}`)}}const Rz="layer.changeFlag",xz="layer.initialize",Cz="layer.update",Pz="layer.finalize",Iz="layer.matched",XT=2**24-1,Mz=Object.freeze([]),Nz=Za(({oldViewport:t,viewport:e})=>t.equals(e));let dn=new Uint8ClampedArray(0);const kz={data:{type:"data",value:Mz,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=n.context;i=i||n.getLoadOptions(),r=r||n.props.loaders,s&&(i={...i,fetch:{...i==null?void 0:i.fetch,signal:s}});let a=o.contains(t);return!a&&!i&&(o.add({resourceId:t,data:cu(t,r),persistent:!1}),a=!0),a?o.subscribe({resourceId:t,onChange:l=>{var c;return(c=n.internalState)==null?void 0:c.reloadAsyncProp(e,l)},consumerId:n.id,requestId:e}):cu(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:ie.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}},Ju=class Ju extends Rg{constructor(){super(...arguments),this.internalState=null,this.lifecycle=Vi.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){ke(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=hA(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,o]=cA(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,o]}unproject(e){return ke(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){ke(this.internalState);const r=this.internalState.viewport||this.context.viewport;return F6(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}setShaderModuleProps(...e){for(const n of this.getModels())n.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===ie.DEFAULT||e===ie.LNGLAT||e===ie.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){ke(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:sz(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){e=HT(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const n of this.props.extensions)e=HT(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,o=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(s!==o){this.internalState.hasPickingBuffer=o;const{pickingColors:a,instancePickingColors:l}=n.attributes,c=a||l;c&&(o&&c.constant&&(c.constant=!1,n.invalidate(c.id)),!c.value&&!o&&(c.constant=!0,c.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.destroy();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i,s,o;n&&(e=new Error(`${n}: ${e.message}`,{cause:e})),(i=(r=this.props).onError)!=null&&i.call(r,e)||(o=(s=this.context)==null?void 0:s.onError)==null||o.call(s,e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)==null?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!Nz({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){let n=!1;for(const r in e)e[r].layoutChanged()&&(n=!0);for(const r of this.getModels())this._setModelAttributes(r,e,n)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(dn.length/4);if(this.internalState.usesPickingColorCache=!0,r<n){n>XT&&G.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),dn=js.allocate(dn,n,{size:4,copy:!0,maxCount:Math.max(n,XT)});const i=Math.floor(dn.length/4),s=[];for(let o=r;o<i;o++)this.encodePickingColor(o,s),dn[o*4+0]=s[0],dn[o*4+1]=s[1],dn[o*4+2]=s[2]}e.value=dn.subarray(0,n*4)}_setModelAttributes(e,n,r=!1){var a;if(!Object.keys(n).length)return;if(r){const l=this.getAttributeManager();e.setBufferLayout(l.getBufferLayouts(e)),n=l.getAttributes()}const i=((a=e.userData)==null?void 0:a.excludeAttributes)||{},s={},o={};for(const l in n){if(i[l])continue;const c=n[l].getValue();for(const u in c){const f=c[u];f instanceof Te?n[l].settings.isIndexed?e.setIndexBuffer(f):s[u]=f:f&&(o[u]=f)}}e.setAttributes(s),e.setConstantAttributes(o)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,o=s&&n.attributes&&n.attributes[s.id];if(o&&o.value){const a=o.value,l=this.encodePickingColor(e);for(let c=0;c<n.length;c++){const u=s.getVertexOffset(c);a[u]===l[0]&&a[u+1]===l[1]&&a[u+2]===l[2]&&this._disablePickingIndex(c)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.write(new Uint8Array(o-s),s)}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==dn.buffer&&(r.value=dn.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){ke(!this.internalState),ke(Number.isFinite(this.props.coordinateSystem)),nt(xz,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Az({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(G.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new Z8(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){nt(Iz,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(nt(Cz,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,o=this._updateUniformTransition();i.propsInTransition=o,r.viewport=i.viewport||s,this.props=o;try{const a=this._getUpdateParams(),l=this.getModels();if(r.device)this.updateState(a);else try{this.updateState(a)}catch{}for(const u of this.props.extensions)u.updateState.call(this,a,u);const c=this.getModels()[0]!==l[0];this._postUpdate(a,c)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){nt(Pz,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,moduleParameters:n=null,uniforms:r={},parameters:i={}}){this._updateAttributeTransition();const s=this.props,o=this.context;this.props=this.internalState.propsInTransition||s;const a=this.props.opacity;r.opacity=Math.pow(a,1/2.2);try{if(n){const{isActive:u,isAttribute:f}=n.picking;this.setModuleParameters(n),this.setShaderModuleProps({picking:{isActive:u,isAttribute:f}})}const{getPolygonOffset:l}=this.props,c=l&&l(r)||[0,0];o.device.setParametersWebGL({polygonOffset:c});for(const u of this.getModels())u.setParameters(i);o.device.withParametersWebGL(i,()=>{const u={renderPass:e,moduleParameters:n,uniforms:r,parameters:i,context:o};for(const f of this.props.extensions)f.draw.call(this,u,f);this.draw(u)})}finally{this.props=s}}getChangeFlags(){var e;return(e=this.internalState)==null?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const o=e[i],a=n[i];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&nt(Rz,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){var i;const r=J8(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged)this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)==null?void 0:i[s]);return this.setChangeFlags(r)}validateProps(){Q8(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={highlightedObjectColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.highlightColor=r(e)),this.setShaderModuleProps({picking:n}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new H8(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const s=this.state.model;s!=null&&s.isInstanced&&s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:l}=r;if(n||i.autoHighlight!==o||i.highlightedObjectIndex!==a||i.highlightColor!==l){const c={};Array.isArray(l)&&(c.highlightColor=l),(n||i.autoHighlight!==o||a!==i.highlightedObjectIndex)&&(c.highlightedObjectColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setShaderModuleProps({picking:c})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}};Ju.defaultProps=kz,Ju.layerName="Layer";let Nr=Ju;const Oz="compositeLayer.renderLayers",Bm=class Bm extends Nr{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var I;const{opacity:n,pickable:r,visible:i,parameters:s,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:l,highlightColor:c,coordinateSystem:u,coordinateOrigin:f,wrapLongitude:h,positionFormat:d,modelMatrix:g,extensions:_,fetch:b,operation:m,_subLayerProps:p}=this.props,y={id:"",updateTriggers:{},opacity:n,pickable:r,visible:i,parameters:s,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:l,highlightColor:c,coordinateSystem:u,coordinateOrigin:f,wrapLongitude:h,positionFormat:d,modelMatrix:g,extensions:_,fetch:b,operation:m},w=p&&e.id&&p[e.id],A=w&&w.updateTriggers,x=e.id||"sublayer";if(w){const O=this.props[Rr],D=e.type?e.type._propTypes:{};for(const z in w){const H=D[z]||O[z];H&&H.type==="accessor"&&(w[z]=this.getSubLayerAccessor(w[z]))}}Object.assign(y,e,w),y.id=`${this.props.id}-${x}`,y.updateTriggers={all:(I=this.props.updateTriggers)==null?void 0:I.all,...e.updateTriggers,...A};for(const O of _){const D=O.getSubLayerProps.call(this,O);D&&Object.assign(y,D,{updateTriggers:Object.assign(y.updateTriggers,D.updateTriggers)})}return y}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=Hs(s,Boolean),this.internalState.subLayers=r}nt(Oz,this,i,r);for(const s of r)s.parent=this}};Bm.layerName="CompositeLayer";let Pu=Bm;class KA{constructor(e){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;const{attributes:n={}}=e;this.typedArrayManager=js,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:o,dataChanged:a,normalize:l=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(o==="XY"?2:3),this.buffers=r,this.normalize=l,s&&(ke(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),l||(r.vertexPositions=s)),this.geometryBuffer=r.vertexPositions,Array.isArray(a))for(const c of a)this._rebuildGeometry(c);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?DA(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:o}=this;for(const a in s)if(a in i)o.release(r[a]),r[a]=null;else{const l=s[a];l.copy=n,r[a]=o.allocate(r[a],e,l)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:o,objectInfo:a}=Qf(i,n,r);for(const l of o){a.index++;const c=s?s(l,a):null;e(c,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:o}=this,{startRow:a=0,endRow:l=1/0}=e||{},c={};if(e||(n=[0],r=[0]),this.normalize||!o)this._forEachGeometry((f,h)=>{const d=f&&this.normalizeGeometry(f);c[h]=d,r[h+1]=r[h]+(d?this.getGeometrySize(d):0)},a,l),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(o))i=i||o.length/this.positionSize;else if(o instanceof Te){const f=this.positionSize*4;i=i||o.byteLength/f}else if(o.buffer){const f=o.stride||this.positionSize*4;i=i||o.buffer.byteLength/f}else if(o.value){const f=o.value,h=o.stride/f.BYTES_PER_ELEMENT||this.positionSize;i=i||f.length/h}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const u={};this._forEachGeometry((f,h)=>{const d=c[h]||f;u.vertexStart=r[h],u.indexStart=n[h];const g=h<r.length-1?r[h+1]:i;u.geometrySize=g-r[h],u.geometryIndex=h,this.updateGeometryAttributes(d,u)},a,l),this.vertexCount=n[n.length-1]}}const Fz=`#version 300 es
#define SHADER_NAME icon-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceSizes;
in float instanceAngles;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec4 instanceIconFrames;
in float instanceColorModes;
in vec2 instanceOffsets;
in vec2 instancePixelOffset;
uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;
out float vColorMode;
out vec4 vColor;
out vec2 vTextureCoords;
out vec2 uv;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = angle * PI / 180.0;
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vec2 iconSize = instanceIconFrames.zw;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
sizeMinPixels, sizeMaxPixels
);
float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
pixelOffset += instancePixelOffset;
pixelOffset.y *= -1.0;
if (billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vTextureCoords = mix(
instanceIconFrames.xy,
instanceIconFrames.xy + iconSize,
(positions.xy + 1.0) / 2.0
) / iconsTextureDim;
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
vColorMode = instanceColorModes;
}
`,Dz=`#version 300 es
#define SHADER_NAME icon-layer-fragment-shader
precision highp float;
uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;
in float vColorMode;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec4 texColor = texture(iconsTexture, vTextureCoords);
vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
float a = texColor.a * opacity * vColor.a;
if (a < alphaCutoff) {
discard;
}
fragColor = vec4(color, a);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Bz=1024,Lz=4,YT=()=>{},KT={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},Uz={x:0,y:0,width:0,height:0};function zz(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function $z(t,e,n,r){const i=Math.min(n/e.width,r/e.height),s=Math.floor(e.width*i),o=Math.floor(e.height*i);return i===1?{data:e,width:s,height:o}:(t.canvas.height=o,t.canvas.width=s,t.clearRect(0,0,s,o),t.drawImage(e,0,0,e.width,e.height,0,0,s,o),{data:t.canvas,width:s,height:o})}function xa(t){return t&&(t.id||t.url)}function Vz(t,e,n,r){const{width:i,height:s,device:o}=t,a=o.createTexture({format:"rgba8unorm",width:e,height:n,sampler:r}),l=o.createCommandEncoder();return l.copyTextureToTexture({source:t,destination:a,width:i,height:s}),l.finish(),t.destroy(),a}function qT(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],o=xa(i);t[o]={...i,x:s,y:n}}}function jz({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let l=0;l<t.length;l++){const c=t[l],u=xa(c);if(!n[u]){const{height:f,width:h}=c;r+h+e>o&&(qT(n,a,i),r=0,i=s+i+e,s=0,a=[]),a.push({icon:c,xOffset:r}),r=r+h+e,s=Math.max(s,f)}}return a.length>0&&qT(n,a,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:o,canvasHeight:zz(s+i+e)}}function Wz(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=Qf(t);for(const o of i){s.index++;const a=e(o,s),l=xa(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!r[l]&&(!n[l]||a.url!==n[l].url)&&(r[l]={...a,source:o,sourceIndex:s.index})}return r}class Hz{constructor(e,{onUpdate:n=YT,onError:r=YT}){this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._textureParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=Lz,this._canvasWidth=Bz,this._canvasHeight=0,this._canvas=null,this.device=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)==null||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?xa(e):e;return this._mapping[n]||Uz}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){var o;e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r&&((o=this._texture)==null||o.delete(),this._texture=null,this._externalTexture=r),s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(Wz(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:o,rowHeight:a,canvasHeight:l}=jz({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=i,this._xOffset=s,this._yOffset=o,this._canvasHeight=l,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",width:this._canvasWidth,height:this._canvasHeight,sampler:this._textureParameters||KT})),this._texture.height!==this._canvasHeight&&(this._texture=Vz(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||KT)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,cu(r.url,this._loadOptions).then(i=>{const s=xa(r),o=this._mapping[s],{x:a,y:l,width:c,height:u}=o,{data:f,width:h,height:d}=$z(n,i,c,u);this._texture.setSubImageData({data:f,x:a+(c-h)/2,y:l+(u-d)/2,width:h,height:d}),o.width=h,o.height=d,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const qA=[0,0,0,255],Xz={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:qA},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}},Gu=class Gu extends Nr{getShaders(){return super.getShaders({vs:Fz,fs:Dz,modules:[Qa,Ja]})}initializeState(){this.state={iconManager:new Hz(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:qA},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){var d;super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:l,getIcon:c,textureParameters:u}=n,{iconManager:f}=this.state;if(typeof o=="string")return;const h=o||this.internalState.isAsyncPropLoading("iconAtlas");f.setProps({loadOptions:n.loadOptions,autoPacking:!h,iconAtlas:o,iconMapping:h?a:null,textureParameters:u}),h?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&f.packIcons(l,c),i.extensionsChanged&&((d=this.state.model)==null||d.destroy(),this.state.model=this._getModel(),s.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:l}=this.state,c=l.getTexture();if(c){const u=this.state.model;u.setBindings({iconsTexture:c}),u.setUniforms(e),u.setUniforms({iconsTextureDim:[c.width,c.height],sizeUnits:gi[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:o,alphaCutoff:a}),u.draw(this.context.renderPass)}}_getModel(){const e=[-1,-1,1,-1,-1,1,1,1];return new nn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Ws({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var r;const n=(r=this.getCurrentLayer())==null?void 0:r.props.onIconError;n?n(e):G.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}};Gu.defaultProps=Xz,Gu.layerName="IconLayer";let Iu=Gu;const Yz=`#version 300 es
#define SHADER_NAME scatterplot-layer-vertex-shader
in vec3 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceRadius;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;
out vec4 vFillColor;
out vec4 vLineColor;
out vec2 unitPosition;
out float innerUnitRadius;
out float outerRadiusPixels;
void main(void) {
geometry.worldPosition = instancePositions;
outerRadiusPixels = clamp(
project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
radiusMinPixels, radiusMaxPixels
);
float lineWidthPixels = clamp(
project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
lineWidthMinPixels, lineWidthMaxPixels
);
outerRadiusPixels += stroked * lineWidthPixels / 2.0;
float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
unitPosition = edgePadding * positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
if (billboard) {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = edgePadding * positions * outerRadiusPixels;
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,Kz=`#version 300 es
#define SHADER_NAME scatterplot-layer-fragment-shader
precision highp float;
uniform bool filled;
uniform float stroked;
uniform bool antialiasing;
in vec4 vFillColor;
in vec4 vLineColor;
in vec2 unitPosition;
in float innerUnitRadius;
in float outerRadiusPixels;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition;
float distToCenter = length(unitPosition) * outerRadiusPixels;
float inCircle = antialiasing ?
smoothedge(distToCenter, outerRadiusPixels) :
step(distToCenter, outerRadiusPixels);
if (inCircle == 0.0) {
discard;
}
if (stroked > 0.5) {
float isLine = antialiasing ?
smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
step(innerUnitRadius * outerRadiusPixels, distToCenter);
if (filled) {
fragColor = mix(vFillColor, vLineColor, isLine);
} else {
if (isLine == 0.0) {
discard;
}
fragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
}
} else if (!filled) {
discard;
} else {
fragColor = vFillColor;
}
fragColor.a *= inCircle;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,ZT=[0,0,0,255],qz={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:ZT},getLineColor:{type:"accessor",value:ZT},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}},ef=class ef extends Nr{getShaders(){return super.getShaders({vs:Yz,fs:Kz,modules:[Qa,Ja]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){var n;super.updateState(e),e.changeFlags.extensionsChanged&&((n=this.state.model)==null||n.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:o,filled:a,billboard:l,antialiasing:c,lineWidthUnits:u,lineWidthScale:f,lineWidthMinPixels:h,lineWidthMaxPixels:d}=this.props,g=this.state.model;g.setUniforms(e),g.setUniforms({stroked:o?1:0,filled:a,billboard:l,antialiasing:c,radiusUnits:gi[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:gi[u],lineWidthScale:f,lineWidthMinPixels:h,lineWidthMaxPixels:d}),g.draw(this.context.renderPass)}_getModel(){const e=[-1,-1,0,1,-1,0,-1,1,0,1,1,0];return new nn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Ws({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array(e)}}}),isInstanced:!0})}};ef.defaultProps=qz,ef.layerName="ScatterplotLayer";let xg=ef;const ZA={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function QA(t,e,n={}){return Zz(t,n)!==e?(Jz(t,n),!0):!1}function Zz(t,e={}){return Math.sign(Qz(t,e))}const QT={x:0,y:1,z:2};function Qz(t,e={}){const{start:n=0,end:r=t.length,plane:i="xy"}=e,s=e.size||2;let o=0;const a=QT[i[0]],l=QT[i[1]];for(let c=n,u=r-s;c<r;c+=s)o+=(t[c+a]-t[u+a])*(t[c+l]+t[u+l]),u=c;return o/2}function Jz(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,o=Math.floor(s/2);for(let a=0;a<o;++a){const l=n+a*i,c=n+(s-1-a)*i;for(let u=0;u<i;++u){const f=t[l+u];t[l+u]=t[c+u],t[c+u]=f}}}function Qt(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function Cg(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function Ca(t,e,n,r,i=[]){const s=r+e*n;for(let o=0;o<n;o++)i[o]=t[s+o];return i}function Pg(t,e,n,r,i=[]){let s,o;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),o=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),o=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),o=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),o=0;else return null;for(let a=0;a<t.length;a++)i[a]=(o&1)===a?r[o]:s*(e[a]-t[a])+t[a];return i}function bc(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function JA(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:o=0,endIndex:a=t.length}=e||{},l=(a-o)/n;let c=[];const u=[c],f=Ca(t,0,n,o);let h,d;const g=eR(f,i,s,[]),_=[];Qt(c,f);for(let b=1;b<l;b++){for(h=Ca(t,b,n,o,h),d=bc(h,g);d;){Pg(f,h,d,g,_);const m=bc(_,g);m&&(Pg(f,_,m,g,_),d=m),Qt(c,_),Cg(f,_),e$(g,i,d),r&&c.length>n&&(c=[],u.push(c),Qt(c,f)),d=bc(h,g)}Qt(c,h),Cg(f,h)}return r?u:u[0]}const JT=0,Gz=1;function GA(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:o=!1}=n||{},a=[],l=[{pos:t,types:o?new Array(t.length/r).fill(Gz):null,holes:e||[]}],c=[[],[]];let u=[];for(;l.length;){const{pos:f,types:h,holes:d}=l.shift();t$(f,r,d[0]||f.length,c),u=eR(c[0],i,s,u);const g=bc(c[1],u);if(g){let _=GT(f,h,r,0,d[0]||f.length,u,g);const b={pos:_[0].pos,types:_[0].types,holes:[]},m={pos:_[1].pos,types:_[1].types,holes:[]};l.push(b,m);for(let p=0;p<d.length;p++)_=GT(f,h,r,d[p],d[p+1]||f.length,u,g),_[0]&&(b.holes.push(b.pos.length),b.pos=Kl(b.pos,_[0].pos),o&&(b.types=Kl(b.types,_[0].types))),_[1]&&(m.holes.push(m.pos.length),m.pos=Kl(m.pos,_[1].pos),o&&(m.types=Kl(m.types,_[1].types)))}else{const _={positions:f};o&&(_.edgeTypes=h),d.length&&(_.holeIndices=d),a.push(_)}}return a}function GT(t,e,n,r,i,s,o){const a=(i-r)/n,l=[],c=[],u=[],f=[],h=[];let d,g,_;const b=Ca(t,a-1,n,r);let m=Math.sign(o&8?b[1]-s[3]:b[0]-s[2]),p=e&&e[a-1],y=0,w=0;for(let A=0;A<a;A++)d=Ca(t,A,n,r,d),g=Math.sign(o&8?d[1]-s[3]:d[0]-s[2]),_=e&&e[r/n+A],g&&m&&m!==g&&(Pg(b,d,o,s,h),Qt(l,h)&&u.push(p),Qt(c,h)&&f.push(p)),g<=0?(Qt(l,d)&&u.push(_),y-=g):u.length&&(u[u.length-1]=JT),g>=0?(Qt(c,d)&&f.push(_),w+=g):f.length&&(f[f.length-1]=JT),Cg(b,d),m=g,p=_;return[y?{pos:l,types:e&&u}:null,w?{pos:c,types:e&&f}:null]}function eR(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function e$(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function t$(t,e,n,r){let i=1/0,s=-1/0,o=1/0,a=-1/0;for(let l=0;l<n;l+=e){const c=t[l],u=t[l+1];i=c<i?c:i,s=c>s?c:s,o=u<o?u:o,a=u>a?u:a}return r[0][0]=i,r[0][1]=o,r[1][0]=s,r[1][1]=a,r}function Kl(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}const n$=85.051129;function r$(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},o=t.slice(r,i);tR(o,n,0,i-r);const a=JA(o,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const l of a)nR(l,n);return a}function i$(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};e=e||[];const o=[],a=[];let l=0,c=0;for(let f=0;f<=e.length;f++){const h=e[f]||t.length,d=c,g=s$(t,r,l,h);for(let _=g;_<h;_++)o[c++]=t[_];for(let _=l;_<g;_++)o[c++]=t[_];tR(o,r,d,c),o$(o,r,d,c,n==null?void 0:n.maxLatitude),l=h,a[f]=c}a.pop();const u=GA(o,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const f of u)nR(f.positions,r);return u}function s$(t,e,n,r){let i=-1,s=-1;for(let o=n+1;o<r;o+=e){const a=Math.abs(t[o]);a>i&&(i=a,s=o-1)}return s}function o$(t,e,n,r,i=n$){const s=t[n],o=t[r-e];if(Math.abs(s-o)>180){const a=Ca(t,0,e,n);a[0]+=Math.round((o-s)/360)*360,Qt(t,a),a[1]=Math.sign(a[1])*i,Qt(t,a),a[0]=s,Qt(t,a)}}function tR(t,e,n,r){let i=t[0],s;for(let o=n;o<r;o+=e){s=t[o];const a=s-i;(a>180||a<-180)&&(s-=Math.round(a/360)*360),t[o]=i=s}}function nR(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}function a$(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let o=0;o<t.length;o++)for(let a=0;a<e;a++)i[o*e+a]=t[o][a]||0}else i=t;return n?JA(i,{size:e,gridResolution:n}):r?r$(i,{size:e}):i}const l$=1,c$=2,xd=4;class u$ extends KA{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?a$(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(ew(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&ew(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:o}=n;r.fill(0,s,s+o),i?(r[s]=xd,r[s+o-2]=xd):(r[s]+=l$,r[s+o-2]+=c$),r[s+o-1]=xd}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,o=new Array(3);for(let a=i,l=0;l<s;a++,l++)this.getPointOnPath(e,l,o),r[a*3]=o[0],r[a*3+1]=o[1],r[a*3+2]=o[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function ew(t){return Array.isArray(t[0])}const f$=`#version 300 es
#define SHADER_NAME path-layer-vertex-shader
in vec2 positions;
in float instanceTypes;
in vec3 instanceStartPositions;
in vec3 instanceEndPositions;
in vec3 instanceLeftPositions;
in vec3 instanceRightPositions;
in vec3 instanceLeftPositions64Low;
in vec3 instanceStartPositions64Low;
in vec3 instanceEndPositions64Low;
in vec3 instanceRightPositions64Low;
in float instanceStrokeWidths;
in vec4 instanceColors;
in vec3 instancePickingColors;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;
uniform float opacity;
out vec4 vColor;
out vec2 vCornerOffset;
out float vMiterLength;
out vec2 vPathPosition;
out float vPathLength;
out float vJointType;
const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);
float flipIfTrue(bool flag) {
return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
vec2 width
) {
bool isEnd = positions.x > 0.0;
float sideOfPath = positions.y;
float isJoint = float(sideOfPath == 0.0);
vec3 deltaA3 = (currPoint - prevPoint);
vec3 deltaB3 = (nextPoint - currPoint);
mat3 rotationMatrix;
bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
if (needsRotation) {
deltaA3 = deltaA3 * rotationMatrix;
deltaB3 = deltaB3 * rotationMatrix;
}
vec2 deltaA = deltaA3.xy / width;
vec2 deltaB = deltaB3.xy / width;
float lenA = length(deltaA);
float lenB = length(deltaB);
vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);
vec2 perpA = vec2(-dirA.y, dirA.x);
vec2 perpB = vec2(-dirB.y, dirB.x);
vec2 tangent = dirA + dirB;
tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
vec2 miterVec = vec2(-tangent.y, tangent.x);
vec2 dir = isEnd ? dirA : dirB;
vec2 perp = isEnd ? perpA : perpB;
float L = isEnd ? lenA : lenB;
float sinHalfA = abs(dot(miterVec, perp));
float cosHalfA = abs(dot(dirA, miterVec));
float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
float cornerPosition = sideOfPath * turnDirection;
float miterSize = 1.0 / max(sinHalfA, EPSILON);
miterSize = mix(
min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
miterSize,
step(0.0, cornerPosition)
);
vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
* (sideOfPath + isJoint * turnDirection);
bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
bool isCap = isStartCap || isEndCap;
if (isCap) {
offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
vJointType = capType;
} else {
vJointType = jointType;
}
vPathLength = L;
vCornerOffset = offsetVec;
vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
vMiterLength = isCap ? isJoint : vMiterLength;
vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
vPathPosition = vec2(
dot(offsetFromStartOfPath, perp),
dot(offsetFromStartOfPath, dir)
);
geometry.uv = vPathPosition;
float isValid = step(instanceTypes, 3.5);
vec3 offset = vec3(offsetVec * width * isValid, 0.0);
if (needsRotation) {
offset = rotationMatrix * offset;
}
return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
if (position.w < EPSILON) {
float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
position = refPosition + (position - refPosition) * r;
}
}
void main() {
geometry.pickingColor = instancePickingColors;
vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);
float isEnd = positions.x;
vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);
vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);
vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);
geometry.worldPosition = currPosition;
vec2 widthPixels = vec2(clamp(
project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
widthMinPixels, widthMaxPixels) / 2.0);
vec3 width;
if (billboard) {
vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);
clipLine(prevPositionScreen, currPositionScreen);
clipLine(nextPositionScreen, currPositionScreen);
clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));
width = vec3(widthPixels, 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(
prevPositionScreen.xyz / prevPositionScreen.w,
currPositionScreen.xyz / currPositionScreen.w,
nextPositionScreen.xyz / nextPositionScreen.w,
project_pixel_size_to_clipspace(width.xy)
);
DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
} else {
prevPosition = project_position(prevPosition, prevPosition64Low);
currPosition = project_position(currPosition, currPosition64Low);
nextPosition = project_position(nextPosition, nextPosition64Low);
width = vec3(project_pixel_size(widthPixels), 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
geometry.position = vec4(currPosition + offset, 1.0);
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,h$=`#version 300 es
#define SHADER_NAME path-layer-fragment-shader
precision highp float;
uniform float miterLimit;
in vec4 vColor;
in vec2 vCornerOffset;
in float vMiterLength;
in vec2 vPathPosition;
in float vPathLength;
in float vJointType;
out vec4 fragColor;
void main(void) {
geometry.uv = vPathPosition;
if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
discard;
}
if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
discard;
}
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,rR=[0,0,0,255],d$={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:rR},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Cd={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t},tf=class tf extends Nr{getShaders(){return super.getShaders({vs:f$,fs:h$,modules:[Qa,Ja]})}get wrapLongitude(){return!1}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["vertexPositions"])}initializeState(){this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:Cd,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Cd,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:Cd,defaultValue:rR},instancePickingColors:{size:4,type:"uint8",accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new u$({fp64:this.use64bitPositions()})})}updateState(e){var o;super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,l=n.data.attributes||{};a.updateGeometry({data:n.data,geometryBuffer:l.getPath,buffers:l,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),r.dataChanged||i.invalidateAll()}r.extensionsChanged&&((o=this.state.model)==null||o.destroy(),this.state.model=this._getModel(),i.invalidateAll())}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,i=this.props.data;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const n=this.props.data;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:o,widthScale:a,widthMinPixels:l,widthMaxPixels:c}=this.props,u=this.state.model;u.setUniforms(e),u.setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:gi[o],widthScale:a,miterLimit:s,widthMinPixels:l,widthMaxPixels:c}),u.draw(this.context.renderPass)}_getModel(){const e=[0,1,2,1,4,2,1,3,4,3,5,4],n=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new nn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Ws({topology:"triangle-list",attributes:{indices:new Uint16Array(e),positions:{value:new Float32Array(n),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}};tf.defaultProps=d$,tf.layerName="PathLayer";let Ig=tf;var Om={exports:{}};Om.exports=Jf;Om.exports.default=Jf;function Jf(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=iR(t,0,i,n,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,c,u,f,h,d;if(r&&(s=y$(t,e,s,n)),t.length>80*n){a=c=t[0],l=u=t[1];for(var g=n;g<i;g+=n)f=t[g],h=t[g+1],f<a&&(a=f),h<l&&(l=h),f>c&&(c=f),h>u&&(u=h);d=Math.max(c-a,u-l),d=d!==0?32767/d:0}return Pa(s,o,n,a,l,d,0),o}function iR(t,e,n,r,i){var s,o;if(i===kg(t,e,n,r)>0)for(s=e;s<n;s+=r)o=tw(s,t[s],t[s+1],o);else for(s=n-r;s>=e;s-=r)o=tw(s,t[s],t[s+1],o);return o&&Gf(o,o.next)&&(Ma(o),o=o.next),o}function yi(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(Gf(n,n.next)||Ee(n.prev,n,n.next)===0)){if(Ma(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function Pa(t,e,n,r,i,s,o){if(t){!o&&s&&E$(t,r,i,s);for(var a=t,l,c;t.prev!==t.next;){if(l=t.prev,c=t.next,s?g$(t,r,i,s):p$(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(c.i/n|0),Ma(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=_$(yi(t),e,n),Pa(t,e,n,r,i,s,2)):o===2&&m$(t,e,n,r,i,s):Pa(yi(t),e,n,r,i,s,1);break}}}}function p$(t){var e=t.prev,n=t,r=t.next;if(Ee(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,o=r.x,a=e.y,l=n.y,c=r.y,u=i<s?i<o?i:o:s<o?s:o,f=a<l?a<c?a:c:l<c?l:c,h=i>s?i>o?i:o:s>o?s:o,d=a>l?a>c?a:c:l>c?l:c,g=r.next;g!==e;){if(g.x>=u&&g.x<=h&&g.y>=f&&g.y<=d&&ls(i,a,s,l,o,c,g.x,g.y)&&Ee(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function g$(t,e,n,r){var i=t.prev,s=t,o=t.next;if(Ee(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,c=o.x,u=i.y,f=s.y,h=o.y,d=a<l?a<c?a:c:l<c?l:c,g=u<f?u<h?u:h:f<h?f:h,_=a>l?a>c?a:c:l>c?l:c,b=u>f?u>h?u:h:f>h?f:h,m=Mg(d,g,e,n,r),p=Mg(_,b,e,n,r),y=t.prevZ,w=t.nextZ;y&&y.z>=m&&w&&w.z<=p;){if(y.x>=d&&y.x<=_&&y.y>=g&&y.y<=b&&y!==i&&y!==o&&ls(a,u,l,f,c,h,y.x,y.y)&&Ee(y.prev,y,y.next)>=0||(y=y.prevZ,w.x>=d&&w.x<=_&&w.y>=g&&w.y<=b&&w!==i&&w!==o&&ls(a,u,l,f,c,h,w.x,w.y)&&Ee(w.prev,w,w.next)>=0))return!1;w=w.nextZ}for(;y&&y.z>=m;){if(y.x>=d&&y.x<=_&&y.y>=g&&y.y<=b&&y!==i&&y!==o&&ls(a,u,l,f,c,h,y.x,y.y)&&Ee(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;w&&w.z<=p;){if(w.x>=d&&w.x<=_&&w.y>=g&&w.y<=b&&w!==i&&w!==o&&ls(a,u,l,f,c,h,w.x,w.y)&&Ee(w.prev,w,w.next)>=0)return!1;w=w.nextZ}return!0}function _$(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!Gf(i,s)&&sR(i,r,r.next,s)&&Ia(i,s)&&Ia(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),Ma(r),Ma(r.next),r=t=s),r=r.next}while(r!==t);return yi(r)}function m$(t,e,n,r,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&R$(o,a)){var l=oR(o,a);o=yi(o,o.next),l=yi(l,l.next),Pa(o,e,n,r,i,s,0),Pa(l,e,n,r,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function y$(t,e,n,r){var i=[],s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:t.length,c=iR(t,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push(A$(c));for(i.sort(v$),s=0;s<i.length;s++)n=T$(i[s],n);return n}function v$(t,e){return t.x-e.x}function T$(t,e){var n=w$(t,e);if(!n)return e;var r=oR(n,t);return yi(r,r.next),yi(n,n.next)}function w$(t,e){var n=e,r=t.x,i=t.y,s=-1/0,o;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var a=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>s&&(s=a,o=n.x<n.next.x?n:n.next,a===r))return o}n=n.next}while(n!==e);if(!o)return null;var l=o,c=o.x,u=o.y,f=1/0,h;n=o;do r>=n.x&&n.x>=c&&r!==n.x&&ls(i<u?r:s,i,c,u,i<u?s:r,i,n.x,n.y)&&(h=Math.abs(i-n.y)/(r-n.x),Ia(n,t)&&(h<f||h===f&&(n.x>o.x||n.x===o.x&&S$(o,n)))&&(o=n,f=h)),n=n.next;while(n!==l);return o}function S$(t,e){return Ee(t.prev,t,e.prev)<0&&Ee(e.next,t,t.next)<0}function E$(t,e,n,r){var i=t;do i.z===0&&(i.z=Mg(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,b$(i)}function b$(t){var e,n,r,i,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,r=n,a=0,e=0;e<c&&(a++,r=r.nextZ,!!r);e++);for(l=c;a>0||l>0&&r;)a!==0&&(l===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,c*=2}while(o>1);return t}function Mg(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function A$(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function ls(t,e,n,r,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(r-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function R$(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!x$(t,e)&&(Ia(t,e)&&Ia(e,t)&&C$(t,e)&&(Ee(t.prev,t,e.prev)||Ee(t,e.prev,e))||Gf(t,e)&&Ee(t.prev,t,t.next)>0&&Ee(e.prev,e,e.next)>0)}function Ee(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Gf(t,e){return t.x===e.x&&t.y===e.y}function sR(t,e,n,r){var i=Zl(Ee(t,e,n)),s=Zl(Ee(t,e,r)),o=Zl(Ee(n,r,t)),a=Zl(Ee(n,r,e));return!!(i!==s&&o!==a||i===0&&ql(t,n,e)||s===0&&ql(t,r,e)||o===0&&ql(n,t,r)||a===0&&ql(n,e,r))}function ql(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Zl(t){return t>0?1:t<0?-1:0}function x$(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&sR(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Ia(t,e){return Ee(t.prev,t,t.next)<0?Ee(t,e,t.next)>=0&&Ee(t,t.prev,e)>=0:Ee(t,e,t.prev)<0||Ee(t,t.next,e)<0}function C$(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function oR(t,e){var n=new Ng(t.i,t.x,t.y),r=new Ng(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function tw(t,e,n,r){var i=new Ng(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Ma(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ng(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Jf.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,o=Math.abs(kg(t,0,s,n));if(i)for(var a=0,l=e.length;a<l;a++){var c=e[a]*n,u=a<l-1?e[a+1]*n:t.length;o-=Math.abs(kg(t,c,u,n))}var f=0;for(a=0;a<r.length;a+=3){var h=r[a]*n,d=r[a+1]*n,g=r[a+2]*n;f+=Math.abs((t[h]-t[g])*(t[d+1]-t[h+1])-(t[h]-t[d])*(t[g+1]-t[h+1]))}return o===0&&f===0?0:Math.abs((f-o)/o)};function kg(t,e,n,r){for(var i=0,s=e,o=n-r;s<n;s+=r)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}Jf.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[i][s][o]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var P$=Om.exports;const I$=lf(P$),Ql=ZA.CLOCKWISE,nw=ZA.COUNTER_CLOCKWISE,mr={isClosed:!0};function M$(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function ko(t){return"positions"in t?t.positions:t}function Ac(t){return"holeIndices"in t?t.holeIndices:null}function N$(t){return Array.isArray(t[0])}function k$(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function O$(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function F$(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function rw(t,e,n,r,i){let s=e;const o=n.length;for(let a=0;a<o;a++)for(let l=0;l<r;l++)t[s++]=n[a][l]||0;if(!O$(n))for(let a=0;a<r;a++)t[s++]=n[0][a]||0;return mr.start=e,mr.end=s,mr.size=r,QA(t,i,mr),s}function iw(t,e,n,r,i=0,s,o){s=s||n.length;const a=s-i;if(a<=0)return e;let l=e;for(let c=0;c<a;c++)t[l++]=n[i+c];if(!F$(n,r,i,s))for(let c=0;c<r;c++)t[l++]=n[i+c];return mr.start=e,mr.end=l,mr.size=r,QA(t,o,mr),l}function D$(t,e){M$(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:s}=t;if(s){let o=0;for(let a=0;a<=s.length;a++)o=iw(n,o,i,e,s[a-1],s[a],a===0?Ql:nw),r.push(o);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!N$(t))return iw(n,0,t,e,0,n.length,Ql),n;if(!k$(t)){let i=0;for(const[s,o]of t.entries())i=rw(n,i,o,e,s===0?Ql:nw),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return rw(n,0,t,e,Ql),n}function Pd(t,e,n){const r=t.length/3;let i=0;for(let s=0;s<r;s++){const o=(s+1)%r;i+=t[s*3+e]*t[o*3+n],i-=t[o*3+e]*t[s*3+n]}return Math.abs(i/2)}function sw(t,e,n,r){const i=t.length/3;for(let s=0;s<i;s++){const o=s*3,a=t[o+0],l=t[o+1],c=t[o+2];t[o+e]=a,t[o+n]=l,t[o+r]=c}}function B$(t,e,n,r){let i=Ac(t);i&&(i=i.map(a=>a/e));let s=ko(t);const o=r&&e===3;if(n){const a=s.length;s=s.slice();const l=[];for(let c=0;c<a;c+=e){l[0]=s[c],l[1]=s[c+1],o&&(l[2]=s[c+2]);const u=n(l);s[c]=u[0],s[c+1]=u[1],o&&(s[c+2]=u[2])}}if(o){const a=Pd(s,0,1),l=Pd(s,0,2),c=Pd(s,1,2);if(!a&&!l&&!c)return[];a>l&&a>c||(l>c?(n||(s=s.slice()),sw(s,0,2,1)):(n||(s=s.slice()),sw(s,2,0,1)))}return I$(s,i,e)}class L$ extends KA{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=D$(e,this.positionSize);return this.opts.resolution?GA(ko(n),Ac(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?i$(ko(n),Ac(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(ow(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return ko(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&ow(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else{const r=e;this._updateIndices(r,n),this._updatePositions(r,n),this._updateVertexValid(r,n)}}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:s,indexStarts:o,typedArrayManager:a}=this;let l=s.indices;if(!l||!e)return;let c=i;const u=B$(e,this.positionSize,this.opts.preproject,this.opts.full3d);l=a.allocate(l,i+u.length,{copy:!0});for(let f=0;f<u.length;f++)l[c++]=u[f]+r;o[n+1]=i+u.length,s.indices=l}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const o=ko(e);for(let a=n,l=0;l<r;a++,l++){const c=o[l*s],u=o[l*s+1],f=s>2?o[l*s+2]:0;i[a*3]=c,i[a*3+1]=u,i[a*3+2]=f}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,s=this.attributes.vertexValid,o=e&&Ac(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),o)for(let a=0;a<o.length;a++)s[n+o[a]/i-1]=0;s[n+r-1]=0}}function ow(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const aR=`uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;
in vec4 fillColors;
in vec4 lineColors;
in vec3 pickingColors;
out vec4 vColor;
struct PolygonProps {
vec3 positions;
vec3 positions64Low;
vec3 normal;
float elevations;
};
vec3 project_offset_normal(vec3 vector) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
return normalize(vector * project_uCommonUnitsPerWorldUnit);
}
return project_normal(vector);
}
void calculatePosition(PolygonProps props) {
vec3 pos = props.positions;
vec3 pos64Low = props.positions64Low;
vec3 normal = props.normal;
vec4 colors = isWireframe ? lineColors : fillColors;
geometry.worldPosition = props.positions;
geometry.pickingColor = pickingColors;
if (extruded) {
pos.z += props.elevations * elevationScale;
}
gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (extruded) {
#ifdef IS_SIDE_VERTEX
normal = project_offset_normal(normal);
#else
normal = project_normal(normal);
#endif
geometry.normal = normal;
vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, colors.a * opacity);
} else {
vColor = vec4(colors.rgb, colors.a * opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,U$=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader
in vec3 vertexPositions;
in vec3 vertexPositions64Low;
in float elevations;
${aR}
void main(void) {
PolygonProps props;
props.positions = vertexPositions;
props.positions64Low = vertexPositions64Low;
props.elevations = elevations;
props.normal = vec3(0.0, 0.0, 1.0);
calculatePosition(props);
}
`,z$=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX
in vec2 positions;
in vec3 vertexPositions;
in vec3 nextVertexPositions;
in vec3 vertexPositions64Low;
in vec3 nextVertexPositions64Low;
in float elevations;
in float instanceVertexValid;
${aR}
void main(void) {
if(instanceVertexValid < 0.5){
gl_Position = vec4(0.);
return;
}
PolygonProps props;
vec3 pos;
vec3 pos64Low;
vec3 nextPos;
vec3 nextPos64Low;
#if RING_WINDING_ORDER_CW == 1
pos = vertexPositions;
pos64Low = vertexPositions64Low;
nextPos = nextVertexPositions;
nextPos64Low = nextVertexPositions64Low;
#else
pos = nextVertexPositions;
pos64Low = nextVertexPositions64Low;
nextPos = vertexPositions;
nextPos64Low = vertexPositions64Low;
#endif
props.positions = mix(pos, nextPos, positions.x);
props.positions64Low = mix(pos64Low, nextPos64Low, positions.x);
props.normal = vec3(
pos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),
nextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),
0.0);
props.elevations = elevations * positions.y;
calculatePosition(props);
}
`,$$=`#version 300 es
#define SHADER_NAME solid-polygon-layer-fragment-shader
precision highp float;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Mu=[0,0,0,255],V$={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Mu},getLineColor:{type:"accessor",value:Mu},material:!0},Jl={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t},nf=class nf extends Nr{getShaders(e){return super.getShaders({vs:e==="top"?U$:z$,fs:$$,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Qa,bB,Ja]})}get wrapLongitude(){return!1}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["vertexPositions"])}initializeState(){const{viewport:e}=this.context;let{coordinateSystem:n}=this.props;const{_full3d:r}=this.props;e.isGeospatial&&n===ie.DEFAULT&&(n=ie.LNGLAT);let i;n===ie.LNGLAT&&(r?i=e.projectPosition.bind(e):i=e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new L$({preproject:i,fp64:this.use64bitPositions(),IndexType:Uint32Array})});const s=this.getAttributeManager(),o=!0;s.remove(["instancePickingColors"]),s.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:o},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:Jl,accessor:"getPolygon",update:this.calculatePositions,noAlloc:o,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:o},elevations:{size:1,stepMode:"dynamic",transition:Jl,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:Jl,accessor:"getFillColor",defaultValue:Mu},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:Jl,accessor:"getLineColor",defaultValue:Mu},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(a,{index:l,target:c})=>this.encodePickingColor(a&&a.__source?a.__source.index:l,c)}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,i=this.props.data;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const n=this.props.data;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:o,sideModel:a,wireframeModel:l,polygonTesselator:c}=this.state,u={...e,extruded:!!n,elevationScale:s};l&&i&&(l.setInstanceCount(c.instanceCount-1),l.setUniforms(u),l.draw(this.context.renderPass)),a&&r&&(a.setInstanceCount(c.instanceCount-1),a.setUniforms(u),a.draw(this.context.renderPass)),o&&r&&(o.setVertexCount(c.vertexCount),o.setUniforms(u),o.draw(this.context.renderPass))}updateState(e){var a;super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager();(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded)&&((a=this.state.models)==null||a.forEach(l=>l.destroy()),this.setState(this._getModels()),s.invalidateAll())}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,o=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:o.getPolygon,buffers:o,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){const{id:e,filled:n,extruded:r}=this.props;let i,s,o;if(n){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1;const l=this.getAttributeManager().getBufferLayouts({isInstanced:!1});i=new nn(this.context.device,{...a,id:`${e}-top`,topology:"triangle-list",uniforms:{isWireframe:!1},bufferLayout:l,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}if(r){const a=this.getAttributeManager().getBufferLayouts({isInstanced:!0});s=new nn(this.context.device,{...this.getShaders("side"),id:`${e}-side`,bufferLayout:a,uniforms:{isWireframe:!1},geometry:new Ws({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),o=new nn(this.context.device,{...this.getShaders("side"),id:`${e}-wireframe`,bufferLayout:a,uniforms:{isWireframe:!0},geometry:new Ws({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})}return{models:[s,o,i].filter(Boolean),topModel:i,sideModel:s,wireframeModel:o}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}};nf.defaultProps=V$,nf.layerName="SolidPolygonLayer";let Og=nf;function j$({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:s=1/0}=n,o=t.length;let a=o,l=o;for(let h=0;h<o;h++){const d=e(t[h]);if(a>h&&d>=i&&(a=h),d>=s){l=h;break}}let c=a;const f=l-a!==r.length?t.slice(l):void 0;for(let h=0;h<r.length;h++)t[c++]=r[h];if(f){for(let h=0;h<f.length;h++)t[c++]=f[h];t.length=c}return{startRow:a,endRow:a+r.length}}function W$(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?H$(t,r,n):null}function H$(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function X$(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const s=[];for(let o=0;o<i.length;o++)e(i[o],s),n[r][o*3+0]=s[0],n[r][o*3+1]=s[1],n[r][o*3+2]=s[2]}return n}const Y$=`#version 300 es
#define SHADER_NAME multi-icon-layer-fragment-shader
precision highp float;
uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
if (!bool(picking.isActive)) {
float alpha = texture(iconsTexture, vTextureCoords).a;
vec4 color = vColor;
if (sdf) {
float distance = alpha;
alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);
if (outlineBuffer > 0.0) {
float inFill = alpha;
float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
color = mix(outlineColor, vColor, inFill);
alpha = inBorder;
}
}
float a = alpha * color.a;
if (a < alphaCutoff) {
discard;
}
fragColor = vec4(color.rgb, a * opacity);
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Id=192/256,aw=[],K$={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}},rf=class rf extends Iu{getShaders(){return{...super.getShaders(),fs:Y$}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&G.warn(`${this.id}: fontSettings.sdf is required to render outline`)()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state,o=i?Math.max(r,Id*(1-i)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:Id,outlineBuffer:o,gamma:r,sdf:!!n,outlineColor:s},super.draw(e),n&&i){const{iconManager:a}=this.state,l=a.getTexture(),c=this.state.model;l&&(c.setUniforms({outlineBuffer:Id}),c.draw(this.context.renderPass))}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):aw}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):aw}};rf.defaultProps=K$,rf.layerName="MultiIconLayer";let Fg=rf;const qo=1e20;class q${constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:s="sans-serif",fontWeight:o="normal",fontStyle:a="normal"}={}){this.buffer=n,this.cutoff=i,this.radius=r;const l=this.size=e+n*4,c=this._createCanvas(l),u=this.ctx=c.getContext("2d",{willReadFrequently:!0});u.font=`${a} ${o} ${e}px ${s}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Uint16Array(l)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:s,actualBoundingBoxRight:o}=this.ctx.measureText(e),a=Math.ceil(r),l=0,c=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-s))),u=Math.min(this.size-this.buffer,a+Math.ceil(i)),f=c+2*this.buffer,h=u+2*this.buffer,d=Math.max(f*h,0),g=new Uint8ClampedArray(d),_={data:g,width:f,height:h,glyphWidth:c,glyphHeight:u,glyphTop:a,glyphLeft:l,glyphAdvance:n};if(c===0||u===0)return _;const{ctx:b,buffer:m,gridInner:p,gridOuter:y}=this;b.clearRect(m,m,c,u),b.fillText(e,m,m+a);const w=b.getImageData(m,m,c,u);y.fill(qo,0,d),p.fill(0,0,d);for(let A=0;A<u;A++)for(let x=0;x<c;x++){const I=w.data[4*(A*c+x)+3]/255;if(I===0)continue;const O=(A+m)*f+x+m;if(I===1)y[O]=0,p[O]=qo;else{const D=.5-I;y[O]=D>0?D*D:0,p[O]=D<0?D*D:0}}lw(y,0,0,f,h,f,this.f,this.v,this.z),lw(p,m,m,c,u,f,this.f,this.v,this.z);for(let A=0;A<d;A++){const x=Math.sqrt(y[A])-Math.sqrt(p[A]);g[A]=Math.round(255-255*(x/this.radius+this.cutoff))}return _}}function lw(t,e,n,r,i,s,o,a,l){for(let c=e;c<e+r;c++)cw(t,n*s+c,s,i,o,a,l);for(let c=n;c<n+i;c++)cw(t,c*s+e,1,r,o,a,l)}function cw(t,e,n,r,i,s,o){s[0]=0,o[0]=-qo,o[1]=qo,i[0]=t[e];for(let a=1,l=0,c=0;a<r;a++){i[a]=t[e+a*n];const u=a*a;do{const f=s[l];c=(i[a]-i[f]+u-f*f)/(a-f)/2}while(c<=o[l]&&--l>-1);l++,s[l]=a,o[l]=c,o[l+1]=qo}for(let a=0,l=0;a<r;a++){for(;o[l+1]<a;)l++;const c=s[l],u=a-c;t[e+a*n]=i[c]+u*u}}const Z$=32,Q$=[];function J$(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function G$({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:o=0,yOffset:a=0}){let l=0,c=o;const u=n+r*2;for(const f of t)if(!s[f]){const h=e(f);c+h+r*2>i&&(c=0,l++),s[f]={x:c+r,y:a+l*u+r,width:h,height:u,layoutWidth:h,layoutHeight:n},c+=h+r*2}return{mapping:s,xOffset:c,yOffset:a+l*u,canvasHeight:J$(a+(l+1)*u)}}function lR(t,e,n,r){var s;let i=0;for(let o=e;o<n;o++){const a=t[o];i+=((s=r[a])==null?void 0:s.layoutWidth)||0}return i}function cR(t,e,n,r,i,s){let o=e,a=0;for(let l=e;l<n;l++){const c=lR(t,l,l+1,i);a+c>r&&(o<l&&s.push(l),o=l,a=0),a+=c}return a}function eV(t,e,n,r,i,s){let o=e,a=e,l=e,c=0;for(let u=e;u<n;u++)if((t[u]===" "||t[u+1]===" "||u+1===n)&&(l=u+1),l>a){let f=lR(t,a,l,i);c+f>r&&(o<a&&(s.push(a),o=a,c=0),f>r&&(f=cR(t,a,l,r,i,s),o=s[s.length-1])),a=l,c+=f}return c}function tV(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const o=[];return e==="break-all"?cR(t,i,s,n,r,o):eV(t,i,s,n,r,o),o}function nV(t,e,n,r,i,s){let o=0,a=0;for(let l=e;l<n;l++){const c=t[l],u=r[c];u?(a||(a=u.layoutHeight),i[l]=o+u.layoutWidth/2,o+=u.layoutWidth):(G.warn(`Missing character: ${c} (${c.codePointAt(0)})`)(),i[l]=o,o+=Z$)}s[0]=o,s[1]=a}function rV(t,e,n,r,i){var b;const s=Array.from(t),o=s.length,a=new Array(o),l=new Array(o),c=new Array(o),u=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,f=[0,0],h=[0,0];let d=0,g=0,_=0;for(let m=0;m<=o;m++){const p=s[m];if((p===`
`||m===o)&&(_=m),_>g){const y=u?tV(s,n,r,i,g,_):Q$;for(let w=0;w<=y.length;w++){const A=w===0?g:y[w-1],x=w<y.length?y[w]:_;nV(s,A,x,i,a,h);for(let I=A;I<x;I++){const O=s[I],D=((b=i[O])==null?void 0:b.layoutOffsetY)||0;l[I]=d+h[1]/2+D,c[I]=h[0]}d=d+h[1]*e,f[0]=Math.max(f[0],h[0])}g=_}p===`
`&&(a[g]=0,l[g]=0,c[g]=0,g++)}return f[1]=d,{x:a,y:l,rowWidth:c,size:f}}function iV({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const o=t.BYTES_PER_ELEMENT,a=n?n/o:1,l=r?r/o:0,c=i[e]||Math.ceil((t.length-l)/a),u=s&&new Set,f=new Array(e);let h=t;if(a>1||l>0){const d=t.constructor;h=new d(c);for(let g=0;g<c;g++)h[g]=t[g*a+l]}for(let d=0;d<e;d++){const g=i[d],_=i[d+1]||c,b=h.subarray(g,_);f[d]=String.fromCodePoint.apply(null,b),u&&b.forEach(u.add,u)}if(u)for(const d of u)s.add(String.fromCodePoint(d));return{texts:f,characterCount:c}}class uR{constructor(e=5){this._cache={},this._order=[],this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function sV(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const ws={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:sV(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},uw=1024,fw=.9,hw=1.2,fR=3;let Nu=new uR(fR);function oV(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=Nu.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function aV(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function dw(t,e,n,r){t.font=`${r} ${n}px ${e}`,t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function lV(t){G.assert(Number.isFinite(t)&&t>=fR,"Invalid cache limit"),Nu=new uR(t)}class cV{constructor(){this.props={...ws}}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*hw+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=oV(this._key,this.props.characterSet),r=Nu.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}const i=this._generateFontAtlas(n,r);this._atlas=i,Nu.set(this._key,i)}_generateFontAtlas(e,n){const{fontFamily:r,fontWeight:i,fontSize:s,buffer:o,sdf:a,radius:l,cutoff:c}=this.props;let u=n&&n.data;u||(u=document.createElement("canvas"),u.width=uw);const f=u.getContext("2d",{willReadFrequently:!0});dw(f,r,s,i);const{mapping:h,canvasHeight:d,xOffset:g,yOffset:_}=G$({getFontWidth:b=>f.measureText(b).width,fontHeight:s*hw,buffer:o,characterSet:e,maxCanvasWidth:uw,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(u.height!==d){const b=f.getImageData(0,0,u.width,u.height);u.height=d,f.putImageData(b,0,0)}if(dw(f,r,s,i),a){const b=new q$({fontSize:s,buffer:o,radius:l,cutoff:c,fontFamily:r,fontWeight:`${i}`});for(const m of e){const{data:p,width:y,height:w,glyphTop:A}=b.draw(m);h[m].width=y,h[m].layoutOffsetY=s*fw-A;const x=f.createImageData(y,w);aV(p,x),f.putImageData(x,h[m].x,h[m].y)}}else for(const b of e)f.fillText(b,h[b].x,h[b].y+o+s*fw);return{xOffset:g,yOffset:_,mapping:h,data:u,width:u.width,height:u.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:o,cutoff:a}=this.props;return s?`${e} ${n} ${r} ${i} ${o} ${a}`:`${e} ${n} ${r} ${i}`}}const uV=`#version 300 es
#define SHADER_NAME text-background-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceRects;
in float instanceSizes;
in float instanceAngles;
in vec2 instancePixelOffsets;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;
out vec4 vFillColor;
out vec4 vLineColor;
out float vLineWidth;
out vec2 uv;
out vec2 dimensions;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = radians(angle);
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vLineWidth = instanceLineWidths;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
sizeMinPixels, sizeMaxPixels
);
dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;
vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
pixelOffset += instancePixelOffsets;
pixelOffset.y *= -1.0;
if (billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,fV=`#version 300 es
#define SHADER_NAME text-background-layer-fragment-shader
precision highp float;
uniform bool stroked;
in vec4 vFillColor;
in vec4 vLineColor;
in float vLineWidth;
in vec2 uv;
in vec2 dimensions;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec2 pixelPosition = uv * dimensions;
if (stroked) {
float distToEdge = min(
min(pixelPosition.x, dimensions.x - pixelPosition.x),
min(pixelPosition.y, dimensions.y - pixelPosition.y)
);
float isBorder = smoothedge(distToEdge, vLineWidth);
fragColor = mix(vFillColor, vLineColor, isBorder);
} else {
fragColor = vFillColor;
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,hV={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}},sf=class sf extends Nr{getShaders(){return super.getShaders({vs:uV,fs:fV,modules:[Qa,Ja]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){var r;super.updateState(e);const{changeFlags:n}=e;n.extensionsChanged&&((r=this.state.model)==null||r.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]);const c=this.state.model;c.setUniforms(e),c.setUniforms({billboard:n,stroked:!!a,padding:l,sizeUnits:gi[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:o}),c.draw(this.context.renderPass)}_getModel(){const e=[0,0,1,0,1,1,0,1];return new nn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Ws({topology:"triangle-fan-webgl",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}};sf.defaultProps=hV,sf.layerName="TextBackgroundLayer";let Dg=sf;const pw={start:1,middle:0,end:-1},gw={top:1,center:0,bottom:-1},Md=[0,0,0,255],dV=1,pV={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Md},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:ws.characterSet},fontFamily:ws.fontFamily,fontWeight:ws.fontWeight,lineHeight:dV,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Md},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Md},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}},of=class of extends Pu{constructor(){super(...arguments),this.getBoundingRect=(e,n)=>{let{size:[r,i]}=this.transformParagraph(e,n);const{fontSize:s}=this.state.fontAtlasManager.props;r/=s,i/=s;const{getTextAnchor:o,getAlignmentBaseline:a}=this.props,l=pw[typeof o=="function"?o(e,n):o],c=gw[typeof a=="function"?a(e,n):a];return[(l-1)*r/2,(c-1)*i/2,r,i]},this.getIconOffsets=(e,n)=>{const{getTextAnchor:r,getAlignmentBaseline:i}=this.props,{x:s,y:o,rowWidth:a,size:[l,c]}=this.transformParagraph(e,n),u=pw[typeof r=="function"?r(e,n):r],f=gw[typeof i=="function"?i(e,n):i],h=s.length,d=new Array(h*2);let g=0;for(let _=0;_<h;_++){const b=(1-u)*(l-a[_])/2;d[g++]=(u-1)*l/2+b+s[_],d[g++]=(f-1)*c/2+o[_]}return d}}initializeState(){this.state={styleVersion:0,fontAtlasManager:new cV},this.props.maxWidth>0&&G.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,o={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(o),!0;for(const a in o)if(o[a]!==i.props[a])return i.setProps(o),!0;return!1}_updateText(){var l;const{data:e,characterSet:n}=this.props,r=(l=e.attributes)==null?void 0:l.getText;let{getText:i}=this.props,s=e.startIndices,o;const a=n==="auto"&&new Set;if(r&&s){const{texts:c,characterCount:u}=iV({...ArrayBuffer.isView(r)?{value:r}:r,length:e.length,startIndices:s,characterSet:a});o=u,i=(f,{index:h})=>c[h]}else{const{iterable:c,objectInfo:u}=Qf(e);s=[0],o=0;for(const f of c){u.index++;const h=Array.from(i(f,u)||"");a&&h.forEach(a.add,a),o+=h.length,s.push(o)}}this.setState({getText:i,startIndices:s,numInstances:o,characterSet:a||n})}transformParagraph(e,n){const{fontAtlasManager:r}=this.state,i=r.mapping,s=this.state.getText,{wordBreak:o,lineHeight:a,maxWidth:l}=this.props,c=s(e,n)||"";return rV(c,a,o,l*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,atlas:s,mapping:o},styleVersion:a}=this.state,{data:l,_dataDiff:c,getPosition:u,getColor:f,getSize:h,getAngle:d,getPixelOffset:g,getBackgroundColor:_,getBorderColor:b,getBorderWidth:m,backgroundPadding:p,background:y,billboard:w,fontSettings:A,outlineWidth:x,outlineColor:I,sizeScale:O,sizeUnits:D,sizeMinPixels:z,sizeMaxPixels:H,transitions:Y,updateTriggers:K}=this.props,Z=this.getSubLayerClass("characters",Fg),Le=this.getSubLayerClass("background",Dg);return[y&&new Le({getFillColor:_,getLineColor:b,getLineWidth:m,padding:p,getPosition:u,getSize:h,getAngle:d,getPixelOffset:g,billboard:w,sizeScale:O,sizeUnits:D,sizeMinPixels:z,sizeMaxPixels:H,transitions:Y&&{getPosition:Y.getPosition,getAngle:Y.getAngle,getSize:Y.getSize,getFillColor:Y.getBackgroundColor,getLineColor:Y.getBorderColor,getLineWidth:Y.getBorderWidth,getPixelOffset:Y.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:K.getPosition,getAngle:K.getAngle,getSize:K.getSize,getFillColor:K.getBackgroundColor,getLineColor:K.getBorderColor,getLineWidth:K.getBorderWidth,getPixelOffset:K.getPixelOffset,getBoundingRect:{getText:K.getText,getTextAnchor:K.getTextAnchor,getAlignmentBaseline:K.getAlignmentBaseline,styleVersion:a}}}),{data:l.attributes&&l.attributes.background?{length:l.length,attributes:l.attributes.background}:l,_dataDiff:c,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new Z({sdf:A.sdf,smoothing:Number.isFinite(A.smoothing)?A.smoothing:ws.smoothing,outlineWidth:x/(A.radius||ws.radius),outlineColor:I,iconAtlas:s,iconMapping:o,getPosition:u,getColor:f,getSize:h,getAngle:d,getPixelOffset:g,billboard:w,sizeScale:O*i,sizeUnits:D,sizeMinPixels:z*i,sizeMaxPixels:H*i,transitions:Y&&{getPosition:Y.getPosition,getAngle:Y.getAngle,getColor:Y.getColor,getSize:Y.getSize,getPixelOffset:Y.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:K.getText,getPosition:K.getPosition,getAngle:K.getAngle,getColor:K.getColor,getSize:K.getSize,getPixelOffset:K.getPixelOffset,getIconOffsets:{getTextAnchor:K.getTextAnchor,getAlignmentBaseline:K.getAlignmentBaseline,styleVersion:a}}}),{data:l,_dataDiff:c,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){lV(e)}};of.defaultProps=pV,of.layerName="TextLayer";let Bg=of;const Rc={circle:{type:xg,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:Iu,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:Bg,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},xc={type:Ig,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},Lg={type:Og,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Eo({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function Nd(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const o=e[s];let a=t.props[s];s.startsWith("get")&&(a=t.getSubLayerAccessor(a),i.updateTriggers[o]=r[s],n&&(i.transitions[o]=n[s])),i[o]=a}return i}function gV(t){if(Array.isArray(t))return t;switch(G.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return G.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function _w(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=t.length}=n;for(let o=i;o<s;o++){const a=t[o],{geometry:l}=a;if(l)if(l.type==="GeometryCollection"){G.assert(Array.isArray(l.geometries),"GeoJSON does not have geometries array");const{geometries:c}=l;for(let u=0;u<c.length;u++){const f=c[u];mw(f,r,e,a,o)}}else mw(l,r,e,a,o)}return r}function mw(t,e,n,r,i){const{type:s,coordinates:o}=t,{pointFeatures:a,lineFeatures:l,polygonFeatures:c,polygonOutlineFeatures:u}=e;if(!mV(s,o)){G.warn(`${s} coordinates are malformed`)();return}switch(s){case"Point":a.push(n({geometry:t},r,i));break;case"MultiPoint":o.forEach(f=>{a.push(n({geometry:{type:"Point",coordinates:f}},r,i))});break;case"LineString":l.push(n({geometry:t},r,i));break;case"MultiLineString":o.forEach(f=>{l.push(n({geometry:{type:"LineString",coordinates:f}},r,i))});break;case"Polygon":c.push(n({geometry:t},r,i)),o.forEach(f=>{u.push(n({geometry:{type:"LineString",coordinates:f}},r,i))});break;case"MultiPolygon":o.forEach(f=>{c.push(n({geometry:{type:"Polygon",coordinates:f}},r,i)),f.forEach(h=>{u.push(n({geometry:{type:"LineString",coordinates:h}},r,i))})});break}}const _V={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function mV(t,e){let n=_V[t];for(G.assert(n,`Unknown GeoJSON type ${t}`);e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function hR(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function Gl(t){return t.geometry.coordinates}function yV(t,e){const n=hR(),{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:o}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=Gl,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=Gl,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=Gl,n.polygonsOutline.data=o,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=Gl,n}function vV(t,e){const n=hR(),{points:r,lines:i,polygons:s}=t,o=X$(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:o.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:o.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const TV=["points","linestrings","polygons"],wV={...Eo(Rc.circle),...Eo(Rc.icon),...Eo(Rc.text),...Eo(xc),...Eo(Lg),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}},af=class af extends Pu{initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=vV(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=gV(e.data),i=this.getSubLayerRow.bind(this);let s={};const o={};if(Array.isArray(n.dataChanged)){const l=this.state.features;for(const c in l)s[c]=l[c].slice(),o[c]=[];for(const c of n.dataChanged){const u=_w(r,i,c);for(const f in l)o[f].push(j$({data:s[f],getIndex:h=>h.__source.index,dataRange:c,replace:u[f]}))}}else s=_w(r,i);const a=yV(s,o);this.setState({features:s,featuresDiff:o,layerProps:a})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=TV.find(s=>i.id.startsWith(`${this.id}-${s}-`)),r>=0&&i.id.startsWith(`${this.id}-points-text`)&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n=`${this.id}-points-`,r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){var o;const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,(o=r.polygons)==null?void 0:o.data)&&this.getSubLayerClass(i,Lg.type);if(s){const a=Nd(this,Lg.props),l=e&&n;return l||delete a.getLineColor,a.updateTriggers.lineColors=l,new s(a,this.getSubLayerProps({id:i,updateTriggers:a.updateTriggers}),r.polygons)}return null}_renderLineLayers(){var l,c;const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",s="linestrings",o=!e&&n&&this.shouldRenderSubLayer(i,(l=r.polygonsOutline)==null?void 0:l.data)&&this.getSubLayerClass(i,xc.type),a=this.shouldRenderSubLayer(s,(c=r.lines)==null?void 0:c.data)&&this.getSubLayerClass(s,xc.type);if(o||a){const u=Nd(this,xc.props);return[o&&new o(u,this.getSubLayerProps({id:i,updateTriggers:u.updateTriggers}),r.polygonsOutline),a&&new a(u,this.getSubLayerProps({id:s,updateTriggers:u.updateTriggers}),r.lines)]}return null}_renderPointLayers(){var a;const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(l=>l.__source.index===i));const s=new Set(e.split("+")),o=[];for(const l of s){const c=`points-${l}`,u=Rc[l],f=u&&this.shouldRenderSubLayer(c,(a=n.points)==null?void 0:a.data)&&this.getSubLayerClass(c,u.type);if(f){const h=Nd(this,u.props);let d=n.points;if(l==="text"&&r){const{instancePickingColors:g,..._}=d.data.attributes;d={...d,data:{...d.data,attributes:_}}}o.push(new f(h,this.getSubLayerProps({id:c,updateTriggers:h.updateTriggers,highlightedObjectIndex:i}),d))}}return o}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:s,index:o}=i,a=W$(s,o);return e(a,i)}}};af.layerName="GeoJsonLayer",af.defaultProps=wV;let ku=af;const kd=512,SV=Math.PI/180;function dR({map:t,gl:e,deck:n}){if(t.__deck)return t.__deck;const r=n==null?void 0:n.props._customRender,i=n==null?void 0:n.props.onLoad,s=gR({...n==null?void 0:n.props,_customRender:()=>{t.triggerRepaint(),r==null||r("")}});let o;return(!n||n.props.gl===e)&&(Object.assign(s,{gl:e,width:null,height:null,touchAction:"unset",viewState:Na(t)}),n!=null&&n.isInitialized?yw(n,t):s.onLoad=()=>{i==null||i(),yw(o,t)}),n?(o=n,n.setProps(s),n.userData.isExternal=!0):(o=new Ra(s),t.on("remove",()=>{pR(t)})),o.userData.mapboxLayers=new Set,t.__deck=o,t.on("render",()=>{o.isInitialized&&CV(o,t)}),o}function yw(t,e){const n=()=>{t.isInitialized?PV(t,e):e.off("move",n)};e.on("move",n)}function pR(t){var e;(e=t.__deck)==null||e.finalize(),t.__deck=null}function gR(t){return{...t,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...t.parameters},views:t.views||[new Ru({id:"mapbox"})]}}function EV(t,e){t.userData.mapboxLayers.add(e),Fm(t)}function bV(t,e){t.userData.mapboxLayers.delete(e),Fm(t)}function AV(t,e){Fm(t)}function RV(t,e,n){let{currentViewport:r}=t.userData,i=!1;r||(r=_R(t,e,!0),t.userData.currentViewport=r,i=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[r],layerFilter:({layer:s})=>n.id===s.id||s.props.operation.includes("terrain"),clearStack:i,clearCanvas:!1})}function Na(t){var i;const{lng:e,lat:n}=t.getCenter(),r={longitude:(e+540)%360-180,latitude:n,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return(i=t.getTerrain)!=null&&i.call(t)&&xV(t,r),r}function xV(t,e){if(t.getFreeCameraOptions){const{position:n}=t.getFreeCameraOptions();if(!n||n.z===void 0)return;const r=t.transform.height,{longitude:i,latitude:s,pitch:o}=e,a=n.x*kd,l=(1-n.y)*kd,c=n.z*kd,u=Sa([i,s]),f=a-u[0],h=l-u[1],d=Math.sqrt(f*f+h*h),g=o*SV,_=1.5*r,b=g<.001?_*Math.cos(g)/c:_*Math.sin(g)/d;e.zoom=Math.log2(b);const m=_*Math.cos(g)/b,p=c-m;e.position=[0,0,p/Sc(s)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function _R(t,e,n=!0){return new Ea({id:"mapbox",x:0,y:0,width:t.width,height:t.height,...Na(e),nearZMultiplier:n?.02:.1,nearZ:e.transform._nearZ/e.transform.height,farZ:e.transform._farZ/e.transform.height})}function CV(t,e){const{mapboxLayers:n,isExternal:r}=t.userData;if(r){const i=Array.from(n,u=>u.id),o=Hs(t.props.layers,Boolean).some(u=>u&&!i.includes(u.id));let a=t.getViewports();const l=a.findIndex(u=>u.id==="mapbox"),c=a.length>1||l<0;(o||c)&&(l>=0&&(a=a.slice(),a[l]=_R(t,e,!1)),t._drawLayers("mapbox-repaint",{viewports:a,layerFilter:u=>(!t.props.layerFilter||t.props.layerFilter(u))&&(u.viewport.id!=="mapbox"||!i.includes(u.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function PV(t,e){t.setProps({viewState:Na(e)}),t.needsRedraw({clearRedrawFlags:!0})}function Fm(t){if(t.userData.isExternal)return;const e=[];t.userData.mapboxLayers.forEach(n=>{const r=n.props.type,i=new r(n.props);e.push(i)}),t.setProps({layers:e})}class IV{constructor(e){if(!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.map=null,this.deck=null,this.props=e}onAdd(e,n){this.map=e,this.deck=dR({map:e,gl:n,deck:this.props.deck}),EV(this.deck,this)}onRemove(){this.deck&&bV(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&AV(this.deck)}render(){RV(this.deck,this.map,this)}}const Od="__UNDEFINED__";function ec(t,e,n,r){if(!t||!e||!t.style||!t.style._loaded)return;const i=Hs(r,Boolean);if(n!==r){const a=Hs(n,Boolean),l=new Set(a.map(c=>c.id));for(const c of i)l.delete(c.id);for(const c of l)t.getLayer(c)&&t.removeLayer(c)}for(const a of i){const l=t.getLayer(a.id);l?(l.implementation||l).setProps(a.props):t.addLayer(new IV({id:a.id,deck:e}),a.props.beforeId)}const s=t.style._order,o={};for(const a of i){let{beforeId:l}=a.props;(!l||!s.includes(l))&&(l=Od),o[l]=o[l]||[],o[l].push(a.id)}for(const a in o){const l=o[a];let c=a===Od?s.length:s.indexOf(a),u=a===Od?void 0:a;for(let f=l.length-1;f>=0;f--){const h=l[f],d=s.indexOf(h);d!==c-1&&(t.moveLayer(h,u),d>c&&c++),c--,u=h}}}class MV{constructor(e){this._handleStyleChange=()=>{ec(this._map,this._deck,this._props.layers,this._props.layers)},this._updateContainerSize=()=>{if(this._map&&this._container){const{clientWidth:i,clientHeight:s}=this._map.getContainer();Object.assign(this._container.style,{width:`${i}px`,height:`${s}px`})}},this._updateViewState=()=>{const i=this._deck;i&&(i.setProps({viewState:Na(this._map)}),i.isInitialized&&i.redraw())},this._handleMouseEvent=i=>{const s=this._deck;if(!s||!s.isInitialized)return;const o={type:i.type,offsetCenter:i.point,srcEvent:i},a=this._lastMouseDownPoint;switch(!i.point&&a&&(o.deltaX=i.originalEvent.clientX-a.clientX,o.deltaY=i.originalEvent.clientY-a.clientY,o.offsetCenter={x:a.x+o.deltaX,y:a.y+o.deltaY}),o.type){case"mousedown":s._onPointerDown(o),this._lastMouseDownPoint={...i.point,clientX:i.originalEvent.clientX,clientY:i.originalEvent.clientY};break;case"dragstart":o.type="panstart",s._onEvent(o);break;case"drag":o.type="panmove",s._onEvent(o);break;case"dragend":o.type="panend",s._onEvent(o);break;case"click":o.tapCount=1,s._onEvent(o);break;case"dblclick":o.type="click",o.tapCount=2,s._onEvent(o);break;case"mousemove":o.type="pointermove",s._onPointerMove(o);break;case"mouseout":o.type="pointerleave",s._onPointerMove(o);break;default:return}};const{interleaved:n=!1,...r}=e;this._interleaved=n,this._props=r}setProps(e){this._interleaved&&e.layers&&ec(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,e),this._deck&&this._deck.setProps(this._interleaved?gR(this._props):this._props)}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const n=document.createElement("div");return Object.assign(n.style,{position:"absolute",left:0,top:0,textAlign:"initial",pointerEvents:"none"}),this._container=n,this._deck=new Ra({...this._props,parent:n,viewState:Na(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),n}_onAddInterleaved(e){const n=e.painter.context.gl;return n instanceof WebGLRenderingContext&&G.warn("Incompatible basemap library. See: https://deck.gl/docs/api-reference/mapbox/overview#compatibility")(),this._deck=dR({map:e,gl:n,deck:new Ra({...this._props,gl:n})}),e.on("styledata",this._handleStyleChange),ec(e,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){var n;e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),(n=this._deck)==null||n.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),ec(e,this._deck,this._props.layers,[]),pR(e)}getDefaultPosition(){return"top-left"}pickObject(e){return ke(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return ke(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return ke(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}function NV(t){return te.createElement(te.Fragment,null,te.createElement(xn,{opened:t.opened,onClose:t.close,title:te.createElement(te.Fragment,null,te.createElement(fm,null,"One street at time")),position:"right"},te.createElement(iu,{my:"md"}),te.createElement(fr,null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),te.createElement(iu,{my:"md"}),te.createElement(ru,{gap:"xs"},te.createElement(fr,{size:"lg",fw:"500"},"Completed:"),te.createElement(fr,{size:"lg"}," 45.61%")),te.createElement(ru,{gap:"xs"},te.createElement(fr,{size:"lg",fw:"500"},"Walked:"),te.createElement(fr,{size:"lg"}," 1558km"))))}const kV="https://raw.githubusercontent.com/kkornakiewicz/walks-fe/main/edges.json",OV="https://raw.githubusercontent.com/kkornakiewicz/walks-fe/main/nodes.json",FV={latitude:41.38685633118305,longitude:2.1696874299405295,zoom:13,bearing:0,pitch:30},DV=Gw.div`
	font-size: 2vw;
	padding: 0.2em 1em;
	line-height: 1.2em;
	font-family: "Gill Sans", sans-serif;
`,BV={fontSizes:{xs:F(10),sm:F(11),md:F(14),lg:F(16),xl:F(20)}},LV="https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json";function UV(t){return Zs(()=>new MV(t)).setProps(t),null}function zV(){const[t,{toggle:e,open:n,close:r}]=eI(!1),[i,s]=M.useState(null),[o,a]=M.useState(null),[l,c]=M.useState(null),[u,f]=M.useState(!0),[h,d]=M.useState(null),[g,_]=M.useState(null),b=w=>{w!=null?_(w.properties.osmid):_(null)},m=w=>w.properties.osmid===g?[112,41,99]:w.properties.visited===!0?[250,128,114,140]:[250,128,114,10],p=w=>w.properties.visited===!0?[0,0,0,20]:[0,0,0,180];M.useEffect(()=>{(async()=>{try{const A=await fetch(kV);if(!A.ok)throw new Error(`HTTP error! Status: ${A.status}`);const x=await A.json();a(x),f(!1)}catch(A){d(A.message),f(!1)}})()},[]),M.useEffect(()=>{(async()=>{try{const A=await fetch(OV);if(!A.ok)throw new Error(`HTTP error! Status: ${A.status}`);const x=await A.json();c(x),console.log(x),f(!1)}catch(A){d(A.message),f(!1)}})()},[]);const y=[new ku({id:"map",data:o,getLineColor:m,getLineWidth:8,autoHighlight:!0,pickable:!0,onClick:w=>s(w.object),onHover:w=>b(w.object),updateTriggers:{getLineColor:[g]},beforeId:"watername_ocean"}),new ku({id:"nodes",data:l,getLineColor:p,autoHighlight:!0,getLineWidth:10,beforeId:"watername_ocean"})];return te.createElement(CE,{theme:BV},te.createElement(tn,{header:{height:60}},te.createElement(tn.Header,{withBorder:!1},te.createElement(IN,{opened:t,toggle:e})),te.createElement(tn.Main,null,te.createElement(NV,{opened:t,close:r,open:n}),te.createElement(um,{h:"100vh",fluid:!0,w:"100%",p:"0"},te.createElement(V3,{initialViewState:FV,mapStyle:LV},i&&te.createElement(j3,{key:i.properties.osmid,style:{zIndex:10},longitude:i.geometry.coordinates[0][0],latitude:i.geometry.coordinates[0][1],maxWidth:"60em"},te.createElement(DV,null,i.properties.name)),te.createElement(UV,{layers:y,useDevicePixels:!1}))))))}const $V=document.body.appendChild(document.createElement("div"));tE($V).render(te.createElement(zV,null));export{jV as c,lf as g};
