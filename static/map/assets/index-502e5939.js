var Gb=Object.defineProperty;var eA=(t,e,n)=>e in t?Gb(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var T=(t,e,n)=>(eA(t,typeof e!="symbol"?e+"":e,n),n);function tA(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var q5=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var eT={exports:{}},G={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var la=Symbol.for("react.element"),nA=Symbol.for("react.portal"),rA=Symbol.for("react.fragment"),iA=Symbol.for("react.strict_mode"),sA=Symbol.for("react.profiler"),oA=Symbol.for("react.provider"),aA=Symbol.for("react.context"),lA=Symbol.for("react.forward_ref"),cA=Symbol.for("react.suspense"),uA=Symbol.for("react.memo"),fA=Symbol.for("react.lazy"),Z_=Symbol.iterator;function hA(t){return t===null||typeof t!="object"?null:(t=Z_&&t[Z_]||t["@@iterator"],typeof t=="function"?t:null)}var tT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nT=Object.assign,rT={};function As(t,e,n){this.props=t,this.context=e,this.refs=rT,this.updater=n||tT}As.prototype.isReactComponent={};As.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};As.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function iT(){}iT.prototype=As.prototype;function Up(t,e,n){this.props=t,this.context=e,this.refs=rT,this.updater=n||tT}var zp=Up.prototype=new iT;zp.constructor=Up;nT(zp,As.prototype);zp.isPureReactComponent=!0;var Q_=Array.isArray,sT=Object.prototype.hasOwnProperty,Vp={current:null},oT={key:!0,ref:!0,__self:!0,__source:!0};function aT(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)sT.call(e,r)&&!oT.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:la,type:t,key:s,ref:o,props:i,_owner:Vp.current}}function dA(t,e){return{$$typeof:la,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function $p(t){return typeof t=="object"&&t!==null&&t.$$typeof===la}function pA(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var J_=/\/+/g;function wf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?pA(""+t.key):e.toString(36)}function xl(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case la:case nA:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+wf(o,0):r,Q_(i)?(n="",t!=null&&(n=t.replace(J_,"$&/")+"/"),xl(i,e,n,"",function(c){return c})):i!=null&&($p(i)&&(i=dA(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(J_,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Q_(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+wf(s,a);o+=xl(s,e,n,l,i)}else if(l=hA(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+wf(s,a++),o+=xl(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function La(t,e,n){if(t==null)return t;var r=[],i=0;return xl(t,r,"","",function(s){return e.call(n,s,i++)}),r}function gA(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var et={current:null},Cl={transition:null},_A={ReactCurrentDispatcher:et,ReactCurrentBatchConfig:Cl,ReactCurrentOwner:Vp};function lT(){throw Error("act(...) is not supported in production builds of React.")}G.Children={map:La,forEach:function(t,e,n){La(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return La(t,function(){e++}),e},toArray:function(t){return La(t,function(e){return e})||[]},only:function(t){if(!$p(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};G.Component=As;G.Fragment=rA;G.Profiler=sA;G.PureComponent=Up;G.StrictMode=iA;G.Suspense=cA;G.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_A;G.act=lT;G.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=nT({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Vp.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)sT.call(e,l)&&!oT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:la,type:t.type,key:i,ref:s,props:r,_owner:o}};G.createContext=function(t){return t={$$typeof:aA,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:oA,_context:t},t.Consumer=t};G.createElement=aT;G.createFactory=function(t){var e=aT.bind(null,t);return e.type=t,e};G.createRef=function(){return{current:null}};G.forwardRef=function(t){return{$$typeof:lA,render:t}};G.isValidElement=$p;G.lazy=function(t){return{$$typeof:fA,_payload:{_status:-1,_result:t},_init:gA}};G.memo=function(t,e){return{$$typeof:uA,type:t,compare:e===void 0?null:e}};G.startTransition=function(t){var e=Cl.transition;Cl.transition={};try{t()}finally{Cl.transition=e}};G.unstable_act=lT;G.useCallback=function(t,e){return et.current.useCallback(t,e)};G.useContext=function(t){return et.current.useContext(t)};G.useDebugValue=function(){};G.useDeferredValue=function(t){return et.current.useDeferredValue(t)};G.useEffect=function(t,e){return et.current.useEffect(t,e)};G.useId=function(){return et.current.useId()};G.useImperativeHandle=function(t,e,n){return et.current.useImperativeHandle(t,e,n)};G.useInsertionEffect=function(t,e){return et.current.useInsertionEffect(t,e)};G.useLayoutEffect=function(t,e){return et.current.useLayoutEffect(t,e)};G.useMemo=function(t,e){return et.current.useMemo(t,e)};G.useReducer=function(t,e,n){return et.current.useReducer(t,e,n)};G.useRef=function(t){return et.current.useRef(t)};G.useState=function(t){return et.current.useState(t)};G.useSyncExternalStore=function(t,e,n){return et.current.useSyncExternalStore(t,e,n)};G.useTransition=function(){return et.current.useTransition()};G.version="18.3.1";eT.exports=G;var I=eT.exports;const ne=bu(I);var cT={exports:{}},_t={},uT={exports:{}},fT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e($,K){var q=$.length;$.push(K);e:for(;0<q;){var fe=q-1>>>1,le=$[fe];if(0<i(le,K))$[fe]=K,$[q]=le,q=fe;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var K=$[0],q=$.pop();if(q!==K){$[0]=q;e:for(var fe=0,le=$.length,Ln=le>>>1;fe<Ln;){var lt=2*(fe+1)-1,Ar=$[lt],It=lt+1,Se=$[It];if(0>i(Ar,q))It<le&&0>i(Se,Ar)?($[fe]=Se,$[It]=q,fe=It):($[fe]=Ar,$[lt]=q,fe=lt);else if(It<le&&0>i(Se,q))$[fe]=Se,$[It]=q,fe=It;else break e}}return K}function i($,K){var q=$.sortIndex-K.sortIndex;return q!==0?q:$.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,f=null,h=3,d=!1,_=!1,g=!1,b=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y($){for(var K=n(c);K!==null;){if(K.callback===null)r(c);else if(K.startTime<=$)r(c),K.sortIndex=K.expirationTime,e(l,K);else break;K=n(c)}}function S($){if(g=!1,y($),!_)if(n(l)!==null)_=!0,br(R);else{var K=n(c);K!==null&&Bn(S,K.startTime-$)}}function R($,K){_=!1,g&&(g=!1,m(k),k=-1),d=!0;var q=h;try{for(y(K),f=n(l);f!==null&&(!(f.expirationTime>K)||$&&!H());){var fe=f.callback;if(typeof fe=="function"){f.callback=null,h=f.priorityLevel;var le=fe(f.expirationTime<=K);K=t.unstable_now(),typeof le=="function"?f.callback=le:f===n(l)&&r(l),y(K)}else r(l);f=n(l)}if(f!==null)var Ln=!0;else{var lt=n(c);lt!==null&&Bn(S,lt.startTime-K),Ln=!1}return Ln}finally{f=null,h=q,d=!1}}var P=!1,O=null,k=-1,D=5,z=-1;function H(){return!(t.unstable_now()-z<D)}function X(){if(O!==null){var $=t.unstable_now();z=$;var K=!0;try{K=O(!0,$)}finally{K?Y():(P=!1,O=null)}}else P=!1}var Y;if(typeof p=="function")Y=function(){p(X)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,je=Z.port2;Z.port1.onmessage=X,Y=function(){je.postMessage(null)}}else Y=function(){b(X,0)};function br($){O=$,P||(P=!0,Y())}function Bn($,K){k=b(function(){$(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){_||d||(_=!0,br(R))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function($){switch(h){case 1:case 2:case 3:var K=3;break;default:K=h}var q=h;h=K;try{return $()}finally{h=q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,K){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var q=h;h=$;try{return K()}finally{h=q}},t.unstable_scheduleCallback=function($,K,q){var fe=t.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?fe+q:fe):q=fe,$){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=q+le,$={id:u++,callback:K,priorityLevel:$,startTime:q,expirationTime:le,sortIndex:-1},q>fe?($.sortIndex=q,e(c,$),n(l)===null&&$===n(c)&&(g?(m(k),k=-1):g=!0,Bn(S,q-fe))):($.sortIndex=le,e(l,$),_||d||(_=!0,br(R))),$},t.unstable_shouldYield=H,t.unstable_wrapCallback=function($){var K=h;return function(){var q=h;h=K;try{return $.apply(this,arguments)}finally{h=q}}}})(fT);uT.exports=fT;var mA=uT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yA=I,gt=mA;function L(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var hT=new Set,Po={};function ii(t,e){os(t,e),os(t+"Capture",e)}function os(t,e){for(Po[t]=e,t=0;t<e.length;t++)hT.add(e[t])}var xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jh=Object.prototype.hasOwnProperty,vA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,G_={},em={};function TA(t){return jh.call(em,t)?!0:jh.call(G_,t)?!1:vA.test(t)?em[t]=!0:(G_[t]=!0,!1)}function wA(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function SA(t,e,n,r){if(e===null||typeof e>"u"||wA(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function tt(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var $e={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){$e[t]=new tt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];$e[e]=new tt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){$e[t]=new tt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){$e[t]=new tt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){$e[t]=new tt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){$e[t]=new tt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){$e[t]=new tt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){$e[t]=new tt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){$e[t]=new tt(t,5,!1,t.toLowerCase(),null,!1,!1)});var jp=/[\-:]([a-z])/g;function Wp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(jp,Wp);$e[e]=new tt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(jp,Wp);$e[e]=new tt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(jp,Wp);$e[e]=new tt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){$e[t]=new tt(t,1,!1,t.toLowerCase(),null,!1,!1)});$e.xlinkHref=new tt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){$e[t]=new tt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Hp(t,e,n,r){var i=$e.hasOwnProperty(e)?$e[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(SA(e,n,i,r)&&(n=null),r||i===null?TA(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Nn=yA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ua=Symbol.for("react.element"),Ci=Symbol.for("react.portal"),Pi=Symbol.for("react.fragment"),Xp=Symbol.for("react.strict_mode"),Wh=Symbol.for("react.profiler"),dT=Symbol.for("react.provider"),pT=Symbol.for("react.context"),Yp=Symbol.for("react.forward_ref"),Hh=Symbol.for("react.suspense"),Xh=Symbol.for("react.suspense_list"),Kp=Symbol.for("react.memo"),Hn=Symbol.for("react.lazy"),gT=Symbol.for("react.offscreen"),tm=Symbol.iterator;function Ds(t){return t===null||typeof t!="object"?null:(t=tm&&t[tm]||t["@@iterator"],typeof t=="function"?t:null)}var Te=Object.assign,Sf;function to(t){if(Sf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Sf=e&&e[1]||""}return`
`+Sf+t}var Ef=!1;function bf(t,e){if(!t||Ef)return"";Ef=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Ef=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?to(t):""}function EA(t){switch(t.tag){case 5:return to(t.type);case 16:return to("Lazy");case 13:return to("Suspense");case 19:return to("SuspenseList");case 0:case 2:case 15:return t=bf(t.type,!1),t;case 11:return t=bf(t.type.render,!1),t;case 1:return t=bf(t.type,!0),t;default:return""}}function Yh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Pi:return"Fragment";case Ci:return"Portal";case Wh:return"Profiler";case Xp:return"StrictMode";case Hh:return"Suspense";case Xh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case pT:return(t.displayName||"Context")+".Consumer";case dT:return(t._context.displayName||"Context")+".Provider";case Yp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Kp:return e=t.displayName||null,e!==null?e:Yh(t.type)||"Memo";case Hn:e=t._payload,t=t._init;try{return Yh(t(e))}catch{}}return null}function bA(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Yh(e);case 8:return e===Xp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function dr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _T(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function AA(t){var e=_T(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function za(t){t._valueTracker||(t._valueTracker=AA(t))}function mT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=_T(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ql(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Kh(t,e){var n=e.checked;return Te({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function nm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=dr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function yT(t,e){e=e.checked,e!=null&&Hp(t,"checked",e,!1)}function qh(t,e){yT(t,e);var n=dr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Zh(t,e.type,n):e.hasOwnProperty("defaultValue")&&Zh(t,e.type,dr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function rm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Zh(t,e,n){(e!=="number"||ql(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var no=Array.isArray;function Ki(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+dr(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Qh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return Te({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function im(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(L(92));if(no(n)){if(1<n.length)throw Error(L(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:dr(n)}}function vT(t,e){var n=dr(e.value),r=dr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function sm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function TT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Jh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?TT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Va,wT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Va=Va||document.createElement("div"),Va.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Va.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Io(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var uo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},RA=["Webkit","ms","Moz","O"];Object.keys(uo).forEach(function(t){RA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),uo[e]=uo[t]})});function ST(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||uo.hasOwnProperty(t)&&uo[t]?(""+e).trim():e+"px"}function ET(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=ST(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var xA=Te({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gh(t,e){if(e){if(xA[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function ed(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var td=null;function qp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var nd=null,qi=null,Zi=null;function om(t){if(t=fa(t)){if(typeof nd!="function")throw Error(L(280));var e=t.stateNode;e&&(e=Pu(e),nd(t.stateNode,t.type,e))}}function bT(t){qi?Zi?Zi.push(t):Zi=[t]:qi=t}function AT(){if(qi){var t=qi,e=Zi;if(Zi=qi=null,om(t),e)for(t=0;t<e.length;t++)om(e[t])}}function RT(t,e){return t(e)}function xT(){}var Af=!1;function CT(t,e,n){if(Af)return t(e,n);Af=!0;try{return RT(t,e,n)}finally{Af=!1,(qi!==null||Zi!==null)&&(xT(),AT())}}function Mo(t,e){var n=t.stateNode;if(n===null)return null;var r=Pu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(L(231,e,typeof n));return n}var rd=!1;if(xn)try{var Bs={};Object.defineProperty(Bs,"passive",{get:function(){rd=!0}}),window.addEventListener("test",Bs,Bs),window.removeEventListener("test",Bs,Bs)}catch{rd=!1}function CA(t,e,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var fo=!1,Zl=null,Ql=!1,id=null,PA={onError:function(t){fo=!0,Zl=t}};function IA(t,e,n,r,i,s,o,a,l){fo=!1,Zl=null,CA.apply(PA,arguments)}function MA(t,e,n,r,i,s,o,a,l){if(IA.apply(this,arguments),fo){if(fo){var c=Zl;fo=!1,Zl=null}else throw Error(L(198));Ql||(Ql=!0,id=c)}}function si(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function PT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function am(t){if(si(t)!==t)throw Error(L(188))}function NA(t){var e=t.alternate;if(!e){if(e=si(t),e===null)throw Error(L(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return am(i),t;if(s===r)return am(i),e;s=s.sibling}throw Error(L(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(L(189))}}if(n.alternate!==r)throw Error(L(190))}if(n.tag!==3)throw Error(L(188));return n.stateNode.current===n?t:e}function IT(t){return t=NA(t),t!==null?MT(t):null}function MT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=MT(t);if(e!==null)return e;t=t.sibling}return null}var NT=gt.unstable_scheduleCallback,lm=gt.unstable_cancelCallback,OA=gt.unstable_shouldYield,kA=gt.unstable_requestPaint,Re=gt.unstable_now,FA=gt.unstable_getCurrentPriorityLevel,Zp=gt.unstable_ImmediatePriority,OT=gt.unstable_UserBlockingPriority,Jl=gt.unstable_NormalPriority,DA=gt.unstable_LowPriority,kT=gt.unstable_IdlePriority,Au=null,an=null;function BA(t){if(an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(Au,t,void 0,(t.current.flags&128)===128)}catch{}}var Ut=Math.clz32?Math.clz32:zA,LA=Math.log,UA=Math.LN2;function zA(t){return t>>>=0,t===0?32:31-(LA(t)/UA|0)|0}var $a=64,ja=4194304;function ro(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Gl(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=ro(a):(s&=o,s!==0&&(r=ro(s)))}else o=n&~i,o!==0?r=ro(o):s!==0&&(r=ro(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ut(e),i=1<<n,r|=t[n],e&=~i;return r}function VA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $A(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Ut(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=VA(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function sd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function FT(){var t=$a;return $a<<=1,!($a&4194240)&&($a=64),t}function Rf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ca(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ut(e),t[e]=n}function jA(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ut(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Qp(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ut(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var re=0;function DT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var BT,Jp,LT,UT,zT,od=!1,Wa=[],rr=null,ir=null,sr=null,No=new Map,Oo=new Map,qn=[],WA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cm(t,e){switch(t){case"focusin":case"focusout":rr=null;break;case"dragenter":case"dragleave":ir=null;break;case"mouseover":case"mouseout":sr=null;break;case"pointerover":case"pointerout":No.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oo.delete(e.pointerId)}}function Ls(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=fa(e),e!==null&&Jp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function HA(t,e,n,r,i){switch(e){case"focusin":return rr=Ls(rr,t,e,n,r,i),!0;case"dragenter":return ir=Ls(ir,t,e,n,r,i),!0;case"mouseover":return sr=Ls(sr,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return No.set(s,Ls(No.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Oo.set(s,Ls(Oo.get(s)||null,t,e,n,r,i)),!0}return!1}function VT(t){var e=Lr(t.target);if(e!==null){var n=si(e);if(n!==null){if(e=n.tag,e===13){if(e=PT(n),e!==null){t.blockedOn=e,zT(t.priority,function(){LT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Pl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ad(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);td=r,n.target.dispatchEvent(r),td=null}else return e=fa(n),e!==null&&Jp(e),t.blockedOn=n,!1;e.shift()}return!0}function um(t,e,n){Pl(t)&&n.delete(e)}function XA(){od=!1,rr!==null&&Pl(rr)&&(rr=null),ir!==null&&Pl(ir)&&(ir=null),sr!==null&&Pl(sr)&&(sr=null),No.forEach(um),Oo.forEach(um)}function Us(t,e){t.blockedOn===e&&(t.blockedOn=null,od||(od=!0,gt.unstable_scheduleCallback(gt.unstable_NormalPriority,XA)))}function ko(t){function e(i){return Us(i,t)}if(0<Wa.length){Us(Wa[0],t);for(var n=1;n<Wa.length;n++){var r=Wa[n];r.blockedOn===t&&(r.blockedOn=null)}}for(rr!==null&&Us(rr,t),ir!==null&&Us(ir,t),sr!==null&&Us(sr,t),No.forEach(e),Oo.forEach(e),n=0;n<qn.length;n++)r=qn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<qn.length&&(n=qn[0],n.blockedOn===null);)VT(n),n.blockedOn===null&&qn.shift()}var Qi=Nn.ReactCurrentBatchConfig,ec=!0;function YA(t,e,n,r){var i=re,s=Qi.transition;Qi.transition=null;try{re=1,Gp(t,e,n,r)}finally{re=i,Qi.transition=s}}function KA(t,e,n,r){var i=re,s=Qi.transition;Qi.transition=null;try{re=4,Gp(t,e,n,r)}finally{re=i,Qi.transition=s}}function Gp(t,e,n,r){if(ec){var i=ad(t,e,n,r);if(i===null)Df(t,e,r,tc,n),cm(t,r);else if(HA(i,t,e,n,r))r.stopPropagation();else if(cm(t,r),e&4&&-1<WA.indexOf(t)){for(;i!==null;){var s=fa(i);if(s!==null&&BT(s),s=ad(t,e,n,r),s===null&&Df(t,e,r,tc,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Df(t,e,r,null,n)}}var tc=null;function ad(t,e,n,r){if(tc=null,t=qp(r),t=Lr(t),t!==null)if(e=si(t),e===null)t=null;else if(n=e.tag,n===13){if(t=PT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return tc=t,null}function $T(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(FA()){case Zp:return 1;case OT:return 4;case Jl:case DA:return 16;case kT:return 536870912;default:return 16}default:return 16}}var Qn=null,eg=null,Il=null;function jT(){if(Il)return Il;var t,e=eg,n=e.length,r,i="value"in Qn?Qn.value:Qn.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Il=i.slice(t,1<r?1-r:void 0)}function Ml(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ha(){return!0}function fm(){return!1}function mt(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ha:fm,this.isPropagationStopped=fm,this}return Te(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ha)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ha)},persist:function(){},isPersistent:Ha}),e}var Rs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tg=mt(Rs),ua=Te({},Rs,{view:0,detail:0}),qA=mt(ua),xf,Cf,zs,Ru=Te({},ua,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ng,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==zs&&(zs&&t.type==="mousemove"?(xf=t.screenX-zs.screenX,Cf=t.screenY-zs.screenY):Cf=xf=0,zs=t),xf)},movementY:function(t){return"movementY"in t?t.movementY:Cf}}),hm=mt(Ru),ZA=Te({},Ru,{dataTransfer:0}),QA=mt(ZA),JA=Te({},ua,{relatedTarget:0}),Pf=mt(JA),GA=Te({},Rs,{animationName:0,elapsedTime:0,pseudoElement:0}),eR=mt(GA),tR=Te({},Rs,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),nR=mt(tR),rR=Te({},Rs,{data:0}),dm=mt(rR),iR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function aR(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=oR[t])?!!e[t]:!1}function ng(){return aR}var lR=Te({},ua,{key:function(t){if(t.key){var e=iR[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ml(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?sR[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ng,charCode:function(t){return t.type==="keypress"?Ml(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ml(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),cR=mt(lR),uR=Te({},Ru,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pm=mt(uR),fR=Te({},ua,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ng}),hR=mt(fR),dR=Te({},Rs,{propertyName:0,elapsedTime:0,pseudoElement:0}),pR=mt(dR),gR=Te({},Ru,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),_R=mt(gR),mR=[9,13,27,32],rg=xn&&"CompositionEvent"in window,ho=null;xn&&"documentMode"in document&&(ho=document.documentMode);var yR=xn&&"TextEvent"in window&&!ho,WT=xn&&(!rg||ho&&8<ho&&11>=ho),gm=String.fromCharCode(32),_m=!1;function HT(t,e){switch(t){case"keyup":return mR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function XT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ii=!1;function vR(t,e){switch(t){case"compositionend":return XT(e);case"keypress":return e.which!==32?null:(_m=!0,gm);case"textInput":return t=e.data,t===gm&&_m?null:t;default:return null}}function TR(t,e){if(Ii)return t==="compositionend"||!rg&&HT(t,e)?(t=jT(),Il=eg=Qn=null,Ii=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return WT&&e.locale!=="ko"?null:e.data;default:return null}}var wR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!wR[t.type]:e==="textarea"}function YT(t,e,n,r){bT(r),e=nc(e,"onChange"),0<e.length&&(n=new tg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var po=null,Fo=null;function SR(t){iw(t,0)}function xu(t){var e=Oi(t);if(mT(e))return t}function ER(t,e){if(t==="change")return e}var KT=!1;if(xn){var If;if(xn){var Mf="oninput"in document;if(!Mf){var ym=document.createElement("div");ym.setAttribute("oninput","return;"),Mf=typeof ym.oninput=="function"}If=Mf}else If=!1;KT=If&&(!document.documentMode||9<document.documentMode)}function vm(){po&&(po.detachEvent("onpropertychange",qT),Fo=po=null)}function qT(t){if(t.propertyName==="value"&&xu(Fo)){var e=[];YT(e,Fo,t,qp(t)),CT(SR,e)}}function bR(t,e,n){t==="focusin"?(vm(),po=e,Fo=n,po.attachEvent("onpropertychange",qT)):t==="focusout"&&vm()}function AR(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return xu(Fo)}function RR(t,e){if(t==="click")return xu(e)}function xR(t,e){if(t==="input"||t==="change")return xu(e)}function CR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var jt=typeof Object.is=="function"?Object.is:CR;function Do(t,e){if(jt(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!jh.call(e,i)||!jt(t[i],e[i]))return!1}return!0}function Tm(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function wm(t,e){var n=Tm(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Tm(n)}}function ZT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?ZT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function QT(){for(var t=window,e=ql();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ql(t.document)}return e}function ig(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function PR(t){var e=QT(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&ZT(n.ownerDocument.documentElement,n)){if(r!==null&&ig(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=wm(n,s);var o=wm(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var IR=xn&&"documentMode"in document&&11>=document.documentMode,Mi=null,ld=null,go=null,cd=!1;function Sm(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;cd||Mi==null||Mi!==ql(r)||(r=Mi,"selectionStart"in r&&ig(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),go&&Do(go,r)||(go=r,r=nc(ld,"onSelect"),0<r.length&&(e=new tg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Mi)))}function Xa(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ni={animationend:Xa("Animation","AnimationEnd"),animationiteration:Xa("Animation","AnimationIteration"),animationstart:Xa("Animation","AnimationStart"),transitionend:Xa("Transition","TransitionEnd")},Nf={},JT={};xn&&(JT=document.createElement("div").style,"AnimationEvent"in window||(delete Ni.animationend.animation,delete Ni.animationiteration.animation,delete Ni.animationstart.animation),"TransitionEvent"in window||delete Ni.transitionend.transition);function Cu(t){if(Nf[t])return Nf[t];if(!Ni[t])return t;var e=Ni[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in JT)return Nf[t]=e[n];return t}var GT=Cu("animationend"),ew=Cu("animationiteration"),tw=Cu("animationstart"),nw=Cu("transitionend"),rw=new Map,Em="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yr(t,e){rw.set(t,e),ii(e,[t])}for(var Of=0;Of<Em.length;Of++){var kf=Em[Of],MR=kf.toLowerCase(),NR=kf[0].toUpperCase()+kf.slice(1);yr(MR,"on"+NR)}yr(GT,"onAnimationEnd");yr(ew,"onAnimationIteration");yr(tw,"onAnimationStart");yr("dblclick","onDoubleClick");yr("focusin","onFocus");yr("focusout","onBlur");yr(nw,"onTransitionEnd");os("onMouseEnter",["mouseout","mouseover"]);os("onMouseLeave",["mouseout","mouseover"]);os("onPointerEnter",["pointerout","pointerover"]);os("onPointerLeave",["pointerout","pointerover"]);ii("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ii("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ii("onBeforeInput",["compositionend","keypress","textInput","paste"]);ii("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ii("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ii("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var io="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),OR=new Set("cancel close invalid load scroll toggle".split(" ").concat(io));function bm(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,MA(r,e,void 0,t),t.currentTarget=null}function iw(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;bm(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;bm(i,a,c),s=l}}}if(Ql)throw t=id,Ql=!1,id=null,t}function he(t,e){var n=e[pd];n===void 0&&(n=e[pd]=new Set);var r=t+"__bubble";n.has(r)||(sw(e,t,2,!1),n.add(r))}function Ff(t,e,n){var r=0;e&&(r|=4),sw(n,t,r,e)}var Ya="_reactListening"+Math.random().toString(36).slice(2);function Bo(t){if(!t[Ya]){t[Ya]=!0,hT.forEach(function(n){n!=="selectionchange"&&(OR.has(n)||Ff(n,!1,t),Ff(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ya]||(e[Ya]=!0,Ff("selectionchange",!1,e))}}function sw(t,e,n,r){switch($T(e)){case 1:var i=YA;break;case 4:i=KA;break;default:i=Gp}n=i.bind(null,e,n,t),i=void 0,!rd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Df(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Lr(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}CT(function(){var c=s,u=qp(n),f=[];e:{var h=rw.get(t);if(h!==void 0){var d=tg,_=t;switch(t){case"keypress":if(Ml(n)===0)break e;case"keydown":case"keyup":d=cR;break;case"focusin":_="focus",d=Pf;break;case"focusout":_="blur",d=Pf;break;case"beforeblur":case"afterblur":d=Pf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=hm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=QA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=hR;break;case GT:case ew:case tw:d=eR;break;case nw:d=pR;break;case"scroll":d=qA;break;case"wheel":d=_R;break;case"copy":case"cut":case"paste":d=nR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=pm}var g=(e&4)!==0,b=!g&&t==="scroll",m=g?h!==null?h+"Capture":null:h;g=[];for(var p=c,y;p!==null;){y=p;var S=y.stateNode;if(y.tag===5&&S!==null&&(y=S,m!==null&&(S=Mo(p,m),S!=null&&g.push(Lo(p,S,y)))),b)break;p=p.return}0<g.length&&(h=new d(h,_,null,n,u),f.push({event:h,listeners:g}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",d=t==="mouseout"||t==="pointerout",h&&n!==td&&(_=n.relatedTarget||n.fromElement)&&(Lr(_)||_[Cn]))break e;if((d||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,d?(_=n.relatedTarget||n.toElement,d=c,_=_?Lr(_):null,_!==null&&(b=si(_),_!==b||_.tag!==5&&_.tag!==6)&&(_=null)):(d=null,_=c),d!==_)){if(g=hm,S="onMouseLeave",m="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(g=pm,S="onPointerLeave",m="onPointerEnter",p="pointer"),b=d==null?h:Oi(d),y=_==null?h:Oi(_),h=new g(S,p+"leave",d,n,u),h.target=b,h.relatedTarget=y,S=null,Lr(u)===c&&(g=new g(m,p+"enter",_,n,u),g.target=y,g.relatedTarget=b,S=g),b=S,d&&_)t:{for(g=d,m=_,p=0,y=g;y;y=pi(y))p++;for(y=0,S=m;S;S=pi(S))y++;for(;0<p-y;)g=pi(g),p--;for(;0<y-p;)m=pi(m),y--;for(;p--;){if(g===m||m!==null&&g===m.alternate)break t;g=pi(g),m=pi(m)}g=null}else g=null;d!==null&&Am(f,h,d,g,!1),_!==null&&b!==null&&Am(f,b,_,g,!0)}}e:{if(h=c?Oi(c):window,d=h.nodeName&&h.nodeName.toLowerCase(),d==="select"||d==="input"&&h.type==="file")var R=ER;else if(mm(h))if(KT)R=xR;else{R=AR;var P=bR}else(d=h.nodeName)&&d.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(R=RR);if(R&&(R=R(t,c))){YT(f,R,n,u);break e}P&&P(t,h,c),t==="focusout"&&(P=h._wrapperState)&&P.controlled&&h.type==="number"&&Zh(h,"number",h.value)}switch(P=c?Oi(c):window,t){case"focusin":(mm(P)||P.contentEditable==="true")&&(Mi=P,ld=c,go=null);break;case"focusout":go=ld=Mi=null;break;case"mousedown":cd=!0;break;case"contextmenu":case"mouseup":case"dragend":cd=!1,Sm(f,n,u);break;case"selectionchange":if(IR)break;case"keydown":case"keyup":Sm(f,n,u)}var O;if(rg)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Ii?HT(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(WT&&n.locale!=="ko"&&(Ii||k!=="onCompositionStart"?k==="onCompositionEnd"&&Ii&&(O=jT()):(Qn=u,eg="value"in Qn?Qn.value:Qn.textContent,Ii=!0)),P=nc(c,k),0<P.length&&(k=new dm(k,t,null,n,u),f.push({event:k,listeners:P}),O?k.data=O:(O=XT(n),O!==null&&(k.data=O)))),(O=yR?vR(t,n):TR(t,n))&&(c=nc(c,"onBeforeInput"),0<c.length&&(u=new dm("onBeforeInput","beforeinput",null,n,u),f.push({event:u,listeners:c}),u.data=O))}iw(f,e)})}function Lo(t,e,n){return{instance:t,listener:e,currentTarget:n}}function nc(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Mo(t,n),s!=null&&r.unshift(Lo(t,s,i)),s=Mo(t,e),s!=null&&r.push(Lo(t,s,i))),t=t.return}return r}function pi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Am(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=Mo(n,s),l!=null&&o.unshift(Lo(n,l,a))):i||(l=Mo(n,s),l!=null&&o.push(Lo(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var kR=/\r\n?/g,FR=/\u0000|\uFFFD/g;function Rm(t){return(typeof t=="string"?t:""+t).replace(kR,`
`).replace(FR,"")}function Ka(t,e,n){if(e=Rm(e),Rm(t)!==e&&n)throw Error(L(425))}function rc(){}var ud=null,fd=null;function hd(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var dd=typeof setTimeout=="function"?setTimeout:void 0,DR=typeof clearTimeout=="function"?clearTimeout:void 0,xm=typeof Promise=="function"?Promise:void 0,BR=typeof queueMicrotask=="function"?queueMicrotask:typeof xm<"u"?function(t){return xm.resolve(null).then(t).catch(LR)}:dd;function LR(t){setTimeout(function(){throw t})}function Bf(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),ko(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ko(e)}function or(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Cm(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var xs=Math.random().toString(36).slice(2),tn="__reactFiber$"+xs,Uo="__reactProps$"+xs,Cn="__reactContainer$"+xs,pd="__reactEvents$"+xs,UR="__reactListeners$"+xs,zR="__reactHandles$"+xs;function Lr(t){var e=t[tn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Cn]||n[tn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Cm(t);t!==null;){if(n=t[tn])return n;t=Cm(t)}return e}t=n,n=t.parentNode}return null}function fa(t){return t=t[tn]||t[Cn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Oi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(L(33))}function Pu(t){return t[Uo]||null}var gd=[],ki=-1;function vr(t){return{current:t}}function de(t){0>ki||(t.current=gd[ki],gd[ki]=null,ki--)}function ce(t,e){ki++,gd[ki]=t.current,t.current=e}var pr={},Ze=vr(pr),it=vr(!1),qr=pr;function as(t,e){var n=t.type.contextTypes;if(!n)return pr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function st(t){return t=t.childContextTypes,t!=null}function ic(){de(it),de(Ze)}function Pm(t,e,n){if(Ze.current!==pr)throw Error(L(168));ce(Ze,e),ce(it,n)}function ow(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(L(108,bA(t)||"Unknown",i));return Te({},n,r)}function sc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||pr,qr=Ze.current,ce(Ze,t),ce(it,it.current),!0}function Im(t,e,n){var r=t.stateNode;if(!r)throw Error(L(169));n?(t=ow(t,e,qr),r.__reactInternalMemoizedMergedChildContext=t,de(it),de(Ze),ce(Ze,t)):de(it),ce(it,n)}var Tn=null,Iu=!1,Lf=!1;function aw(t){Tn===null?Tn=[t]:Tn.push(t)}function VR(t){Iu=!0,aw(t)}function Tr(){if(!Lf&&Tn!==null){Lf=!0;var t=0,e=re;try{var n=Tn;for(re=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Tn=null,Iu=!1}catch(i){throw Tn!==null&&(Tn=Tn.slice(t+1)),NT(Zp,Tr),i}finally{re=e,Lf=!1}}return null}var Fi=[],Di=0,oc=null,ac=0,wt=[],St=0,Zr=null,En=1,bn="";function Nr(t,e){Fi[Di++]=ac,Fi[Di++]=oc,oc=t,ac=e}function lw(t,e,n){wt[St++]=En,wt[St++]=bn,wt[St++]=Zr,Zr=t;var r=En;t=bn;var i=32-Ut(r)-1;r&=~(1<<i),n+=1;var s=32-Ut(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,En=1<<32-Ut(e)+i|n<<i|r,bn=s+t}else En=1<<s|n<<i|r,bn=t}function sg(t){t.return!==null&&(Nr(t,1),lw(t,1,0))}function og(t){for(;t===oc;)oc=Fi[--Di],Fi[Di]=null,ac=Fi[--Di],Fi[Di]=null;for(;t===Zr;)Zr=wt[--St],wt[St]=null,bn=wt[--St],wt[St]=null,En=wt[--St],wt[St]=null}var pt=null,ht=null,pe=!1,Ft=null;function cw(t,e){var n=Et(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Mm(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,pt=t,ht=or(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,pt=t,ht=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Zr!==null?{id:En,overflow:bn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Et(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,pt=t,ht=null,!0):!1;default:return!1}}function _d(t){return(t.mode&1)!==0&&(t.flags&128)===0}function md(t){if(pe){var e=ht;if(e){var n=e;if(!Mm(t,e)){if(_d(t))throw Error(L(418));e=or(n.nextSibling);var r=pt;e&&Mm(t,e)?cw(r,n):(t.flags=t.flags&-4097|2,pe=!1,pt=t)}}else{if(_d(t))throw Error(L(418));t.flags=t.flags&-4097|2,pe=!1,pt=t}}}function Nm(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;pt=t}function qa(t){if(t!==pt)return!1;if(!pe)return Nm(t),pe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!hd(t.type,t.memoizedProps)),e&&(e=ht)){if(_d(t))throw uw(),Error(L(418));for(;e;)cw(t,e),e=or(e.nextSibling)}if(Nm(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(L(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ht=or(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ht=null}}else ht=pt?or(t.stateNode.nextSibling):null;return!0}function uw(){for(var t=ht;t;)t=or(t.nextSibling)}function ls(){ht=pt=null,pe=!1}function ag(t){Ft===null?Ft=[t]:Ft.push(t)}var $R=Nn.ReactCurrentBatchConfig;function Vs(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(L(309));var r=n.stateNode}if(!r)throw Error(L(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(L(284));if(!n._owner)throw Error(L(290,t))}return t}function Za(t,e){throw t=Object.prototype.toString.call(e),Error(L(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Om(t){var e=t._init;return e(t._payload)}function fw(t){function e(m,p){if(t){var y=m.deletions;y===null?(m.deletions=[p],m.flags|=16):y.push(p)}}function n(m,p){if(!t)return null;for(;p!==null;)e(m,p),p=p.sibling;return null}function r(m,p){for(m=new Map;p!==null;)p.key!==null?m.set(p.key,p):m.set(p.index,p),p=p.sibling;return m}function i(m,p){return m=ur(m,p),m.index=0,m.sibling=null,m}function s(m,p,y){return m.index=y,t?(y=m.alternate,y!==null?(y=y.index,y<p?(m.flags|=2,p):y):(m.flags|=2,p)):(m.flags|=1048576,p)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function a(m,p,y,S){return p===null||p.tag!==6?(p=Hf(y,m.mode,S),p.return=m,p):(p=i(p,y),p.return=m,p)}function l(m,p,y,S){var R=y.type;return R===Pi?u(m,p,y.props.children,S,y.key):p!==null&&(p.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Hn&&Om(R)===p.type)?(S=i(p,y.props),S.ref=Vs(m,p,y),S.return=m,S):(S=Ll(y.type,y.key,y.props,null,m.mode,S),S.ref=Vs(m,p,y),S.return=m,S)}function c(m,p,y,S){return p===null||p.tag!==4||p.stateNode.containerInfo!==y.containerInfo||p.stateNode.implementation!==y.implementation?(p=Xf(y,m.mode,S),p.return=m,p):(p=i(p,y.children||[]),p.return=m,p)}function u(m,p,y,S,R){return p===null||p.tag!==7?(p=Hr(y,m.mode,S,R),p.return=m,p):(p=i(p,y),p.return=m,p)}function f(m,p,y){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Hf(""+p,m.mode,y),p.return=m,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Ua:return y=Ll(p.type,p.key,p.props,null,m.mode,y),y.ref=Vs(m,null,p),y.return=m,y;case Ci:return p=Xf(p,m.mode,y),p.return=m,p;case Hn:var S=p._init;return f(m,S(p._payload),y)}if(no(p)||Ds(p))return p=Hr(p,m.mode,y,null),p.return=m,p;Za(m,p)}return null}function h(m,p,y,S){var R=p!==null?p.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return R!==null?null:a(m,p,""+y,S);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ua:return y.key===R?l(m,p,y,S):null;case Ci:return y.key===R?c(m,p,y,S):null;case Hn:return R=y._init,h(m,p,R(y._payload),S)}if(no(y)||Ds(y))return R!==null?null:u(m,p,y,S,null);Za(m,y)}return null}function d(m,p,y,S,R){if(typeof S=="string"&&S!==""||typeof S=="number")return m=m.get(y)||null,a(p,m,""+S,R);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Ua:return m=m.get(S.key===null?y:S.key)||null,l(p,m,S,R);case Ci:return m=m.get(S.key===null?y:S.key)||null,c(p,m,S,R);case Hn:var P=S._init;return d(m,p,y,P(S._payload),R)}if(no(S)||Ds(S))return m=m.get(y)||null,u(p,m,S,R,null);Za(p,S)}return null}function _(m,p,y,S){for(var R=null,P=null,O=p,k=p=0,D=null;O!==null&&k<y.length;k++){O.index>k?(D=O,O=null):D=O.sibling;var z=h(m,O,y[k],S);if(z===null){O===null&&(O=D);break}t&&O&&z.alternate===null&&e(m,O),p=s(z,p,k),P===null?R=z:P.sibling=z,P=z,O=D}if(k===y.length)return n(m,O),pe&&Nr(m,k),R;if(O===null){for(;k<y.length;k++)O=f(m,y[k],S),O!==null&&(p=s(O,p,k),P===null?R=O:P.sibling=O,P=O);return pe&&Nr(m,k),R}for(O=r(m,O);k<y.length;k++)D=d(O,m,k,y[k],S),D!==null&&(t&&D.alternate!==null&&O.delete(D.key===null?k:D.key),p=s(D,p,k),P===null?R=D:P.sibling=D,P=D);return t&&O.forEach(function(H){return e(m,H)}),pe&&Nr(m,k),R}function g(m,p,y,S){var R=Ds(y);if(typeof R!="function")throw Error(L(150));if(y=R.call(y),y==null)throw Error(L(151));for(var P=R=null,O=p,k=p=0,D=null,z=y.next();O!==null&&!z.done;k++,z=y.next()){O.index>k?(D=O,O=null):D=O.sibling;var H=h(m,O,z.value,S);if(H===null){O===null&&(O=D);break}t&&O&&H.alternate===null&&e(m,O),p=s(H,p,k),P===null?R=H:P.sibling=H,P=H,O=D}if(z.done)return n(m,O),pe&&Nr(m,k),R;if(O===null){for(;!z.done;k++,z=y.next())z=f(m,z.value,S),z!==null&&(p=s(z,p,k),P===null?R=z:P.sibling=z,P=z);return pe&&Nr(m,k),R}for(O=r(m,O);!z.done;k++,z=y.next())z=d(O,m,k,z.value,S),z!==null&&(t&&z.alternate!==null&&O.delete(z.key===null?k:z.key),p=s(z,p,k),P===null?R=z:P.sibling=z,P=z);return t&&O.forEach(function(X){return e(m,X)}),pe&&Nr(m,k),R}function b(m,p,y,S){if(typeof y=="object"&&y!==null&&y.type===Pi&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Ua:e:{for(var R=y.key,P=p;P!==null;){if(P.key===R){if(R=y.type,R===Pi){if(P.tag===7){n(m,P.sibling),p=i(P,y.props.children),p.return=m,m=p;break e}}else if(P.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Hn&&Om(R)===P.type){n(m,P.sibling),p=i(P,y.props),p.ref=Vs(m,P,y),p.return=m,m=p;break e}n(m,P);break}else e(m,P);P=P.sibling}y.type===Pi?(p=Hr(y.props.children,m.mode,S,y.key),p.return=m,m=p):(S=Ll(y.type,y.key,y.props,null,m.mode,S),S.ref=Vs(m,p,y),S.return=m,m=S)}return o(m);case Ci:e:{for(P=y.key;p!==null;){if(p.key===P)if(p.tag===4&&p.stateNode.containerInfo===y.containerInfo&&p.stateNode.implementation===y.implementation){n(m,p.sibling),p=i(p,y.children||[]),p.return=m,m=p;break e}else{n(m,p);break}else e(m,p);p=p.sibling}p=Xf(y,m.mode,S),p.return=m,m=p}return o(m);case Hn:return P=y._init,b(m,p,P(y._payload),S)}if(no(y))return _(m,p,y,S);if(Ds(y))return g(m,p,y,S);Za(m,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,p!==null&&p.tag===6?(n(m,p.sibling),p=i(p,y),p.return=m,m=p):(n(m,p),p=Hf(y,m.mode,S),p.return=m,m=p),o(m)):n(m,p)}return b}var cs=fw(!0),hw=fw(!1),lc=vr(null),cc=null,Bi=null,lg=null;function cg(){lg=Bi=cc=null}function ug(t){var e=lc.current;de(lc),t._currentValue=e}function yd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ji(t,e){cc=t,lg=Bi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(rt=!0),t.firstContext=null)}function xt(t){var e=t._currentValue;if(lg!==t)if(t={context:t,memoizedValue:e,next:null},Bi===null){if(cc===null)throw Error(L(308));Bi=t,cc.dependencies={lanes:0,firstContext:t}}else Bi=Bi.next=t;return e}var Ur=null;function fg(t){Ur===null?Ur=[t]:Ur.push(t)}function dw(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,fg(e)):(n.next=i.next,i.next=n),e.interleaved=n,Pn(t,r)}function Pn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Xn=!1;function hg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pw(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Rn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ar(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ee&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Pn(t,n)}return i=r.interleaved,i===null?(e.next=e,fg(r)):(e.next=i.next,i.next=e),r.interleaved=e,Pn(t,n)}function Nl(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Qp(t,n)}}function km(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function uc(t,e,n,r){var i=t.updateQueue;Xn=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(s!==null){var f=i.baseState;o=0,u=c=l=null,a=s;do{var h=a.lane,d=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var _=t,g=a;switch(h=e,d=n,g.tag){case 1:if(_=g.payload,typeof _=="function"){f=_.call(d,f,h);break e}f=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=g.payload,h=typeof _=="function"?_.call(d,f,h):_,h==null)break e;f=Te({},f,h);break e;case 2:Xn=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else d={eventTime:d,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=d,l=f):u=u.next=d,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(u===null&&(l=f),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Jr|=o,t.lanes=o,t.memoizedState=f}}function Fm(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(L(191,i));i.call(r)}}}var ha={},ln=vr(ha),zo=vr(ha),Vo=vr(ha);function zr(t){if(t===ha)throw Error(L(174));return t}function dg(t,e){switch(ce(Vo,e),ce(zo,t),ce(ln,ha),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Jh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Jh(e,t)}de(ln),ce(ln,e)}function us(){de(ln),de(zo),de(Vo)}function gw(t){zr(Vo.current);var e=zr(ln.current),n=Jh(e,t.type);e!==n&&(ce(zo,t),ce(ln,n))}function pg(t){zo.current===t&&(de(ln),de(zo))}var me=vr(0);function fc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Uf=[];function gg(){for(var t=0;t<Uf.length;t++)Uf[t]._workInProgressVersionPrimary=null;Uf.length=0}var Ol=Nn.ReactCurrentDispatcher,zf=Nn.ReactCurrentBatchConfig,Qr=0,ve=null,Me=null,Fe=null,hc=!1,_o=!1,$o=0,jR=0;function He(){throw Error(L(321))}function _g(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!jt(t[n],e[n]))return!1;return!0}function mg(t,e,n,r,i,s){if(Qr=s,ve=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ol.current=t===null||t.memoizedState===null?YR:KR,t=n(r,i),_o){s=0;do{if(_o=!1,$o=0,25<=s)throw Error(L(301));s+=1,Fe=Me=null,e.updateQueue=null,Ol.current=qR,t=n(r,i)}while(_o)}if(Ol.current=dc,e=Me!==null&&Me.next!==null,Qr=0,Fe=Me=ve=null,hc=!1,e)throw Error(L(300));return t}function yg(){var t=$o!==0;return $o=0,t}function Gt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fe===null?ve.memoizedState=Fe=t:Fe=Fe.next=t,Fe}function Ct(){if(Me===null){var t=ve.alternate;t=t!==null?t.memoizedState:null}else t=Me.next;var e=Fe===null?ve.memoizedState:Fe.next;if(e!==null)Fe=e,Me=t;else{if(t===null)throw Error(L(310));Me=t,t={memoizedState:Me.memoizedState,baseState:Me.baseState,baseQueue:Me.baseQueue,queue:Me.queue,next:null},Fe===null?ve.memoizedState=Fe=t:Fe=Fe.next=t}return Fe}function jo(t,e){return typeof e=="function"?e(t):e}function Vf(t){var e=Ct(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=Me,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var u=c.lane;if((Qr&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=f,o=r):l=l.next=f,ve.lanes|=u,Jr|=u}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,jt(r,e.memoizedState)||(rt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ve.lanes|=s,Jr|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function $f(t){var e=Ct(),n=e.queue;if(n===null)throw Error(L(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);jt(s,e.memoizedState)||(rt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function _w(){}function mw(t,e){var n=ve,r=Ct(),i=e(),s=!jt(r.memoizedState,i);if(s&&(r.memoizedState=i,rt=!0),r=r.queue,vg(Tw.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Fe!==null&&Fe.memoizedState.tag&1){if(n.flags|=2048,Wo(9,vw.bind(null,n,r,i,e),void 0,null),De===null)throw Error(L(349));Qr&30||yw(n,e,i)}return i}function yw(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ve.updateQueue,e===null?(e={lastEffect:null,stores:null},ve.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function vw(t,e,n,r){e.value=n,e.getSnapshot=r,ww(e)&&Sw(t)}function Tw(t,e,n){return n(function(){ww(e)&&Sw(t)})}function ww(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!jt(t,n)}catch{return!0}}function Sw(t){var e=Pn(t,1);e!==null&&zt(e,t,1,-1)}function Dm(t){var e=Gt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jo,lastRenderedState:t},e.queue=t,t=t.dispatch=XR.bind(null,ve,t),[e.memoizedState,t]}function Wo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ve.updateQueue,e===null?(e={lastEffect:null,stores:null},ve.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Ew(){return Ct().memoizedState}function kl(t,e,n,r){var i=Gt();ve.flags|=t,i.memoizedState=Wo(1|e,n,void 0,r===void 0?null:r)}function Mu(t,e,n,r){var i=Ct();r=r===void 0?null:r;var s=void 0;if(Me!==null){var o=Me.memoizedState;if(s=o.destroy,r!==null&&_g(r,o.deps)){i.memoizedState=Wo(e,n,s,r);return}}ve.flags|=t,i.memoizedState=Wo(1|e,n,s,r)}function Bm(t,e){return kl(8390656,8,t,e)}function vg(t,e){return Mu(2048,8,t,e)}function bw(t,e){return Mu(4,2,t,e)}function Aw(t,e){return Mu(4,4,t,e)}function Rw(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function xw(t,e,n){return n=n!=null?n.concat([t]):null,Mu(4,4,Rw.bind(null,e,t),n)}function Tg(){}function Cw(t,e){var n=Ct();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&_g(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Pw(t,e){var n=Ct();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&_g(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Iw(t,e,n){return Qr&21?(jt(n,e)||(n=FT(),ve.lanes|=n,Jr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,rt=!0),t.memoizedState=n)}function WR(t,e){var n=re;re=n!==0&&4>n?n:4,t(!0);var r=zf.transition;zf.transition={};try{t(!1),e()}finally{re=n,zf.transition=r}}function Mw(){return Ct().memoizedState}function HR(t,e,n){var r=cr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Nw(t))Ow(e,n);else if(n=dw(t,e,n,r),n!==null){var i=Ge();zt(n,t,r,i),kw(n,e,r)}}function XR(t,e,n){var r=cr(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Nw(t))Ow(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,jt(a,o)){var l=e.interleaved;l===null?(i.next=i,fg(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=dw(t,e,i,r),n!==null&&(i=Ge(),zt(n,t,r,i),kw(n,e,r))}}function Nw(t){var e=t.alternate;return t===ve||e!==null&&e===ve}function Ow(t,e){_o=hc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function kw(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Qp(t,n)}}var dc={readContext:xt,useCallback:He,useContext:He,useEffect:He,useImperativeHandle:He,useInsertionEffect:He,useLayoutEffect:He,useMemo:He,useReducer:He,useRef:He,useState:He,useDebugValue:He,useDeferredValue:He,useTransition:He,useMutableSource:He,useSyncExternalStore:He,useId:He,unstable_isNewReconciler:!1},YR={readContext:xt,useCallback:function(t,e){return Gt().memoizedState=[t,e===void 0?null:e],t},useContext:xt,useEffect:Bm,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,kl(4194308,4,Rw.bind(null,e,t),n)},useLayoutEffect:function(t,e){return kl(4194308,4,t,e)},useInsertionEffect:function(t,e){return kl(4,2,t,e)},useMemo:function(t,e){var n=Gt();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Gt();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=HR.bind(null,ve,t),[r.memoizedState,t]},useRef:function(t){var e=Gt();return t={current:t},e.memoizedState=t},useState:Dm,useDebugValue:Tg,useDeferredValue:function(t){return Gt().memoizedState=t},useTransition:function(){var t=Dm(!1),e=t[0];return t=WR.bind(null,t[1]),Gt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ve,i=Gt();if(pe){if(n===void 0)throw Error(L(407));n=n()}else{if(n=e(),De===null)throw Error(L(349));Qr&30||yw(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Bm(Tw.bind(null,r,s,t),[t]),r.flags|=2048,Wo(9,vw.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Gt(),e=De.identifierPrefix;if(pe){var n=bn,r=En;n=(r&~(1<<32-Ut(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=$o++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=jR++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},KR={readContext:xt,useCallback:Cw,useContext:xt,useEffect:vg,useImperativeHandle:xw,useInsertionEffect:bw,useLayoutEffect:Aw,useMemo:Pw,useReducer:Vf,useRef:Ew,useState:function(){return Vf(jo)},useDebugValue:Tg,useDeferredValue:function(t){var e=Ct();return Iw(e,Me.memoizedState,t)},useTransition:function(){var t=Vf(jo)[0],e=Ct().memoizedState;return[t,e]},useMutableSource:_w,useSyncExternalStore:mw,useId:Mw,unstable_isNewReconciler:!1},qR={readContext:xt,useCallback:Cw,useContext:xt,useEffect:vg,useImperativeHandle:xw,useInsertionEffect:bw,useLayoutEffect:Aw,useMemo:Pw,useReducer:$f,useRef:Ew,useState:function(){return $f(jo)},useDebugValue:Tg,useDeferredValue:function(t){var e=Ct();return Me===null?e.memoizedState=t:Iw(e,Me.memoizedState,t)},useTransition:function(){var t=$f(jo)[0],e=Ct().memoizedState;return[t,e]},useMutableSource:_w,useSyncExternalStore:mw,useId:Mw,unstable_isNewReconciler:!1};function Ot(t,e){if(t&&t.defaultProps){e=Te({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function vd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Te({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Nu={isMounted:function(t){return(t=t._reactInternals)?si(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ge(),i=cr(t),s=Rn(r,i);s.payload=e,n!=null&&(s.callback=n),e=ar(t,s,i),e!==null&&(zt(e,t,i,r),Nl(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ge(),i=cr(t),s=Rn(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=ar(t,s,i),e!==null&&(zt(e,t,i,r),Nl(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ge(),r=cr(t),i=Rn(n,r);i.tag=2,e!=null&&(i.callback=e),e=ar(t,i,r),e!==null&&(zt(e,t,r,n),Nl(e,t,r))}};function Lm(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Do(n,r)||!Do(i,s):!0}function Fw(t,e,n){var r=!1,i=pr,s=e.contextType;return typeof s=="object"&&s!==null?s=xt(s):(i=st(e)?qr:Ze.current,r=e.contextTypes,s=(r=r!=null)?as(t,i):pr),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Nu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Um(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Nu.enqueueReplaceState(e,e.state,null)}function Td(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},hg(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=xt(s):(s=st(e)?qr:Ze.current,i.context=as(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(vd(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Nu.enqueueReplaceState(i,i.state,null),uc(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function fs(t,e){try{var n="",r=e;do n+=EA(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function jf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function wd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var ZR=typeof WeakMap=="function"?WeakMap:Map;function Dw(t,e,n){n=Rn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){gc||(gc=!0,Md=r),wd(t,e)},n}function Bw(t,e,n){n=Rn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){wd(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){wd(t,e),typeof r!="function"&&(lr===null?lr=new Set([this]):lr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function zm(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new ZR;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=ux.bind(null,t,e,n),e.then(t,t))}function Vm(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function $m(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Rn(-1,1),e.tag=2,ar(n,e,1))),n.lanes|=1),t)}var QR=Nn.ReactCurrentOwner,rt=!1;function Je(t,e,n,r){e.child=t===null?hw(e,null,n,r):cs(e,t.child,n,r)}function jm(t,e,n,r,i){n=n.render;var s=e.ref;return Ji(e,i),r=mg(t,e,n,r,s,i),n=yg(),t!==null&&!rt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,In(t,e,i)):(pe&&n&&sg(e),e.flags|=1,Je(t,e,r,i),e.child)}function Wm(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Cg(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Lw(t,e,s,r,i)):(t=Ll(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Do,n(o,r)&&t.ref===e.ref)return In(t,e,i)}return e.flags|=1,t=ur(s,r),t.ref=e.ref,t.return=e,e.child=t}function Lw(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Do(s,r)&&t.ref===e.ref)if(rt=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(rt=!0);else return e.lanes=t.lanes,In(t,e,i)}return Sd(t,e,n,r,i)}function Uw(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ce(Ui,ut),ut|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ce(Ui,ut),ut|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ce(Ui,ut),ut|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ce(Ui,ut),ut|=r;return Je(t,e,i,n),e.child}function zw(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Sd(t,e,n,r,i){var s=st(n)?qr:Ze.current;return s=as(e,s),Ji(e,i),n=mg(t,e,n,r,s,i),r=yg(),t!==null&&!rt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,In(t,e,i)):(pe&&r&&sg(e),e.flags|=1,Je(t,e,n,i),e.child)}function Hm(t,e,n,r,i){if(st(n)){var s=!0;sc(e)}else s=!1;if(Ji(e,i),e.stateNode===null)Fl(t,e),Fw(e,n,r),Td(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=xt(c):(c=st(n)?qr:Ze.current,c=as(e,c));var u=n.getDerivedStateFromProps,f=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&Um(e,o,r,c),Xn=!1;var h=e.memoizedState;o.state=h,uc(e,r,o,i),l=e.memoizedState,a!==r||h!==l||it.current||Xn?(typeof u=="function"&&(vd(e,n,u,r),l=e.memoizedState),(a=Xn||Lm(e,n,a,r,h,l,c))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,pw(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Ot(e.type,a),o.props=c,f=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=xt(l):(l=st(n)?qr:Ze.current,l=as(e,l));var d=n.getDerivedStateFromProps;(u=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==f||h!==l)&&Um(e,o,r,l),Xn=!1,h=e.memoizedState,o.state=h,uc(e,r,o,i);var _=e.memoizedState;a!==f||h!==_||it.current||Xn?(typeof d=="function"&&(vd(e,n,d,r),_=e.memoizedState),(c=Xn||Lm(e,n,c,r,h,_,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,_,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,_,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=_),o.props=r,o.state=_,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Ed(t,e,n,r,s,i)}function Ed(t,e,n,r,i,s){zw(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Im(e,n,!1),In(t,e,s);r=e.stateNode,QR.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=cs(e,t.child,null,s),e.child=cs(e,null,a,s)):Je(t,e,a,s),e.memoizedState=r.state,i&&Im(e,n,!0),e.child}function Vw(t){var e=t.stateNode;e.pendingContext?Pm(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Pm(t,e.context,!1),dg(t,e.containerInfo)}function Xm(t,e,n,r,i){return ls(),ag(i),e.flags|=256,Je(t,e,n,r),e.child}var bd={dehydrated:null,treeContext:null,retryLane:0};function Ad(t){return{baseLanes:t,cachePool:null,transitions:null}}function $w(t,e,n){var r=e.pendingProps,i=me.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ce(me,i&1),t===null)return md(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Fu(o,r,0,null),t=Hr(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Ad(n),e.memoizedState=bd,t):wg(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return JR(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ur(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=ur(a,s):(s=Hr(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Ad(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=bd,r}return s=t.child,t=s.sibling,r=ur(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function wg(t,e){return e=Fu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Qa(t,e,n,r){return r!==null&&ag(r),cs(e,t.child,null,n),t=wg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function JR(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=jf(Error(L(422))),Qa(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Fu({mode:"visible",children:r.children},i,0,null),s=Hr(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&cs(e,t.child,null,o),e.child.memoizedState=Ad(o),e.memoizedState=bd,s);if(!(e.mode&1))return Qa(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(L(419)),r=jf(s,r,void 0),Qa(t,e,o,r)}if(a=(o&t.childLanes)!==0,rt||a){if(r=De,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Pn(t,i),zt(r,t,i,-1))}return xg(),r=jf(Error(L(421))),Qa(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=fx.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,ht=or(i.nextSibling),pt=e,pe=!0,Ft=null,t!==null&&(wt[St++]=En,wt[St++]=bn,wt[St++]=Zr,En=t.id,bn=t.overflow,Zr=e),e=wg(e,r.children),e.flags|=4096,e)}function Ym(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),yd(t.return,e,n)}function Wf(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function jw(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Je(t,e,r.children,n),r=me.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ym(t,n,e);else if(t.tag===19)Ym(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ce(me,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&fc(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Wf(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&fc(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Wf(e,!0,n,null,s);break;case"together":Wf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Fl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function In(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Jr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(L(153));if(e.child!==null){for(t=e.child,n=ur(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ur(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function GR(t,e,n){switch(e.tag){case 3:Vw(e),ls();break;case 5:gw(e);break;case 1:st(e.type)&&sc(e);break;case 4:dg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ce(lc,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ce(me,me.current&1),e.flags|=128,null):n&e.child.childLanes?$w(t,e,n):(ce(me,me.current&1),t=In(t,e,n),t!==null?t.sibling:null);ce(me,me.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return jw(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ce(me,me.current),r)break;return null;case 22:case 23:return e.lanes=0,Uw(t,e,n)}return In(t,e,n)}var Ww,Rd,Hw,Xw;Ww=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Rd=function(){};Hw=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,zr(ln.current);var s=null;switch(n){case"input":i=Kh(t,i),r=Kh(t,r),s=[];break;case"select":i=Te({},i,{value:void 0}),r=Te({},r,{value:void 0}),s=[];break;case"textarea":i=Qh(t,i),r=Qh(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=rc)}Gh(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Po.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Po.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&he("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};Xw=function(t,e,n,r){n!==r&&(e.flags|=4)};function $s(t,e){if(!pe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Xe(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function ex(t,e,n){var r=e.pendingProps;switch(og(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xe(e),null;case 1:return st(e.type)&&ic(),Xe(e),null;case 3:return r=e.stateNode,us(),de(it),de(Ze),gg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(qa(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ft!==null&&(kd(Ft),Ft=null))),Rd(t,e),Xe(e),null;case 5:pg(e);var i=zr(Vo.current);if(n=e.type,t!==null&&e.stateNode!=null)Hw(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(L(166));return Xe(e),null}if(t=zr(ln.current),qa(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[tn]=e,r[Uo]=s,t=(e.mode&1)!==0,n){case"dialog":he("cancel",r),he("close",r);break;case"iframe":case"object":case"embed":he("load",r);break;case"video":case"audio":for(i=0;i<io.length;i++)he(io[i],r);break;case"source":he("error",r);break;case"img":case"image":case"link":he("error",r),he("load",r);break;case"details":he("toggle",r);break;case"input":nm(r,s),he("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},he("invalid",r);break;case"textarea":im(r,s),he("invalid",r)}Gh(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Ka(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Ka(r.textContent,a,t),i=["children",""+a]):Po.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&he("scroll",r)}switch(n){case"input":za(r),rm(r,s,!0);break;case"textarea":za(r),sm(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=rc)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=TT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[tn]=e,t[Uo]=r,Ww(t,e,!1,!1),e.stateNode=t;e:{switch(o=ed(n,r),n){case"dialog":he("cancel",t),he("close",t),i=r;break;case"iframe":case"object":case"embed":he("load",t),i=r;break;case"video":case"audio":for(i=0;i<io.length;i++)he(io[i],t);i=r;break;case"source":he("error",t),i=r;break;case"img":case"image":case"link":he("error",t),he("load",t),i=r;break;case"details":he("toggle",t),i=r;break;case"input":nm(t,r),i=Kh(t,r),he("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Te({},r,{value:void 0}),he("invalid",t);break;case"textarea":im(t,r),i=Qh(t,r),he("invalid",t);break;default:i=r}Gh(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?ET(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&wT(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Io(t,l):typeof l=="number"&&Io(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Po.hasOwnProperty(s)?l!=null&&s==="onScroll"&&he("scroll",t):l!=null&&Hp(t,s,l,o))}switch(n){case"input":za(t),rm(t,r,!1);break;case"textarea":za(t),sm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+dr(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Ki(t,!!r.multiple,s,!1):r.defaultValue!=null&&Ki(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=rc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Xe(e),null;case 6:if(t&&e.stateNode!=null)Xw(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(L(166));if(n=zr(Vo.current),zr(ln.current),qa(e)){if(r=e.stateNode,n=e.memoizedProps,r[tn]=e,(s=r.nodeValue!==n)&&(t=pt,t!==null))switch(t.tag){case 3:Ka(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ka(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[tn]=e,e.stateNode=r}return Xe(e),null;case 13:if(de(me),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(pe&&ht!==null&&e.mode&1&&!(e.flags&128))uw(),ls(),e.flags|=98560,s=!1;else if(s=qa(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(L(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(L(317));s[tn]=e}else ls(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Xe(e),s=!1}else Ft!==null&&(kd(Ft),Ft=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||me.current&1?Ne===0&&(Ne=3):xg())),e.updateQueue!==null&&(e.flags|=4),Xe(e),null);case 4:return us(),Rd(t,e),t===null&&Bo(e.stateNode.containerInfo),Xe(e),null;case 10:return ug(e.type._context),Xe(e),null;case 17:return st(e.type)&&ic(),Xe(e),null;case 19:if(de(me),s=e.memoizedState,s===null)return Xe(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)$s(s,!1);else{if(Ne!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=fc(t),o!==null){for(e.flags|=128,$s(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ce(me,me.current&1|2),e.child}t=t.sibling}s.tail!==null&&Re()>hs&&(e.flags|=128,r=!0,$s(s,!1),e.lanes=4194304)}else{if(!r)if(t=fc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),$s(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!pe)return Xe(e),null}else 2*Re()-s.renderingStartTime>hs&&n!==1073741824&&(e.flags|=128,r=!0,$s(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Re(),e.sibling=null,n=me.current,ce(me,r?n&1|2:n&1),e):(Xe(e),null);case 22:case 23:return Rg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ut&1073741824&&(Xe(e),e.subtreeFlags&6&&(e.flags|=8192)):Xe(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function tx(t,e){switch(og(e),e.tag){case 1:return st(e.type)&&ic(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return us(),de(it),de(Ze),gg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return pg(e),null;case 13:if(de(me),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(L(340));ls()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return de(me),null;case 4:return us(),null;case 10:return ug(e.type._context),null;case 22:case 23:return Rg(),null;case 24:return null;default:return null}}var Ja=!1,qe=!1,nx=typeof WeakSet=="function"?WeakSet:Set,W=null;function Li(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ae(t,e,r)}else n.current=null}function xd(t,e,n){try{n()}catch(r){Ae(t,e,r)}}var Km=!1;function rx(t,e){if(ud=ec,t=QT(),ig(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,f=t,h=null;t:for(;;){for(var d;f!==n||i!==0&&f.nodeType!==3||(a=o+i),f!==s||r!==0&&f.nodeType!==3||(l=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(d=f.firstChild)!==null;)h=f,f=d;for(;;){if(f===t)break t;if(h===n&&++c===i&&(a=o),h===s&&++u===r&&(l=o),(d=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=d}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(fd={focusedElem:t,selectionRange:n},ec=!1,W=e;W!==null;)if(e=W,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,W=t;else for(;W!==null;){e=W;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var g=_.memoizedProps,b=_.memoizedState,m=e.stateNode,p=m.getSnapshotBeforeUpdate(e.elementType===e.type?g:Ot(e.type,g),b);m.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(S){Ae(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,W=t;break}W=e.return}return _=Km,Km=!1,_}function mo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&xd(e,n,s)}i=i.next}while(i!==r)}}function Ou(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Cd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Yw(t){var e=t.alternate;e!==null&&(t.alternate=null,Yw(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[tn],delete e[Uo],delete e[pd],delete e[UR],delete e[zR])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Kw(t){return t.tag===5||t.tag===3||t.tag===4}function qm(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Kw(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Pd(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=rc));else if(r!==4&&(t=t.child,t!==null))for(Pd(t,e,n),t=t.sibling;t!==null;)Pd(t,e,n),t=t.sibling}function Id(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Id(t,e,n),t=t.sibling;t!==null;)Id(t,e,n),t=t.sibling}var Ue=null,kt=!1;function zn(t,e,n){for(n=n.child;n!==null;)qw(t,e,n),n=n.sibling}function qw(t,e,n){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(Au,n)}catch{}switch(n.tag){case 5:qe||Li(n,e);case 6:var r=Ue,i=kt;Ue=null,zn(t,e,n),Ue=r,kt=i,Ue!==null&&(kt?(t=Ue,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ue.removeChild(n.stateNode));break;case 18:Ue!==null&&(kt?(t=Ue,n=n.stateNode,t.nodeType===8?Bf(t.parentNode,n):t.nodeType===1&&Bf(t,n),ko(t)):Bf(Ue,n.stateNode));break;case 4:r=Ue,i=kt,Ue=n.stateNode.containerInfo,kt=!0,zn(t,e,n),Ue=r,kt=i;break;case 0:case 11:case 14:case 15:if(!qe&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&xd(n,e,o),i=i.next}while(i!==r)}zn(t,e,n);break;case 1:if(!qe&&(Li(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ae(n,e,a)}zn(t,e,n);break;case 21:zn(t,e,n);break;case 22:n.mode&1?(qe=(r=qe)||n.memoizedState!==null,zn(t,e,n),qe=r):zn(t,e,n);break;default:zn(t,e,n)}}function Zm(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new nx),e.forEach(function(r){var i=hx.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Nt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ue=a.stateNode,kt=!1;break e;case 3:Ue=a.stateNode.containerInfo,kt=!0;break e;case 4:Ue=a.stateNode.containerInfo,kt=!0;break e}a=a.return}if(Ue===null)throw Error(L(160));qw(s,o,i),Ue=null,kt=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Ae(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Zw(e,t),e=e.sibling}function Zw(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Nt(e,t),Yt(t),r&4){try{mo(3,t,t.return),Ou(3,t)}catch(g){Ae(t,t.return,g)}try{mo(5,t,t.return)}catch(g){Ae(t,t.return,g)}}break;case 1:Nt(e,t),Yt(t),r&512&&n!==null&&Li(n,n.return);break;case 5:if(Nt(e,t),Yt(t),r&512&&n!==null&&Li(n,n.return),t.flags&32){var i=t.stateNode;try{Io(i,"")}catch(g){Ae(t,t.return,g)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&yT(i,s),ed(a,o);var c=ed(a,s);for(o=0;o<l.length;o+=2){var u=l[o],f=l[o+1];u==="style"?ET(i,f):u==="dangerouslySetInnerHTML"?wT(i,f):u==="children"?Io(i,f):Hp(i,u,f,c)}switch(a){case"input":qh(i,s);break;case"textarea":vT(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var d=s.value;d!=null?Ki(i,!!s.multiple,d,!1):h!==!!s.multiple&&(s.defaultValue!=null?Ki(i,!!s.multiple,s.defaultValue,!0):Ki(i,!!s.multiple,s.multiple?[]:"",!1))}i[Uo]=s}catch(g){Ae(t,t.return,g)}}break;case 6:if(Nt(e,t),Yt(t),r&4){if(t.stateNode===null)throw Error(L(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(g){Ae(t,t.return,g)}}break;case 3:if(Nt(e,t),Yt(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ko(e.containerInfo)}catch(g){Ae(t,t.return,g)}break;case 4:Nt(e,t),Yt(t);break;case 13:Nt(e,t),Yt(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(bg=Re())),r&4&&Zm(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(qe=(c=qe)||u,Nt(e,t),qe=c):Nt(e,t),Yt(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(W=t,u=t.child;u!==null;){for(f=W=u;W!==null;){switch(h=W,d=h.child,h.tag){case 0:case 11:case 14:case 15:mo(4,h,h.return);break;case 1:Li(h,h.return);var _=h.stateNode;if(typeof _.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(g){Ae(r,n,g)}}break;case 5:Li(h,h.return);break;case 22:if(h.memoizedState!==null){Jm(f);continue}}d!==null?(d.return=h,W=d):Jm(f)}u=u.sibling}e:for(u=null,f=t;;){if(f.tag===5){if(u===null){u=f;try{i=f.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=f.stateNode,l=f.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=ST("display",o))}catch(g){Ae(t,t.return,g)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(g){Ae(t,t.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Nt(e,t),Yt(t),r&4&&Zm(t);break;case 21:break;default:Nt(e,t),Yt(t)}}function Yt(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Kw(n)){var r=n;break e}n=n.return}throw Error(L(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Io(i,""),r.flags&=-33);var s=qm(t);Id(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=qm(t);Pd(t,a,o);break;default:throw Error(L(161))}}catch(l){Ae(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function ix(t,e,n){W=t,Qw(t)}function Qw(t,e,n){for(var r=(t.mode&1)!==0;W!==null;){var i=W,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Ja;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||qe;a=Ja;var c=qe;if(Ja=o,(qe=l)&&!c)for(W=i;W!==null;)o=W,l=o.child,o.tag===22&&o.memoizedState!==null?Gm(i):l!==null?(l.return=o,W=l):Gm(i);for(;s!==null;)W=s,Qw(s),s=s.sibling;W=i,Ja=a,qe=c}Qm(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,W=s):Qm(t)}}function Qm(t){for(;W!==null;){var e=W;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:qe||Ou(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!qe)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Ot(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Fm(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Fm(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&ko(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}qe||e.flags&512&&Cd(e)}catch(h){Ae(e,e.return,h)}}if(e===t){W=null;break}if(n=e.sibling,n!==null){n.return=e.return,W=n;break}W=e.return}}function Jm(t){for(;W!==null;){var e=W;if(e===t){W=null;break}var n=e.sibling;if(n!==null){n.return=e.return,W=n;break}W=e.return}}function Gm(t){for(;W!==null;){var e=W;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ou(4,e)}catch(l){Ae(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Ae(e,i,l)}}var s=e.return;try{Cd(e)}catch(l){Ae(e,s,l)}break;case 5:var o=e.return;try{Cd(e)}catch(l){Ae(e,o,l)}}}catch(l){Ae(e,e.return,l)}if(e===t){W=null;break}var a=e.sibling;if(a!==null){a.return=e.return,W=a;break}W=e.return}}var sx=Math.ceil,pc=Nn.ReactCurrentDispatcher,Sg=Nn.ReactCurrentOwner,At=Nn.ReactCurrentBatchConfig,ee=0,De=null,Pe=null,ze=0,ut=0,Ui=vr(0),Ne=0,Ho=null,Jr=0,ku=0,Eg=0,yo=null,nt=null,bg=0,hs=1/0,yn=null,gc=!1,Md=null,lr=null,Ga=!1,Jn=null,_c=0,vo=0,Nd=null,Dl=-1,Bl=0;function Ge(){return ee&6?Re():Dl!==-1?Dl:Dl=Re()}function cr(t){return t.mode&1?ee&2&&ze!==0?ze&-ze:$R.transition!==null?(Bl===0&&(Bl=FT()),Bl):(t=re,t!==0||(t=window.event,t=t===void 0?16:$T(t.type)),t):1}function zt(t,e,n,r){if(50<vo)throw vo=0,Nd=null,Error(L(185));ca(t,n,r),(!(ee&2)||t!==De)&&(t===De&&(!(ee&2)&&(ku|=n),Ne===4&&Zn(t,ze)),ot(t,r),n===1&&ee===0&&!(e.mode&1)&&(hs=Re()+500,Iu&&Tr()))}function ot(t,e){var n=t.callbackNode;$A(t,e);var r=Gl(t,t===De?ze:0);if(r===0)n!==null&&lm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&lm(n),e===1)t.tag===0?VR(ey.bind(null,t)):aw(ey.bind(null,t)),BR(function(){!(ee&6)&&Tr()}),n=null;else{switch(DT(r)){case 1:n=Zp;break;case 4:n=OT;break;case 16:n=Jl;break;case 536870912:n=kT;break;default:n=Jl}n=sS(n,Jw.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Jw(t,e){if(Dl=-1,Bl=0,ee&6)throw Error(L(327));var n=t.callbackNode;if(Gi()&&t.callbackNode!==n)return null;var r=Gl(t,t===De?ze:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=mc(t,r);else{e=r;var i=ee;ee|=2;var s=eS();(De!==t||ze!==e)&&(yn=null,hs=Re()+500,Wr(t,e));do try{lx();break}catch(a){Gw(t,a)}while(1);cg(),pc.current=s,ee=i,Pe!==null?e=0:(De=null,ze=0,e=Ne)}if(e!==0){if(e===2&&(i=sd(t),i!==0&&(r=i,e=Od(t,i))),e===1)throw n=Ho,Wr(t,0),Zn(t,r),ot(t,Re()),n;if(e===6)Zn(t,r);else{if(i=t.current.alternate,!(r&30)&&!ox(i)&&(e=mc(t,r),e===2&&(s=sd(t),s!==0&&(r=s,e=Od(t,s))),e===1))throw n=Ho,Wr(t,0),Zn(t,r),ot(t,Re()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(L(345));case 2:Or(t,nt,yn);break;case 3:if(Zn(t,r),(r&130023424)===r&&(e=bg+500-Re(),10<e)){if(Gl(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Ge(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=dd(Or.bind(null,t,nt,yn),e);break}Or(t,nt,yn);break;case 4:if(Zn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Ut(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=Re()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*sx(r/1960))-r,10<r){t.timeoutHandle=dd(Or.bind(null,t,nt,yn),r);break}Or(t,nt,yn);break;case 5:Or(t,nt,yn);break;default:throw Error(L(329))}}}return ot(t,Re()),t.callbackNode===n?Jw.bind(null,t):null}function Od(t,e){var n=yo;return t.current.memoizedState.isDehydrated&&(Wr(t,e).flags|=256),t=mc(t,e),t!==2&&(e=nt,nt=n,e!==null&&kd(e)),t}function kd(t){nt===null?nt=t:nt.push.apply(nt,t)}function ox(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!jt(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zn(t,e){for(e&=~Eg,e&=~ku,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ut(e),r=1<<n;t[n]=-1,e&=~r}}function ey(t){if(ee&6)throw Error(L(327));Gi();var e=Gl(t,0);if(!(e&1))return ot(t,Re()),null;var n=mc(t,e);if(t.tag!==0&&n===2){var r=sd(t);r!==0&&(e=r,n=Od(t,r))}if(n===1)throw n=Ho,Wr(t,0),Zn(t,e),ot(t,Re()),n;if(n===6)throw Error(L(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Or(t,nt,yn),ot(t,Re()),null}function Ag(t,e){var n=ee;ee|=1;try{return t(e)}finally{ee=n,ee===0&&(hs=Re()+500,Iu&&Tr())}}function Gr(t){Jn!==null&&Jn.tag===0&&!(ee&6)&&Gi();var e=ee;ee|=1;var n=At.transition,r=re;try{if(At.transition=null,re=1,t)return t()}finally{re=r,At.transition=n,ee=e,!(ee&6)&&Tr()}}function Rg(){ut=Ui.current,de(Ui)}function Wr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,DR(n)),Pe!==null)for(n=Pe.return;n!==null;){var r=n;switch(og(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ic();break;case 3:us(),de(it),de(Ze),gg();break;case 5:pg(r);break;case 4:us();break;case 13:de(me);break;case 19:de(me);break;case 10:ug(r.type._context);break;case 22:case 23:Rg()}n=n.return}if(De=t,Pe=t=ur(t.current,null),ze=ut=e,Ne=0,Ho=null,Eg=ku=Jr=0,nt=yo=null,Ur!==null){for(e=0;e<Ur.length;e++)if(n=Ur[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ur=null}return t}function Gw(t,e){do{var n=Pe;try{if(cg(),Ol.current=dc,hc){for(var r=ve.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}hc=!1}if(Qr=0,Fe=Me=ve=null,_o=!1,$o=0,Sg.current=null,n===null||n.return===null){Ne=1,Ho=e,Pe=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=ze,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var d=Vm(o);if(d!==null){d.flags&=-257,$m(d,o,a,s,e),d.mode&1&&zm(s,c,e),e=d,l=c;var _=e.updateQueue;if(_===null){var g=new Set;g.add(l),e.updateQueue=g}else _.add(l);break e}else{if(!(e&1)){zm(s,c,e),xg();break e}l=Error(L(426))}}else if(pe&&a.mode&1){var b=Vm(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),$m(b,o,a,s,e),ag(fs(l,a));break e}}s=l=fs(l,a),Ne!==4&&(Ne=2),yo===null?yo=[s]:yo.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var m=Dw(s,l,e);km(s,m);break e;case 1:a=l;var p=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof p.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(lr===null||!lr.has(y)))){s.flags|=65536,e&=-e,s.lanes|=e;var S=Bw(s,a,e);km(s,S);break e}}s=s.return}while(s!==null)}nS(n)}catch(R){e=R,Pe===n&&n!==null&&(Pe=n=n.return);continue}break}while(1)}function eS(){var t=pc.current;return pc.current=dc,t===null?dc:t}function xg(){(Ne===0||Ne===3||Ne===2)&&(Ne=4),De===null||!(Jr&268435455)&&!(ku&268435455)||Zn(De,ze)}function mc(t,e){var n=ee;ee|=2;var r=eS();(De!==t||ze!==e)&&(yn=null,Wr(t,e));do try{ax();break}catch(i){Gw(t,i)}while(1);if(cg(),ee=n,pc.current=r,Pe!==null)throw Error(L(261));return De=null,ze=0,Ne}function ax(){for(;Pe!==null;)tS(Pe)}function lx(){for(;Pe!==null&&!OA();)tS(Pe)}function tS(t){var e=iS(t.alternate,t,ut);t.memoizedProps=t.pendingProps,e===null?nS(t):Pe=e,Sg.current=null}function nS(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=tx(n,e),n!==null){n.flags&=32767,Pe=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ne=6,Pe=null;return}}else if(n=ex(n,e,ut),n!==null){Pe=n;return}if(e=e.sibling,e!==null){Pe=e;return}Pe=e=t}while(e!==null);Ne===0&&(Ne=5)}function Or(t,e,n){var r=re,i=At.transition;try{At.transition=null,re=1,cx(t,e,n,r)}finally{At.transition=i,re=r}return null}function cx(t,e,n,r){do Gi();while(Jn!==null);if(ee&6)throw Error(L(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(L(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(jA(t,s),t===De&&(Pe=De=null,ze=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ga||(Ga=!0,sS(Jl,function(){return Gi(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=At.transition,At.transition=null;var o=re;re=1;var a=ee;ee|=4,Sg.current=null,rx(t,n),Zw(n,t),PR(fd),ec=!!ud,fd=ud=null,t.current=n,ix(n),kA(),ee=a,re=o,At.transition=s}else t.current=n;if(Ga&&(Ga=!1,Jn=t,_c=i),s=t.pendingLanes,s===0&&(lr=null),BA(n.stateNode),ot(t,Re()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(gc)throw gc=!1,t=Md,Md=null,t;return _c&1&&t.tag!==0&&Gi(),s=t.pendingLanes,s&1?t===Nd?vo++:(vo=0,Nd=t):vo=0,Tr(),null}function Gi(){if(Jn!==null){var t=DT(_c),e=At.transition,n=re;try{if(At.transition=null,re=16>t?16:t,Jn===null)var r=!1;else{if(t=Jn,Jn=null,_c=0,ee&6)throw Error(L(331));var i=ee;for(ee|=4,W=t.current;W!==null;){var s=W,o=s.child;if(W.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(W=c;W!==null;){var u=W;switch(u.tag){case 0:case 11:case 15:mo(8,u,s)}var f=u.child;if(f!==null)f.return=u,W=f;else for(;W!==null;){u=W;var h=u.sibling,d=u.return;if(Yw(u),u===c){W=null;break}if(h!==null){h.return=d,W=h;break}W=d}}}var _=s.alternate;if(_!==null){var g=_.child;if(g!==null){_.child=null;do{var b=g.sibling;g.sibling=null,g=b}while(g!==null)}}W=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,W=o;else e:for(;W!==null;){if(s=W,s.flags&2048)switch(s.tag){case 0:case 11:case 15:mo(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,W=m;break e}W=s.return}}var p=t.current;for(W=p;W!==null;){o=W;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,W=y;else e:for(o=p;W!==null;){if(a=W,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ou(9,a)}}catch(R){Ae(a,a.return,R)}if(a===o){W=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,W=S;break e}W=a.return}}if(ee=i,Tr(),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(Au,t)}catch{}r=!0}return r}finally{re=n,At.transition=e}}return!1}function ty(t,e,n){e=fs(n,e),e=Dw(t,e,1),t=ar(t,e,1),e=Ge(),t!==null&&(ca(t,1,e),ot(t,e))}function Ae(t,e,n){if(t.tag===3)ty(t,t,n);else for(;e!==null;){if(e.tag===3){ty(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(lr===null||!lr.has(r))){t=fs(n,t),t=Bw(e,t,1),e=ar(e,t,1),t=Ge(),e!==null&&(ca(e,1,t),ot(e,t));break}}e=e.return}}function ux(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ge(),t.pingedLanes|=t.suspendedLanes&n,De===t&&(ze&n)===n&&(Ne===4||Ne===3&&(ze&130023424)===ze&&500>Re()-bg?Wr(t,0):Eg|=n),ot(t,e)}function rS(t,e){e===0&&(t.mode&1?(e=ja,ja<<=1,!(ja&130023424)&&(ja=4194304)):e=1);var n=Ge();t=Pn(t,e),t!==null&&(ca(t,e,n),ot(t,n))}function fx(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),rS(t,n)}function hx(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(L(314))}r!==null&&r.delete(e),rS(t,n)}var iS;iS=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||it.current)rt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return rt=!1,GR(t,e,n);rt=!!(t.flags&131072)}else rt=!1,pe&&e.flags&1048576&&lw(e,ac,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Fl(t,e),t=e.pendingProps;var i=as(e,Ze.current);Ji(e,n),i=mg(null,e,r,t,i,n);var s=yg();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,st(r)?(s=!0,sc(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,hg(e),i.updater=Nu,e.stateNode=i,i._reactInternals=e,Td(e,r,t,n),e=Ed(null,e,r,!0,s,n)):(e.tag=0,pe&&s&&sg(e),Je(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Fl(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=px(r),t=Ot(r,t),i){case 0:e=Sd(null,e,r,t,n);break e;case 1:e=Hm(null,e,r,t,n);break e;case 11:e=jm(null,e,r,t,n);break e;case 14:e=Wm(null,e,r,Ot(r.type,t),n);break e}throw Error(L(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ot(r,i),Sd(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ot(r,i),Hm(t,e,r,i,n);case 3:e:{if(Vw(e),t===null)throw Error(L(387));r=e.pendingProps,s=e.memoizedState,i=s.element,pw(t,e),uc(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=fs(Error(L(423)),e),e=Xm(t,e,r,n,i);break e}else if(r!==i){i=fs(Error(L(424)),e),e=Xm(t,e,r,n,i);break e}else for(ht=or(e.stateNode.containerInfo.firstChild),pt=e,pe=!0,Ft=null,n=hw(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ls(),r===i){e=In(t,e,n);break e}Je(t,e,r,n)}e=e.child}return e;case 5:return gw(e),t===null&&md(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,hd(r,i)?o=null:s!==null&&hd(r,s)&&(e.flags|=32),zw(t,e),Je(t,e,o,n),e.child;case 6:return t===null&&md(e),null;case 13:return $w(t,e,n);case 4:return dg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=cs(e,null,r,n):Je(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ot(r,i),jm(t,e,r,i,n);case 7:return Je(t,e,e.pendingProps,n),e.child;case 8:return Je(t,e,e.pendingProps.children,n),e.child;case 12:return Je(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,ce(lc,r._currentValue),r._currentValue=o,s!==null)if(jt(s.value,o)){if(s.children===i.children&&!it.current){e=In(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Rn(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),yd(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(L(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),yd(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Je(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ji(e,n),i=xt(i),r=r(i),e.flags|=1,Je(t,e,r,n),e.child;case 14:return r=e.type,i=Ot(r,e.pendingProps),i=Ot(r.type,i),Wm(t,e,r,i,n);case 15:return Lw(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Ot(r,i),Fl(t,e),e.tag=1,st(r)?(t=!0,sc(e)):t=!1,Ji(e,n),Fw(e,r,i),Td(e,r,i,n),Ed(null,e,r,!0,t,n);case 19:return jw(t,e,n);case 22:return Uw(t,e,n)}throw Error(L(156,e.tag))};function sS(t,e){return NT(t,e)}function dx(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Et(t,e,n,r){return new dx(t,e,n,r)}function Cg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function px(t){if(typeof t=="function")return Cg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Yp)return 11;if(t===Kp)return 14}return 2}function ur(t,e){var n=t.alternate;return n===null?(n=Et(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ll(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Cg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Pi:return Hr(n.children,i,s,e);case Xp:o=8,i|=8;break;case Wh:return t=Et(12,n,e,i|2),t.elementType=Wh,t.lanes=s,t;case Hh:return t=Et(13,n,e,i),t.elementType=Hh,t.lanes=s,t;case Xh:return t=Et(19,n,e,i),t.elementType=Xh,t.lanes=s,t;case gT:return Fu(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case dT:o=10;break e;case pT:o=9;break e;case Yp:o=11;break e;case Kp:o=14;break e;case Hn:o=16,r=null;break e}throw Error(L(130,t==null?t:typeof t,""))}return e=Et(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Hr(t,e,n,r){return t=Et(7,t,r,e),t.lanes=n,t}function Fu(t,e,n,r){return t=Et(22,t,r,e),t.elementType=gT,t.lanes=n,t.stateNode={isHidden:!1},t}function Hf(t,e,n){return t=Et(6,t,null,e),t.lanes=n,t}function Xf(t,e,n){return e=Et(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function gx(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rf(0),this.expirationTimes=Rf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Pg(t,e,n,r,i,s,o,a,l){return t=new gx(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Et(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},hg(s),t}function _x(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ci,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function oS(t){if(!t)return pr;t=t._reactInternals;e:{if(si(t)!==t||t.tag!==1)throw Error(L(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(st(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(t.tag===1){var n=t.type;if(st(n))return ow(t,n,e)}return e}function aS(t,e,n,r,i,s,o,a,l){return t=Pg(n,r,!0,t,i,s,o,a,l),t.context=oS(null),n=t.current,r=Ge(),i=cr(n),s=Rn(r,i),s.callback=e??null,ar(n,s,i),t.current.lanes=i,ca(t,i,r),ot(t,r),t}function Du(t,e,n,r){var i=e.current,s=Ge(),o=cr(i);return n=oS(n),e.context===null?e.context=n:e.pendingContext=n,e=Rn(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ar(i,e,o),t!==null&&(zt(t,i,o,s),Nl(t,i,o)),o}function yc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ny(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Ig(t,e){ny(t,e),(t=t.alternate)&&ny(t,e)}function mx(){return null}var lS=typeof reportError=="function"?reportError:function(t){console.error(t)};function Mg(t){this._internalRoot=t}Bu.prototype.render=Mg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(L(409));Du(t,e,null,null)};Bu.prototype.unmount=Mg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Gr(function(){Du(null,t,null,null)}),e[Cn]=null}};function Bu(t){this._internalRoot=t}Bu.prototype.unstable_scheduleHydration=function(t){if(t){var e=UT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<qn.length&&e!==0&&e<qn[n].priority;n++);qn.splice(n,0,t),n===0&&VT(t)}};function Ng(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Lu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ry(){}function yx(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=yc(o);s.call(c)}}var o=aS(e,r,t,0,null,!1,!1,"",ry);return t._reactRootContainer=o,t[Cn]=o.current,Bo(t.nodeType===8?t.parentNode:t),Gr(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=yc(l);a.call(c)}}var l=Pg(t,0,!1,null,null,!1,!1,"",ry);return t._reactRootContainer=l,t[Cn]=l.current,Bo(t.nodeType===8?t.parentNode:t),Gr(function(){Du(e,l,n,r)}),l}function Uu(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=yc(o);a.call(l)}}Du(e,o,t,i)}else o=yx(n,e,t,i,r);return yc(o)}BT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ro(e.pendingLanes);n!==0&&(Qp(e,n|1),ot(e,Re()),!(ee&6)&&(hs=Re()+500,Tr()))}break;case 13:Gr(function(){var r=Pn(t,1);if(r!==null){var i=Ge();zt(r,t,1,i)}}),Ig(t,1)}};Jp=function(t){if(t.tag===13){var e=Pn(t,134217728);if(e!==null){var n=Ge();zt(e,t,134217728,n)}Ig(t,134217728)}};LT=function(t){if(t.tag===13){var e=cr(t),n=Pn(t,e);if(n!==null){var r=Ge();zt(n,t,e,r)}Ig(t,e)}};UT=function(){return re};zT=function(t,e){var n=re;try{return re=t,e()}finally{re=n}};nd=function(t,e,n){switch(e){case"input":if(qh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Pu(r);if(!i)throw Error(L(90));mT(r),qh(r,i)}}}break;case"textarea":vT(t,n);break;case"select":e=n.value,e!=null&&Ki(t,!!n.multiple,e,!1)}};RT=Ag;xT=Gr;var vx={usingClientEntryPoint:!1,Events:[fa,Oi,Pu,bT,AT,Ag]},js={findFiberByHostInstance:Lr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Tx={bundleType:js.bundleType,version:js.version,rendererPackageName:js.rendererPackageName,rendererConfig:js.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Nn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=IT(t),t===null?null:t.stateNode},findFiberByHostInstance:js.findFiberByHostInstance||mx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var el=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!el.isDisabled&&el.supportsFiber)try{Au=el.inject(Tx),an=el}catch{}}_t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vx;_t.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ng(e))throw Error(L(200));return _x(t,e,null,n)};_t.createRoot=function(t,e){if(!Ng(t))throw Error(L(299));var n=!1,r="",i=lS;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Pg(t,1,!1,null,null,n,!1,r,i),t[Cn]=e.current,Bo(t.nodeType===8?t.parentNode:t),new Mg(e)};_t.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(L(188)):(t=Object.keys(t).join(","),Error(L(268,t)));return t=IT(e),t=t===null?null:t.stateNode,t};_t.flushSync=function(t){return Gr(t)};_t.hydrate=function(t,e,n){if(!Lu(e))throw Error(L(200));return Uu(null,t,e,!0,n)};_t.hydrateRoot=function(t,e,n){if(!Ng(t))throw Error(L(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=lS;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=aS(e,null,t,1,n??null,i,!1,s,o),t[Cn]=e.current,Bo(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Bu(e)};_t.render=function(t,e,n){if(!Lu(e))throw Error(L(200));return Uu(null,t,e,!1,n)};_t.unmountComponentAtNode=function(t){if(!Lu(t))throw Error(L(40));return t._reactRootContainer?(Gr(function(){Uu(null,null,t,!1,function(){t._reactRootContainer=null,t[Cn]=null})}),!0):!1};_t.unstable_batchedUpdates=Ag;_t.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Lu(n))throw Error(L(200));if(t==null||t._reactInternals===void 0)throw Error(L(38));return Uu(t,e,n,!1,r)};_t.version="18.3.1-next-f1338f8080-20240426";function cS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(cS)}catch(t){console.error(t)}}cS(),cT.exports=_t;var da=cT.exports;const wx=bu(da);var uS,iy=da;uS=iy.createRoot,iy.hydrateRoot;const Sx="modulepreload",Ex=function(t){return"/map/"+t},sy={},bx=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=Ex(s),s in sy)return;sy[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let u=i.length-1;u>=0;u--){const f=i[u];if(f.href===s&&(!o||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":Sx,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((u,f)=>{c.addEventListener("load",u),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},Ax=I.createContext(null);function Rx(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===s}function wn(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!wn(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!wn(t[i],e[i]))return!1;return!0}return!1}function xx(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function oy(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();wn(n,r)||e.setProjection(n)}function ay(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function ly(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const Cx=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function cy(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const s=e[r.ref];if(s){i=i||Object.assign({},r),delete i.ref;for(const o of Cx)o in s&&(i[o]=s[o])}return i||r});return{...t,layers:n}}const uy={version:8,sources:{},layers:[]},fy={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Yf={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},hy={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Px=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Ix=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class ds{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const s=this.props[hy[i.type]];s?s(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const s=this.props[fy[i.type]];s&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),s(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const s=this.props[Yf[i.type]];s&&s(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=ds.savedMaps.pop();if(!r)return null;const i=r.map,s=i.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);i._container=n;const o=i._resizeObserver;o&&(o.disconnect(),o.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:a}=e;return a&&(a.bounds?i.fitBounds(a.bounds,{...a.fitBoundsOptions,duration:0}):r._updateViewState(a,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=uy}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||Mx()||null,container:e,style:cy(r)},s=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),n.gl){const u=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=u,n.gl)}const o=new this._MapClass(i);s.padding&&o.setPadding(s.padding),n.cursor&&(o.getCanvas().style.cursor=n.cursor),this._createShadowTransform(o);const a=o._render;o._render=u=>{this._inRender=!0,a.call(o,u),this._inRender=!1};const l=o._renderTaskQueue.run;o._renderTaskQueue.run=u=>{l.call(o._renderTaskQueue,u),this._onBeforeRepaint()},o.on("render",()=>this._onAfterRepaint());const c=o.fire;o.fire=this._fireEvent.bind(this,c),o.on("resize",()=>{this._renderTransform.resize(o.transform.width,o.transform.height)}),o.on("styledata",()=>{this._updateStyleComponents(this.props,{}),oy(o.transform,this._renderTransform)}),o.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const u in fy)o.on(u,this._onPointerEvent);for(const u in Yf)o.on(u,this._onCameraEvent);for(const u in hy)o.on(u,this._onEvent);this._map=o}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),ds.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=xx(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:s,pitch:o,bearing:a}=i,l=r.isMoving();l&&(i.cameraElevationReference="sea");const c=ly(i,{...ay(r.transform),...e});if(l&&(i.cameraElevationReference="ground"),c&&n){const u=this._deferredEvents;u.move=!0,u.zoom||(u.zoom=s!==i.zoom),u.rotate||(u.rotate=a!==i.bearing),u.pitch||(u.pitch=o!==i.pitch)}return l||ly(r.transform,e),c}_updateSettings(e,n){const r=this._map;let i=!1;for(const s of Px)if(s in e&&!wn(e[s],n[s])){i=!0;const o=r[`set${s[0].toUpperCase()}${s.slice(1)}`];o==null||o.call(r,e[s])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=uy,styleDiffing:i=!0}=e,s={diff:i};return"localIdeographFontFamily"in e&&(s.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(cy(r),s),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!wn(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!wn(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!wn(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const s=this._map;let o=!1;for(const a of Ix){const l=(r=e[a])!==null&&r!==void 0?r:!0,c=(i=n[a])!==null&&i!==void 0?i:!0;wn(l,c)||(o=!0,l?s[a].enable(l):s[a].disable())}return o}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const s=e.type,o=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,a=this._queryRenderedFeatures(e.point),l=a.length>0;!l&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,l&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,s=i.transform,o=typeof n=="string"?n:n.type;return o==="move"&&this._updateViewState(this.props,!1),o in Yf&&(typeof n=="object"&&(n.viewState=ay(s)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=s,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{oy(this._renderTransform,n),e.transform=n}}}ds.savedMaps=[];function Mx(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const Nx=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Ox(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const s=e.project(r);return e.transform=i,s},unproject:r=>{const i=e.transform;e.transform=t.transform;const s=e.unproject(r);return e.transform=i,s},queryTerrainElevation:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryTerrainElevation(r,i);return e.transform=s,o},queryRenderedFeatures:(r,i)=>{const s=e.transform;e.transform=t.transform;const o=e.queryRenderedFeatures(r,i);return e.transform=s,o}};for(const r of kx(e))!(r in n)&&!Nx.includes(r)&&(n[r]=e[r].bind(e));return n}function kx(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const Fx=typeof document<"u"?I.useLayoutEffect:I.useEffect,Dx=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function Bx(t,e){for(const r of Dx)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!0)}const zu=I.createContext(null);function Lx(t,e,n){const r=I.useContext(Ax),[i,s]=I.useState(null),o=I.useRef(),{current:a}=I.useRef({mapLib:null,map:null});I.useEffect(()=>{const u=t.mapLib;let f=!0,h;return Promise.resolve(u||n).then(d=>{if(!f)return;if(!d)throw new Error("Invalid mapLib");const _="Map"in d?d:d.default;if(!_.Map)throw new Error("Invalid mapLib");if(Bx(_,t),!_.supported||_.supported(t))t.reuseMaps&&(h=ds.reuse(t,o.current)),h||(h=new ds(_.Map,t,o.current)),a.map=Ox(h),a.mapLib=_,s(h),r==null||r.onMapMount(a.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(d=>{const{onError:_}=t;_?_({type:"error",target:null,originalEvent:null,error:d}):console.error(d)}),()=>{f=!1,h&&(r==null||r.onMapUnmount(t.id),t.reuseMaps?h.recycle():h.destroy())}},[]),Fx(()=>{i&&i.setProps(t)}),I.useImperativeHandle(e,()=>a.map,[i]);const l=I.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),c={height:"100%"};return I.createElement("div",{id:t.id,ref:o,style:l},i&&I.createElement(zu.Provider,{value:a},I.createElement("div",{"mapboxgl-children":"",style:c},t.children)))}const Ux=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function oi(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!Ux.test(r)?n[r]=`${i}px`:n[r]=i}}function zx(t,e){const{map:n,mapLib:r}=I.useContext(zu),i=I.useRef({props:t});i.current.props=t;const s=I.useMemo(()=>{let g=!1;I.Children.forEach(t.children,p=>{p&&(g=!0)});const b={...t,element:g?document.createElement("div"):null},m=new r.Marker(b);return m.setLngLat([t.longitude,t.latitude]),m.getElement().addEventListener("click",p=>{var y,S;(S=(y=i.current.props).onClick)===null||S===void 0||S.call(y,{type:"click",target:m,originalEvent:p})}),m.on("dragstart",p=>{var y,S;const R=p;R.lngLat=s.getLngLat(),(S=(y=i.current.props).onDragStart)===null||S===void 0||S.call(y,R)}),m.on("drag",p=>{var y,S;const R=p;R.lngLat=s.getLngLat(),(S=(y=i.current.props).onDrag)===null||S===void 0||S.call(y,R)}),m.on("dragend",p=>{var y,S;const R=p;R.lngLat=s.getLngLat(),(S=(y=i.current.props).onDragEnd)===null||S===void 0||S.call(y,R)}),m},[]);I.useEffect(()=>(s.addTo(n.getMap()),()=>{s.remove()}),[]);const{longitude:o,latitude:a,offset:l,style:c,draggable:u=!1,popup:f=null,rotation:h=0,rotationAlignment:d="auto",pitchAlignment:_="auto"}=t;return I.useEffect(()=>{oi(s.getElement(),c)},[c]),I.useImperativeHandle(e,()=>s,[]),(s.getLngLat().lng!==o||s.getLngLat().lat!==a)&&s.setLngLat([o,a]),l&&!Rx(s.getOffset(),l)&&s.setOffset(l),s.isDraggable()!==u&&s.setDraggable(u),s.getRotation()!==h&&s.setRotation(h),s.getRotationAlignment()!==d&&s.setRotationAlignment(d),s.getPitchAlignment()!==_&&s.setPitchAlignment(_),s.getPopup()!==f&&s.setPopup(f),da.createPortal(t.children,s.getElement())}I.memo(I.forwardRef(zx));function dy(t){return new Set(t?t.trim().split(/\s+/):[])}function Vx(t,e){const{map:n,mapLib:r}=I.useContext(zu),i=I.useMemo(()=>document.createElement("div"),[]),s=I.useRef({props:t});s.current.props=t;const o=I.useMemo(()=>{const a={...t},l=new r.Popup(a);return l.setLngLat([t.longitude,t.latitude]),l.once("open",c=>{var u,f;(f=(u=s.current.props).onOpen)===null||f===void 0||f.call(u,c)}),l},[]);if(I.useEffect(()=>{const a=l=>{var c,u;(u=(c=s.current.props).onClose)===null||u===void 0||u.call(c,l)};return o.on("close",a),o.setDOMContent(i).addTo(n.getMap()),()=>{o.off("close",a),o.isOpen()&&o.remove()}},[]),I.useEffect(()=>{oi(o.getElement(),t.style)},[t.style]),I.useImperativeHandle(e,()=>o,[]),o.isOpen()&&((o.getLngLat().lng!==t.longitude||o.getLngLat().lat!==t.latitude)&&o.setLngLat([t.longitude,t.latitude]),t.offset&&!wn(o.options.offset,t.offset)&&o.setOffset(t.offset),(o.options.anchor!==t.anchor||o.options.maxWidth!==t.maxWidth)&&(o.options.anchor=t.anchor,o.setMaxWidth(t.maxWidth)),o.options.className!==t.className)){const a=dy(o.options.className),l=dy(t.className);for(const c of a)l.has(c)||o.removeClassName(c);for(const c of l)a.has(c)||o.addClassName(c);o.options.className=t.className}return da.createPortal(t.children,i)}const $x=I.memo(I.forwardRef(Vx));function Cs(t,e,n,r){const i=I.useContext(zu),s=I.useMemo(()=>t(i),[]);return I.useEffect(()=>{const o=r||n||e,a=typeof e=="function"&&typeof n=="function"?e:null,l=typeof n=="function"?n:typeof e=="function"?e:null,{map:c}=i;return c.hasControl(s)||(c.addControl(s,o==null?void 0:o.position),a&&a(i)),()=>{l&&l(i),c.hasControl(s)&&c.removeControl(s)}},[]),s}function jx(t){const e=Cs(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return I.useEffect(()=>{oi(e._container,t.style)},[t.style]),null}I.memo(jx);function Wx(t){const e=Cs(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return I.useEffect(()=>{oi(e._controlContainer,t.style)},[t.style]),null}I.memo(Wx);function Hx(t,e){const n=I.useRef({props:t}),r=Cs(({mapLib:i})=>{const s=new i.GeolocateControl(t),o=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||o(a)},s.on("geolocate",a=>{var l,c;(c=(l=n.current.props).onGeolocate)===null||c===void 0||c.call(l,a)}),s.on("error",a=>{var l,c;(c=(l=n.current.props).onError)===null||c===void 0||c.call(l,a)}),s.on("outofmaxbounds",a=>{var l,c;(c=(l=n.current.props).onOutOfMaxBounds)===null||c===void 0||c.call(l,a)}),s.on("trackuserlocationstart",a=>{var l,c;(c=(l=n.current.props).onTrackUserLocationStart)===null||c===void 0||c.call(l,a)}),s.on("trackuserlocationend",a=>{var l,c;(c=(l=n.current.props).onTrackUserLocationEnd)===null||c===void 0||c.call(l,a)}),s},{position:t.position});return n.current.props=t,I.useImperativeHandle(e,()=>r,[]),I.useEffect(()=>{oi(r._container,t.style)},[t.style]),null}I.memo(I.forwardRef(Hx));function Xx(t){const e=Cs(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return I.useEffect(()=>{oi(e._container,t.style)},[t.style]),null}I.memo(Xx);function Yx(t){const e=Cs(({mapLib:s})=>new s.ScaleControl(t),{position:t.position}),n=I.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),I.useEffect(()=>{oi(e._container,i)},[i]),null}I.memo(Yx);const Kx=bx(()=>import("./maplibre-gl-55d953dc.js").then(t=>t.m),[]),qx=(()=>I.forwardRef(function(e,n){return Lx(e,n,Kx)}))(),Zx=$x;var nn=function(){return nn=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},nn.apply(this,arguments)};function fS(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function Qx(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var Ul="right-scroll-bar-position",zl="width-before-scroll-bar",Jx="with-scroll-bars-hidden",Gx="--removed-body-scroll-bar-size";function Kf(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function eC(t,e){var n=I.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}var tC=typeof window<"u"?I.useLayoutEffect:I.useEffect,py=new WeakMap;function nC(t,e){var n=eC(e||null,function(r){return t.forEach(function(i){return Kf(i,r)})});return tC(function(){var r=py.get(n);if(r){var i=new Set(r),s=new Set(t),o=n.current;i.forEach(function(a){s.has(a)||Kf(a,null)}),s.forEach(function(a){i.has(a)||Kf(a,o)})}py.set(n,t)},[t]),n}function rC(t){return t}function iC(t,e){e===void 0&&(e=rC);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var o=e(s,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(r=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(s),o=n}var l=function(){var u=o;o=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),n}}}};return i}function sC(t){t===void 0&&(t={});var e=iC(null);return e.options=nn({async:!0,ssr:!1},t),e}var hS=function(t){var e=t.sideCar,n=fS(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return I.createElement(r,nn({},n))};hS.isSideCarExport=!0;function oC(t,e){return t.useMedium(e),hS}var dS=sC(),qf=function(){},Vu=I.forwardRef(function(t,e){var n=I.useRef(null),r=I.useState({onScrollCapture:qf,onWheelCapture:qf,onTouchMoveCapture:qf}),i=r[0],s=r[1],o=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,f=t.shards,h=t.sideCar,d=t.noIsolation,_=t.inert,g=t.allowPinchZoom,b=t.as,m=b===void 0?"div":b,p=t.gapMode,y=fS(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=h,R=nC([n,e]),P=nn(nn({},y),i);return I.createElement(I.Fragment,null,u&&I.createElement(S,{sideCar:dS,removeScrollBar:c,shards:f,noIsolation:d,inert:_,setCallbacks:s,allowPinchZoom:!!g,lockRef:n,gapMode:p}),o?I.cloneElement(I.Children.only(a),nn(nn({},P),{ref:R})):I.createElement(m,nn({},P,{className:l,ref:R}),a))});Vu.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Vu.classNames={fullWidth:zl,zeroRight:Ul};var gy,aC=function(){if(gy)return gy;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function lC(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=aC();return e&&t.setAttribute("nonce",e),t}function cC(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function uC(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var fC=function(){var t=0,e=null;return{add:function(n){t==0&&(e=lC())&&(cC(e,n),uC(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},hC=function(){var t=fC();return function(e,n){I.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},pS=function(){var t=hC(),e=function(n){var r=n.styles,i=n.dynamic;return t(r,i),null};return e},dC={left:0,top:0,right:0,gap:0},Zf=function(t){return parseInt(t||"",10)||0},pC=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],i=e[t==="padding"?"paddingRight":"marginRight"];return[Zf(n),Zf(r),Zf(i)]},gC=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return dC;var e=pC(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},_C=pS(),es="data-scroll-locked",mC=function(t,e,n,r){var i=t.left,s=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(Jx,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(es,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Ul,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(zl,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Ul," .").concat(Ul,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(zl," .").concat(zl,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(es,`] {
    `).concat(Gx,": ").concat(a,`px;
  }
`)},_y=function(){var t=parseInt(document.body.getAttribute(es)||"0",10);return isFinite(t)?t:0},yC=function(){I.useEffect(function(){return document.body.setAttribute(es,(_y()+1).toString()),function(){var t=_y()-1;t<=0?document.body.removeAttribute(es):document.body.setAttribute(es,t.toString())}},[])},vC=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,i=r===void 0?"margin":r;yC();var s=I.useMemo(function(){return gC(i)},[i]);return I.createElement(_C,{styles:mC(s,!e,i,n?"":"!important")})},Fd=!1;if(typeof window<"u")try{var tl=Object.defineProperty({},"passive",{get:function(){return Fd=!0,!0}});window.addEventListener("test",tl,tl),window.removeEventListener("test",tl,tl)}catch{Fd=!1}var gi=Fd?{passive:!1}:!1,TC=function(t){return t.tagName==="TEXTAREA"},gS=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!TC(t)&&n[e]==="visible")},wC=function(t){return gS(t,"overflowY")},SC=function(t){return gS(t,"overflowX")},my=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=_S(t,r);if(i){var s=mS(t,r),o=s[1],a=s[2];if(o>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},EC=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},bC=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},_S=function(t,e){return t==="v"?wC(e):SC(e)},mS=function(t,e){return t==="v"?EC(e):bC(e)},AC=function(t,e){return t==="h"&&e==="rtl"?-1:1},RC=function(t,e,n,r,i){var s=AC(t,window.getComputedStyle(e).direction),o=s*r,a=n.target,l=e.contains(a),c=!1,u=o>0,f=0,h=0;do{var d=mS(t,a),_=d[0],g=d[1],b=d[2],m=g-b-s*_;(_||m)&&_S(t,a)&&(f+=m,h+=_),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&(i&&Math.abs(f)<1||!i&&o>f)||!u&&(i&&Math.abs(h)<1||!i&&-o>h))&&(c=!0),c},nl=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},yy=function(t){return[t.deltaX,t.deltaY]},vy=function(t){return t&&"current"in t?t.current:t},xC=function(t,e){return t[0]===e[0]&&t[1]===e[1]},CC=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},PC=0,_i=[];function IC(t){var e=I.useRef([]),n=I.useRef([0,0]),r=I.useRef(),i=I.useState(PC++)[0],s=I.useState(pS)[0],o=I.useRef(t);I.useEffect(function(){o.current=t},[t]),I.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var g=Qx([t.lockRef.current],(t.shards||[]).map(vy),!0).filter(Boolean);return g.forEach(function(b){return b.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),g.forEach(function(b){return b.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var a=I.useCallback(function(g,b){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!o.current.allowPinchZoom;var m=nl(g),p=n.current,y="deltaX"in g?g.deltaX:p[0]-m[0],S="deltaY"in g?g.deltaY:p[1]-m[1],R,P=g.target,O=Math.abs(y)>Math.abs(S)?"h":"v";if("touches"in g&&O==="h"&&P.type==="range")return!1;var k=my(O,P);if(!k)return!0;if(k?R=O:(R=O==="v"?"h":"v",k=my(O,P)),!k)return!1;if(!r.current&&"changedTouches"in g&&(y||S)&&(r.current=R),!R)return!0;var D=r.current||R;return RC(D,b,g,D==="h"?y:S,!0)},[]),l=I.useCallback(function(g){var b=g;if(!(!_i.length||_i[_i.length-1]!==s)){var m="deltaY"in b?yy(b):nl(b),p=e.current.filter(function(R){return R.name===b.type&&(R.target===b.target||b.target===R.shadowParent)&&xC(R.delta,m)})[0];if(p&&p.should){b.cancelable&&b.preventDefault();return}if(!p){var y=(o.current.shards||[]).map(vy).filter(Boolean).filter(function(R){return R.contains(b.target)}),S=y.length>0?a(b,y[0]):!o.current.noIsolation;S&&b.cancelable&&b.preventDefault()}}},[]),c=I.useCallback(function(g,b,m,p){var y={name:g,delta:b,target:m,should:p,shadowParent:MC(m)};e.current.push(y),setTimeout(function(){e.current=e.current.filter(function(S){return S!==y})},1)},[]),u=I.useCallback(function(g){n.current=nl(g),r.current=void 0},[]),f=I.useCallback(function(g){c(g.type,yy(g),g.target,a(g,t.lockRef.current))},[]),h=I.useCallback(function(g){c(g.type,nl(g),g.target,a(g,t.lockRef.current))},[]);I.useEffect(function(){return _i.push(s),t.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:h}),document.addEventListener("wheel",l,gi),document.addEventListener("touchmove",l,gi),document.addEventListener("touchstart",u,gi),function(){_i=_i.filter(function(g){return g!==s}),document.removeEventListener("wheel",l,gi),document.removeEventListener("touchmove",l,gi),document.removeEventListener("touchstart",u,gi)}},[]);var d=t.removeScrollBar,_=t.inert;return I.createElement(I.Fragment,null,_?I.createElement(s,{styles:CC(i)}):null,d?I.createElement(vC,{gapMode:t.gapMode}):null)}function MC(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const NC=oC(dS,IC);var yS=I.forwardRef(function(t,e){return I.createElement(Vu,nn({},t,{ref:e,sideCar:NC}))});yS.classNames=Vu.classNames;const Og=yS;function Ve(t){return Object.keys(t)}function Qf(t){return t&&typeof t=="object"&&!Array.isArray(t)}function kg(t,e){const n={...t},r=e;return Qf(t)&&Qf(e)&&Object.keys(e).forEach(i=>{Qf(r[i])&&i in t?n[i]=kg(n[i],r[i]):n[i]=r[i]}),n}function OC(t){return t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}function kC(t){var e;return typeof t!="string"||!t.includes("var(--mantine-scale)")?t:(e=t.match(/^calc\((.*?)\)$/))==null?void 0:e[1].split("*")[0].trim()}function Dd(t){const e=kC(t);return typeof e=="number"?e:typeof e=="string"?e.includes("calc")||e.includes("var")?e:e.includes("px")?Number(e.replace("px","")):e.includes("rem")?Number(e.replace("rem",""))*16:e.includes("em")?Number(e.replace("em",""))*16:Number(e):NaN}function Jf(t){return t==="0rem"?"0rem":`calc(${t} * var(--mantine-scale))`}function vS(t,{shouldScale:e=!1}={}){function n(r){if(r===0||r==="0")return`0${t}`;if(typeof r=="number"){const i=`${r/16}${t}`;return e?Jf(i):i}if(typeof r=="string"){if(r===""||r.startsWith("calc(")||r.startsWith("clamp(")||r.includes("rgba("))return r;if(r.includes(","))return r.split(",").map(s=>n(s)).join(",");if(r.includes(" "))return r.split(" ").map(s=>n(s)).join(" ");if(r.includes(t))return e?Jf(r):r;const i=r.replace("px","");if(!Number.isNaN(Number(i))){const s=`${Number(i)/16}${t}`;return e?Jf(s):s}}return r}return n}const F=vS("rem",{shouldScale:!0}),vc=vS("em");function $u(t){return Object.keys(t).reduce((e,n)=>(t[n]!==void 0&&(e[n]=t[n]),e),{})}function TS(t){return typeof t=="number"?!0:typeof t=="string"?t.startsWith("calc(")||t.startsWith("var(")||t.includes(" ")&&t.trim()!==""?!0:/[0-9]/.test(t.trim().replace("-","")[0]):!1}function FC(t){return Array.isArray(t)||t===null?!1:typeof t=="object"?t.type!==I.Fragment:!1}var wS={exports:{}},ju={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DC=I,BC=Symbol.for("react.element"),LC=Symbol.for("react.fragment"),UC=Object.prototype.hasOwnProperty,zC=DC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,VC={key:!0,ref:!0,__self:!0,__source:!0};function SS(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)UC.call(e,r)&&!VC.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:BC,type:t,key:s,ref:o,props:i,_owner:zC.current}}ju.Fragment=LC;ju.jsx=SS;ju.jsxs=SS;wS.exports=ju;var V=wS.exports;function Fg(t){const e=I.createContext(null);return[({children:i,value:s})=>V.jsx(e.Provider,{value:s,children:i}),()=>{const i=I.useContext(e);if(i===null)throw new Error(t);return i}]}const $C={app:100,modal:200,popover:300,overlay:400,max:9999};function pa(t){return $C[t]}function fn(t,e="size",n=!0){if(t!==void 0)return TS(t)?n?F(t):t:`var(--${e}-${t})`}function Wu(t){return fn(t,"mantine-spacing")}function Dg(t){return t===void 0?"var(--mantine-radius-default)":fn(t,"mantine-radius")}function jC(t){return fn(t,"mantine-font-size")}function WC(t){return fn(t,"mantine-line-height",!1)}function ES(t){if(t)return fn(t,"mantine-shadow",!1)}function Bg(t,e){return t in e.breakpoints?Dd(e.breakpoints[t]):Dd(t)}function Ty(t,e){const n=t.map(r=>({value:r,px:Bg(r,e)}));return n.sort((r,i)=>r.px-i.px),n}function bS(){return`mantine-${Math.random().toString(36).slice(2,11)}`}function HC(t,e){try{return t.addEventListener("change",e),()=>t.removeEventListener("change",e)}catch{return t.addListener(e),()=>t.removeListener(e)}}function XC(t,e){return typeof e=="boolean"?e:typeof window<"u"&&"matchMedia"in window?window.matchMedia(t).matches:!1}function YC(t,e,{getInitialValueInEffect:n}={getInitialValueInEffect:!0}){const[r,i]=I.useState(n?e:XC(t)),s=I.useRef();return I.useEffect(()=>{if("matchMedia"in window)return s.current=window.matchMedia(t),i(s.current.matches),HC(s.current,o=>i(o.matches))},[t]),r}const ga=typeof document<"u"?I.useLayoutEffect:I.useEffect;function AS(t,e){const n=I.useRef(!1);I.useEffect(()=>()=>{n.current=!1},[]),I.useEffect(()=>{if(n.current)return t();n.current=!0},e)}function KC({opened:t,shouldReturnFocus:e=!0}){const n=I.useRef(),r=()=>{var i;n.current&&"focus"in n.current&&typeof n.current.focus=="function"&&((i=n.current)==null||i.focus({preventScroll:!0}))};return AS(()=>{let i=-1;const s=o=>{o.key==="Tab"&&window.clearTimeout(i)};return document.addEventListener("keydown",s),t?n.current=document.activeElement:e&&(i=window.setTimeout(r,10)),()=>{window.clearTimeout(i),document.removeEventListener("keydown",s)}},[t,e]),r}function qC(t,e="body > :not(script)"){const n=bS(),r=Array.from(document.querySelectorAll(e)).map(i=>{var l;if((l=i==null?void 0:i.shadowRoot)!=null&&l.contains(t)||i.contains(t))return;const s=i.getAttribute("aria-hidden"),o=i.getAttribute("data-hidden"),a=i.getAttribute("data-focus-id");return i.setAttribute("data-focus-id",n),s===null||s==="false"?i.setAttribute("aria-hidden","true"):!o&&!a&&i.setAttribute("data-hidden",s),{node:i,ariaHidden:o||null}});return()=>{r.forEach(i=>{!i||n!==i.node.getAttribute("data-focus-id")||(i.ariaHidden===null?i.node.removeAttribute("aria-hidden"):i.node.setAttribute("aria-hidden",i.ariaHidden),i.node.removeAttribute("data-focus-id"),i.node.removeAttribute("data-hidden"))})}}const ZC=/input|select|textarea|button|object/,RS="a, input, select, textarea, button, object, [tabindex]";function QC(t){return t.style.display==="none"}function JC(t){if(t.getAttribute("aria-hidden")||t.getAttribute("hidden")||t.getAttribute("type")==="hidden")return!1;let n=t;for(;n&&!(n===document.body||n.nodeType===11);){if(QC(n))return!1;n=n.parentNode}return!0}function xS(t){let e=t.getAttribute("tabindex");return e===null&&(e=void 0),parseInt(e,10)}function Bd(t){const e=t.nodeName.toLowerCase(),n=!Number.isNaN(xS(t));return(ZC.test(e)&&!t.disabled||t instanceof HTMLAnchorElement&&t.href||n)&&JC(t)}function CS(t){const e=xS(t);return(Number.isNaN(e)||e>=0)&&Bd(t)}function GC(t){return Array.from(t.querySelectorAll(RS)).filter(CS)}function eP(t,e){const n=GC(t);if(!n.length){e.preventDefault();return}const r=n[e.shiftKey?0:n.length-1],i=t.getRootNode();let s=r===i.activeElement||t===i.activeElement;const o=i.activeElement;if(o.tagName==="INPUT"&&o.getAttribute("type")==="radio"&&(s=n.filter(u=>u.getAttribute("type")==="radio"&&u.getAttribute("name")===o.getAttribute("name")).includes(r)),!s)return;e.preventDefault();const l=n[e.shiftKey?n.length-1:0];l&&l.focus()}function tP(t=!0){const e=I.useRef(),n=I.useRef(null),r=s=>{let o=s.querySelector("[data-autofocus]");if(!o){const a=Array.from(s.querySelectorAll(RS));o=a.find(CS)||a.find(Bd)||null,!o&&Bd(s)&&(o=s)}o&&o.focus({preventScroll:!0})},i=I.useCallback(s=>{if(t){if(s===null){n.current&&(n.current(),n.current=null);return}n.current=qC(s),e.current!==s&&(s?(setTimeout(()=>{s.getRootNode()&&r(s)}),e.current=s):e.current=null)}},[t]);return I.useEffect(()=>{if(!t)return;e.current&&setTimeout(()=>r(e.current));const s=o=>{o.key==="Tab"&&e.current&&eP(e.current,o)};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s),n.current&&n.current()}},[t]),i}const nP=ne["useId".toString()]||(()=>{});function rP(){const t=nP();return t?`mantine-${t.replace(/:/g,"")}`:""}function iP(t){const e=rP(),[n,r]=I.useState(e);return ga(()=>{r(bS())},[]),typeof t=="string"?t:typeof window>"u"?e:n}function PS(t,e,n){I.useEffect(()=>(window.addEventListener(t,e,n),()=>window.removeEventListener(t,e,n)),[t,e])}function IS(t,e){typeof t=="function"?t(e):typeof t=="object"&&t!==null&&"current"in t&&(t.current=e)}function sP(...t){return e=>{t.forEach(n=>IS(n,e))}}function oP(...t){return I.useCallback(sP(...t),t)}function MS(t,e){return YC("(prefers-reduced-motion: reduce)",t,e)}function aP(t=!1,e){const{onOpen:n,onClose:r}=e||{},[i,s]=I.useState(t),o=I.useCallback(()=>{s(c=>c||(n==null||n(),!0))},[n]),a=I.useCallback(()=>{s(c=>c&&(r==null||r(),!1))},[r]),l=I.useCallback(()=>{i?a():o()},[a,o,i]);return[i,{open:o,close:a,toggle:l}]}function NS(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=NS(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Pt(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=NS(t))&&(r&&(r+=" "),r+=e);return r}const lP={};function cP(t){const e={};return t.forEach(n=>{Object.entries(n).forEach(([r,i])=>{e[r]?e[r]=Pt(e[r],i):e[r]=i})}),e}function Lg({theme:t,classNames:e,props:n,stylesCtx:r}){const s=(Array.isArray(e)?e:[e]).map(o=>typeof o=="function"?o(t,n,r):o||lP);return cP(s)}function Ld({theme:t,styles:e,props:n,stylesCtx:r}){return(Array.isArray(e)?e:[e]).reduce((s,o)=>typeof o=="function"?{...s,...o(t,n,r)}:{...s,...o},{})}const OS=I.createContext(null);function wr(){const t=I.useContext(OS);if(!t)throw new Error("[@mantine/core] MantineProvider was not found in tree");return t}function uP(){return wr().cssVariablesResolver}function fP(){return wr().classNamesPrefix}function Ug(){return wr().getStyleNonce}function hP(){return wr().withStaticClasses}function dP(){return wr().headless}function pP(){var t;return(t=wr().stylesTransform)==null?void 0:t.sx}function gP(){var t;return(t=wr().stylesTransform)==null?void 0:t.styles}function _P(t){return/^#?([0-9A-F]{3}){1,2}([0-9A-F]{2})?$/i.test(t)}function mP(t){let e=t.replace("#","");if(e.length===3){const o=e.split("");e=[o[0],o[0],o[1],o[1],o[2],o[2]].join("")}if(e.length===8){const o=parseInt(e.slice(6,8),16)/255;return{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16),a:o}}const n=parseInt(e,16),r=n>>16&255,i=n>>8&255,s=n&255;return{r,g:i,b:s,a:1}}function yP(t){const[e,n,r,i]=t.replace(/[^0-9,./]/g,"").split(/[/,]/).map(Number);return{r:e,g:n,b:r,a:i||1}}function vP(t){const e=/^hsla?\(\s*(\d+)\s*,\s*(\d+%)\s*,\s*(\d+%)\s*(,\s*(0?\.\d+|\d+(\.\d+)?))?\s*\)$/i,n=t.match(e);if(!n)return{r:0,g:0,b:0,a:1};const r=parseInt(n[1],10),i=parseInt(n[2],10)/100,s=parseInt(n[3],10)/100,o=n[5]?parseFloat(n[5]):void 0,a=(1-Math.abs(2*s-1))*i,l=r/60,c=a*(1-Math.abs(l%2-1)),u=s-a/2;let f,h,d;return l>=0&&l<1?(f=a,h=c,d=0):l>=1&&l<2?(f=c,h=a,d=0):l>=2&&l<3?(f=0,h=a,d=c):l>=3&&l<4?(f=0,h=c,d=a):l>=4&&l<5?(f=c,h=0,d=a):(f=a,h=0,d=c),{r:Math.round((f+u)*255),g:Math.round((h+u)*255),b:Math.round((d+u)*255),a:o||1}}function zg(t){return _P(t)?mP(t):t.startsWith("rgb")?yP(t):t.startsWith("hsl")?vP(t):{r:0,g:0,b:0,a:1}}function rl(t,e){if(t.startsWith("var("))return`color-mix(in srgb, ${t}, black ${e*100}%)`;const{r:n,g:r,b:i,a:s}=zg(t),o=1-e,a=l=>Math.round(l*o);return`rgba(${a(n)}, ${a(r)}, ${a(i)}, ${s})`}function Xo(t,e){return typeof t.primaryShade=="number"?t.primaryShade:e==="dark"?t.primaryShade.dark:t.primaryShade.light}function Gf(t){return t<=.03928?t/12.92:((t+.055)/1.055)**2.4}function TP(t){const e=t.match(/oklch\((.*?)%\s/);return e?parseFloat(e[1]):null}function wP(t){if(t.startsWith("oklch("))return(TP(t)||0)/100;const{r:e,g:n,b:r}=zg(t),i=e/255,s=n/255,o=r/255,a=Gf(i),l=Gf(s),c=Gf(o);return .2126*a+.7152*l+.0722*c}function Ws(t,e=.179){return t.startsWith("var(")?!1:wP(t)>e}function _a({color:t,theme:e,colorScheme:n}){if(typeof t!="string")throw new Error(`[@mantine/core] Failed to parse color. Expected color to be a string, instead got ${typeof t}`);if(t==="bright")return{color:t,value:n==="dark"?e.white:e.black,shade:void 0,isThemeColor:!1,isLight:Ws(n==="dark"?e.white:e.black,e.luminanceThreshold),variable:"--mantine-color-bright"};if(t==="dimmed")return{color:t,value:n==="dark"?e.colors.dark[2]:e.colors.gray[7],shade:void 0,isThemeColor:!1,isLight:Ws(n==="dark"?e.colors.dark[2]:e.colors.gray[6],e.luminanceThreshold),variable:"--mantine-color-dimmed"};if(t==="white"||t==="black")return{color:t,value:t==="white"?e.white:e.black,shade:void 0,isThemeColor:!1,isLight:Ws(t==="white"?e.white:e.black,e.luminanceThreshold),variable:`--mantine-color-${t}`};const[r,i]=t.split("."),s=i?Number(i):void 0,o=r in e.colors;if(o){const a=s!==void 0?e.colors[r][s]:e.colors[r][Xo(e,n||"light")];return{color:r,value:a,shade:s,isThemeColor:o,isLight:Ws(a,e.luminanceThreshold),variable:i?`--mantine-color-${r}-${s}`:`--mantine-color-${r}-filled`}}return{color:t,value:t,isThemeColor:o,isLight:Ws(t,e.luminanceThreshold),shade:s,variable:void 0}}function Yo(t,e){const n=_a({color:t||e.primaryColor,theme:e});return n.variable?`var(${n.variable})`:t}function Ud(t,e){const n={from:(t==null?void 0:t.from)||e.defaultGradient.from,to:(t==null?void 0:t.to)||e.defaultGradient.to,deg:(t==null?void 0:t.deg)||e.defaultGradient.deg||0},r=Yo(n.from,e),i=Yo(n.to,e);return`linear-gradient(${n.deg}deg, ${r} 0%, ${i} 100%)`}function en(t,e){if(typeof t!="string"||e>1||e<0)return"rgba(0, 0, 0, 1)";if(t.startsWith("var(")){const s=(1-e)*100;return`color-mix(in srgb, ${t}, transparent ${s}%)`}if(t.startsWith("oklch"))return t.includes("/")?t.replace(/\/\s*[\d.]+\s*\)/,`/ ${e})`):t.replace(")",` / ${e})`);const{r:n,g:r,b:i}=zg(t);return`rgba(${n}, ${r}, ${i}, ${e})`}const mi=en,SP=({color:t,theme:e,variant:n,gradient:r,autoContrast:i})=>{const s=_a({color:t,theme:e}),o=typeof i=="boolean"?i:e.autoContrast;if(n==="filled"){const a=o&&s.isLight?"var(--mantine-color-black)":"var(--mantine-color-white)";return s.isThemeColor?s.shade===void 0?{background:`var(--mantine-color-${t}-filled)`,hover:`var(--mantine-color-${t}-filled-hover)`,color:a,border:`${F(1)} solid transparent`}:{background:`var(--mantine-color-${s.color}-${s.shade})`,hover:`var(--mantine-color-${s.color}-${s.shade===9?8:s.shade+1})`,color:a,border:`${F(1)} solid transparent`}:{background:t,hover:rl(t,.1),color:a,border:`${F(1)} solid transparent`}}if(n==="light"){if(s.isThemeColor){if(s.shade===void 0)return{background:`var(--mantine-color-${t}-light)`,hover:`var(--mantine-color-${t}-light-hover)`,color:`var(--mantine-color-${t}-light-color)`,border:`${F(1)} solid transparent`};const a=e.colors[s.color][s.shade];return{background:en(a,.1),hover:en(a,.12),color:`var(--mantine-color-${s.color}-${Math.min(s.shade,6)})`,border:`${F(1)} solid transparent`}}return{background:en(t,.1),hover:en(t,.12),color:t,border:`${F(1)} solid transparent`}}if(n==="outline")return s.isThemeColor?s.shade===void 0?{background:"transparent",hover:`var(--mantine-color-${t}-outline-hover)`,color:`var(--mantine-color-${t}-outline)`,border:`${F(1)} solid var(--mantine-color-${t}-outline)`}:{background:"transparent",hover:en(e.colors[s.color][s.shade],.05),color:`var(--mantine-color-${s.color}-${s.shade})`,border:`${F(1)} solid var(--mantine-color-${s.color}-${s.shade})`}:{background:"transparent",hover:en(t,.05),color:t,border:`${F(1)} solid ${t}`};if(n==="subtle"){if(s.isThemeColor){if(s.shade===void 0)return{background:"transparent",hover:`var(--mantine-color-${t}-light-hover)`,color:`var(--mantine-color-${t}-light-color)`,border:`${F(1)} solid transparent`};const a=e.colors[s.color][s.shade];return{background:"transparent",hover:en(a,.12),color:`var(--mantine-color-${s.color}-${Math.min(s.shade,6)})`,border:`${F(1)} solid transparent`}}return{background:"transparent",hover:en(t,.12),color:t,border:`${F(1)} solid transparent`}}return n==="transparent"?s.isThemeColor?s.shade===void 0?{background:"transparent",hover:"transparent",color:`var(--mantine-color-${t}-light-color)`,border:`${F(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:`var(--mantine-color-${s.color}-${Math.min(s.shade,6)})`,border:`${F(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:t,border:`${F(1)} solid transparent`}:n==="white"?s.isThemeColor?s.shade===void 0?{background:"var(--mantine-color-white)",hover:rl(e.white,.01),color:`var(--mantine-color-${t}-filled)`,border:`${F(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:rl(e.white,.01),color:`var(--mantine-color-${s.color}-${s.shade})`,border:`${F(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:rl(e.white,.01),color:t,border:`${F(1)} solid transparent`}:n==="gradient"?{background:Ud(r,e),hover:Ud(r,e),color:"var(--mantine-color-white)",border:"none"}:n==="default"?{background:"var(--mantine-color-default)",hover:"var(--mantine-color-default-hover)",color:"var(--mantine-color-default-color)",border:`${F(1)} solid var(--mantine-color-default-border)`}:{}},EP={dark:["#C9C9C9","#b8b8b8","#828282","#696969","#424242","#3b3b3b","#2e2e2e","#242424","#1f1f1f","#141414"],gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]},wy="-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",Vg={scale:1,fontSmoothing:!0,focusRing:"auto",white:"#fff",black:"#000",colors:EP,primaryShade:{light:6,dark:8},primaryColor:"blue",variantColorResolver:SP,autoContrast:!1,luminanceThreshold:.3,fontFamily:wy,fontFamilyMonospace:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace",respectReducedMotion:!1,cursorType:"default",defaultGradient:{from:"blue",to:"cyan",deg:45},defaultRadius:"sm",activeClassName:"mantine-active",focusClassName:"",headings:{fontFamily:wy,fontWeight:"700",textWrap:"wrap",sizes:{h1:{fontSize:F(34),lineHeight:"1.3"},h2:{fontSize:F(26),lineHeight:"1.35"},h3:{fontSize:F(22),lineHeight:"1.4"},h4:{fontSize:F(18),lineHeight:"1.45"},h5:{fontSize:F(16),lineHeight:"1.5"},h6:{fontSize:F(14),lineHeight:"1.5"}}},fontSizes:{xs:F(12),sm:F(14),md:F(16),lg:F(18),xl:F(20)},lineHeights:{xs:"1.4",sm:"1.45",md:"1.55",lg:"1.6",xl:"1.65"},radius:{xs:F(2),sm:F(4),md:F(8),lg:F(16),xl:F(32)},spacing:{xs:F(10),sm:F(12),md:F(16),lg:F(20),xl:F(32)},breakpoints:{xs:"36em",sm:"48em",md:"62em",lg:"75em",xl:"88em"},shadows:{xs:`0 ${F(1)} ${F(3)} rgba(0, 0, 0, 0.05), 0 ${F(1)} ${F(2)} rgba(0, 0, 0, 0.1)`,sm:`0 ${F(1)} ${F(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${F(10)} ${F(15)} ${F(-5)}, rgba(0, 0, 0, 0.04) 0 ${F(7)} ${F(7)} ${F(-5)}`,md:`0 ${F(1)} ${F(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${F(20)} ${F(25)} ${F(-5)}, rgba(0, 0, 0, 0.04) 0 ${F(10)} ${F(10)} ${F(-5)}`,lg:`0 ${F(1)} ${F(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${F(28)} ${F(23)} ${F(-7)}, rgba(0, 0, 0, 0.04) 0 ${F(12)} ${F(12)} ${F(-7)}`,xl:`0 ${F(1)} ${F(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${F(36)} ${F(28)} ${F(-7)}, rgba(0, 0, 0, 0.04) 0 ${F(17)} ${F(17)} ${F(-7)}`},other:{},components:{}};function Sy(t){return t==="auto"||t==="dark"||t==="light"}function bP({key:t="mantine-color-scheme-value"}={}){let e;return{get:n=>{if(typeof window>"u")return n;try{const r=window.localStorage.getItem(t);return Sy(r)?r:n}catch{return n}},set:n=>{try{window.localStorage.setItem(t,n)}catch(r){console.warn("[@mantine/core] Local storage color scheme manager was unable to save color scheme.",r)}},subscribe:n=>{e=r=>{r.storageArea===window.localStorage&&r.key===t&&Sy(r.newValue)&&n(r.newValue)},window.addEventListener("storage",e)},unsubscribe:()=>{window.removeEventListener("storage",e)},clear:()=>{window.localStorage.removeItem(t)}}}const AP="[@mantine/core] MantineProvider: Invalid theme.primaryColor, it accepts only key of theme.colors, learn more – https://mantine.dev/theming/colors/#primary-color",Ey="[@mantine/core] MantineProvider: Invalid theme.primaryShade, it accepts only 0-9 integers or an object { light: 0-9, dark: 0-9 }";function eh(t){return t<0||t>9?!1:parseInt(t.toString(),10)===t}function by(t){if(!(t.primaryColor in t.colors))throw new Error(AP);if(typeof t.primaryShade=="object"&&(!eh(t.primaryShade.dark)||!eh(t.primaryShade.light)))throw new Error(Ey);if(typeof t.primaryShade=="number"&&!eh(t.primaryShade))throw new Error(Ey)}function RP(t,e){var r;if(!e)return by(t),t;const n=kg(t,e);return e.fontFamily&&!((r=e.headings)!=null&&r.fontFamily)&&(n.headings.fontFamily=e.fontFamily),by(n),n}const $g=I.createContext(null),xP=()=>I.useContext($g)||Vg;function On(){const t=I.useContext($g);if(!t)throw new Error("@mantine/core: MantineProvider was not found in component tree, make sure you have it in your app");return t}function kS({theme:t,children:e,inherit:n=!0}){const r=xP(),i=I.useMemo(()=>RP(n?r:Vg,t),[t,r,n]);return V.jsx($g.Provider,{value:i,children:e})}kS.displayName="@mantine/core/MantineThemeProvider";function CP(){const t=On(),e=Ug(),n=Ve(t.breakpoints).reduce((r,i)=>{const s=t.breakpoints[i].includes("px"),o=Dd(t.breakpoints[i]),a=s?`${o-.1}px`:vc(o-.1),l=s?`${o}px`:vc(o);return`${r}@media (max-width: ${a}) {.mantine-visible-from-${i} {display: none !important;}}@media (min-width: ${l}) {.mantine-hidden-from-${i} {display: none !important;}}`},"");return V.jsx("style",{"data-mantine-styles":"classes",nonce:e==null?void 0:e(),dangerouslySetInnerHTML:{__html:n}})}function th(t){return Object.entries(t).map(([e,n])=>`${e}: ${n};`).join("")}function Hs(t,e){return(Array.isArray(t)?t:[t]).reduce((r,i)=>`${i}{${r}}`,e)}function PP(t,e){const n=th(t.variables),r=n?Hs(e,n):"",i=th(t.dark),s=th(t.light),o=i?Hs(e===":host"?`${e}([data-mantine-color-scheme="dark"])`:`${e}[data-mantine-color-scheme="dark"]`,i):"",a=s?Hs(e===":host"?`${e}([data-mantine-color-scheme="light"])`:`${e}[data-mantine-color-scheme="light"]`,s):"";return`${r}${o}${a}`}function IP({color:t,theme:e,autoContrast:n}){return(typeof n=="boolean"?n:e.autoContrast)&&_a({color:t||e.primaryColor,theme:e}).isLight?"var(--mantine-color-black)":"var(--mantine-color-white)"}function Ay(t,e){return IP({color:t.colors[t.primaryColor][Xo(t,e)],theme:t,autoContrast:null})}function il({theme:t,color:e,colorScheme:n,name:r=e,withColorValues:i=!0}){if(!t.colors[e])return{};if(n==="light"){const a=Xo(t,"light"),l={[`--mantine-color-${r}-text`]:`var(--mantine-color-${r}-filled)`,[`--mantine-color-${r}-filled`]:`var(--mantine-color-${r}-${a})`,[`--mantine-color-${r}-filled-hover`]:`var(--mantine-color-${r}-${a===9?8:a+1})`,[`--mantine-color-${r}-light`]:mi(t.colors[e][a],.1),[`--mantine-color-${r}-light-hover`]:mi(t.colors[e][a],.12),[`--mantine-color-${r}-light-color`]:`var(--mantine-color-${r}-${a})`,[`--mantine-color-${r}-outline`]:`var(--mantine-color-${r}-${a})`,[`--mantine-color-${r}-outline-hover`]:mi(t.colors[e][a],.05)};return i?{[`--mantine-color-${r}-0`]:t.colors[e][0],[`--mantine-color-${r}-1`]:t.colors[e][1],[`--mantine-color-${r}-2`]:t.colors[e][2],[`--mantine-color-${r}-3`]:t.colors[e][3],[`--mantine-color-${r}-4`]:t.colors[e][4],[`--mantine-color-${r}-5`]:t.colors[e][5],[`--mantine-color-${r}-6`]:t.colors[e][6],[`--mantine-color-${r}-7`]:t.colors[e][7],[`--mantine-color-${r}-8`]:t.colors[e][8],[`--mantine-color-${r}-9`]:t.colors[e][9],...l}:l}const s=Xo(t,"dark"),o={[`--mantine-color-${r}-text`]:`var(--mantine-color-${r}-4)`,[`--mantine-color-${r}-filled`]:`var(--mantine-color-${r}-${s})`,[`--mantine-color-${r}-filled-hover`]:`var(--mantine-color-${r}-${s===9?8:s+1})`,[`--mantine-color-${r}-light`]:mi(t.colors[e][Math.max(0,s-2)],.15),[`--mantine-color-${r}-light-hover`]:mi(t.colors[e][Math.max(0,s-2)],.2),[`--mantine-color-${r}-light-color`]:`var(--mantine-color-${r}-${Math.max(s-5,0)})`,[`--mantine-color-${r}-outline`]:`var(--mantine-color-${r}-${Math.max(s-4,0)})`,[`--mantine-color-${r}-outline-hover`]:mi(t.colors[e][Math.max(s-4,0)],.05)};return i?{[`--mantine-color-${r}-0`]:t.colors[e][0],[`--mantine-color-${r}-1`]:t.colors[e][1],[`--mantine-color-${r}-2`]:t.colors[e][2],[`--mantine-color-${r}-3`]:t.colors[e][3],[`--mantine-color-${r}-4`]:t.colors[e][4],[`--mantine-color-${r}-5`]:t.colors[e][5],[`--mantine-color-${r}-6`]:t.colors[e][6],[`--mantine-color-${r}-7`]:t.colors[e][7],[`--mantine-color-${r}-8`]:t.colors[e][8],[`--mantine-color-${r}-9`]:t.colors[e][9],...o}:o}function MP(t){return!!t&&typeof t=="object"&&"mantine-virtual-color"in t}function yi(t,e,n){Ve(e).forEach(r=>Object.assign(t,{[`--mantine-${n}-${r}`]:e[r]}))}const FS=t=>{const e=Xo(t,"light"),n=t.defaultRadius in t.radius?t.radius[t.defaultRadius]:F(t.defaultRadius),r={variables:{"--mantine-scale":t.scale.toString(),"--mantine-cursor-type":t.cursorType,"--mantine-color-scheme":"light dark","--mantine-webkit-font-smoothing":t.fontSmoothing?"antialiased":"unset","--mantine-moz-font-smoothing":t.fontSmoothing?"grayscale":"unset","--mantine-color-white":t.white,"--mantine-color-black":t.black,"--mantine-line-height":t.lineHeights.md,"--mantine-font-family":t.fontFamily,"--mantine-font-family-monospace":t.fontFamilyMonospace,"--mantine-font-family-headings":t.headings.fontFamily,"--mantine-heading-font-weight":t.headings.fontWeight,"--mantine-heading-text-wrap":t.headings.textWrap,"--mantine-radius-default":n,"--mantine-primary-color-filled":`var(--mantine-color-${t.primaryColor}-filled)`,"--mantine-primary-color-filled-hover":`var(--mantine-color-${t.primaryColor}-filled-hover)`,"--mantine-primary-color-light":`var(--mantine-color-${t.primaryColor}-light)`,"--mantine-primary-color-light-hover":`var(--mantine-color-${t.primaryColor}-light-hover)`,"--mantine-primary-color-light-color":`var(--mantine-color-${t.primaryColor}-light-color)`},light:{"--mantine-primary-color-contrast":Ay(t,"light"),"--mantine-color-bright":"var(--mantine-color-black)","--mantine-color-text":t.black,"--mantine-color-body":t.white,"--mantine-color-error":"var(--mantine-color-red-6)","--mantine-color-placeholder":"var(--mantine-color-gray-5)","--mantine-color-anchor":`var(--mantine-color-${t.primaryColor}-${e})`,"--mantine-color-default":"var(--mantine-color-white)","--mantine-color-default-hover":"var(--mantine-color-gray-0)","--mantine-color-default-color":"var(--mantine-color-black)","--mantine-color-default-border":"var(--mantine-color-gray-4)","--mantine-color-dimmed":"var(--mantine-color-gray-6)"},dark:{"--mantine-primary-color-contrast":Ay(t,"dark"),"--mantine-color-bright":"var(--mantine-color-white)","--mantine-color-text":"var(--mantine-color-dark-0)","--mantine-color-body":"var(--mantine-color-dark-7)","--mantine-color-error":"var(--mantine-color-red-8)","--mantine-color-placeholder":"var(--mantine-color-dark-3)","--mantine-color-anchor":`var(--mantine-color-${t.primaryColor}-4)`,"--mantine-color-default":"var(--mantine-color-dark-6)","--mantine-color-default-hover":"var(--mantine-color-dark-5)","--mantine-color-default-color":"var(--mantine-color-white)","--mantine-color-default-border":"var(--mantine-color-dark-4)","--mantine-color-dimmed":"var(--mantine-color-dark-2)"}};yi(r.variables,t.breakpoints,"breakpoint"),yi(r.variables,t.spacing,"spacing"),yi(r.variables,t.fontSizes,"font-size"),yi(r.variables,t.lineHeights,"line-height"),yi(r.variables,t.shadows,"shadow"),yi(r.variables,t.radius,"radius"),t.colors[t.primaryColor].forEach((s,o)=>{r.variables[`--mantine-primary-color-${o}`]=`var(--mantine-color-${t.primaryColor}-${o})`}),Ve(t.colors).forEach(s=>{const o=t.colors[s];if(MP(o)){Object.assign(r.light,il({theme:t,name:o.name,color:o.light,colorScheme:"light",withColorValues:!0})),Object.assign(r.dark,il({theme:t,name:o.name,color:o.dark,colorScheme:"dark",withColorValues:!0}));return}o.forEach((a,l)=>{r.variables[`--mantine-color-${s}-${l}`]=a}),Object.assign(r.light,il({theme:t,color:s,colorScheme:"light",withColorValues:!1})),Object.assign(r.dark,il({theme:t,color:s,colorScheme:"dark",withColorValues:!1}))});const i=t.headings.sizes;return Ve(i).forEach(s=>{r.variables[`--mantine-${s}-font-size`]=i[s].fontSize,r.variables[`--mantine-${s}-line-height`]=i[s].lineHeight,r.variables[`--mantine-${s}-font-weight`]=i[s].fontWeight||t.headings.fontWeight}),r};function NP({theme:t,generator:e}){const n=FS(t),r=e==null?void 0:e(t);return r?kg(n,r):n}const nh=FS(Vg);function OP(t){const e={variables:{},light:{},dark:{}};return Ve(t.variables).forEach(n=>{nh.variables[n]!==t.variables[n]&&(e.variables[n]=t.variables[n])}),Ve(t.light).forEach(n=>{nh.light[n]!==t.light[n]&&(e.light[n]=t.light[n])}),Ve(t.dark).forEach(n=>{nh.dark[n]!==t.dark[n]&&(e.dark[n]=t.dark[n])}),e}function kP(t){return`
  ${t}[data-mantine-color-scheme="dark"] { --mantine-color-scheme: dark; }
  ${t}[data-mantine-color-scheme="light"] { --mantine-color-scheme: light; }
`}function DS({cssVariablesSelector:t,deduplicateCssVariables:e}){const n=On(),r=Ug(),i=uP(),s=NP({theme:n,generator:i}),o=t===":root"&&e,a=o?OP(s):s,l=PP(a,t);return l?V.jsx("style",{"data-mantine-styles":!0,nonce:r==null?void 0:r(),dangerouslySetInnerHTML:{__html:`${l}${o?"":kP(t)}`}}):null}DS.displayName="@mantine/CssVariables";function FP(){const t=console.error;console.error=(...e)=>{e.length>1&&typeof e[0]=="string"&&e[0].toLowerCase().includes("extra attributes from the server")&&typeof e[1]=="string"&&e[1].toLowerCase().includes("data-mantine-color-scheme")||t(...e)}}function vi(t,e){var r;const n=t!=="auto"?t:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";(r=e())==null||r.setAttribute("data-mantine-color-scheme",n)}function DP({manager:t,defaultColorScheme:e,getRootElement:n,forceColorScheme:r}){const i=I.useRef(),[s,o]=I.useState(()=>t.get(e)),a=r||s,l=I.useCallback(u=>{r||(vi(u,n),o(u),t.set(u))},[t.set,a,r]),c=I.useCallback(()=>{o(e),vi(e,n),t.clear()},[t.clear,e]);return I.useEffect(()=>(t.subscribe(l),t.unsubscribe),[t.subscribe,t.unsubscribe]),ga(()=>{vi(t.get(e),n)},[]),I.useEffect(()=>{var f;if(r)return vi(r,n),()=>{};r===void 0&&vi(s,n),i.current=window.matchMedia("(prefers-color-scheme: dark)");const u=h=>{s==="auto"&&vi(h.matches?"dark":"light",n)};return(f=i.current)==null||f.addEventListener("change",u),()=>{var h;return(h=i.current)==null?void 0:h.removeEventListener("change",u)}},[s,r]),{colorScheme:a,setColorScheme:l,clearColorScheme:c}}function BP({respectReducedMotion:t,getRootElement:e}){ga(()=>{var n;t&&((n=e())==null||n.setAttribute("data-respect-reduced-motion","true"))},[t])}FP();function BS({theme:t,children:e,getStyleNonce:n,withStaticClasses:r=!0,withGlobalClasses:i=!0,deduplicateCssVariables:s=!0,withCssVariables:o=!0,cssVariablesSelector:a=":root",classNamesPrefix:l="mantine",colorSchemeManager:c=bP(),defaultColorScheme:u="light",getRootElement:f=()=>document.documentElement,cssVariablesResolver:h,forceColorScheme:d,stylesTransform:_}){const{colorScheme:g,setColorScheme:b,clearColorScheme:m}=DP({defaultColorScheme:u,forceColorScheme:d,manager:c,getRootElement:f});return BP({respectReducedMotion:(t==null?void 0:t.respectReducedMotion)||!1,getRootElement:f}),V.jsx(OS.Provider,{value:{colorScheme:g,setColorScheme:b,clearColorScheme:m,getRootElement:f,classNamesPrefix:l,getStyleNonce:n,cssVariablesResolver:h,cssVariablesSelector:a,withStaticClasses:r,stylesTransform:_},children:V.jsxs(kS,{theme:t,children:[o&&V.jsx(DS,{cssVariablesSelector:a,deduplicateCssVariables:s}),i&&V.jsx(CP,{}),e]})})}BS.displayName="@mantine/core/MantineProvider";const LP={always:"mantine-focus-always",auto:"mantine-focus-auto",never:"mantine-focus-never"};function UP({theme:t,options:e,unstyled:n}){return Pt((e==null?void 0:e.focusable)&&!n&&(t.focusClassName||LP[t.focusRing]),(e==null?void 0:e.active)&&!n&&t.activeClassName)}function zP({selector:t,stylesCtx:e,options:n,props:r,theme:i}){return Lg({theme:i,classNames:n==null?void 0:n.classNames,props:(n==null?void 0:n.props)||r,stylesCtx:e})[t]}function Ry({selector:t,stylesCtx:e,theme:n,classNames:r,props:i}){return Lg({theme:n,classNames:r,props:i,stylesCtx:e})[t]}function VP({rootSelector:t,selector:e,className:n}){return t===e?n:void 0}function $P({selector:t,classes:e,unstyled:n}){return n?void 0:e[t]}function jP({themeName:t,classNamesPrefix:e,selector:n,withStaticClass:r}){return r===!1?[]:t.map(i=>`${e}-${i}-${n}`)}function WP({themeName:t,theme:e,selector:n,props:r,stylesCtx:i}){return t.map(s=>{var o,a;return(a=Lg({theme:e,classNames:(o=e.components[s])==null?void 0:o.classNames,props:r,stylesCtx:i}))==null?void 0:a[n]})}function HP({options:t,classes:e,selector:n,unstyled:r}){return t!=null&&t.variant&&!r?e[`${n}--${t.variant}`]:void 0}function XP({theme:t,options:e,themeName:n,selector:r,classNamesPrefix:i,classNames:s,classes:o,unstyled:a,className:l,rootSelector:c,props:u,stylesCtx:f,withStaticClasses:h,headless:d,transformedStyles:_}){return Pt(UP({theme:t,options:e,unstyled:a||d}),WP({theme:t,themeName:n,selector:r,props:u,stylesCtx:f}),HP({options:e,classes:o,selector:r,unstyled:a}),Ry({selector:r,stylesCtx:f,theme:t,classNames:s,props:u}),Ry({selector:r,stylesCtx:f,theme:t,classNames:_,props:u}),zP({selector:r,stylesCtx:f,options:e,props:u,theme:t}),VP({rootSelector:c,selector:r,className:l}),$P({selector:r,classes:o,unstyled:a||d}),h&&!d&&jP({themeName:n,classNamesPrefix:i,selector:r,withStaticClass:e==null?void 0:e.withStaticClass}),e==null?void 0:e.className)}function YP({theme:t,themeName:e,props:n,stylesCtx:r,selector:i}){return e.map(s=>{var o;return Ld({theme:t,styles:(o=t.components[s])==null?void 0:o.styles,props:n,stylesCtx:r})[i]}).reduce((s,o)=>({...s,...o}),{})}function zd({style:t,theme:e}){return Array.isArray(t)?[...t].reduce((n,r)=>({...n,...zd({style:r,theme:e})}),{}):typeof t=="function"?t(e):t??{}}function KP(t){return t.reduce((e,n)=>(n&&Object.keys(n).forEach(r=>{e[r]={...e[r],...$u(n[r])}}),e),{})}function qP({vars:t,varsResolver:e,theme:n,props:r,stylesCtx:i,selector:s,themeName:o,headless:a}){var l;return(l=KP([a?{}:e==null?void 0:e(n,r,i),...o.map(c=>{var u,f,h;return(h=(f=(u=n.components)==null?void 0:u[c])==null?void 0:f.vars)==null?void 0:h.call(f,n,r,i)}),t==null?void 0:t(n,r,i)]))==null?void 0:l[s]}function ZP({theme:t,themeName:e,selector:n,options:r,props:i,stylesCtx:s,rootSelector:o,styles:a,style:l,vars:c,varsResolver:u,headless:f,withStylesTransform:h}){return{...!h&&YP({theme:t,themeName:e,props:i,stylesCtx:s,selector:n}),...!h&&Ld({theme:t,styles:a,props:i,stylesCtx:s})[n],...!h&&Ld({theme:t,styles:r==null?void 0:r.styles,props:(r==null?void 0:r.props)||i,stylesCtx:s})[n],...qP({theme:t,props:i,stylesCtx:s,vars:c,varsResolver:u,selector:n,themeName:e,headless:f}),...o===n?zd({style:l,theme:t}):null,...zd({style:r==null?void 0:r.style,theme:t})}}function QP({props:t,stylesCtx:e,themeName:n}){var o;const r=On(),i=(o=gP())==null?void 0:o();return{getTransformedStyles:a=>i?[...a.map(c=>i(c,{props:t,theme:r,ctx:e})),...n.map(c=>{var u;return i((u=r.components[c])==null?void 0:u.styles,{props:t,theme:r,ctx:e})})].filter(Boolean):[],withStylesTransform:!!i}}function at({name:t,classes:e,props:n,stylesCtx:r,className:i,style:s,rootSelector:o="root",unstyled:a,classNames:l,styles:c,vars:u,varsResolver:f}){const h=On(),d=fP(),_=hP(),g=dP(),b=(Array.isArray(t)?t:[t]).filter(y=>y),{withStylesTransform:m,getTransformedStyles:p}=QP({props:n,stylesCtx:r,themeName:b});return(y,S)=>({className:XP({theme:h,options:S,themeName:b,selector:y,classNamesPrefix:d,classNames:l,classes:e,unstyled:a,className:i,rootSelector:o,props:n,stylesCtx:r,withStaticClasses:_,headless:g,transformedStyles:p([S==null?void 0:S.styles,c])}),style:ZP({theme:h,themeName:b,selector:y,options:S,props:n,stylesCtx:r,rootSelector:o,styles:c,style:s,vars:u,varsResolver:f,headless:g,withStylesTransform:m})})}function ae(t,e,n){var o;const r=On(),i=(o=r.components[t])==null?void 0:o.defaultProps,s=typeof i=="function"?i(r):i;return{...e,...s,...$u(n)}}function rh(t){return Ve(t).reduce((e,n)=>t[n]!==void 0?`${e}${OC(n)}:${t[n]};`:e,"").trim()}function JP({selector:t,styles:e,media:n,container:r}){const i=e?rh(e):"",s=Array.isArray(n)?n.map(a=>`@media${a.query}{${t}{${rh(a.styles)}}}`):[],o=Array.isArray(r)?r.map(a=>`@container ${a.query}{${t}{${rh(a.styles)}}}`):[];return`${i?`${t}{${i}}`:""}${s.join("")}${o.join("")}`.trim()}function jg(t){const e=Ug();return V.jsx("style",{"data-mantine-styles":"inline",nonce:e==null?void 0:e(),dangerouslySetInnerHTML:{__html:JP(t)}})}function GP(t){const{m:e,mx:n,my:r,mt:i,mb:s,ml:o,mr:a,me:l,ms:c,p:u,px:f,py:h,pt:d,pb:_,pl:g,pr:b,pe:m,ps:p,bd:y,bg:S,c:R,opacity:P,ff:O,fz:k,fw:D,lts:z,ta:H,lh:X,fs:Y,tt:Z,td:je,w:br,miw:Bn,maw:$,h:K,mih:q,mah:fe,bgsz:le,bgp:Ln,bgr:lt,bga:Ar,pos:It,top:Se,left:dn,bottom:Ee,right:We,inset:hi,display:Rr,flex:xr,hiddenFrom:Cr,visibleFrom:Pr,lightHidden:yt,darkHidden:pn,sx:Ca,...Pa}=t;return{styleProps:$u({m:e,mx:n,my:r,mt:i,mb:s,ml:o,mr:a,me:l,ms:c,p:u,px:f,py:h,pt:d,pb:_,pl:g,pr:b,pe:m,ps:p,bd:y,bg:S,c:R,opacity:P,ff:O,fz:k,fw:D,lts:z,ta:H,lh:X,fs:Y,tt:Z,td:je,w:br,miw:Bn,maw:$,h:K,mih:q,mah:fe,bgsz:le,bgp:Ln,bgr:lt,bga:Ar,pos:It,top:Se,left:dn,bottom:Ee,right:We,inset:hi,display:Rr,flex:xr,hiddenFrom:Cr,visibleFrom:Pr,lightHidden:yt,darkHidden:pn,sx:Ca}),rest:Pa}}const e3={m:{type:"spacing",property:"margin"},mt:{type:"spacing",property:"marginTop"},mb:{type:"spacing",property:"marginBottom"},ml:{type:"spacing",property:"marginLeft"},mr:{type:"spacing",property:"marginRight"},ms:{type:"spacing",property:"marginInlineStart"},me:{type:"spacing",property:"marginInlineEnd"},mx:{type:"spacing",property:"marginInline"},my:{type:"spacing",property:"marginBlock"},p:{type:"spacing",property:"padding"},pt:{type:"spacing",property:"paddingTop"},pb:{type:"spacing",property:"paddingBottom"},pl:{type:"spacing",property:"paddingLeft"},pr:{type:"spacing",property:"paddingRight"},ps:{type:"spacing",property:"paddingInlineStart"},pe:{type:"spacing",property:"paddingInlineEnd"},px:{type:"spacing",property:"paddingInline"},py:{type:"spacing",property:"paddingBlock"},bd:{type:"border",property:"border"},bg:{type:"color",property:"background"},c:{type:"textColor",property:"color"},opacity:{type:"identity",property:"opacity"},ff:{type:"fontFamily",property:"fontFamily"},fz:{type:"fontSize",property:"fontSize"},fw:{type:"identity",property:"fontWeight"},lts:{type:"size",property:"letterSpacing"},ta:{type:"identity",property:"textAlign"},lh:{type:"lineHeight",property:"lineHeight"},fs:{type:"identity",property:"fontStyle"},tt:{type:"identity",property:"textTransform"},td:{type:"identity",property:"textDecoration"},w:{type:"spacing",property:"width"},miw:{type:"spacing",property:"minWidth"},maw:{type:"spacing",property:"maxWidth"},h:{type:"spacing",property:"height"},mih:{type:"spacing",property:"minHeight"},mah:{type:"spacing",property:"maxHeight"},bgsz:{type:"size",property:"backgroundSize"},bgp:{type:"identity",property:"backgroundPosition"},bgr:{type:"identity",property:"backgroundRepeat"},bga:{type:"identity",property:"backgroundAttachment"},pos:{type:"identity",property:"position"},top:{type:"identity",property:"top"},left:{type:"size",property:"left"},bottom:{type:"size",property:"bottom"},right:{type:"size",property:"right"},inset:{type:"size",property:"inset"},display:{type:"identity",property:"display"},flex:{type:"identity",property:"flex"}};function Wg(t,e){const n=_a({color:t,theme:e});return n.color==="dimmed"?"var(--mantine-color-dimmed)":n.color==="bright"?"var(--mantine-color-bright)":n.variable?`var(${n.variable})`:n.color}function t3(t,e){const n=_a({color:t,theme:e});return n.isThemeColor&&n.shade===void 0?`var(--mantine-color-${n.color}-text)`:Wg(t,e)}function n3(t,e){if(typeof t=="number")return F(t);if(typeof t=="string"){const[n,r,...i]=t.split(" ").filter(o=>o.trim()!=="");let s=`${F(n)}`;return r&&(s+=` ${r}`),i.length>0&&(s+=` ${Wg(i.join(" "),e)}`),s.trim()}return t}const xy={text:"var(--mantine-font-family)",mono:"var(--mantine-font-family-monospace)",monospace:"var(--mantine-font-family-monospace)",heading:"var(--mantine-font-family-headings)",headings:"var(--mantine-font-family-headings)"};function r3(t){return typeof t=="string"&&t in xy?xy[t]:t}const i3=["h1","h2","h3","h4","h5","h6"];function s3(t,e){return typeof t=="string"&&t in e.fontSizes?`var(--mantine-font-size-${t})`:typeof t=="string"&&i3.includes(t)?`var(--mantine-${t}-font-size)`:typeof t=="number"||typeof t=="string"?F(t):t}function o3(t){return t}const a3=["h1","h2","h3","h4","h5","h6"];function l3(t,e){return typeof t=="string"&&t in e.lineHeights?`var(--mantine-line-height-${t})`:typeof t=="string"&&a3.includes(t)?`var(--mantine-${t}-line-height)`:t}function c3(t){return typeof t=="number"?F(t):t}function u3(t,e){if(typeof t=="number")return F(t);if(typeof t=="string"){const n=t.replace("-","");if(!(n in e.spacing))return F(t);const r=`--mantine-spacing-${n}`;return t.startsWith("-")?`calc(var(${r}) * -1)`:`var(${r})`}return t}const ih={color:Wg,textColor:t3,fontSize:s3,spacing:u3,identity:o3,size:c3,lineHeight:l3,fontFamily:r3,border:n3};function Cy(t){return t.replace("(min-width: ","").replace("em)","")}function f3({media:t,...e}){const r=Object.keys(t).sort((i,s)=>Number(Cy(i))-Number(Cy(s))).map(i=>({query:i,styles:t[i]}));return{...e,media:r}}function h3(t){if(typeof t!="object"||t===null)return!1;const e=Object.keys(t);return!(e.length===1&&e[0]==="base")}function d3(t){return typeof t=="object"&&t!==null?"base"in t?t.base:void 0:t}function p3(t){return typeof t=="object"&&t!==null?Ve(t).filter(e=>e!=="base"):[]}function g3(t,e){return typeof t=="object"&&t!==null&&e in t?t[e]:t}function LS({styleProps:t,data:e,theme:n}){return f3(Ve(t).reduce((r,i)=>{if(i==="hiddenFrom"||i==="visibleFrom"||i==="sx")return r;const s=e[i],o=Array.isArray(s.property)?s.property:[s.property],a=d3(t[i]);if(!h3(t[i]))return o.forEach(c=>{r.inlineStyles[c]=ih[s.type](a,n)}),r;r.hasResponsiveStyles=!0;const l=p3(t[i]);return o.forEach(c=>{a&&(r.styles[c]=ih[s.type](a,n)),l.forEach(u=>{const f=`(min-width: ${n.breakpoints[u]})`;r.media[f]={...r.media[f],[c]:ih[s.type](g3(t[i],u),n)}})}),r},{hasResponsiveStyles:!1,styles:{},inlineStyles:{},media:{}}))}function US(){return`__m__-${I.useId().replace(/:/g,"")}`}function zS(t){return t.startsWith("data-")?t:`data-${t}`}function _3(t){return Object.keys(t).reduce((e,n)=>{const r=t[n];return r===void 0||r===""||r===!1||r===null||(e[zS(n)]=t[n]),e},{})}function VS(t){return t?typeof t=="string"?{[zS(t)]:!0}:Array.isArray(t)?[...t].reduce((e,n)=>({...e,...VS(n)}),{}):_3(t):null}function Vd(t,e){return Array.isArray(t)?[...t].reduce((n,r)=>({...n,...Vd(r,e)}),{}):typeof t=="function"?t(e):t??{}}function m3({theme:t,style:e,vars:n,styleProps:r}){const i=Vd(e,t),s=Vd(n,t);return{...i,...s,...r}}const $S=I.forwardRef(({component:t,style:e,__vars:n,className:r,variant:i,mod:s,size:o,hiddenFrom:a,visibleFrom:l,lightHidden:c,darkHidden:u,renderRoot:f,__size:h,...d},_)=>{var k;const g=On(),b=t||"div",{styleProps:m,rest:p}=GP(d),y=pP(),S=(k=y==null?void 0:y())==null?void 0:k(m.sx),R=US(),P=LS({styleProps:m,theme:g,data:e3}),O={ref:_,style:m3({theme:g,style:e,vars:n,styleProps:P.inlineStyles}),className:Pt(r,S,{[R]:P.hasResponsiveStyles,"mantine-light-hidden":c,"mantine-dark-hidden":u,[`mantine-hidden-from-${a}`]:a,[`mantine-visible-from-${l}`]:l}),"data-variant":i,"data-size":TS(o)?void 0:o||void 0,size:h,...VS(s),...p};return V.jsxs(V.Fragment,{children:[P.hasResponsiveStyles&&V.jsx(jg,{selector:`.${R}`,styles:P.styles,media:P.media}),typeof f=="function"?f(O):V.jsx(b,{...O})]})});$S.displayName="@mantine/core/Box";const we=$S;function jS(t){return t}function Ie(t){const e=I.forwardRef(t);return e.extend=jS,e.withProps=n=>{const r=I.forwardRef((i,s)=>V.jsx(e,{...n,...i,ref:s}));return r.extend=e.extend,r.displayName=`WithProps(${e.displayName})`,r},e}function ai(t){const e=I.forwardRef(t);return e.withProps=n=>{const r=I.forwardRef((i,s)=>V.jsx(e,{...n,...i,ref:s}));return r.extend=e.extend,r.displayName=`WithProps(${e.displayName})`,r},e.extend=jS,e}const y3=I.createContext({dir:"ltr",toggleDirection:()=>{},setDirection:()=>{}});function v3(){return I.useContext(y3)}var WS={root:"m_87cf2631"};const T3={__staticSelector:"UnstyledButton"},Hu=ai((t,e)=>{const n=ae("UnstyledButton",T3,t),{className:r,component:i="button",__staticSelector:s,unstyled:o,classNames:a,styles:l,style:c,...u}=n,f=at({name:s,props:n,classes:WS,className:r,style:c,classNames:a,styles:l,unstyled:o});return V.jsx(we,{...f("root",{focusable:!0}),component:i,ref:e,type:i==="button"?"button":void 0,...u})});Hu.classes=WS;Hu.displayName="@mantine/core/UnstyledButton";var HS={root:"m_515a97f8"};const w3={},Hg=Ie((t,e)=>{const n=ae("VisuallyHidden",w3,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,...c}=n,u=at({name:"VisuallyHidden",classes:HS,props:n,className:i,style:s,classNames:r,styles:o,unstyled:a});return V.jsx(we,{component:"span",ref:e,...u("root"),...c})});Hg.classes=HS;Hg.displayName="@mantine/core/VisuallyHidden";var XS={root:"m_1b7284a3"};const S3={},E3=(t,{radius:e,shadow:n})=>({root:{"--paper-radius":e===void 0?void 0:Dg(e),"--paper-shadow":ES(n)}}),Xg=ai((t,e)=>{const n=ae("Paper",S3,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,withBorder:l,vars:c,radius:u,shadow:f,variant:h,mod:d,..._}=n,g=at({name:"Paper",props:n,classes:XS,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:c,varsResolver:E3});return V.jsx(we,{ref:e,mod:[{"data-with-border":l},d],...g("root"),variant:h,..._})});Xg.classes=XS;Xg.displayName="@mantine/core/Paper";function Yg({children:t,active:e=!0,refProp:n="ref",innerRef:r}){const i=tP(e),s=oP(i,r);return FC(t)?I.cloneElement(t,{[n]:s}):t}function YS(t){return V.jsx(Hg,{tabIndex:-1,"data-autofocus":!0,...t})}Yg.displayName="@mantine/core/FocusTrap";YS.displayName="@mantine/core/FocusTrapInitialFocus";Yg.InitialFocus=YS;function b3(t){const e=document.createElement("div");return e.setAttribute("data-portal","true"),typeof t.className=="string"&&e.classList.add(...t.className.split(" ").filter(Boolean)),typeof t.style=="object"&&Object.assign(e.style,t.style),typeof t.id=="string"&&e.setAttribute("id",t.id),e}const A3={},KS=I.forwardRef((t,e)=>{const{children:n,target:r,...i}=ae("Portal",A3,t),[s,o]=I.useState(!1),a=I.useRef(null);return ga(()=>(o(!0),a.current=r?typeof r=="string"?document.querySelector(r):r:b3(i),IS(e,a.current),!r&&a.current&&document.body.appendChild(a.current),()=>{!r&&a.current&&document.body.removeChild(a.current)}),[r]),!s||!a.current?null:da.createPortal(V.jsx(V.Fragment,{children:n}),a.current)});KS.displayName="@mantine/core/Portal";function qS({withinPortal:t=!0,children:e,...n}){return t?V.jsx(KS,{...n,children:e}):V.jsx(V.Fragment,{children:e})}qS.displayName="@mantine/core/OptionalPortal";const Xs=t=>({in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:`scale(.9) translateY(${F(t==="bottom"?10:-10)})`},transitionProperty:"transform, opacity"}),sl={fade:{in:{opacity:1},out:{opacity:0},transitionProperty:"opacity"},"fade-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:`translateY(${F(30)}`},transitionProperty:"opacity, transform"},"fade-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:`translateY(${F(-30)}`},transitionProperty:"opacity, transform"},"fade-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:`translateX(${F(30)}`},transitionProperty:"opacity, transform"},"fade-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:`translateX(${F(-30)}`},transitionProperty:"opacity, transform"},scale:{in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:"scale(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-y":{in:{opacity:1,transform:"scaleY(1)"},out:{opacity:0,transform:"scaleY(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-x":{in:{opacity:1,transform:"scaleX(1)"},out:{opacity:0,transform:"scaleX(0)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"skew-up":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:`translateY(${F(-20)}) skew(-10deg, -5deg)`},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"skew-down":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:`translateY(${F(20)}) skew(-10deg, -5deg)`},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-left":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:`translateY(${F(20)}) rotate(-5deg)`},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-right":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:`translateY(${F(20)}) rotate(5deg)`},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-100%)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(100%)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"slide-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(100%)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"slide-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-100%)"},common:{transformOrigin:"right"},transitionProperty:"transform, opacity"},pop:{...Xs("bottom"),common:{transformOrigin:"center center"}},"pop-bottom-left":{...Xs("bottom"),common:{transformOrigin:"bottom left"}},"pop-bottom-right":{...Xs("bottom"),common:{transformOrigin:"bottom right"}},"pop-top-left":{...Xs("top"),common:{transformOrigin:"top left"}},"pop-top-right":{...Xs("top"),common:{transformOrigin:"top right"}}},Py={entering:"in",entered:"in",exiting:"out",exited:"out","pre-exiting":"out","pre-entering":"out"};function R3({transition:t,state:e,duration:n,timingFunction:r}){const i={transitionDuration:`${n}ms`,transitionTimingFunction:r};return typeof t=="string"?t in sl?{transitionProperty:sl[t].transitionProperty,...i,...sl[t].common,...sl[t][Py[e]]}:{}:{transitionProperty:t.transitionProperty,...i,...t.common,...t[Py[e]]}}function x3({duration:t,exitDuration:e,timingFunction:n,mounted:r,onEnter:i,onExit:s,onEntered:o,onExited:a,enterDelay:l,exitDelay:c}){const u=On(),f=MS(),h=u.respectReducedMotion?f:!1,[d,_]=I.useState(h?0:t),[g,b]=I.useState(r?"entered":"exited"),m=I.useRef(-1),p=I.useRef(-1),y=I.useRef(-1),S=P=>{const O=P?i:s,k=P?o:a;window.clearTimeout(m.current);const D=h?0:P?t:e;_(D),D===0?(typeof O=="function"&&O(),typeof k=="function"&&k(),b(P?"entered":"exited")):y.current=requestAnimationFrame(()=>{wx.flushSync(()=>{b(P?"pre-entering":"pre-exiting")}),y.current=requestAnimationFrame(()=>{typeof O=="function"&&O(),b(P?"entering":"exiting"),m.current=window.setTimeout(()=>{typeof k=="function"&&k(),b(P?"entered":"exited")},D)})})},R=P=>{if(window.clearTimeout(p.current),typeof(P?l:c)!="number"){S(P);return}p.current=window.setTimeout(()=>{S(P)},P?l:c)};return AS(()=>{R(r)},[r]),I.useEffect(()=>()=>{window.clearTimeout(m.current),cancelAnimationFrame(y.current)},[]),{transitionDuration:d,transitionStatus:g,transitionTimingFunction:n||"ease"}}function Kg({keepMounted:t,transition:e="fade",duration:n=250,exitDuration:r=n,mounted:i,children:s,timingFunction:o="ease",onExit:a,onEntered:l,onEnter:c,onExited:u,enterDelay:f,exitDelay:h}){const{transitionDuration:d,transitionStatus:_,transitionTimingFunction:g}=x3({mounted:i,exitDuration:r,duration:n,timingFunction:o,onExit:a,onEntered:l,onEnter:c,onExited:u,enterDelay:f,exitDelay:h});return d===0?i?V.jsx(V.Fragment,{children:s({})}):t?s({display:"none"}):null:_==="exited"?t?s({display:"none"}):null:V.jsx(V.Fragment,{children:s(R3({transition:e,duration:d,state:_,timingFunction:g}))})}Kg.displayName="@mantine/core/Transition";const ZS=I.forwardRef(({size:t="var(--cb-icon-size, 70%)",style:e,...n},r)=>V.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...e,width:t,height:t},ref:r,...n,children:V.jsx("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}));ZS.displayName="@mantine/core/CloseIcon";var QS={root:"m_86a44da5","root--subtle":"m_220c80f2"};const C3={variant:"subtle"},P3=(t,{size:e,radius:n,iconSize:r})=>({root:{"--cb-size":fn(e,"cb-size"),"--cb-radius":n===void 0?void 0:Dg(n),"--cb-icon-size":F(r)}}),qg=ai((t,e)=>{const n=ae("CloseButton",C3,t),{iconSize:r,children:i,vars:s,radius:o,className:a,classNames:l,style:c,styles:u,unstyled:f,"data-disabled":h,disabled:d,variant:_,icon:g,mod:b,...m}=n,p=at({name:"CloseButton",props:n,className:a,style:c,classes:QS,classNames:l,styles:u,unstyled:f,vars:s,varsResolver:P3});return V.jsxs(Hu,{ref:e,...m,unstyled:f,variant:_,disabled:d,mod:[{disabled:d||h},b],...p("root",{variant:_,active:!d&&!h}),children:[g||V.jsx(ZS,{}),i]})});qg.classes=QS;qg.displayName="@mantine/core/CloseButton";function I3(t){return I.Children.toArray(t).filter(Boolean)}var JS={root:"m_4081bf90"};const M3={preventGrowOverflow:!0,gap:"md",align:"center",justify:"flex-start",wrap:"wrap"},N3=(t,{grow:e,preventGrowOverflow:n,gap:r,align:i,justify:s,wrap:o},{childWidth:a})=>({root:{"--group-child-width":e&&n?a:void 0,"--group-gap":Wu(r),"--group-align":i,"--group-justify":s,"--group-wrap":o}}),Tc=Ie((t,e)=>{const n=ae("Group",M3,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,children:l,gap:c,align:u,justify:f,wrap:h,grow:d,preventGrowOverflow:_,vars:g,variant:b,__size:m,mod:p,...y}=n,S=I3(l),R=S.length,P=Wu(c??"md"),k={childWidth:`calc(${100/R}% - (${P} - ${P} / ${R}))`},D=at({name:"Group",props:n,stylesCtx:k,className:i,style:s,classes:JS,classNames:r,styles:o,unstyled:a,vars:g,varsResolver:N3});return V.jsx(we,{...D("root"),ref:e,variant:b,mod:[{grow:d},p],size:m,...y,children:S})});Tc.classes=JS;Tc.displayName="@mantine/core/Group";var GS={root:"m_9814e45f"};const O3={zIndex:pa("modal")},k3=(t,{gradient:e,color:n,backgroundOpacity:r,blur:i,radius:s,zIndex:o})=>({root:{"--overlay-bg":e||(n!==void 0||r!==void 0)&&en(n||"#000",r??.6)||void 0,"--overlay-filter":i?`blur(${F(i)})`:void 0,"--overlay-radius":s===void 0?void 0:Dg(s),"--overlay-z-index":o==null?void 0:o.toString()}}),Zg=ai((t,e)=>{const n=ae("Overlay",O3,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,fixed:c,center:u,children:f,radius:h,zIndex:d,gradient:_,blur:g,color:b,backgroundOpacity:m,mod:p,...y}=n,S=at({name:"Overlay",props:n,classes:GS,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:l,varsResolver:k3});return V.jsx(we,{ref:e,...S("root"),mod:[{center:u,fixed:c},p],...y,children:f})});Zg.classes=GS;Zg.displayName="@mantine/core/Overlay";const[F3,kn]=Fg("ModalBase component was not found in tree");function D3({opened:t,transitionDuration:e}){const[n,r]=I.useState(t),i=I.useRef(),o=MS()?0:e;return I.useEffect(()=>(t?(r(!0),window.clearTimeout(i.current)):o===0?r(!1):i.current=window.setTimeout(()=>r(!1),o),()=>window.clearTimeout(i.current)),[t,o]),n}function B3({id:t,transitionProps:e,opened:n,trapFocus:r,closeOnEscape:i,onClose:s,returnFocus:o}){const a=iP(t),[l,c]=I.useState(!1),[u,f]=I.useState(!1),h=typeof(e==null?void 0:e.duration)=="number"?e==null?void 0:e.duration:200,d=D3({opened:n,transitionDuration:h});return PS("keydown",_=>{var g;_.key==="Escape"&&i&&n&&((g=_.target)==null?void 0:g.getAttribute("data-mantine-stop-propagation"))!=="true"&&s()},{capture:!0}),KC({opened:n,shouldReturnFocus:r&&o}),{_id:a,titleMounted:l,bodyMounted:u,shouldLockScroll:d,setTitleMounted:c,setBodyMounted:f}}const L3=I.forwardRef(({keepMounted:t,opened:e,onClose:n,id:r,transitionProps:i,trapFocus:s,closeOnEscape:o,returnFocus:a,closeOnClickOutside:l,withinPortal:c,portalProps:u,lockScroll:f,children:h,zIndex:d,shadow:_,padding:g,__vars:b,unstyled:m,removeScrollProps:p,...y},S)=>{const{_id:R,titleMounted:P,bodyMounted:O,shouldLockScroll:k,setTitleMounted:D,setBodyMounted:z}=B3({id:r,transitionProps:i,opened:e,trapFocus:s,closeOnEscape:o,onClose:n,returnFocus:a}),{key:H,...X}=p||{};return V.jsx(qS,{...u,withinPortal:c,children:V.jsx(F3,{value:{opened:e,onClose:n,closeOnClickOutside:l,transitionProps:{...i,keepMounted:t},getTitleId:()=>`${R}-title`,getBodyId:()=>`${R}-body`,titleMounted:P,bodyMounted:O,setTitleMounted:D,setBodyMounted:z,trapFocus:s,closeOnEscape:o,zIndex:d,unstyled:m},children:V.jsx(Og,{enabled:k&&f,...X,children:V.jsx(we,{ref:S,...y,__vars:{...b,"--mb-z-index":(d||pa("modal")).toString(),"--mb-shadow":ES(_),"--mb-padding":Wu(g)},children:h})},H)})})});function U3(){const t=kn();return I.useEffect(()=>(t.setBodyMounted(!0),()=>t.setBodyMounted(!1)),[]),t.getBodyId()}var ps={title:"m_615af6c9",header:"m_b5489c3c",inner:"m_60c222c7",content:"m_fd1ab0aa",close:"m_606cb269",body:"m_5df29311"};const eE=I.forwardRef(({className:t,...e},n)=>{const r=U3(),i=kn();return V.jsx(we,{ref:n,...e,id:r,className:Pt({[ps.body]:!i.unstyled},t)})});eE.displayName="@mantine/core/ModalBaseBody";const tE=I.forwardRef(({className:t,onClick:e,...n},r)=>{const i=kn();return V.jsx(qg,{ref:r,...n,onClick:s=>{i.onClose(),e==null||e(s)},className:Pt({[ps.close]:!i.unstyled},t),unstyled:i.unstyled})});tE.displayName="@mantine/core/ModalBaseCloseButton";const z3=I.forwardRef(({transitionProps:t,className:e,innerProps:n,onKeyDown:r,style:i,...s},o)=>{const a=kn();return V.jsx(Kg,{mounted:a.opened,transition:"pop",...a.transitionProps,...t,children:l=>V.jsx("div",{...n,className:Pt({[ps.inner]:!a.unstyled},n.className),children:V.jsx(Yg,{active:a.opened&&a.trapFocus,innerRef:o,children:V.jsx(Xg,{...s,component:"section",role:"dialog",tabIndex:-1,"aria-modal":!0,"aria-describedby":a.bodyMounted?a.getBodyId():void 0,"aria-labelledby":a.titleMounted?a.getTitleId():void 0,style:[i,l],className:Pt({[ps.content]:!a.unstyled},e),unstyled:a.unstyled,children:s.children})})})})}),nE=I.forwardRef(({className:t,...e},n)=>{const r=kn();return V.jsx(we,{component:"header",ref:n,className:Pt({[ps.header]:!r.unstyled},t),...e})});nE.displayName="@mantine/core/ModalBaseHeader";const V3={duration:200,timingFunction:"ease",transition:"fade"};function $3(t){const e=kn();return{...V3,...e.transitionProps,...t}}const rE=I.forwardRef(({onClick:t,transitionProps:e,style:n,...r},i)=>{const s=kn(),o=$3(e);return V.jsx(Kg,{mounted:s.opened,...o,transition:"fade",children:a=>V.jsx(Zg,{ref:i,fixed:!0,style:[n,a],zIndex:s.zIndex,unstyled:s.unstyled,onClick:l=>{t==null||t(l),s.closeOnClickOutside&&s.onClose()},...r})})});rE.displayName="@mantine/core/ModalBaseOverlay";function j3(){const t=kn();return I.useEffect(()=>(t.setTitleMounted(!0),()=>t.setTitleMounted(!1)),[]),t.getTitleId()}const iE=I.forwardRef(({className:t,...e},n)=>{const r=j3(),i=kn();return V.jsx(we,{component:"h2",ref:n,className:Pt({[ps.title]:!i.unstyled},t),...e,id:r})});iE.displayName="@mantine/core/ModalBaseTitle";function W3({children:t}){return V.jsx(V.Fragment,{children:t})}const H3={gap:{type:"spacing",property:"gap"},rowGap:{type:"spacing",property:"rowGap"},columnGap:{type:"spacing",property:"columnGap"},align:{type:"identity",property:"alignItems"},justify:{type:"identity",property:"justifyContent"},wrap:{type:"identity",property:"flexWrap"},direction:{type:"identity",property:"flexDirection"}};var sE={root:"m_8bffd616"};const X3={},Qg=ai((t,e)=>{const n=ae("Flex",X3,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,gap:c,rowGap:u,columnGap:f,align:h,justify:d,wrap:_,direction:g,...b}=n,m=at({name:"Flex",classes:sE,props:n,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:l}),p=On(),y=US(),S=LS({styleProps:{gap:c,rowGap:u,columnGap:f,align:h,justify:d,wrap:_,direction:g},theme:p,data:H3});return V.jsxs(V.Fragment,{children:[S.hasResponsiveStyles&&V.jsx(jg,{selector:`.${y}`,styles:S.styles,media:S.media}),V.jsx(we,{ref:e,...m("root",{className:y,style:$u(S.inlineStyles)}),...b})]})});Qg.classes=sE;Qg.displayName="@mantine/core/Flex";var oE={root:"m_b6d8b162"};function Y3(t){if(t==="start")return"start";if(t==="end"||t)return"end"}const K3={inherit:!1},q3=(t,{variant:e,lineClamp:n,gradient:r,size:i,color:s})=>({root:{"--text-fz":jC(i),"--text-lh":WC(i),"--text-gradient":e==="gradient"?Ud(r,t):void 0,"--text-line-clamp":typeof n=="number"?n.toString():void 0,"--text-color":s?Yo(s,t):void 0}}),Sn=ai((t,e)=>{const n=ae("Text",K3,t),{lineClamp:r,truncate:i,inline:s,inherit:o,gradient:a,span:l,__staticSelector:c,vars:u,className:f,style:h,classNames:d,styles:_,unstyled:g,variant:b,mod:m,size:p,...y}=n,S=at({name:["Text",c],props:n,classes:oE,className:f,style:h,classNames:d,styles:_,unstyled:g,vars:u,varsResolver:q3});return V.jsx(we,{...S("root",{focusable:!0}),ref:e,component:l?"span":"p",variant:b,mod:[{"data-truncate":Y3(i),"data-line-clamp":typeof r=="number","data-inline":s,"data-inherit":o},m],size:p,...y})});Sn.classes=oE;Sn.displayName="@mantine/core/Text";const[Z3,Ps]=Fg("AppShell was not found in tree");var Sr={root:"m_89ab340",navbar:"m_45252eee",aside:"m_9cdde9a",header:"m_3b16f56b",main:"m_8983817",footer:"m_3840c879",section:"m_6dcfc7c7"};const Q3={},Jg=Ie((t,e)=>{const n=ae("AppShellAside",Q3,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,withBorder:c,zIndex:u,mod:f,...h}=n,d=Ps();return d.disabled?null:V.jsx(we,{component:"aside",ref:e,mod:[{"with-border":c??d.withBorder},f],...d.getStyles("aside",{className:i,classNames:r,styles:o,style:s}),...h,__vars:{"--app-shell-aside-z-index":`calc(${u??d.zIndex} + 1)`}})});Jg.classes=Sr;Jg.displayName="@mantine/core/AppShellAside";const J3={},Gg=Ie((t,e)=>{var _;const n=ae("AppShellFooter",J3,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,withBorder:c,zIndex:u,mod:f,...h}=n,d=Ps();return d.disabled?null:V.jsx(we,{component:"footer",ref:e,mod:[{"with-border":c??d.withBorder},f],...d.getStyles("footer",{className:Pt({[Og.classNames.zeroRight]:d.offsetScrollbars},i),classNames:r,styles:o,style:s}),...h,__vars:{"--app-shell-footer-z-index":(_=u??d.zIndex)==null?void 0:_.toString()}})});Gg.classes=Sr;Gg.displayName="@mantine/core/AppShellFooter";const G3={},e_=Ie((t,e)=>{var _;const n=ae("AppShellHeader",G3,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,withBorder:c,zIndex:u,mod:f,...h}=n,d=Ps();return d.disabled?null:V.jsx(we,{component:"header",ref:e,mod:[{"with-border":c??d.withBorder},f],...d.getStyles("header",{className:Pt({[Og.classNames.zeroRight]:d.offsetScrollbars},i),classNames:r,styles:o,style:s}),...h,__vars:{"--app-shell-header-z-index":(_=u??d.zIndex)==null?void 0:_.toString()}})});e_.classes=Sr;e_.displayName="@mantine/core/AppShellHeader";const e2={},t_=Ie((t,e)=>{const n=ae("AppShellMain",e2,t),{classNames:r,className:i,style:s,styles:o,vars:a,...l}=n,c=Ps();return V.jsx(we,{component:"main",ref:e,...c.getStyles("main",{className:i,style:s,classNames:r,styles:o}),...l})});t_.classes=Sr;t_.displayName="@mantine/core/AppShellMain";function ma(t){return typeof t=="object"?t.base:t}function ya(t){const e=typeof t=="object"&&t!==null&&typeof t.base<"u"&&Object.keys(t).length===1;return typeof t=="number"||typeof t=="string"||e}function va(t){return!(typeof t!="object"||t===null||Object.keys(t).length===1&&"base"in t)}function t2({baseStyles:t,minMediaStyles:e,maxMediaStyles:n,aside:r,theme:i}){var l,c,u;const s=r==null?void 0:r.width,o="translateX(var(--app-shell-aside-width))",a="translateX(calc(var(--app-shell-aside-width) * -1))";if(r!=null&&r.breakpoint&&!((l=r==null?void 0:r.collapsed)!=null&&l.mobile)&&(n[r==null?void 0:r.breakpoint]=n[r==null?void 0:r.breakpoint]||{},n[r==null?void 0:r.breakpoint]["--app-shell-aside-width"]="100%",n[r==null?void 0:r.breakpoint]["--app-shell-aside-offset"]="0px"),ya(s)){const f=F(ma(s));t["--app-shell-aside-width"]=f,t["--app-shell-aside-offset"]=f}if(va(s)&&(typeof s.base<"u"&&(t["--app-shell-aside-width"]=F(s.base),t["--app-shell-aside-offset"]=F(s.base)),Ve(s).forEach(f=>{f!=="base"&&(e[f]=e[f]||{},e[f]["--app-shell-aside-width"]=F(s[f]),e[f]["--app-shell-aside-offset"]=F(s[f]))})),(c=r==null?void 0:r.collapsed)!=null&&c.desktop){const f=r.breakpoint;e[f]=e[f]||{},e[f]["--app-shell-aside-transform"]=o,e[f]["--app-shell-aside-transform-rtl"]=a,e[f]["--app-shell-aside-offset"]="0px !important"}if((u=r==null?void 0:r.collapsed)!=null&&u.mobile){const f=Bg(r.breakpoint,i)-.1;n[f]=n[f]||{},n[f]["--app-shell-aside-width"]="100%",n[f]["--app-shell-aside-offset"]="0px",n[f]["--app-shell-aside-transform"]=o,n[f]["--app-shell-aside-transform-rtl"]=a}}function n2({baseStyles:t,minMediaStyles:e,footer:n}){const r=n==null?void 0:n.height,i="translateY(var(--app-shell-footer-height))",s=(n==null?void 0:n.offset)??!0;if(ya(r)){const o=F(ma(r));t["--app-shell-footer-height"]=o,s&&(t["--app-shell-footer-offset"]=o)}va(r)&&(typeof r.base<"u"&&(t["--app-shell-footer-height"]=F(r.base),s&&(t["--app-shell-footer-offset"]=F(r.base))),Ve(r).forEach(o=>{o!=="base"&&(e[o]=e[o]||{},e[o]["--app-shell-footer-height"]=F(r[o]),s&&(e[o]["--app-shell-footer-offset"]=F(r[o])))})),n!=null&&n.collapsed&&(t["--app-shell-footer-transform"]=i,t["--app-shell-footer-offset"]="0px !important")}function r2({baseStyles:t,minMediaStyles:e,header:n}){const r=n==null?void 0:n.height,i="translateY(calc(var(--app-shell-header-height) * -1))",s=(n==null?void 0:n.offset)??!0;if(ya(r)){const o=F(ma(r));t["--app-shell-header-height"]=o,s&&(t["--app-shell-header-offset"]=o)}va(r)&&(typeof r.base<"u"&&(t["--app-shell-header-height"]=F(r.base),s&&(t["--app-shell-header-offset"]=F(r.base))),Ve(r).forEach(o=>{o!=="base"&&(e[o]=e[o]||{},e[o]["--app-shell-header-height"]=F(r[o]),s&&(e[o]["--app-shell-header-offset"]=F(r[o])))})),n!=null&&n.collapsed&&(t["--app-shell-header-transform"]=i,t["--app-shell-header-offset"]="0px !important")}function i2({baseStyles:t,minMediaStyles:e,maxMediaStyles:n,navbar:r,theme:i}){var l,c,u;const s=r==null?void 0:r.width,o="translateX(calc(var(--app-shell-navbar-width) * -1))",a="translateX(var(--app-shell-navbar-width))";if(r!=null&&r.breakpoint&&!((l=r==null?void 0:r.collapsed)!=null&&l.mobile)&&(n[r==null?void 0:r.breakpoint]=n[r==null?void 0:r.breakpoint]||{},n[r==null?void 0:r.breakpoint]["--app-shell-navbar-width"]="100%",n[r==null?void 0:r.breakpoint]["--app-shell-navbar-offset"]="0px"),ya(s)){const f=F(ma(s));t["--app-shell-navbar-width"]=f,t["--app-shell-navbar-offset"]=f}if(va(s)&&(typeof s.base<"u"&&(t["--app-shell-navbar-width"]=F(s.base),t["--app-shell-navbar-offset"]=F(s.base)),Ve(s).forEach(f=>{f!=="base"&&(e[f]=e[f]||{},e[f]["--app-shell-navbar-width"]=F(s[f]),e[f]["--app-shell-navbar-offset"]=F(s[f]))})),(c=r==null?void 0:r.collapsed)!=null&&c.desktop){const f=r.breakpoint;e[f]=e[f]||{},e[f]["--app-shell-navbar-transform"]=o,e[f]["--app-shell-navbar-transform-rtl"]=a,e[f]["--app-shell-navbar-offset"]="0px !important"}if((u=r==null?void 0:r.collapsed)!=null&&u.mobile){const f=Bg(r.breakpoint,i)-.1;n[f]=n[f]||{},n[f]["--app-shell-navbar-width"]="100%",n[f]["--app-shell-navbar-offset"]="0px",n[f]["--app-shell-navbar-transform"]=o,n[f]["--app-shell-navbar-transform-rtl"]=a}}function sh(t){return Number(t)===0?"0px":Wu(t)}function s2({padding:t,baseStyles:e,minMediaStyles:n}){ya(t)&&(e["--app-shell-padding"]=sh(ma(t))),va(t)&&(t.base&&(e["--app-shell-padding"]=sh(t.base)),Ve(t).forEach(r=>{r!=="base"&&(n[r]=n[r]||{},n[r]["--app-shell-padding"]=sh(t[r]))}))}function o2({navbar:t,header:e,footer:n,aside:r,padding:i,theme:s}){const o={},a={},l={};i2({baseStyles:l,minMediaStyles:o,maxMediaStyles:a,navbar:t,theme:s}),t2({baseStyles:l,minMediaStyles:o,maxMediaStyles:a,aside:r,theme:s}),r2({baseStyles:l,minMediaStyles:o,header:e}),n2({baseStyles:l,minMediaStyles:o,footer:n}),s2({baseStyles:l,minMediaStyles:o,padding:i});const c=Ty(Ve(o),s).map(h=>({query:`(min-width: ${vc(h.px)})`,styles:o[h.value]})),u=Ty(Ve(a),s).map(h=>({query:`(max-width: ${vc(h.px)})`,styles:a[h.value]})),f=[...c,...u];return{baseStyles:l,media:f}}function a2({navbar:t,header:e,aside:n,footer:r,padding:i}){const s=On(),o=wr(),{media:a,baseStyles:l}=o2({navbar:t,header:e,footer:r,aside:n,padding:i,theme:s});return V.jsx(jg,{media:a,styles:l,selector:o.cssVariablesSelector})}const l2={},n_=Ie((t,e)=>{const n=ae("AppShellNavbar",l2,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,withBorder:c,zIndex:u,mod:f,...h}=n,d=Ps();return d.disabled?null:V.jsx(we,{component:"nav",ref:e,mod:[{"with-border":c??d.withBorder},f],...d.getStyles("navbar",{className:i,classNames:r,styles:o,style:s}),...h,__vars:{"--app-shell-navbar-z-index":`calc(${u??d.zIndex} + 1)`}})});n_.classes=Sr;n_.displayName="@mantine/core/AppShellNavbar";const c2={},r_=ai((t,e)=>{const n=ae("AppShellSection",c2,t),{classNames:r,className:i,style:s,styles:o,vars:a,grow:l,mod:c,...u}=n,f=Ps();return V.jsx(we,{ref:e,mod:[{grow:l},c],...f.getStyles("section",{className:i,style:s,classNames:r,styles:o}),...u})});r_.classes=Sr;r_.displayName="@mantine/core/AppShellSection";function u2({transitionDuration:t,disabled:e}){const[n,r]=I.useState(!0),i=I.useRef(),s=I.useRef();return PS("resize",()=>{r(!0),clearTimeout(i.current),i.current=window.setTimeout(()=>r(!1),200)}),ga(()=>{I.startTransition(()=>{r(!0),clearTimeout(s.current),s.current=window.setTimeout(()=>r(!1),t||0)})},[e,t]),n}const f2={withBorder:!0,offsetScrollbars:!0,padding:0,transitionDuration:200,transitionTimingFunction:"ease",zIndex:pa("app")},h2=(t,{transitionDuration:e,transitionTimingFunction:n})=>({root:{"--app-shell-transition-duration":`${e}ms`,"--app-shell-transition-timing-function":n}}),Vt=Ie((t,e)=>{const n=ae("AppShell",f2,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,navbar:c,withBorder:u,padding:f,transitionDuration:h,transitionTimingFunction:d,header:_,zIndex:g,layout:b,disabled:m,aside:p,footer:y,offsetScrollbars:S,mod:R,...P}=n,O=at({name:"AppShell",classes:Sr,props:n,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:l,varsResolver:h2}),k=u2({disabled:m,transitionDuration:h});return V.jsxs(Z3,{value:{getStyles:O,withBorder:u,zIndex:g,disabled:m,offsetScrollbars:S},children:[V.jsx(a2,{navbar:c,header:_,aside:p,footer:y,padding:f}),V.jsx(we,{ref:e,...O("root"),mod:[{resizing:k,layout:b,disabled:m},R],...P})]})});Vt.classes=Sr;Vt.displayName="@mantine/core/AppShell";Vt.Navbar=n_;Vt.Header=e_;Vt.Main=t_;Vt.Aside=Jg;Vt.Footer=Gg;Vt.Section=r_;var aE={root:"m_fea6bf1a",burger:"m_d4fb9cad"};const d2={},p2=(t,{color:e,size:n,lineSize:r,transitionDuration:i,transitionTimingFunction:s})=>({root:{"--burger-color":e?Yo(e,t):void 0,"--burger-size":fn(n,"burger-size"),"--burger-line-size":r?F(r):void 0,"--burger-transition-duration":i===void 0?void 0:`${i}ms`,"--burger-transition-timing-function":s}}),i_=Ie((t,e)=>{const n=ae("Burger",d2,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,opened:c,children:u,transitionDuration:f,transitionTimingFunction:h,lineSize:d,..._}=n,g=at({name:"Burger",classes:aE,props:n,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:l,varsResolver:p2});return V.jsxs(Hu,{...g("root"),ref:e,..._,children:[V.jsx(we,{mod:["reduce-motion",{opened:c}],...g("burger")}),u]})});i_.classes=aE;i_.displayName="@mantine/core/Burger";var lE={root:"m_7485cace"};const g2={},_2=(t,{size:e,fluid:n})=>({root:{"--container-size":n?void 0:fn(e,"container-size")}}),s_=Ie((t,e)=>{const n=ae("Container",g2,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,fluid:c,mod:u,...f}=n,h=at({name:"Container",classes:lE,props:n,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:l,varsResolver:_2});return V.jsx(we,{ref:e,mod:[{fluid:c},u],...h("root"),...f})});s_.classes=lE;s_.displayName="@mantine/core/Container";var cE={root:"m_3eebeb36",label:"m_9e365f20"};const m2={orientation:"horizontal"},y2=(t,{color:e,variant:n,size:r})=>({root:{"--divider-color":e?Yo(e,t):void 0,"--divider-border-style":n,"--divider-size":fn(r,"divider-size")}}),wc=Ie((t,e)=>{const n=ae("Divider",m2,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,color:c,orientation:u,label:f,labelPosition:h,mod:d,..._}=n,g=at({name:"Divider",classes:cE,props:n,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:l,varsResolver:y2});return V.jsx(we,{ref:e,mod:[{orientation:u,"with-label":!!f},d],...g("root"),..._,role:"separator",children:f&&V.jsx(we,{component:"span",mod:{position:h},...g("label"),children:f})})});wc.classes=cE;wc.displayName="@mantine/core/Divider";const[v2,Is]=Fg("Drawer component was not found in tree");var Fn={root:"m_f11b401e",header:"m_5a7c2c9",content:"m_b8a05bbd",inner:"m_31cd769a"};const T2={},Xu=Ie((t,e)=>{const n=ae("DrawerBody",T2,t),{classNames:r,className:i,style:s,styles:o,vars:a,...l}=n,c=Is();return V.jsx(eE,{ref:e,...c.getStyles("body",{classNames:r,style:s,styles:o,className:i}),...l})});Xu.classes=Fn;Xu.displayName="@mantine/core/DrawerBody";const w2={},Yu=Ie((t,e)=>{const n=ae("DrawerCloseButton",w2,t),{classNames:r,className:i,style:s,styles:o,vars:a,...l}=n,c=Is();return V.jsx(tE,{ref:e,...c.getStyles("close",{classNames:r,style:s,styles:o,className:i}),...l})});Yu.classes=Fn;Yu.displayName="@mantine/core/DrawerCloseButton";const S2={},Ku=Ie((t,e)=>{const n=ae("DrawerContent",S2,t),{classNames:r,className:i,style:s,styles:o,vars:a,children:l,radius:c,...u}=n,f=Is(),h=f.scrollAreaComponent||W3;return V.jsx(z3,{...f.getStyles("content",{className:i,style:s,styles:o,classNames:r}),innerProps:f.getStyles("inner",{className:i,style:s,styles:o,classNames:r}),ref:e,...u,radius:c||f.radius||0,children:V.jsx(h,{style:{height:"calc(100vh - var(--drawer-offset) * 2)"},children:l})})});Ku.classes=Fn;Ku.displayName="@mantine/core/DrawerContent";const E2={},qu=Ie((t,e)=>{const n=ae("DrawerHeader",E2,t),{classNames:r,className:i,style:s,styles:o,vars:a,...l}=n,c=Is();return V.jsx(nE,{ref:e,...c.getStyles("header",{classNames:r,style:s,styles:o,className:i}),...l})});qu.classes=Fn;qu.displayName="@mantine/core/DrawerHeader";const b2={},Zu=Ie((t,e)=>{const n=ae("DrawerOverlay",b2,t),{classNames:r,className:i,style:s,styles:o,vars:a,...l}=n,c=Is();return V.jsx(rE,{ref:e,...c.getStyles("overlay",{classNames:r,style:s,styles:o,className:i}),...l})});Zu.classes=Fn;Zu.displayName="@mantine/core/DrawerOverlay";function A2(t){switch(t){case"top":return"flex-start";case"bottom":return"flex-end";default:return}}function R2(t){if(t==="top"||t==="bottom")return"0 0 calc(100% - var(--drawer-offset, 0rem) * 2)"}const x2={top:"slide-down",bottom:"slide-up",left:"slide-right",right:"slide-left"},C2={top:"slide-down",bottom:"slide-up",right:"slide-right",left:"slide-left"},P2={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:pa("modal"),position:"left"},I2=(t,{position:e,size:n,offset:r})=>({root:{"--drawer-size":fn(n,"drawer-size"),"--drawer-flex":R2(e),"--drawer-height":e==="left"||e==="right"?void 0:"var(--drawer-size)","--drawer-align":A2(e),"--drawer-justify":e==="right"?"flex-end":void 0,"--drawer-offset":F(r)}}),Qu=Ie((t,e)=>{const n=ae("DrawerRoot",P2,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,vars:l,scrollAreaComponent:c,position:u,transitionProps:f,radius:h,...d}=n,{dir:_}=v3(),g=at({name:"Drawer",classes:Fn,props:n,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:l,varsResolver:I2}),b=(_==="rtl"?C2:x2)[u];return V.jsx(v2,{value:{scrollAreaComponent:c,getStyles:g,radius:h},children:V.jsx(L3,{ref:e,...g("root"),transitionProps:{transition:b,...f},unstyled:a,...d})})});Qu.classes=Fn;Qu.displayName="@mantine/core/DrawerRoot";const M2={},Ju=Ie((t,e)=>{const n=ae("DrawerTitle",M2,t),{classNames:r,className:i,style:s,styles:o,vars:a,...l}=n,c=Is();return V.jsx(iE,{ref:e,...c.getStyles("title",{classNames:r,style:s,styles:o,className:i}),...l})});Ju.classes=Fn;Ju.displayName="@mantine/core/DrawerTitle";const N2={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:pa("modal"),withOverlay:!0,withCloseButton:!0},hn=Ie((t,e)=>{const{title:n,withOverlay:r,overlayProps:i,withCloseButton:s,closeButtonProps:o,children:a,...l}=ae("Drawer",N2,t),c=!!n||s;return V.jsxs(Qu,{ref:e,...l,children:[r&&V.jsx(Zu,{...i}),V.jsxs(Ku,{children:[c&&V.jsxs(qu,{children:[n&&V.jsx(Ju,{children:n}),s&&V.jsx(Yu,{...o})]}),V.jsx(Xu,{children:a})]})]})});hn.classes=Fn;hn.displayName="@mantine/core/Drawer";hn.Root=Qu;hn.Overlay=Zu;hn.Content=Ku;hn.Body=Xu;hn.Header=qu;hn.Title=Ju;hn.CloseButton=Yu;const O2=["h1","h2","h3","h4","h5","h6"];function k2(t,e){const n=e!==void 0?e:`h${t}`;return O2.includes(n)?{fontSize:`var(--mantine-${n}-font-size)`,fontWeight:`var(--mantine-${n}-font-weight)`,lineHeight:`var(--mantine-${n}-line-height)`}:{fontSize:F(n),fontWeight:`var(--mantine-h${t}-font-weight)`,lineHeight:`var(--mantine-h${t}-line-height)`}}var uE={root:"m_8a5d1357"};const F2={order:1},D2=(t,{order:e,size:n,lineClamp:r,textWrap:i})=>{const s=k2(e,n);return{root:{"--title-fw":s.fontWeight,"--title-lh":s.lineHeight,"--title-fz":s.fontSize,"--title-line-clamp":typeof r=="number"?r.toString():void 0,"--title-text-wrap":i}}},o_=Ie((t,e)=>{const n=ae("Title",F2,t),{classNames:r,className:i,style:s,styles:o,unstyled:a,order:l,vars:c,size:u,variant:f,lineClamp:h,textWrap:d,mod:_,...g}=n,b=at({name:"Title",props:n,classes:uE,className:i,style:s,classNames:r,styles:o,unstyled:a,vars:c,varsResolver:D2});return[1,2,3,4,5,6].includes(l)?V.jsx(we,{...b("root"),component:`h${l}`,variant:f,ref:e,mod:[{order:l,"data-line-clamp":typeof h=="number"},_],size:u,...g}):null});o_.classes=uE;o_.displayName="@mantine/core/Title";const B2=t=>ne.createElement(Qg,{justify:"space-between",p:"0 2rem",align:"center",bg:"#282c34",c:"white",ff:"Gill Sans",h:"100%"},ne.createElement(Sn,{size:"xl",p:"0.5rem",fw:"700"},"Walking in Barcelona"),ne.createElement(i_,{lineSize:2,size:"xl",opened:t.opened,onClick:t.toggle,"aria-label":"Toggle navigation",color:"white"}));function Sc(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const a_=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),Iy=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Iy&&parseFloat(Iy[1]);const ol=globalThis,Ti=globalThis.process||{},L2=globalThis.navigator||{};function fE(t){var r,i;if(typeof window<"u"&&((r=window.process)==null?void 0:r.type)==="renderer"||typeof process<"u"&&((i=process.versions)!=null&&i.electron))return!0;const e=typeof navigator<"u"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Er(){return!(typeof process=="object"&&String(process)==="[object process]"&&!(process!=null&&process.browser))||fE()}function U2(t){return!t&&!Er()?"Node":fE(t)?"Electron":(t||L2.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown"}const hE="4.0.7";function z2(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class V2{constructor(e,n,r="sessionStorage"){this.storage=z2(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function $2(t){let e;return t<10?e=`${t.toFixed(2)}ms`:t<100?e=`${t.toFixed(1)}ms`:t<1e3?e=`${t.toFixed(0)}ms`:e=`${(t/1e3).toFixed(2)}s`,e}function j2(t,e=8){const n=Math.max(e-t.length,0);return`${" ".repeat(n)}${t}`}var Ec;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Ec||(Ec={}));const W2=10;function My(t){return typeof t!="string"?t:(t=t.toUpperCase(),Ec[t]||Ec.WHITE)}function H2(t,e,n){return!Er&&typeof t=="string"&&(e&&(t=`\x1B[${My(e)}m${t}\x1B[39m`),n&&(t=`\x1B[${My(n)+W2}m${t}\x1B[49m`)),t}function X2(t,e=["constructor"]){const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const s of r){const o=i[s];typeof o=="function"&&(e.find(a=>s===a)||(i[s]=o.bind(t)))}}function l_(t,e){if(!t)throw new Error(e||"Assertion failed")}function wi(){var e,n,r;let t;if(Er()&&ol.performance)t=(n=(e=ol==null?void 0:ol.performance)==null?void 0:e.now)==null?void 0:n.call(e);else if("hrtime"in Ti){const i=(r=Ti==null?void 0:Ti.hrtime)==null?void 0:r.call(Ti);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Si={debug:Er()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Y2={enabled:!0,level:0};function Ei(){}const Ny={},Oy={once:!0};class Ta{constructor({id:e}={id:""}){this.VERSION=hE,this._startTs=wi(),this._deltaTs=wi(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new V2(`__probe-${this.id}__`,Y2),this.timeStamp(`${this.id} started`),X2(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((wi()-this._startTs).toPrecision(10))}getDelta(){return Number((wi()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){if(!e)throw new Error(n||"Assertion failed")}warn(e){return this._getLogFunction(0,e,Si.warn,arguments,Oy)}error(e){return this._getLogFunction(0,e,Si.error,arguments)}deprecated(e,n){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${n}\` instead`)}removed(e,n){return this.error(`\`${e}\` has been removed. Use \`${n}\` instead`)}probe(e,n){return this._getLogFunction(e,n,Si.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Si.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,Si.debug||Si.info,arguments,Oy)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||Ei,r&&[r],{tag:q2(n)}):Ei}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||Ei)}group(e,n,r={collapsed:!1}){const i=ky({logLevel:e,message:n,opts:r}),{collapsed:s}=r;return i.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n,r={}){return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Ei)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=dE(e)}_getLogFunction(e,n,r,i,s){if(this._shouldLog(e)){s=ky({logLevel:e,message:n,args:i,opts:s}),r=r||s.method,l_(r),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=wi();const o=s.tag||s.message;if(s.once&&o)if(!Ny[o])Ny[o]=wi();else return Ei;return n=K2(this.id,s.message,s),r.bind(console,n,...s.args)}return Ei}}Ta.VERSION=hE;function dE(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return l_(Number.isFinite(e)&&e>=0),e}function ky(t){const{logLevel:e,message:n}=t;t.logLevel=dE(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return l_(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function K2(t,e,n){if(typeof e=="string"){const r=n.time?j2($2(n.total)):"";e=n.time?`${t}: ${r}  ${e}`:`${t}: ${e}`,e=H2(e,n.color,n.background)}return e}function q2(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}function Z2(t,e){return pE(t||{},e)}function pE(t,e,n=0){if(n>3)return e;const r={...t};for(const[i,s]of Object.entries(e))s&&typeof s=="object"&&!Array.isArray(s)?r[i]=pE(r[i]||{},e[i],n+1):r[i]=e[i];return r}const Q2="latest";function J2(){var t;return(t=globalThis._loadersgl_)!=null&&t.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.2.2"),globalThis._loadersgl_.version}const G2=J2();function gr(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Xr=typeof process!="object"||String(process)!=="[object process]"||process.browser,eI=typeof window<"u"&&typeof window.orientation<"u",Fy=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Fy&&parseFloat(Fy[1]);class tI{constructor(e,n){T(this,"name");T(this,"workerThread");T(this,"isRunning",!0);T(this,"result");T(this,"_resolve",()=>{});T(this,"_reject",()=>{});this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){gr(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){gr(this.isRunning),this.isRunning=!1,this._reject(e)}}class oh{terminate(){}}const ah=new Map;function nI(t){gr(t.source&&!t.url||!t.source&&t.url);let e=ah.get(t.source||t.url);return e||(t.url&&(e=rI(t.url),ah.set(t.url,e)),t.source&&(e=gE(t.source),ah.set(t.source,e))),gr(e),e}function rI(t){if(!t.startsWith("http"))return t;const e=iI(t);return gE(e)}function gE(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function iI(t){return`try {
  importScripts('${t}');
} catch (error) {
  console.error(error);
  throw error;
}`}function _E(t,e=!0,n){const r=n||new Set;if(t){if(Dy(t))r.add(t);else if(Dy(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)_E(t[i],e,r)}}return n===void 0?Array.from(r):[]}function Dy(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const lh=()=>{};class $d{constructor(e){T(this,"name");T(this,"source");T(this,"url");T(this,"terminated",!1);T(this,"worker");T(this,"onMessage");T(this,"onError");T(this,"_loadableURL","");const{name:n,source:r,url:i}=e;gr(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=lh,this.onError=s=>console.log(s),this.worker=Xr?this._createBrowserWorker():this._createNodeWorker()}static isSupported(){return typeof Worker<"u"&&Xr||typeof oh<"u"&&!Xr}destroy(){this.onMessage=lh,this.onError=lh,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||_E(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+=`worker ${this.name} from ${this.url}. `,e.message&&(n+=`${e.message} in `),e.lineno&&(n+=`:${e.lineno}:${e.colno}`),new Error(n)}_createBrowserWorker(){this._loadableURL=nI({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new oh(r,{eval:!1})}else if(this.source)e=new oh(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class sI{constructor(e){T(this,"name","unnamed");T(this,"source");T(this,"url");T(this,"maxConcurrency",1);T(this,"maxMobileConcurrency",1);T(this,"onDebug",()=>{});T(this,"reuseWorkers",!0);T(this,"props",{});T(this,"jobQueue",[]);T(this,"idleQueue",[]);T(this,"count",0);T(this,"isDestroyed",!1);this.source=e.source,this.url=e.url,this.setProps(e)}static isSupported(){return $d.isSupported()}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,n=(i,s,o)=>i.done(o),r=(i,s)=>i.error(s)){const i=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:s}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new tI(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!Xr||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new $d({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return eI?this.maxMobileConcurrency:this.maxConcurrency}}const oI={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},Kn=class Kn{constructor(e){T(this,"props");T(this,"workerPools",new Map);this.props={...oI},this.setProps(e),this.workerPools=new Map}static isSupported(){return $d.isSupported()}static getWorkerFarm(e={}){return Kn._workerFarm=Kn._workerFarm||new Kn({}),Kn._workerFarm.setProps(e),Kn._workerFarm}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let s=this.workerPools.get(n);return s||(s=new sI({name:n,source:r,url:i}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}};T(Kn,"_workerFarm");let bc=Kn;function aI(t,e={}){const n=e[t.id]||{},r=Xr?`${t.id}-worker.js`:`${t.id}-worker-node.js`;let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(Xr?i=`modules/${t.module}/dist/${r}`:i=`modules/${t.module}/src/workers/${t.id}-worker-node.ts`),!i){let s=t.version;s==="latest"&&(s=Q2);const o=s?`@${s}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${o}/dist/${r}`}return gr(i),i}function lI(t,e=G2){gr(t,"no worker provided");const n=t.version;return!(!e||!n)}function cI(t,e){return!bc.isSupported()||!Xr&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function uI(t,e,n,r,i){const s=t.id,o=aI(t,n),l=bc.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const c=await l.startJob("process-on-worker",fI.bind(null,i));return c.postMessage("process",{input:e,options:n,context:r}),await(await c.result).result}async function fI(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:s,options:o}=r;try{const a=await t(s,o);e.postMessage("done",{id:i,result:a})}catch(a){const l=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:i,error:l})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}function hI(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}function dI(...t){return pI(t)}function pI(t){const e=t.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),n=e.reduce((s,o)=>s+o.byteLength,0),r=new Uint8Array(n);let i=0;for(const s of e)r.set(s,i),i+=s.byteLength;return r.buffer}async function gI(t){const e=[];for await(const n of t)e.push(n);return dI(...e)}function By(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class Ly{constructor(e,n){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=By(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(By()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Gu{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,n="count"){return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let i=this.stats[n];return i||(e instanceof Ly?i=e:i=new Ly(n,r),this.stats[n]=i),i}}let _I="";const Uy={};function mI(t){for(const e in Uy)if(t.startsWith(e)){const n=Uy[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t=`${_I}${t}`),t}function yI(t){return t&&typeof t=="object"&&t.isBuffer}function mE(t){if(yI(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function yE(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function vI(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const TI=t=>typeof t=="boolean",To=t=>typeof t=="function",wa=t=>t!==null&&typeof t=="object",zy=t=>wa(t)&&t.constructor==={}.constructor,wI=t=>!!t&&typeof t[Symbol.iterator]=="function",SI=t=>t&&typeof t[Symbol.asyncIterator]=="function",li=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,ci=t=>typeof Blob<"u"&&t instanceof Blob,EI=t=>t&&typeof t=="object"&&t.isBuffer,bI=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||wa(t)&&To(t.tee)&&To(t.cancel)&&To(t.getReader),AI=t=>wa(t)&&To(t.read)&&To(t.pipe)&&TI(t.readable),vE=t=>bI(t)||AI(t);class RI extends Error{constructor(n,r){super(n);T(this,"reason");T(this,"url");T(this,"response");this.reason=r.reason,this.url=r.url,this.response=r.response}}const xI=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,CI=/^([-\w.]+\/[-\w.+]+)/;function Vy(t,e){return t.toLowerCase()===e.toLowerCase()}function PI(t){const e=CI.exec(t);return e?e[1]:t}function $y(t){const e=xI.exec(t);return e?e[1]:""}const TE=/\?.*/;function II(t){const e=t.match(TE);return e&&e[0]}function c_(t){return t.replace(TE,"")}function MI(t){if(t.length<50)return t;const e=t.slice(t.length-15);return`${t.substr(0,32)}...${e}`}function ef(t){return li(t)?t.url:ci(t)?t.name||"":typeof t=="string"?t:""}function u_(t){if(li(t)){const e=t,n=e.headers.get("content-type")||"",r=c_(e.url);return PI(n)||$y(r)}return ci(t)?t.type||"":typeof t=="string"?$y(t):""}function NI(t){return li(t)?t.headers["content-length"]||-1:ci(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function wE(t){if(li(t))return t;const e={},n=NI(t);n>=0&&(e["content-length"]=String(n));const r=ef(t),i=u_(t);i&&(e["content-type"]=i);const s=await FI(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:r}),o}async function OI(t){if(!t.ok)throw await kI(t)}async function kI(t){const e=MI(t.url);let n=`Failed to fetch resource (${t.status}) ${t.statusText}: ${e}`;n=n.length>100?`${n.slice(0,100)}...`:n;const r={reason:t.statusText,url:t.url,response:t};try{const i=t.headers.get("Content-Type");r.reason=i!=null&&i.includes("application/json")?await t.json():t.text()}catch{}return new RI(n,r)}async function FI(t){if(typeof t=="string")return`data:,${t.slice(0,5)}`;if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=s=>{var o;return r((o=s==null?void 0:s.target)==null?void 0:o.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5);return`data:base64,${DI(n)}`}return null}function DI(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}function BI(t){return!LI(t)&&!UI(t)}function LI(t){return t.startsWith("http:")||t.startsWith("https:")}function UI(t){return t.startsWith("data:")}async function jy(t,e){var n,r;if(typeof t=="string"){const i=mI(t);return BI(i)&&(n=globalThis.loaders)!=null&&n.fetchNode?(r=globalThis.loaders)==null?void 0:r.fetchNode(i,e):await fetch(i,e)}return await wE(t)}const Wy=new Ta({id:"loaders.gl"});class zI{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class VI{constructor(){T(this,"console");this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const SE={fetch:null,mimeType:void 0,nothrow:!1,log:new VI,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:a_,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},$I={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function EE(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state||(t._state={}),t._state}function bE(){const t=EE();return t.globalOptions=t.globalOptions||{...SE},t.globalOptions}function jI(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],WI(t,n),XI(e,t,r)}function WI(t,e){Hy(t,null,SE,$I,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};Hy(r,n.id,i,s,e)}}function Hy(t,e,n,r,i){const s=e||"Top level",o=e?`${e}.`:"";for(const a in t){const l=!e&&wa(t[a]),c=a==="baseUri"&&!e,u=a==="workerUrl"&&e;if(!(a in n)&&!c&&!u){if(a in r)Wy.warn(`${s} loader option '${o}${a}' no longer supported, use '${r[a]}'`)();else if(!l){const f=HI(a,i);Wy.warn(`${s} loader option '${o}${a}' not recognized. ${f}`)()}}}}function HI(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const s in i.options){if(t===s)return`Did you mean '${i.id}.${s}'?`;const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||`Did you mean '${i.id}.${s}'?`)}return r}function XI(t,e,n){const i={...t.options||{}};return YI(i,n),i.log===null&&(i.log=new zI),Xy(i,bE()),Xy(i,e),i}function Xy(t,e){for(const n in e)if(n in e){const r=e[n];zy(r)&&zy(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function YI(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function f_(t){return t?(Array.isArray(t)&&(t=t[0]),Array.isArray(t==null?void 0:t.extensions)):!1}function h_(t){Sc(t,"null loader"),Sc(f_(t),"invalid loader");let e;return Array.isArray(t)&&(e=t[1],t=t[0],t={...t,options:{...t.options,...e}}),(t!=null&&t.parseTextSync||t!=null&&t.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const AE=()=>{const t=EE();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function KI(t){const e=AE();t=Array.isArray(t)?t:[t];for(const n of t){const r=h_(n);e.find(i=>r===i)||e.unshift(r)}}function qI(){return AE()}const ZI=new Ta({id:"loaders.gl"}),QI=/\.([^.]+)$/;async function JI(t,e=[],n,r){if(!RE(t))return null;let i=Yy(t,e,{...n,nothrow:!0},r);if(i)return i;if(ci(t)&&(t=await t.slice(0,10).arrayBuffer(),i=Yy(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(xE(t));return i}function Yy(t,e=[],n,r){if(!RE(t))return null;if(e&&!Array.isArray(e))return h_(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...qI()),eM(i);const s=GI(t,i,n,r);if(!s&&!(n!=null&&n.nothrow))throw new Error(xE(t));return s}function GI(t,e,n,r){const i=ef(t),s=u_(t),o=c_(i)||(r==null?void 0:r.url);let a=null,l="";return n!=null&&n.mimeType&&(a=ch(e,n==null?void 0:n.mimeType),l=`match forced by supplied MIME type ${n==null?void 0:n.mimeType}`),a=a||tM(e,o),l=l||(a?`matched url ${o}`:""),a=a||ch(e,s),l=l||(a?`matched MIME type ${s}`:""),a=a||rM(e,t),l=l||(a?`matched initial data ${CE(t)}`:""),n!=null&&n.fallbackMimeType&&(a=a||ch(e,n==null?void 0:n.fallbackMimeType),l=l||(a?`matched fallback MIME type ${s}`:"")),l&&ZI.log(1,`selectLoader selected ${a==null?void 0:a.name}: ${l}.`),a}function RE(t){return!(t instanceof Response&&t.status===204)}function xE(t){const e=ef(t),n=u_(t);let r="No valid loader found (";r+=e?`${yE(e)}, `:"no url provided, ",r+=`MIME type: ${n?`"${n}"`:"not provided"}, `;const i=t?CE(t):"";return r+=i?` first bytes: "${i}"`:"first bytes: not available",r+=")",r}function eM(t){for(const e of t)h_(e)}function tM(t,e){const n=e&&QI.exec(e),r=n&&n[1];return r?nM(t,r):null}function nM(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function ch(t,e){var n;for(const r of t)if((n=r.mimeTypes)!=null&&n.some(i=>Vy(e,i))||Vy(e,`application/x.${r.id}`))return r;return null}function rM(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(iM(e,n))return n}else if(ArrayBuffer.isView(e)){if(Ky(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&Ky(e,0,n))return n;return null}function iM(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function Ky(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>sM(t,e,n,i))}function sM(t,e,n,r){if(r instanceof ArrayBuffer)return hI(r,t,r.byteLength);switch(typeof r){case"function":return r(t);case"string":const i=jd(t,e,r.length);return r===i;default:return!1}}function CE(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?jd(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?jd(t,0,e):""}function jd(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let s=0;s<n;s++)i+=String.fromCharCode(r.getUint8(e+s));return i}const oM=256*1024;function*aM(t,e){const n=(e==null?void 0:e.chunkSize)||oM;let r=0;const i=new TextEncoder;for(;r<t.length;){const s=Math.min(t.length-r,n),o=t.slice(r,r+s);r+=s,yield i.encode(o)}}const lM=256*1024;function*cM(t,e={}){const{chunkSize:n=lM}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),s=new ArrayBuffer(i),o=new Uint8Array(t,r,i);new Uint8Array(s).set(o),r+=i,yield s}}const uM=1024*1024;async function*fM(t,e){const n=(e==null?void 0:e.chunkSize)||uM;let r=0;for(;r<t.size;){const i=r+n,s=await t.slice(r,i).arrayBuffer();r=i,yield s}}function qy(t,e){return a_?hM(t,e):dM(t)}async function*hM(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:s,value:o}=await i;if(s)return;yield mE(o)}}catch{n.releaseLock()}}async function*dM(t,e){for await(const n of t)yield mE(n)}function pM(t,e){if(typeof t=="string")return aM(t,e);if(t instanceof ArrayBuffer)return cM(t,e);if(ci(t))return fM(t,e);if(vE(t))return qy(t,e);if(li(t))return qy(t.body,e);throw new Error("makeIterator")}const PE="Cannot convert supplied data type";function gM(t,e,n){if(e.text&&typeof t=="string")return t;if(EI(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(PE)}async function _M(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return gM(t,e);if(ci(t)&&(t=await wE(t)),li(t)){const i=t;return await OI(i),e.binary?await i.arrayBuffer():await i.text()}if(vE(t)&&(t=pM(t,n)),wI(t)||SI(t))return gI(t);throw new Error(PE)}function IE(t,e){const n=bE(),r=t||n;return typeof r.fetch=="function"?r.fetch:wa(r.fetch)?i=>jy(i,r.fetch):e!=null&&e.fetch?e==null?void 0:e.fetch:jy}function mM(t,e,n){if(n)return n;const r={fetch:IE(e,t),...t};if(r.url){const i=c_(r.url);r.baseUrl=i,r.queryString=II(r.url),r.filename=yE(i),r.baseUrl=vI(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function yM(t,e){if(t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:void 0}async function Ac(t,e,n,r){e&&!Array.isArray(e)&&!f_(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=ef(t),o=yM(e,r),a=await JI(t,o,n);return a?(n=jI(n,a,o,i),r=mM({url:i,_parse:Ac,loaders:o},n,r||null),await vM(a,t,n,r)):null}async function vM(t,e,n,r){if(lI(t),n=Z2(t.options,n),li(e)){const s=e,{ok:o,redirected:a,status:l,statusText:c,type:u,url:f}=s,h=Object.fromEntries(s.headers.entries());r.response={headers:h,ok:o,redirected:a,status:l,statusText:c,type:u,url:f}}e=await _M(e,t,n);const i=t;if(i.parseTextSync&&typeof e=="string")return i.parseTextSync(e,n,r);if(cI(t,n))return await uI(t,e,n,r,Ac);if(i.parseText&&typeof e=="string")return await i.parseText(e,n,r);if(i.parse)return await i.parse(e,n,r);throw gr(!i.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}async function Rc(t,e,n,r){let i,s;!Array.isArray(e)&&!f_(e)?(i=[],s=e):(i=e,s=n);const o=IE(s);let a=t;return typeof t=="string"&&(a=await o(t)),ci(t)&&(a=await o(t)),Array.isArray(i)?await Ac(a,i,s):await Ac(a,i,s)}const TM="4.2.2";var Gv;const wM=(Gv=globalThis.loaders)==null?void 0:Gv.parseImageNode,Wd=typeof Image<"u",Hd=typeof ImageBitmap<"u",SM=!!wM,Xd=a_?!0:SM;function EM(t){switch(t){case"auto":return Hd||Wd||Xd;case"imagebitmap":return Hd;case"image":return Wd;case"data":return Xd;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function bM(){if(Hd)return"imagebitmap";if(Wd)return"image";if(Xd)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function AM(t){const e=xM(t);if(!e)throw new Error("Not an image");return e}function RM(t){switch(AM(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function xM(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const CM=/^data:image\/svg\+xml/,PM=/\.svg((\?|#).*)?$/;function d_(t){return t&&(CM.test(t)||PM.test(t))}function IM(t,e){if(d_(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(r)}`}return ME(t,e)}function ME(t,e){if(d_(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function NE(t,e,n){const r=IM(t,n),i=self.URL||self.webkitURL,s=typeof r!="string"&&i.createObjectURL(r);try{return await MM(s||r,e)}finally{s&&i.revokeObjectURL(s)}}async function MM(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=s=>{const o=s instanceof Error?s.message:"error";i(new Error(o))}}catch(s){i(s)}})}const NM={};let Zy=!0;async function OM(t,e,n){let r;d_(n)?r=await NE(t,e,n):r=ME(t,n);const i=e&&e.imagebitmap;return await kM(r,i)}async function kM(t,e=null){if((FM(e)||!Zy)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),Zy=!1}return await createImageBitmap(t)}function FM(t){for(const e in t||NM)return!1;return!0}function DM(t){return!zM(t,"ftyp",4)||!(t[8]&96)?null:BM(t)}function BM(t){switch(LM(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function LM(t,e,n){return String.fromCharCode(...t.slice(e,n))}function UM(t){return[...t].map(e=>e.charCodeAt(0))}function zM(t,e,n=0){const r=UM(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const rn=!1,wo=!0;function OE(t){const e=Sa(t);return $M(e)||HM(e)||jM(e)||WM(e)||VM(e)}function VM(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=DM(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function $M(t){const e=Sa(t);return e.byteLength>=24&&e.getUint32(0,rn)===2303741511?{mimeType:"image/png",width:e.getUint32(16,rn),height:e.getUint32(20,rn)}:null}function jM(t){const e=Sa(t);return e.byteLength>=10&&e.getUint32(0,rn)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,wo),height:e.getUint16(8,wo)}:null}function WM(t){const e=Sa(t);return e.byteLength>=14&&e.getUint16(0,rn)===16973&&e.getUint32(2,wo)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,wo),height:e.getUint32(22,wo)}:null}function HM(t){const e=Sa(t);if(!(e.byteLength>=3&&e.getUint16(0,rn)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=XM();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,rn);if(i.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,rn),width:e.getUint16(s+7,rn)};if(!r.has(o))return null;s+=2,s+=e.getUint16(s,rn)}return null}function XM(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Sa(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function YM(t,e){var i;const{mimeType:n}=OE(t)||{},r=(i=globalThis.loaders)==null?void 0:i.parseImageNode;return Sc(r),await r(t,n)}async function KM(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:s}=n||{},o=qM(i);let a;switch(o){case"imagebitmap":a=await OM(t,e,s);break;case"image":a=await NE(t,e,s);break;case"data":a=await YM(t);break;default:Sc(!1)}return i==="data"&&(a=RM(a)),a}function qM(t){switch(t){case"auto":case"data":return bM();default:return EM(t),t}}const ZM=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],QM=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],JM={image:{type:"auto",decode:!0}},GM={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:TM,mimeTypes:QM,extensions:ZM,parse:KM,tests:[t=>!!OE(new DataView(t))],options:JM},eN=new Ta({id:"deck"}),J=eN;let Yd={};function tN(t){Yd=t}function Ke(t,e,n,r){J.level>0&&Yd[t]&&Yd[t].call(null,e,n,r)}function nN(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const rN={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:nN,parseTextSync:JSON.parse};function iN(){const t="9.0.29",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${t}`);return e||(J.log(1,`deck.gl ${t}`)(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:J,_registerLoggers:tN},KI([rN,[GM,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const sN=iN();function Vr(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const uh={number:{type:"number",validate(t,e){return Number.isFinite(t)&&typeof e=="object"&&(e.max===void 0||t<=e.max)&&(e.min===void 0||t>=e.min)}},array:{type:"array",validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function oN(t){const e={};for(const[n,r]of Object.entries(t))e[n]=lN(r);return e}function aN(t,e,n){const r={};for(const[i,s]of Object.entries(e))t&&i in t&&!s.private?(s.validate&&Vr(s.validate(t[i],s),`${n}: invalid ${i}`),r[i]=t[i]):r[i]=s.value;return r}function lN(t){let e=Qy(t);if(e!=="object")return{value:t,...uh[e],type:e};if(typeof t=="object")return t?t.type!==void 0?{...t,...uh[t.type],type:t.type}:t.value===void 0?{type:"object",value:t}:(e=Qy(t.value),{...t,...uh[e],type:e}):{type:"object",value:null};throw new Error("props")}function Qy(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const cN=`#ifdef MODULE_LOGDEPTH
logdepth_adjustPosition(gl_Position);
#endif
`,uN=`#ifdef MODULE_MATERIAL
gl_FragColor = material_filterColor(gl_FragColor);
#endif
#ifdef MODULE_LIGHTING
gl_FragColor = lighting_filterColor(gl_FragColor);
#endif
#ifdef MODULE_FOG
gl_FragColor = fog_filterColor(gl_FragColor);
#endif
#ifdef MODULE_PICKING
gl_FragColor = picking_filterHighlightColor(gl_FragColor);
gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif
#ifdef MODULE_LOGDEPTH
logdepth_setFragDepth();
#endif
`,fN={vertex:cN,fragment:uN},Jy=/void\s+main\s*\([^)]*\)\s*\{\n?/,Gy=/}\n?[^{}]*$/,fh=[],Vl="__LUMA_INJECT_DECLARATIONS__";function hN(t){const e={vertex:{},fragment:{}};for(const n in t){let r=t[n];const i=dN(n);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function dN(t){const e=t.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function xc(t,e,n,r=!1){const i=e==="vertex";for(const s in n){const o=n[s];o.sort((l,c)=>l.order-c.order),fh.length=o.length;for(let l=0,c=o.length;l<c;++l)fh[l]=o[l].injection;const a=`${fh.join(`
`)}
`;switch(s){case"vs:#decl":i&&(t=t.replace(Vl,a));break;case"vs:#main-start":i&&(t=t.replace(Jy,l=>l+a));break;case"vs:#main-end":i&&(t=t.replace(Gy,l=>a+l));break;case"fs:#decl":i||(t=t.replace(Vl,a));break;case"fs:#main-start":i||(t=t.replace(Jy,l=>l+a));break;case"fs:#main-end":i||(t=t.replace(Gy,l=>a+l));break;default:t=t.replace(s,l=>l+a)}}return t=t.replace(Vl,""),r&&(t=t.replace(/\}\s*$/,s=>s+fN[e])),t}let pN=1;class $r{constructor(e){T(this,"name");T(this,"vs");T(this,"fs");T(this,"getModuleUniforms");T(this,"dependencies");T(this,"deprecations");T(this,"defines");T(this,"injections");T(this,"uniforms",{});T(this,"uniformTypes",{});const{name:n,vs:r,fs:i,dependencies:s=[],uniformTypes:o={},uniformPropTypes:a={},getUniforms:l,deprecations:c=[],defines:u={},inject:f={}}=e;Vr(typeof n=="string"),this.name=n,this.vs=r,this.fs=i,this.getModuleUniforms=l,this.dependencies=$r.instantiateModules(s),this.deprecations=this._parseDeprecationDefinitions(c),this.defines=u,this.injections=hN(f),this.uniformTypes=o,a&&(this.uniforms=oN(a))}static instantiateModules(e){return e.map(n=>{if(n instanceof $r)return n;Vr(typeof n!="string",`Shader module use by name is deprecated. Import shader module '${JSON.stringify(n)}' and use it directly.`),n.name||(console.warn("shader module has no name"),n.name=`shader-module-${pN++}`);const r=new $r(n);return r.dependencies=$r.instantiateModules(n.dependencies||[]),r})}getModuleSource(e){let n;switch(e){case"vertex":n=this.vs||"";break;case"fragment":n=this.fs||"";break;default:Vr(!1)}const r=this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");return`// ----- MODULE ${this.name} ---------------

#define MODULE_${r}
${n}

`}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):aN(e,this.uniforms,this.name)}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{var i;(i=r.regex)!=null&&i.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp(`\\b${n.old}\\(`);break;default:n.regex=new RegExp(`${n.type} ${n.old};`)}}),e}_defaultGetUniforms(e={}){const n={},r=this.uniforms;for(const i in r){const s=r[i];i in e&&!s.private?(s.validate&&Vr(s.validate(e[i],s),`${this.name}: invalid ${i}`),n[i]=e[i]):n[i]=s.value}return n}}function e0(t){if(t.source&&t.platformInfo.type==="webgpu")return{...t,vs:void 0,fs:void 0};if(!t.vs)throw new Error("no vertex shader");const e=t0(t.platformInfo,t.vs);let n;return t.fs&&(n=t0(t.platformInfo,t.fs)),{...t,vs:e,fs:n}}function t0(t,e){if(typeof e=="string")return e;switch(t.type){case"webgpu":if(e!=null&&e.wgsl)return e.wgsl;throw new Error("WebGPU does not support GLSL shaders");default:if(e!=null&&e.glsl)return e.glsl;throw new Error("WebGL does not support WGSL shaders")}}function tf(t){const e=$r.instantiateModules(t);return gN(e)}function gN(t){const e={},n={};return kE({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function kE(t){const{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)r[s.name]=s,(i[s.name]===void 0||i[s.name]<n)&&(i[s.name]=n);for(const s of e)s.dependencies&&kE({modules:s.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function _N(t){switch(t==null?void 0:t.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function mN(t,e){var r;if(Number(((r=t.match(/^#version[ \t]+(\d+)/m))==null?void 0:r[1])||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return t=n0(t,yN),t;case"fragment":return t=n0(t,vN),t;default:throw new Error(e)}}const FE=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],yN=[...FE,[Kd("attribute"),"in $1"],[Kd("varying"),"out $1"]],vN=[...FE,[Kd("varying"),"in $1"]];function n0(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function Kd(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function DE(t,e){let n="";for(const r in t){const i=t[r];if(n+=`void ${i.signature} {
`,i.header&&(n+=`  ${i.header}`),e[r]){const s=e[r];s.sort((o,a)=>o.order-a.order);for(const o of s)n+=`  ${o.injection}
`}i.footer&&(n+=`  ${i.footer}`),n+=`}
`}return n}function BE(t){const e={vertex:{},fragment:{}};for(const n of t){let r,i;typeof n!="string"?(r=n,i=r.hook):(r={},i=n),i=i.trim();const[s,o]=i.split(":"),a=i.replace(/\(.+/,""),l=Object.assign(r,{signature:o});switch(s){case"vs":e.vertex[a]=l;break;case"fs":e.fragment[a]=l;break;default:throw new Error(s)}}return e}function TN(t,e){return{name:wN(t,e),language:"glsl",version:SN(t)}}function wN(t,e="unnamed"){const r=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(t);return r?r[1]:e}function SN(t){let e=100;const n=t.match(/[^\s]+/g);if(n&&n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}const LE=`

${Vl}
`,EN=`precision highp float;
`;function bN(t){const e=tf(t.modules||[]);return{source:qd(t.platformInfo,{...t,source:t.source,stage:"vertex",modules:e}),getUniforms:p_(e)}}function AN(t){const e=tf(t.modules||[]);return{vs:qd(t.platformInfo,{...t,source:t.vs,stage:"vertex",modules:e}),fs:qd(t.platformInfo,{...t,source:t.fs,stage:"fragment",modules:e}),getUniforms:p_(e)}}function RN(t){const{vs:e,fs:n}=t,r=tf(t.modules||[]);return{vs:r0(t.platformInfo,{...t,source:e,stage:"vertex",modules:r}),fs:r0(t.platformInfo,{...t,source:n,stage:"fragment",modules:r}),getUniforms:p_(r)}}function qd(t,e){const{source:n,stage:r,modules:i,hookFunctions:s=[],inject:o={},log:a}=e;Vr(typeof n=="string","shader source must be a string");const l=n;let c="";const u=BE(s),f={},h={},d={};for(const g in o){const b=typeof o[g]=="string"?{injection:o[g],order:0}:o[g],m=/^(v|f)s:(#)?([\w-]+)$/.exec(g);if(m){const p=m[2],y=m[3];p?y==="decl"?h[g]=[b]:d[g]=[b]:f[g]=[b]}else d[g]=[b]}const _=t.type!=="webgpu"?i:[];for(const g of _){a&&g.checkDeprecations(l,a);const b=g.getModuleSource(r,"wgsl");c+=b;const m=g.injections[r];for(const p in m){const y=/^(v|f)s:#([\w-]+)$/.exec(p);if(y){const R=y[2]==="decl"?h:d;R[p]=R[p]||[],R[p].push(m[p])}else f[p]=f[p]||[],f[p].push(m[p])}}return c+=LE,c=xc(c,r,h),c+=DE(u[r],f),c+=l,c=xc(c,r,d),c}function r0(t,e){const{id:n,source:r,stage:i,language:s="glsl",modules:o,defines:a={},hookFunctions:l=[],inject:c={},prologue:u=!0,log:f}=e;Vr(typeof r=="string","shader source must be a string");const h=s==="glsl"?TN(r).version:-1,d=t.shaderLanguageVersion,_=h===100?"#version 100":"#version 300 es",b=r.split(`
`).slice(1).join(`
`),m={};o.forEach(O=>{Object.assign(m,O.getDefines())}),Object.assign(m,a);let p="";switch(s){case"wgsl":break;case"glsl":p=u?`${_}

// ----- PROLOGUE -------------------------
${xN({id:n,source:r,stage:i})}
${`#define SHADER_TYPE_${i.toUpperCase()}`}
${_N(t)}
${i==="fragment"?EN:""}

// ----- APPLICATION DEFINES -------------------------

${CN(m)}

`:`${_}
`;break}const y=BE(l),S={},R={},P={};for(const O in c){const k=typeof c[O]=="string"?{injection:c[O],order:0}:c[O],D=/^(v|f)s:(#)?([\w-]+)$/.exec(O);if(D){const z=D[2],H=D[3];z?H==="decl"?R[O]=[k]:P[O]=[k]:S[O]=[k]}else P[O]=[k]}for(const O of o){f&&O.checkDeprecations(b,f);const k=O.getModuleSource(i);p+=k;const D=O.injections[i];for(const z in D){const H=/^(v|f)s:#([\w-]+)$/.exec(z);if(H){const Y=H[2]==="decl"?R:P;Y[z]=Y[z]||[],Y[z].push(D[z])}else S[z]=S[z]||[],S[z].push(D[z])}}return p+="// ----- MAIN SHADER SOURCE -------------------------",p+=LE,p=xc(p,i,R),p+=DE(y[i],S),p+=b,p=xc(p,i,P),s==="glsl"&&h!==d&&(p=mN(p,i)),p.trim()}function p_(t){return function(n){const r={};for(const i of t){const s=i.getUniforms(n,r);Object.assign(r,s)}return r}}function xN(t){const{id:e,source:n,stage:r}=t;return e&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME ${e}_${r}

`:""}function CN(t={}){let e="";for(const n in t){const r=t[n];(r||Number.isFinite(r))&&(e+=`#define ${n.toUpperCase()} ${t[n]}
`)}return e}const Dr=class Dr{constructor(){T(this,"_hookFunctions",[]);T(this,"_defaultModules",[])}static getDefaultShaderAssembler(){return Dr.defaultShaderAssembler=Dr.defaultShaderAssembler||new Dr,Dr.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(n=>n.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n)}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e)}assembleShader(e){const n=this._getModuleList(e.modules),r=this._hookFunctions,i=e0(e);return{...bN({platformInfo:e.platformInfo,...i,modules:n,hookFunctions:r}),modules:n}}assembleShaderPair(e){const n=e0(e),r=this._getModuleList(e.modules),i=this._hookFunctions,{platformInfo:s}=e;return{...e.platformInfo.shaderLanguage==="wgsl"?AN({platformInfo:s,...n,modules:r,hookFunctions:i}):RN({platformInfo:s,...n,modules:r,hookFunctions:i}),modules:r}}_getModuleList(e=[]){const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],l=a.name;n[i++]=a,r[l]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],l=a.name;r[l]||(n[i++]=a,r[l]=!0)}return n.length=i,$r.instantiateModules(n)}};T(Dr,"defaultShaderAssembler");let Cc=Dr;const PN=`out vec4 transform_output;
void main() {
transform_output = vec4(0);
}`,IN=`#version 300 es
${PN}`;function MN(t){const{input:e,inputChannels:n,output:r}=t||{};if(!e)return IN;if(!n)throw new Error("inputChannels");const i=NN(n),s=ON(e,n);return`#version 300 es
in ${i} ${e};
out vec4 ${r};
void main() {
  ${r} = ${s};
}`}function NN(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${t}`)}}function ON(t,e){switch(e){case 1:return`vec4(${t}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${t}, 0.0, 1.0)`;case 3:return`vec4(${t}, 1.0)`;case 4:return t;default:throw new Error(`invalid channels: ${e}`)}}const U=new Ta({id:"luma.gl"});class kN{constructor(){T(this,"stats",new Map)}getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new Gu({id:e})),this.stats.get(e)}}const g_=new kN;function FN(){const t="9.0.27",e="set luma.log.level=1 (or higher) to trace rendering";if(globalThis.luma&&globalThis.luma.VERSION!==t)throw new Error(`luma.gl - multiple VERSIONs detected: ${globalThis.luma.VERSION} vs ${t}`);return globalThis.luma||(Er()&&U.log(1,`${t} - ${e}`)(),globalThis.luma=globalThis.luma||{VERSION:t,version:t,log:U,stats:g_}),t}const DN=FN();function BN(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)?t:null}function Ko(t){return Array.isArray(t)?t.length===0||typeof t[0]=="number"?t:null:BN(t)}const hh={};function ui(t="id"){hh[t]=hh[t]||1;const e=hh[t]++;return`${t}-${e}`}function Pc(t){let e=!0;for(const n in t){e=!1;break}return e}var $h;let oe=($h=class{constructor(e,n,r){T(this,"id");T(this,"props");T(this,"userData",{});T(this,"_device");T(this,"destroyed",!1);T(this,"allocatedBytes",0);T(this,"_attachedResources",new Set);if(!e)throw new Error("no device");this._device=e,this.props=LN(n,r);const i=this.props.id!=="undefined"?this.props.id:ui(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}(${this.id})`}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),n=this[Symbol.toStringTag];e.get(`${n}s Active`).decrementCount()}trackAllocatedMemory(e,n=this[Symbol.toStringTag]){const r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").addCount(e),r.get(`${n} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const n=this._device.statsManager.getStats("Resource Counts");n.get("GPU Memory").subtractCount(this.allocatedBytes),n.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),n=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${n}s Created`).incrementCount(),e.get(`${n}s Active`).incrementCount()}},T($h,"defaultProps",{id:"undefined",handle:void 0,userData:void 0}),$h);function LN(t,e){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}const Le=class Le extends oe{constructor(n,r){const i={...r};(r.usage||0)&Le.INDEX&&!r.indexType&&(r.data instanceof Uint32Array?i.indexType="uint32":r.data instanceof Uint16Array&&(i.indexType="uint16"));super(n,i,Le.defaultProps);T(this,"usage");T(this,"indexType");T(this,"updateTimestamp");T(this,"debugData",new ArrayBuffer(0));this.usage=r.usage||0,this.indexType=i.indexType,this.updateTimestamp=n.incrementTimestamp()}get[Symbol.toStringTag](){return"Buffer"}readSyncWebGL(n,r){throw new Error("not implemented")}_setDebugData(n,r,i){const s=ArrayBuffer.isView(n)?n.buffer:n,o=Math.min(n?n.byteLength:i,Le.DEBUG_DATA_MAX_LENGTH);n===null?this.debugData=new ArrayBuffer(o):r===0&&i===n.byteLength?this.debugData=s.slice(0,o):this.debugData=s.slice(r,r+o)}};T(Le,"defaultProps",{...oe.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1}),T(Le,"MAP_READ",1),T(Le,"MAP_WRITE",2),T(Le,"COPY_SRC",4),T(Le,"COPY_DST",8),T(Le,"INDEX",16),T(Le,"VERTEX",32),T(Le,"UNIFORM",64),T(Le,"STORAGE",128),T(Le,"INDIRECT",256),T(Le,"QUERY_RESOLVE",512),T(Le,"DEBUG_DATA_MAX_LENGTH",32);let ge=Le;function UE(t){const e=i0[t],n=UN(e),r=t.includes("norm"),i=!r&&!t.startsWith("float"),s=t.startsWith("s");return{dataType:i0[t],byteLength:n,integer:i,signed:s,normalized:r}}function UN(t){return zN[t]}const i0={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},zN={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4},VN=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],$N=/^(rg?b?a?)([0-9]*)([a-z]*)(-srgb)?(-webgl|-unsized)?$/;function jN(t){return VN.some(e=>t.startsWith(e))}function zE(t){const e=$N.exec(t);if(e){const[,n,r,i,s,o]=e;if(n){const a=`${i}${r}`,l=UE(a);return{format:n,components:n.length,srgb:s==="-srgb",unsized:o==="-unsized",webgl:o==="-webgl",...l}}}return HN(t)}const WN={"rgba4unorm-webgl":{format:"rgba",bpp:2},"rgb565unorm-webgl":{format:"rgb",bpp:2},"rgb5a1unorm-webgl":{format:"rgba",bbp:2},rgb9e5ufloat:{format:"rgb",bbp:4},rg11b10ufloat:{format:"rgb",bbp:4},rgb10a2unorm:{format:"rgba",bbp:4},"rgb10a2uint-webgl":{format:"rgba",bbp:4},stencil8:{components:1,bpp:1,a:"stencil"},depth16unorm:{components:1,bpp:2,a:"depth"},depth24plus:{components:1,bpp:3,a:"depth"},depth32float:{components:1,bpp:4,a:"depth"},"depth24plus-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth24unorm-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth32float-stencil8":{components:2,bpp:4,a:"depth-stencil"}};function HN(t){var n;const e=WN[t];if(!e)throw new Error(`Unknown format ${t}`);return{format:e.format||"",components:e.components||((n=e.format)==null?void 0:n.length)||1,byteLength:e.bpp||1,srgb:!1,unsized:!1}}class XN{}class YN{constructor(e=[],n){T(this,"features");T(this,"disabledFeatures");this.features=new Set(e),this.disabledFeatures=n||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures[e]&&this.features.has(e)}}const Ro=class Ro{constructor(e){T(this,"id");T(this,"props");T(this,"userData",{});T(this,"statsManager",g_);T(this,"_lumaData",{});T(this,"timestamp",0);this.props={...Ro.defaultProps,...e},this.id=this.props.id||ui(this[Symbol.toStringTag].toLowerCase())}get[Symbol.toStringTag](){return"Device"}isTextureFormatCompressed(e){return jN(e)}loseDevice(){return!1}getCanvasContext(){if(!this.canvasContext)throw new Error("Device has no CanvasContext");return this.canvasContext}createTexture(e){return(e instanceof Promise||typeof e=="string")&&(e={data:e}),this._createTexture(e)}createCommandEncoder(e={}){throw new Error("not implemented")}readPixelsToArrayWebGL(e,n){throw new Error("not implemented")}readPixelsToBufferWebGL(e,n){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,n){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}_getBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const n={...e};return(e.usage||0)&ge.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?n.indexType="uint32":e.data instanceof Uint16Array?n.indexType="uint16":U.warn("indices buffer content must be of integer type")()),n}};T(Ro,"defaultProps",{id:null,canvas:null,container:null,manageState:!0,width:800,height:600,requestMaxLimits:!0,debug:!!U.get("debug"),spector:!!(U.get("spector")||U.get("spectorjs")),break:[],initalizeFeatures:!0,disabledFeatures:{"compilation-status-async-webgl":!0},gl:null,onError:e=>U.error(e.message)}),T(Ro,"VERSION",DN);let gs=Ro;function ue(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const Ys=new Map,Yi=class Yi{static registerDevices(e){for(const n of e)ue(n.type&&n.isSupported&&n.create),Ys.set(n.type,n)}static getAvailableDevices(){return Array.from(Ys).map(e=>e.type)}static getSupportedDevices(){return Array.from(Ys).filter(e=>e.isSupported()).map(e=>e.type)}static setDefaultDeviceProps(e){Object.assign(gs.defaultProps,e)}static async attachDevice(e){const n=s0(e.devices)||Ys;if(e.handle instanceof WebGL2RenderingContext){const r=n.get("webgl");if(r)return await r.attach(e.handle)}if(e.handle===null){const r=n.get("unknown");if(r)return await r.attach(null)}throw new Error("Failed to attach device. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static async createDevice(e={}){var s,o;e={...Yi.defaultProps,...e},e.gl&&(e.type="webgl");const n=s0(e.devices)||Ys;let r,i;switch(e.type){case"webgpu":if(r=n.get("webgpu"),r)return await r.create(e);break;case"webgl":if(i=n.get("webgl"),i)return await i.create(e);break;case"unknown":const a=n.get("unknown");if(a)return await a.create(e);break;case"best-available":if(r=n.get("webgpu"),(s=r==null?void 0:r.isSupported)!=null&&s.call(r))return await r.create(e);if(i=n.get("webgl"),(o=i==null?void 0:i.isSupported)!=null&&o.call(i))return await i.create(e);break}throw new Error("No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static enforceWebGL2(e=!0){const n=HTMLCanvasElement.prototype;if(!e&&n.originalGetContext){n.getContext=n.originalGetContext,n.originalGetContext=void 0;return}n.originalGetContext=n.getContext,n.getContext=function(r,i){return r==="webgl"||r==="experimental-webgl"?this.originalGetContext("webgl2",i):this.originalGetContext(r,i)}}};T(Yi,"defaultProps",{...gs.defaultProps,type:"best-available",devices:void 0}),T(Yi,"stats",g_),T(Yi,"log",U);let ts=Yi;function s0(t){if(!t||(t==null?void 0:t.length)===0)return null;const e=new Map;for(const n of t)e.set(n.type,n);return e}const KN=Er()&&typeof document<"u",nf=()=>KN&&document.readyState==="complete",qN={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,colorSpace:"srgb",alphaMode:"opaque"};class __{constructor(e){T(this,"id");T(this,"props");T(this,"canvas");T(this,"htmlCanvas");T(this,"offscreenCanvas");T(this,"type");T(this,"width",1);T(this,"height",1);T(this,"resizeObserver");T(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1});if(this.props={...qN,...e},e=this.props,!Er()){this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,this.canvas=null;return}if(e.canvas)typeof e.canvas=="string"?this.canvas=JN(e.canvas):this.canvas=e.canvas;else{const n=GN(e),r=QN((e==null?void 0:e.container)||null);r.insertBefore(n,r.firstChild),this.canvas=n,e!=null&&e.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver(n=>{for(const r of n)r.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}static get isPageLoaded(){return nf()}getDevicePixelRatio(e){return typeof OffscreenCanvas<"u"&&this.canvas instanceof OffscreenCanvas||(e=e===void 0?this.props.useDevicePixels:e,!e||e<=0)?1:e===!0?typeof window<"u"&&window.devicePixelRatio||1:e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),n=this.canvas;return n.parentElement?[n.clientWidth*e,n.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,n]=this.getPixelSize();return e/n}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),{clientWidth:n}=this._canvasSizeInfo;return n?e/n:1}catch{return 1}}cssToDevicePixels(e,n=!0){const r=this.cssToDeviceRatio(),[i,s]=this.getDrawingBufferSize();return eO(e,r,i,s,n)}setDevicePixelRatio(e,n={}){if(!this.htmlCanvas)return;let r="width"in n?n.width:this.htmlCanvas.clientWidth,i="height"in n?n.height:this.htmlCanvas.clientHeight;(!r||!i)&&(U.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=this.htmlCanvas.width||1,i=this.htmlCanvas.height||1);const s=this._canvasSizeInfo;if(s.clientWidth!==r||s.clientHeight!==i||s.devicePixelRatio!==e){let o=e;const a=Math.floor(r*o),l=Math.floor(i*o);this.htmlCanvas.width=a,this.htmlCanvas.height=l;const[c,u]=this.getDrawingBufferSize();(c!==a||u!==l)&&(o=Math.min(c/r,u/i),this.htmlCanvas.width=Math.floor(r*o),this.htmlCanvas.height=Math.floor(i*o),U.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=r,this._canvasSizeInfo.clientHeight=i,this._canvasSizeInfo.devicePixelRatio=e}}getDrawingBufferSize(){const e=this.device.gl;if(!e)throw new Error("canvas size");return[e.drawingBufferWidth,e.drawingBufferHeight]}_setAutoCreatedCanvasId(e){var n;((n=this.htmlCanvas)==null?void 0:n.id)==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}}T(__,"pageLoaded",ZN());function ZN(){return nf()||typeof window>"u"?Promise.resolve():new Promise(t=>{window.addEventListener("load",()=>t())})}function QN(t){if(typeof t=="string"){const e=document.getElementById(t);if(!e&&!nf())throw new Error(`Accessing '${t}' before page was loaded`);if(!e)throw new Error(`${t} is not an HTML element`);return e}else if(t)return t;return document.body}function JN(t){const e=document.getElementById(t);if(!e&&!nf())throw new Error(`Accessing '${t}' before page was loaded`);if(!(e instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return e}function GN(t){const{width:e,height:n}=t,r=document.createElement("canvas");return r.id="lumagl-auto-created-canvas",r.width=e||1,r.height=n||1,r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(n)?`${n}px`:"100%",r}function eO(t,e,n,r,i){const s=t,o=o0(s[0],e,n);let a=a0(s[1],e,r,i),l=o0(s[0]+1,e,n);const c=l===n-1?l:l-1;l=a0(s[1]+1,e,r,i);let u;return i?(l=l===0?l:l+1,u=a,a=l):u=l===r-1?l:l-1,{x:o,y:a,width:Math.max(c-o+1,1),height:Math.max(u-a+1,1)}}function o0(t,e,n){return Math.min(Math.round(t*e),n-1)}function a0(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const vn=class vn extends oe{constructor(n,r,i=vn.defaultProps){super(n,r,i);T(this,"dimension");T(this,"format");T(this,"width");T(this,"height");T(this,"depth");T(this,"updateTimestamp");this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.updateTimestamp=n.incrementTimestamp()}get[Symbol.toStringTag](){return"Texture"}};T(vn,"defaultProps",{...oe.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!0,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,type:void 0,sampler:{},view:void 0}),T(vn,"COPY_SRC",1),T(vn,"COPY_DST",2),T(vn,"TEXTURE_BINDING",4),T(vn,"STORAGE_BINDING",8),T(vn,"RENDER_ATTACHMENT",16);let bt=vn;const Qc=class Qc extends oe{get[Symbol.toStringTag](){return"TextureView"}constructor(e,n){super(e,n,Qc.defaultProps)}};T(Qc,"defaultProps",{...oe.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0});let Ic=Qc;function tO(t,e,n){let r="";const i=e.split(/\r?\n/),s=t.slice().sort((o,a)=>o.lineNum-a.lineNum);switch((n==null?void 0:n.showSourceCode)||"no"){case"all":let o=0;for(let a=1;a<=i.length;a++)for(r+=VE(i[a-1],a,n);s.length>o&&s[o].lineNum===a;){const l=s[o++];r+=l0(l,i,l.lineNum,{...n,inlineSource:!1})}return r;case"issues":case"no":for(const a of t)r+=l0(a,i,a.lineNum,{inlineSource:(n==null?void 0:n.showSourceCode)!=="no"});return r}}function l0(t,e,n,r){if(r!=null&&r.inlineSource){const i=nO(e,n),s=t.linePos>0?`${" ".repeat(t.linePos+5)}^^^
`:"";return`
${i}${s}${t.type.toUpperCase()}: ${t.message}

`}return r!=null&&r.html?`<div class='luma-compiler-log-error' style="color:red;"><b> ${t.type.toUpperCase()}: ${t.message}</b></div>`:`${t.type.toUpperCase()}: ${t.message}`}function nO(t,e,n){let r="";for(let i=e-2;i<=e;i++){const s=t[i-1];s!==void 0&&(r+=VE(s,e,n))}return r}function VE(t,e,n){const r=n!=null&&n.html?iO(t):t;return`${rO(String(e),4)}: ${r}${n!=null&&n.html?"<br/>":`
`}`}function rO(t,e){let n="";for(let r=t.length;r<e;++r)n+=" ";return n+t}function iO(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function $E(t,e){return{name:sO(t,e),language:"glsl",version:oO(t)}}function sO(t,e="unnamed"){const r=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(t);return r?r[1]:e}function oO(t){let e=100;const n=t.match(/[^\s]+/g);if(n&&n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const Jc=class Jc extends oe{constructor(n,r){super(n,{id:aO(r),...r},Jc.defaultProps);T(this,"stage");T(this,"source");T(this,"compilationStatus","pending");this.stage=this.props.stage,this.source=this.props.source}get[Symbol.toStringTag](){return"Shader"}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(n=this.props.debug){switch(n){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const r=await this.getCompilationInfo();this.props.debug==="warnings"&&(r==null?void 0:r.length)===0||this._displayShaderLog(r)}_displayShaderLog(n){var c;if(typeof document>"u"||!(document!=null&&document.createElement))return;const r=$E(this.source).name,i=`${this.stage} ${r}`;let s=tO(n,this.source,{showSourceCode:"all",html:!0});const o=this.getTranslatedSource();o&&(s+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${o}</pre></code>`);const a=document.createElement("Button");a.innerHTML=`
<h1>Shader Compilation Error in ${i}</h1><br /><br />
<code style="user-select:text;"><pre>
${s}
</pre></code>`,a.style.top="10px",a.style.left="10px",a.style.position="absolute",a.style.zIndex="9999",a.style.width="100%",a.style.textAlign="left",document.body.appendChild(a);const l=document.getElementsByClassName("luma-compiler-log-error");(c=l[0])!=null&&c.scrollIntoView&&l[0].scrollIntoView(),a.onclick=()=>{const u=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(u)}}};T(Jc,"defaultProps",{...oe.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debug:"errors"});let Mc=Jc;function aO(t){return $E(t.source).name||t.id||ui(`unnamed ${t.stage}-shader`)}const Gc=class Gc extends oe{get[Symbol.toStringTag](){return"Sampler"}constructor(e,n){super(e,n,Gc.defaultProps)}};T(Gc,"defaultProps",{...oe.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"nearest",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1});let Nc=Gc;const eu=class eu extends oe{constructor(n,r={}){super(n,r,eu.defaultProps);T(this,"width");T(this,"height");T(this,"colorAttachments",[]);T(this,"depthStencilAttachment",null);this.width=this.props.width,this.height=this.props.height}get[Symbol.toStringTag](){return"Framebuffer"}resize(n){let r=!n;if(n){const[i,s]=Array.isArray(n)?n:[n.width,n.height];r=r||s!==this.height||i!==this.width,this.width=i,this.height=s}r&&(U.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map(r=>{if(typeof r=="string"){const i=this.createColorTexture(r);return this.attachResource(i),i.view}return r instanceof bt?r.view:r});const n=this.props.depthStencilAttachment;if(n)if(typeof n=="string"){const r=this.createDepthStencilTexture(n);this.attachResource(r),this.depthStencilAttachment=r.view}else n instanceof bt?this.depthStencilAttachment=n.view:this.depthStencilAttachment=n}createColorTexture(n){return this.device.createTexture({id:"color-attachment",usage:bt.RENDER_ATTACHMENT,format:n,width:this.width,height:this.height})}createDepthStencilTexture(n){return this.device.createTexture({id:"depth-stencil-attachment",usage:bt.RENDER_ATTACHMENT,format:n,width:this.width,height:this.height})}resizeAttachments(n,r){for(let i=0;i<this.colorAttachments.length;++i)if(this.colorAttachments[i]){const s=this.device._createTexture({...this.colorAttachments[i].props,width:n,height:r});this.destroyAttachedResource(this.colorAttachments[i]),this.colorAttachments[i]=s.view,this.attachResource(s.view)}if(this.depthStencilAttachment){const i=this.device._createTexture({...this.depthStencilAttachment.props,width:n,height:r});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=i.view,this.attachResource(i)}}};T(eu,"defaultProps",{...oe.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null});let Oc=eu;const tu=class tu extends oe{constructor(n,r){super(n,r,tu.defaultProps);T(this,"shaderLayout");T(this,"bufferLayout");T(this,"linkStatus","pending");T(this,"hash","");this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}get[Symbol.toStringTag](){return"RenderPipeline"}setUniformsWebGL(n){throw new Error("Use uniform blocks")}};T(tu,"defaultProps",{...oe.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}});let _s=tu;const nu=class nu extends oe{get[Symbol.toStringTag](){return"RenderPass"}constructor(e,n){super(e,n,nu.defaultProps)}};T(nu,"defaultProps",{...oe.defaultProps,framebuffer:null,parameters:void 0,clearColor:[0,0,0,0],clearDepth:1,clearStencil:0,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0});let Zd=nu;const ru=class ru extends oe{constructor(n,r){super(n,r,ru.defaultProps);T(this,"hash","")}get[Symbol.toStringTag](){return"ComputePipeline"}};T(ru,"defaultProps",{...oe.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0});let kc=ru;const iu=class iu extends oe{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,n){super(e,n,iu.defaultProps)}};T(iu,"defaultProps",{...oe.defaultProps,measureExecutionTime:void 0});let Qd=iu;const su=class su extends oe{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,n){super(e,n,su.defaultProps)}};T(su,"defaultProps",{...oe.defaultProps});let Jd=su;function lO(t){const[e,n]=uO[t],r=e==="i32"||e==="u32",i=e!=="u32",s=fO[e]*n,o=cO(e,n);return{dataType:e,components:n,defaultVertexFormat:o,byteLength:s,integer:r,signed:i}}function cO(t,e){let n;switch(t){case"f32":n="float32";break;case"i32":n="sint32";break;case"u32":n="uint32";break;case"f16":return e<=2?"float16x2":"float16x4"}return e===1?n:`${n}x${e}`}const uO={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},fO={f32:4,f16:2,i32:4,u32:4};function jE(t){let e;t.endsWith("-webgl")&&(t.replace("-webgl",""),e=!0);const[n,r]=t.split("x"),i=n,s=r?parseInt(r):1,o=UE(i),a={type:i,components:s,byteLength:o.byteLength*s,integer:o.integer,signed:o.signed,normalized:o.normalized};return e&&(a.webglOnly=!0),a}function WE(t,e){const n={};for(const r of t.attributes)n[r.name]=dO(t,e,r.name);return n}function hO(t,e,n=16){const r=WE(t,e),i=new Array(n).fill(null);for(const s of Object.values(r))i[s.location]=s;return i}function dO(t,e,n){const r=pO(t,n),i=gO(e,n);if(!r)return null;const s=lO(r.type),o=(i==null?void 0:i.vertexFormat)||s.defaultVertexFormat,a=jE(o);return{attributeName:(i==null?void 0:i.attributeName)||r.name,bufferName:(i==null?void 0:i.bufferName)||r.name,location:r.location,shaderType:r.type,shaderDataType:s.dataType,shaderComponents:s.components,vertexFormat:o,bufferDataType:a.type,bufferComponents:a.components,normalized:a.normalized,integer:s.integer,stepMode:(i==null?void 0:i.stepMode)||r.stepMode,byteOffset:(i==null?void 0:i.byteOffset)||0,byteStride:(i==null?void 0:i.byteStride)||0}}function pO(t,e){const n=t.attributes.find(r=>r.name===e);return n||U.warn(`shader layout attribute "${e}" not present in shader`),n||null}function gO(t,e){_O(t);let n=mO(t,e);return n||(n=yO(t,e),n)?n:(U.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function _O(t){for(const e of t)(e.attributes&&e.format||!e.attributes&&!e.format)&&U.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function mO(t,e){for(const n of t)if(n.format&&n.name===e)return{attributeName:n.name,bufferName:e,stepMode:n.stepMode,vertexFormat:n.format,byteOffset:0,byteStride:n.byteStride||0};return null}function yO(t,e){var n;for(const r of t){let i=r.byteStride;if(typeof r.byteStride!="number")for(const o of r.attributes||[]){const a=jE(o.format);i+=a.byteLength}const s=(n=r.attributes)==null?void 0:n.find(o=>o.attribute===e);if(s)return{attributeName:s.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:s.format,byteOffset:s.byteOffset,byteStride:i}}return null}function vO(t,e){const n={...t,attributes:t.attributes.map(r=>({...r}))};for(const r of(e==null?void 0:e.attributes)||[]){const i=n.attributes.find(s=>s.name===r.name);i?(i.type=r.type||i.type,i.stepMode=r.stepMode||i.stepMode):U.warn(`shader layout attribute ${r.name} not present in shader`)}return n}const ou=class ou extends oe{constructor(n,r){super(n,r,ou.defaultProps);T(this,"maxVertexAttributes");T(this,"attributeInfos");T(this,"indexBuffer",null);T(this,"attributes");this.maxVertexAttributes=n.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=hO(r.renderPipeline.shaderLayout,r.renderPipeline.bufferLayout,this.maxVertexAttributes)}get[Symbol.toStringTag](){return"VertexArray"}setConstantWebGL(n,r){throw new Error("constant attributes not supported")}};T(ou,"defaultProps",{...oe.defaultProps,renderPipeline:null});let Gd=ou;const au=class au extends oe{get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,n){super(e,n,au.defaultProps)}};T(au,"defaultProps",{...oe.defaultProps,layout:void 0,buffers:{}});let ep=au;const lu=class lu extends oe{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,n){super(e,n,lu.defaultProps)}};T(lu,"defaultProps",{...oe.defaultProps,type:void 0,count:void 0});let tp=lu;const TO={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function wO(t){const e=TO[t];return ue(t),e}function SO(t,e){switch(e){case 1:return t;case 2:return t+t%2;default:return t+(4-t%4)%4}}let al;function HE(t){return(!al||al.byteLength<t)&&(al=new ArrayBuffer(t)),al}function EO(t,e){const n=HE(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function bO(t){const{target:e,source:n,start:r=0,count:i=1}=t,s=n.length,o=i*s;let a=0;for(let l=r;a<s;a++)e[l++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(r+a,r,r+a),a*=2):(e.copyWithin(r+a,r,r+o-a),a=o);return t.target}const c0=1024;class AO{constructor(e){T(this,"layout",{});T(this,"byteLength");let n=0;for(const[i,s]of Object.entries(e)){const o=wO(s),{type:a,components:l}=o;n=SO(n,l);const c=n;n+=l,this.layout[i]={type:a,size:l,offset:c}}n+=(4-n%4)%4;const r=n*4;this.byteLength=Math.max(r,c0)}getData(e){const n=Math.max(this.byteLength,c0),r=HE(n),i={i32:new Int32Array(r),u32:new Uint32Array(r),f32:new Float32Array(r),f16:new Uint16Array(r)};for(const[s,o]of Object.entries(e)){const a=this.layout[s];if(!a){U.warn(`Supplied uniform value ${s} not present in uniform block layout`)();continue}const{type:l,size:c,offset:u}=a,f=i[l];if(c===1){if(typeof o!="number"&&typeof o!="boolean"){U.warn(`Supplied value for single component uniform ${s} is not a number: ${o}`)();continue}f[u]=Number(o)}else{const h=Ko(o);if(!h){U.warn(`Supplied value for multi component / array uniform ${s} is not a numeric array: ${o}`)();continue}f.set(h,u)}}return new Uint8Array(r)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}function RO(t,e,n=16){if(t!==e)return!1;const r=Ko(t);if(!r)return!1;const i=Ko(e);if(i&&r.length===i.length){for(let s=0;s<r.length;++s)if(i[s]!==r[s])return!1}return!0}function xO(t){const e=Ko(t);return e?e.slice():t}class CO{constructor(e){T(this,"name");T(this,"uniforms",{});T(this,"modifiedUniforms",{});T(this,"modified",!0);T(this,"bindingLayout",{});T(this,"needsRedraw","initialized");var n;if(this.name=e==null?void 0:e.name,e!=null&&e.name&&(e!=null&&e.shaderLayout)){const r=(n=e==null?void 0:e.shaderLayout.bindings)==null?void 0:n.find(s=>s.type==="uniform"&&s.name===(e==null?void 0:e.name));if(!r)throw new Error(e==null?void 0:e.name);const i=r;for(const s of i.uniforms||[])this.bindingLayout[s.name]=s}}setUniforms(e){for(const[n,r]of Object.entries(e))this._setUniform(n,r),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${n}=${r}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,n){RO(this.uniforms[e],n)||(this.uniforms[e]=xO(n),this.modifiedUniforms[e]=!0,this.modified=!0)}}class PO{constructor(e){T(this,"uniformBlocks",new Map);T(this,"uniformBufferLayouts",new Map);T(this,"uniformBuffers",new Map);for(const[n,r]of Object.entries(e)){const i=n,s=new AO(r.uniformTypes||{});this.uniformBufferLayouts.set(i,s);const o=new CO({name:n});o.setUniforms(r.defaultUniforms||{}),this.uniformBlocks.set(i,o)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[n,r]of Object.entries(e))this.uniformBlocks.get(n).setUniforms(r);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e).byteLength}getUniformBufferData(e){const n=this.uniformBlocks.get(e).getAllUniforms();return this.uniformBufferLayouts.get(e).getData(n)}createUniformBuffer(e,n,r){r&&this.setUniforms(r);const i=this.getUniformBufferByteLength(n),s=e.createBuffer({usage:ge.UNIFORM|ge.COPY_DST,byteLength:i}),o=this.getUniformBufferData(n);return s.write(o),s}getManagedUniformBuffer(e,n){if(!this.uniformBuffers.get(n)){const r=this.getUniformBufferByteLength(n),i=e.createBuffer({usage:ge.UNIFORM|ge.COPY_DST,byteLength:r});this.uniformBuffers.set(n,i)}return this.uniformBuffers.get(n)}updateUniformBuffers(){let e=!1;for(const n of this.uniformBlocks.keys()){const r=this.updateUniformBuffer(n);e||(e=r)}return e&&U.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const n=this.uniformBlocks.get(e),r=this.uniformBuffers.get(e);let i=!1;if(r&&n.needsRedraw){i||(i=n.needsRedraw);const s=this.getUniformBufferData(e);this.uniformBuffers.get(e).write(s);const a=this.uniformBlocks.get(e).getAllUniforms();U.log(4,`Writing to uniform buffer ${String(e)}`,s,a)()}return i}}function XE(t){const e=ArrayBuffer.isView(t)?t.constructor:t;switch(e){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(e.constructor.name)}}function YE(t){switch(t){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(t)}}function IO(t,e,n){if(!e||e>4)throw new Error(`size ${e}`);const r=e;let i=XE(t);if(i==="uint8"&&n&&r===1)return"unorm8-webgl";if(i==="uint8"&&n&&r===3)return"unorm8x3-webgl";if(i==="uint8"||i==="sint8"){if(r===1||r===3)throw new Error(`size: ${e}`);return n&&(i=i.replace("int","norm")),`${i}x${r}`}if(i==="uint16"||i==="sint16"){if(r===1||r===3)throw new Error(`size: ${e}`);return n&&(i=i.replace("int","norm")),`${i}x${r}`}return r===1?i:`${i}x${r}`}function MO(t){return Ko(t)!==null||typeof t=="number"||typeof t=="boolean"}function m_(t){const e={bindings:{},uniforms:{}};return Object.keys(t).forEach(n=>{const r=t[n];MO(r)?e.uniforms[n]=r:e.bindings[n]=r}),e}function NO(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:s={}}=n;for(const a in r)if(a in e){const c=r[a]?`${t}.${r[a]}`:"N/A";U.removed(`${t}.${a}`,c)()}for(const a in i)if(a in e){const l=i[a];U.deprecated(`${t}.${a}`,`${t}.${l}`)()}let o=null;for(const[a,l]of Object.entries(s))a in e&&(U.deprecated(`${t}.${a}`,`${t}.${l}`)(),o=o||Object.assign({},e),o[l]=e[a],delete o[a]);return o||e}let OO="";async function kO(t,e){return await new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error(`Could not load image ${t}.`)),i.crossOrigin=(e==null?void 0:e.crossOrigin)||"anonymous",i.src=t.startsWith("http")?t:OO+t}catch(i){r(i)}})}async function KE(t,e){const n=document.getElementsByTagName("head")[0];if(!n)throw new Error("loadScript");const r=document.createElement("script");return r.setAttribute("type","text/javascript"),r.setAttribute("src",t),e&&(r.id=e),new Promise((i,s)=>{r.onload=i,r.onerror=o=>s(new Error(`Unable to load script '${t}': ${o}`)),n.appendChild(r)})}function np(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!np(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!np(t[s],e[s],n-1))return!1;return!0}return!1}function FO(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function DO(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}class BO{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}let Dn=class{constructor(){}get isAstNode(){return!0}get astNodeType(){return""}evaluate(e){throw new Error("Cannot evaluate node")}evaluateString(e){return this.evaluate(e).toString()}search(e){}searchBlock(e,n){if(e){n(Fc.instance);for(const r of e)r instanceof Array?this.searchBlock(r,n):r.search(n);n(Dc.instance)}}};class Fc extends Dn{}Fc.instance=new Fc;class Dc extends Dn{}Dc.instance=new Dc;class _e extends Dn{constructor(){super()}}class rp extends _e{constructor(e,n,r,i,s,o){super(),this.calls=new Set,this.name=e,this.args=n,this.returnType=r,this.body=i,this.startLine=s,this.endLine=o}get astNodeType(){return"function"}search(e){this.searchBlock(this.body,e)}}class LO extends _e{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class UO extends _e{constructor(e,n){super(),this.condition=e,this.body=n}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class zO extends _e{constructor(e){super(),this.body=e}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class VO extends _e{constructor(e,n,r,i){super(),this.init=e,this.condition=n,this.increment=r,this.body=i}get astNodeType(){return"for"}search(e){var n,r,i;(n=this.init)===null||n===void 0||n.search(e),(r=this.condition)===null||r===void 0||r.search(e),(i=this.increment)===null||i===void 0||i.search(e),this.searchBlock(this.body,e)}}class Fr extends _e{constructor(e,n,r,i,s){super(),this.name=e,this.type=n,this.storage=r,this.access=i,this.value=s}get astNodeType(){return"var"}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}}class qE extends _e{constructor(e,n,r){super(),this.name=e,this.type=n,this.value=r}get astNodeType(){return"override"}search(e){var n;(n=this.value)===null||n===void 0||n.search(e)}}class ip extends _e{constructor(e,n,r,i,s){super(),this.name=e,this.type=n,this.storage=r,this.access=i,this.value=s}get astNodeType(){return"let"}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}}class u0 extends _e{constructor(e,n,r,i,s){super(),this.name=e,this.type=n,this.storage=r,this.access=i,this.value=s}get astNodeType(){return"const"}evaluate(e){return this.value.evaluate(e)}search(e){var n;e(this),(n=this.value)===null||n===void 0||n.search(e)}}var ms;(function(t){t.increment="++",t.decrement="--"})(ms||(ms={}));(function(t){function e(n){const r=n;if(r=="parse")throw new Error("Invalid value for IncrementOperator");return t[r]}t.parse=e})(ms||(ms={}));class $O extends _e{constructor(e,n){super(),this.operator=e,this.variable=n}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}var qo;(function(t){t.assign="=",t.addAssign="+=",t.subtractAssin="-=",t.multiplyAssign="*=",t.divideAssign="/=",t.moduloAssign="%=",t.andAssign="&=",t.orAssign="|=",t.xorAssign="^=",t.shiftLeftAssign="<<=",t.shiftRightAssign=">>="})(qo||(qo={}));(function(t){function e(n){const r=n;if(r=="parse")throw new Error("Invalid value for AssignOperator");return r}t.parse=e})(qo||(qo={}));class jO extends _e{constructor(e,n,r){super(),this.operator=e,this.variable=n,this.value=r}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class ZE extends _e{constructor(e,n){super(),this.name=e,this.args=n}get astNodeType(){return"call"}search(e){for(const n of this.args)n.search(e);e(this)}}class WO extends _e{constructor(e,n){super(),this.body=e,this.continuing=n}get astNodeType(){return"loop"}}class HO extends _e{constructor(e,n){super(),this.condition=e,this.body=n}get astNodeType(){return"body"}}class XO extends _e{constructor(e,n,r,i){super(),this.condition=e,this.body=n,this.elseif=r,this.else=i}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class YO extends _e{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var n;(n=this.value)===null||n===void 0||n.search(e)}}class KO extends _e{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class qO extends _e{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class ZO extends _e{constructor(e,n){super(),this.severity=e,this.rule=n}get astNodeType(){return"diagnostic"}}class QE extends _e{constructor(e,n){super(),this.name=e,this.type=n}get astNodeType(){return"alias"}}class QO extends _e{constructor(){super()}get astNodeType(){return"discard"}}class JO extends _e{constructor(){super()}get astNodeType(){return"break"}}class GO extends _e{constructor(){super()}get astNodeType(){return"continue"}}class fi extends _e{constructor(e){super(),this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}}class kr extends fi{constructor(e,n,r,i){super(e),this.members=n,this.startLine=r,this.endLine=i}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let n=0;n<this.members.length;n++)if(this.members[n].name==e)return n;return-1}}class JE extends fi{constructor(e,n,r){super(e),this.format=n,this.access=r}get astNodeType(){return"template"}}class ek extends fi{constructor(e,n,r,i){super(e),this.storage=n,this.type=r,this.access=i}get astNodeType(){return"pointer"}}class GE extends fi{constructor(e,n,r,i){super(e),this.attributes=n,this.format=r,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}}class so extends fi{constructor(e,n,r){super(e),this.format=n,this.access=r}get astNodeType(){return"sampler"}}class Wt extends Dn{constructor(){super()}}class f0 extends Wt{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}evaluateString(){return this.value}}class zi extends Wt{constructor(e,n){super(),this.type=e,this.args=n}get astNodeType(){return"createExpr"}search(e){e(this);for(const n of this.args)n.search(e)}}class e1 extends Wt{constructor(e,n){super(),this.name=e,this.args=n}get astNodeType(){return"callExpr"}evaluate(e){switch(this.name){case"abs":return Math.abs(this.args[0].evaluate(e));case"acos":return Math.acos(this.args[0].evaluate(e));case"acosh":return Math.acosh(this.args[0].evaluate(e));case"asin":return Math.asin(this.args[0].evaluate(e));case"asinh":return Math.asinh(this.args[0].evaluate(e));case"atan":return Math.atan(this.args[0].evaluate(e));case"atan2":return Math.atan2(this.args[0].evaluate(e),this.args[1].evaluate(e));case"atanh":return Math.atanh(this.args[0].evaluate(e));case"ceil":return Math.ceil(this.args[0].evaluate(e));case"clamp":return Math.min(Math.max(this.args[0].evaluate(e),this.args[1].evaluate(e)),this.args[2].evaluate(e));case"cos":return Math.cos(this.args[0].evaluate(e));case"degrees":return this.args[0].evaluate(e)*180/Math.PI;case"distance":return Math.sqrt(Math.pow(this.args[0].evaluate(e)-this.args[1].evaluate(e),2));case"dot":case"exp":return Math.exp(this.args[0].evaluate(e));case"exp2":return Math.pow(2,this.args[0].evaluate(e));case"floor":return Math.floor(this.args[0].evaluate(e));case"fma":return this.args[0].evaluate(e)*this.args[1].evaluate(e)+this.args[2].evaluate(e);case"fract":return this.args[0].evaluate(e)-Math.floor(this.args[0].evaluate(e));case"inverseSqrt":return 1/Math.sqrt(this.args[0].evaluate(e));case"log":return Math.log(this.args[0].evaluate(e));case"log2":return Math.log2(this.args[0].evaluate(e));case"max":return Math.max(this.args[0].evaluate(e),this.args[1].evaluate(e));case"min":return Math.min(this.args[0].evaluate(e),this.args[1].evaluate(e));case"mix":return this.args[0].evaluate(e)*(1-this.args[2].evaluate(e))+this.args[1].evaluate(e)*this.args[2].evaluate(e);case"modf":return this.args[0].evaluate(e)-Math.floor(this.args[0].evaluate(e));case"pow":return Math.pow(this.args[0].evaluate(e),this.args[1].evaluate(e));case"radians":return this.args[0].evaluate(e)*Math.PI/180;case"round":return Math.round(this.args[0].evaluate(e));case"sign":return Math.sign(this.args[0].evaluate(e));case"sin":return Math.sin(this.args[0].evaluate(e));case"sinh":return Math.sinh(this.args[0].evaluate(e));case"saturate":return Math.min(Math.max(this.args[0].evaluate(e),0),1);case"smoothstep":return this.args[0].evaluate(e)*this.args[0].evaluate(e)*(3-2*this.args[0].evaluate(e));case"sqrt":return Math.sqrt(this.args[0].evaluate(e));case"step":return this.args[0].evaluate(e)<this.args[1].evaluate(e)?0:1;case"tan":return Math.tan(this.args[0].evaluate(e));case"tanh":return Math.tanh(this.args[0].evaluate(e));case"trunc":return Math.trunc(this.args[0].evaluate(e));default:throw new Error("Non const function: "+this.name)}}search(e){for(const n of this.args)n.search(e);e(this)}}class sp extends Wt{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}evaluate(e){const n=e.constants.get(this.name);if(!n)throw new Error("Cannot evaluate node");return n.evaluate(e)}}class h0 extends Wt{constructor(e,n){super(),this.name=e,this.initializer=n}get astNodeType(){return"constExpr"}evaluate(e){var n,r;if(this.initializer instanceof zi){const i=(n=this.postfix)===null||n===void 0?void 0:n.evaluateString(e),s=(r=this.initializer.type)===null||r===void 0?void 0:r.name,o=e.structs.get(s),a=o==null?void 0:o.getMemberIndex(i);if(a!=-1)return this.initializer.args[a].evaluate(e);console.log(a)}return this.initializer.evaluate(e)}search(e){this.initializer.search(e)}}class d0 extends Wt{constructor(e){super(),this.value=e}get astNodeType(){return"literalExpr"}evaluate(){return this.value}}class tk extends Wt{constructor(e,n){super(),this.type=e,this.value=n}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class nk extends Wt{constructor(e,n){super(),this.type=e,this.args=n}get astNodeType(){return"typecastExpr"}evaluate(e){return this.args[0].evaluate(e)}search(e){this.searchBlock(this.args,e)}}class p0 extends Wt{constructor(e){super(),this.contents=e}get astNodeType(){return"groupExpr"}evaluate(e){return this.contents[0].evaluate(e)}search(e){this.searchBlock(this.contents,e)}}class rk extends Wt{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class t1 extends Wt{constructor(){super()}}class ik extends t1{constructor(e,n){super(),this.operator=e,this.right=n}get astNodeType(){return"unaryOp"}evaluate(e){switch(this.operator){case"+":return this.right.evaluate(e);case"-":return-this.right.evaluate(e);case"!":return this.right.evaluate(e)?0:1;case"~":return~this.right.evaluate(e);default:throw new Error("Unknown unary operator: "+this.operator)}}search(e){this.right.search(e)}}class Kt extends t1{constructor(e,n,r){super(),this.operator=e,this.left=n,this.right=r}get astNodeType(){return"binaryOp"}evaluate(e){switch(this.operator){case"+":return this.left.evaluate(e)+this.right.evaluate(e);case"-":return this.left.evaluate(e)-this.right.evaluate(e);case"*":return this.left.evaluate(e)*this.right.evaluate(e);case"/":return this.left.evaluate(e)/this.right.evaluate(e);case"%":return this.left.evaluate(e)%this.right.evaluate(e);case"==":return this.left.evaluate(e)==this.right.evaluate(e)?1:0;case"!=":return this.left.evaluate(e)!=this.right.evaluate(e)?1:0;case"<":return this.left.evaluate(e)<this.right.evaluate(e)?1:0;case">":return this.left.evaluate(e)>this.right.evaluate(e)?1:0;case"<=":return this.left.evaluate(e)<=this.right.evaluate(e)?1:0;case">=":return this.left.evaluate(e)>=this.right.evaluate(e)?1:0;case"&&":return this.left.evaluate(e)&&this.right.evaluate(e)?1:0;case"||":return this.left.evaluate(e)||this.right.evaluate(e)?1:0;default:throw new Error(`Unknown operator ${this.operator}`)}}search(e){this.left.search(e),this.right.search(e)}}class n1 extends Dn{constructor(){super()}}class sk extends n1{constructor(e,n){super(),this.selector=e,this.body=n}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class ok extends n1{constructor(e){super(),this.body=e}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class ak extends Dn{constructor(e,n,r){super(),this.name=e,this.type=n,this.attributes=r}get astNodeType(){return"argument"}}class lk extends Dn{constructor(e,n){super(),this.condition=e,this.body=n}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class ck extends Dn{constructor(e,n,r){super(),this.name=e,this.type=n,this.attributes=r}get astNodeType(){return"member"}}let uk=class extends Dn{constructor(e,n){super(),this.name=e,this.value=n}get astNodeType(){return"attribute"}};var M,x;(function(t){t[t.token=0]="token",t[t.keyword=1]="keyword",t[t.reserved=2]="reserved"})(x||(x={}));class C{constructor(e,n,r){this.name=e,this.type=n,this.rule=r}toString(){return this.name}}class E{}M=E;E.none=new C("",x.reserved,"");E.eof=new C("EOF",x.token,"");E.reserved={asm:new C("asm",x.reserved,"asm"),bf16:new C("bf16",x.reserved,"bf16"),do:new C("do",x.reserved,"do"),enum:new C("enum",x.reserved,"enum"),f16:new C("f16",x.reserved,"f16"),f64:new C("f64",x.reserved,"f64"),handle:new C("handle",x.reserved,"handle"),i8:new C("i8",x.reserved,"i8"),i16:new C("i16",x.reserved,"i16"),i64:new C("i64",x.reserved,"i64"),mat:new C("mat",x.reserved,"mat"),premerge:new C("premerge",x.reserved,"premerge"),regardless:new C("regardless",x.reserved,"regardless"),typedef:new C("typedef",x.reserved,"typedef"),u8:new C("u8",x.reserved,"u8"),u16:new C("u16",x.reserved,"u16"),u64:new C("u64",x.reserved,"u64"),unless:new C("unless",x.reserved,"unless"),using:new C("using",x.reserved,"using"),vec:new C("vec",x.reserved,"vec"),void:new C("void",x.reserved,"void")};E.keywords={array:new C("array",x.keyword,"array"),atomic:new C("atomic",x.keyword,"atomic"),bool:new C("bool",x.keyword,"bool"),f32:new C("f32",x.keyword,"f32"),i32:new C("i32",x.keyword,"i32"),mat2x2:new C("mat2x2",x.keyword,"mat2x2"),mat2x3:new C("mat2x3",x.keyword,"mat2x3"),mat2x4:new C("mat2x4",x.keyword,"mat2x4"),mat3x2:new C("mat3x2",x.keyword,"mat3x2"),mat3x3:new C("mat3x3",x.keyword,"mat3x3"),mat3x4:new C("mat3x4",x.keyword,"mat3x4"),mat4x2:new C("mat4x2",x.keyword,"mat4x2"),mat4x3:new C("mat4x3",x.keyword,"mat4x3"),mat4x4:new C("mat4x4",x.keyword,"mat4x4"),ptr:new C("ptr",x.keyword,"ptr"),sampler:new C("sampler",x.keyword,"sampler"),sampler_comparison:new C("sampler_comparison",x.keyword,"sampler_comparison"),struct:new C("struct",x.keyword,"struct"),texture_1d:new C("texture_1d",x.keyword,"texture_1d"),texture_2d:new C("texture_2d",x.keyword,"texture_2d"),texture_2d_array:new C("texture_2d_array",x.keyword,"texture_2d_array"),texture_3d:new C("texture_3d",x.keyword,"texture_3d"),texture_cube:new C("texture_cube",x.keyword,"texture_cube"),texture_cube_array:new C("texture_cube_array",x.keyword,"texture_cube_array"),texture_multisampled_2d:new C("texture_multisampled_2d",x.keyword,"texture_multisampled_2d"),texture_storage_1d:new C("texture_storage_1d",x.keyword,"texture_storage_1d"),texture_storage_2d:new C("texture_storage_2d",x.keyword,"texture_storage_2d"),texture_storage_2d_array:new C("texture_storage_2d_array",x.keyword,"texture_storage_2d_array"),texture_storage_3d:new C("texture_storage_3d",x.keyword,"texture_storage_3d"),texture_depth_2d:new C("texture_depth_2d",x.keyword,"texture_depth_2d"),texture_depth_2d_array:new C("texture_depth_2d_array",x.keyword,"texture_depth_2d_array"),texture_depth_cube:new C("texture_depth_cube",x.keyword,"texture_depth_cube"),texture_depth_cube_array:new C("texture_depth_cube_array",x.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new C("texture_depth_multisampled_2d",x.keyword,"texture_depth_multisampled_2d"),texture_external:new C("texture_external",x.keyword,"texture_external"),u32:new C("u32",x.keyword,"u32"),vec2:new C("vec2",x.keyword,"vec2"),vec3:new C("vec3",x.keyword,"vec3"),vec4:new C("vec4",x.keyword,"vec4"),bitcast:new C("bitcast",x.keyword,"bitcast"),block:new C("block",x.keyword,"block"),break:new C("break",x.keyword,"break"),case:new C("case",x.keyword,"case"),continue:new C("continue",x.keyword,"continue"),continuing:new C("continuing",x.keyword,"continuing"),default:new C("default",x.keyword,"default"),diagnostic:new C("diagnostic",x.keyword,"diagnostic"),discard:new C("discard",x.keyword,"discard"),else:new C("else",x.keyword,"else"),enable:new C("enable",x.keyword,"enable"),fallthrough:new C("fallthrough",x.keyword,"fallthrough"),false:new C("false",x.keyword,"false"),fn:new C("fn",x.keyword,"fn"),for:new C("for",x.keyword,"for"),function:new C("function",x.keyword,"function"),if:new C("if",x.keyword,"if"),let:new C("let",x.keyword,"let"),const:new C("const",x.keyword,"const"),loop:new C("loop",x.keyword,"loop"),while:new C("while",x.keyword,"while"),private:new C("private",x.keyword,"private"),read:new C("read",x.keyword,"read"),read_write:new C("read_write",x.keyword,"read_write"),return:new C("return",x.keyword,"return"),requires:new C("requires",x.keyword,"requires"),storage:new C("storage",x.keyword,"storage"),switch:new C("switch",x.keyword,"switch"),true:new C("true",x.keyword,"true"),alias:new C("alias",x.keyword,"alias"),type:new C("type",x.keyword,"type"),uniform:new C("uniform",x.keyword,"uniform"),var:new C("var",x.keyword,"var"),override:new C("override",x.keyword,"override"),workgroup:new C("workgroup",x.keyword,"workgroup"),write:new C("write",x.keyword,"write"),r8unorm:new C("r8unorm",x.keyword,"r8unorm"),r8snorm:new C("r8snorm",x.keyword,"r8snorm"),r8uint:new C("r8uint",x.keyword,"r8uint"),r8sint:new C("r8sint",x.keyword,"r8sint"),r16uint:new C("r16uint",x.keyword,"r16uint"),r16sint:new C("r16sint",x.keyword,"r16sint"),r16float:new C("r16float",x.keyword,"r16float"),rg8unorm:new C("rg8unorm",x.keyword,"rg8unorm"),rg8snorm:new C("rg8snorm",x.keyword,"rg8snorm"),rg8uint:new C("rg8uint",x.keyword,"rg8uint"),rg8sint:new C("rg8sint",x.keyword,"rg8sint"),r32uint:new C("r32uint",x.keyword,"r32uint"),r32sint:new C("r32sint",x.keyword,"r32sint"),r32float:new C("r32float",x.keyword,"r32float"),rg16uint:new C("rg16uint",x.keyword,"rg16uint"),rg16sint:new C("rg16sint",x.keyword,"rg16sint"),rg16float:new C("rg16float",x.keyword,"rg16float"),rgba8unorm:new C("rgba8unorm",x.keyword,"rgba8unorm"),rgba8unorm_srgb:new C("rgba8unorm_srgb",x.keyword,"rgba8unorm_srgb"),rgba8snorm:new C("rgba8snorm",x.keyword,"rgba8snorm"),rgba8uint:new C("rgba8uint",x.keyword,"rgba8uint"),rgba8sint:new C("rgba8sint",x.keyword,"rgba8sint"),bgra8unorm:new C("bgra8unorm",x.keyword,"bgra8unorm"),bgra8unorm_srgb:new C("bgra8unorm_srgb",x.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new C("rgb10a2unorm",x.keyword,"rgb10a2unorm"),rg11b10float:new C("rg11b10float",x.keyword,"rg11b10float"),rg32uint:new C("rg32uint",x.keyword,"rg32uint"),rg32sint:new C("rg32sint",x.keyword,"rg32sint"),rg32float:new C("rg32float",x.keyword,"rg32float"),rgba16uint:new C("rgba16uint",x.keyword,"rgba16uint"),rgba16sint:new C("rgba16sint",x.keyword,"rgba16sint"),rgba16float:new C("rgba16float",x.keyword,"rgba16float"),rgba32uint:new C("rgba32uint",x.keyword,"rgba32uint"),rgba32sint:new C("rgba32sint",x.keyword,"rgba32sint"),rgba32float:new C("rgba32float",x.keyword,"rgba32float"),static_assert:new C("static_assert",x.keyword,"static_assert")};E.tokens={decimal_float_literal:new C("decimal_float_literal",x.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?f?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+f?)|([0-9]+f)/),hex_float_literal:new C("hex_float_literal",x.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+f?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+f?))/),int_literal:new C("int_literal",x.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new C("uint_literal",x.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),ident:new C("ident",x.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new C("and",x.token,"&"),and_and:new C("and_and",x.token,"&&"),arrow:new C("arrow ",x.token,"->"),attr:new C("attr",x.token,"@"),forward_slash:new C("forward_slash",x.token,"/"),bang:new C("bang",x.token,"!"),bracket_left:new C("bracket_left",x.token,"["),bracket_right:new C("bracket_right",x.token,"]"),brace_left:new C("brace_left",x.token,"{"),brace_right:new C("brace_right",x.token,"}"),colon:new C("colon",x.token,":"),comma:new C("comma",x.token,","),equal:new C("equal",x.token,"="),equal_equal:new C("equal_equal",x.token,"=="),not_equal:new C("not_equal",x.token,"!="),greater_than:new C("greater_than",x.token,">"),greater_than_equal:new C("greater_than_equal",x.token,">="),shift_right:new C("shift_right",x.token,">>"),less_than:new C("less_than",x.token,"<"),less_than_equal:new C("less_than_equal",x.token,"<="),shift_left:new C("shift_left",x.token,"<<"),modulo:new C("modulo",x.token,"%"),minus:new C("minus",x.token,"-"),minus_minus:new C("minus_minus",x.token,"--"),period:new C("period",x.token,"."),plus:new C("plus",x.token,"+"),plus_plus:new C("plus_plus",x.token,"++"),or:new C("or",x.token,"|"),or_or:new C("or_or",x.token,"||"),paren_left:new C("paren_left",x.token,"("),paren_right:new C("paren_right",x.token,")"),semicolon:new C("semicolon",x.token,";"),star:new C("star",x.token,"*"),tilde:new C("tilde",x.token,"~"),underscore:new C("underscore",x.token,"_"),xor:new C("xor",x.token,"^"),plus_equal:new C("plus_equal",x.token,"+="),minus_equal:new C("minus_equal",x.token,"-="),times_equal:new C("times_equal",x.token,"*="),division_equal:new C("division_equal",x.token,"/="),modulo_equal:new C("modulo_equal",x.token,"%="),and_equal:new C("and_equal",x.token,"&="),or_equal:new C("or_equal",x.token,"|="),xor_equal:new C("xor_equal",x.token,"^="),shift_right_equal:new C("shift_right_equal",x.token,">>="),shift_left_equal:new C("shift_left_equal",x.token,"<<=")};E.simpleTokens={"@":M.tokens.attr,"{":M.tokens.brace_left,"}":M.tokens.brace_right,":":M.tokens.colon,",":M.tokens.comma,"(":M.tokens.paren_left,")":M.tokens.paren_right,";":M.tokens.semicolon};E.literalTokens={"&":M.tokens.and,"&&":M.tokens.and_and,"->":M.tokens.arrow,"/":M.tokens.forward_slash,"!":M.tokens.bang,"[":M.tokens.bracket_left,"]":M.tokens.bracket_right,"=":M.tokens.equal,"==":M.tokens.equal_equal,"!=":M.tokens.not_equal,">":M.tokens.greater_than,">=":M.tokens.greater_than_equal,">>":M.tokens.shift_right,"<":M.tokens.less_than,"<=":M.tokens.less_than_equal,"<<":M.tokens.shift_left,"%":M.tokens.modulo,"-":M.tokens.minus,"--":M.tokens.minus_minus,".":M.tokens.period,"+":M.tokens.plus,"++":M.tokens.plus_plus,"|":M.tokens.or,"||":M.tokens.or_or,"*":M.tokens.star,"~":M.tokens.tilde,_:M.tokens.underscore,"^":M.tokens.xor,"+=":M.tokens.plus_equal,"-=":M.tokens.minus_equal,"*=":M.tokens.times_equal,"/=":M.tokens.division_equal,"%=":M.tokens.modulo_equal,"&=":M.tokens.and_equal,"|=":M.tokens.or_equal,"^=":M.tokens.xor_equal,">>=":M.tokens.shift_right_equal,"<<=":M.tokens.shift_left_equal};E.regexTokens={decimal_float_literal:M.tokens.decimal_float_literal,hex_float_literal:M.tokens.hex_float_literal,int_literal:M.tokens.int_literal,uint_literal:M.tokens.uint_literal,ident:M.tokens.ident};E.storage_class=[M.keywords.function,M.keywords.private,M.keywords.workgroup,M.keywords.uniform,M.keywords.storage];E.access_mode=[M.keywords.read,M.keywords.write,M.keywords.read_write];E.sampler_type=[M.keywords.sampler,M.keywords.sampler_comparison];E.sampled_texture_type=[M.keywords.texture_1d,M.keywords.texture_2d,M.keywords.texture_2d_array,M.keywords.texture_3d,M.keywords.texture_cube,M.keywords.texture_cube_array];E.multisampled_texture_type=[M.keywords.texture_multisampled_2d];E.storage_texture_type=[M.keywords.texture_storage_1d,M.keywords.texture_storage_2d,M.keywords.texture_storage_2d_array,M.keywords.texture_storage_3d];E.depth_texture_type=[M.keywords.texture_depth_2d,M.keywords.texture_depth_2d_array,M.keywords.texture_depth_cube,M.keywords.texture_depth_cube_array,M.keywords.texture_depth_multisampled_2d];E.texture_external_type=[M.keywords.texture_external];E.any_texture_type=[...M.sampled_texture_type,...M.multisampled_texture_type,...M.storage_texture_type,...M.depth_texture_type,...M.texture_external_type];E.texel_format=[M.keywords.r8unorm,M.keywords.r8snorm,M.keywords.r8uint,M.keywords.r8sint,M.keywords.r16uint,M.keywords.r16sint,M.keywords.r16float,M.keywords.rg8unorm,M.keywords.rg8snorm,M.keywords.rg8uint,M.keywords.rg8sint,M.keywords.r32uint,M.keywords.r32sint,M.keywords.r32float,M.keywords.rg16uint,M.keywords.rg16sint,M.keywords.rg16float,M.keywords.rgba8unorm,M.keywords.rgba8unorm_srgb,M.keywords.rgba8snorm,M.keywords.rgba8uint,M.keywords.rgba8sint,M.keywords.bgra8unorm,M.keywords.bgra8unorm_srgb,M.keywords.rgb10a2unorm,M.keywords.rg11b10float,M.keywords.rg32uint,M.keywords.rg32sint,M.keywords.rg32float,M.keywords.rgba16uint,M.keywords.rgba16sint,M.keywords.rgba16float,M.keywords.rgba32uint,M.keywords.rgba32sint,M.keywords.rgba32float];E.const_literal=[M.tokens.int_literal,M.tokens.uint_literal,M.tokens.decimal_float_literal,M.tokens.hex_float_literal,M.keywords.true,M.keywords.false];E.literal_or_ident=[M.tokens.ident,M.tokens.int_literal,M.tokens.uint_literal,M.tokens.decimal_float_literal,M.tokens.hex_float_literal];E.element_count_expression=[M.tokens.int_literal,M.tokens.uint_literal,M.tokens.ident];E.template_types=[M.keywords.vec2,M.keywords.vec3,M.keywords.vec4,M.keywords.mat2x2,M.keywords.mat2x3,M.keywords.mat2x4,M.keywords.mat3x2,M.keywords.mat3x3,M.keywords.mat3x4,M.keywords.mat4x2,M.keywords.mat4x3,M.keywords.mat4x4,M.keywords.atomic,M.keywords.bitcast,...M.any_texture_type];E.attribute_name=[M.tokens.ident,M.keywords.block,M.keywords.diagnostic];E.assignment_operators=[M.tokens.equal,M.tokens.plus_equal,M.tokens.minus_equal,M.tokens.times_equal,M.tokens.division_equal,M.tokens.modulo_equal,M.tokens.and_equal,M.tokens.or_equal,M.tokens.xor_equal,M.tokens.shift_right_equal,M.tokens.shift_left_equal];E.increment_operators=[M.tokens.plus_plus,M.tokens.minus_minus];class g0{constructor(e,n,r){this.type=e,this.lexeme=n,this.line=r}toString(){return this.lexeme}isTemplateType(){return E.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==E.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class fk{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new g0(E.eof,"",this._line)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}else if(this._peekAhead()=="*"){this._advance();let o=1;for(;o>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),o--,o==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),o++)}return!0}}const n=E.simpleTokens[e];if(n)return this._addToken(n),!0;let r=E.none;const i=this._isAlpha(e),s=e==="_";if(this._isAlphaNumeric(e)){let o=this._peekAhead();for(;this._isAlphaNumeric(o);)e+=this._advance(),o=this._peekAhead()}if(i){const o=E.keywords[e];if(o)return this._addToken(o),!0}if(i||s)return this._addToken(E.tokens.ident),!0;for(;;){let o=this._findType(e);const a=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(a=="=")return this._current++,e+=a,this._addToken(E.tokens.minus_equal),!0;if(a=="-")return this._current++,e+=a,this._addToken(E.tokens.minus_minus),!0;const l=this._tokens.length-1;if((E.literal_or_ident.indexOf(this._tokens[l].type)!=-1||this._tokens[l].type==E.tokens.paren_right)&&a!=">")return this._addToken(o),!0}if(e==">"&&(a==">"||a=="=")){let l=!1,c=this._tokens.length-1;for(let u=0;u<5&&c>=0&&E.assignment_operators.indexOf(this._tokens[c].type)===-1;++u,--c)if(this._tokens[c].type===E.tokens.less_than){c>0&&this._tokens[c-1].isArrayOrTemplateType()&&(l=!0);break}if(l)return this._addToken(o),!0}if(o===E.none){let l=e,c=0;const u=2;for(let f=0;f<u;++f)if(l+=this._peekAhead(f),o=this._findType(l),o!==E.none){c=f;break}if(o===E.none)return r===E.none?!1:(this._current--,this._addToken(r),!0);e=l,this._current+=c+1}if(r=o,this._isAtEnd())break;e+=this._advance()}return r===E.none?!1:(this._addToken(r),!0)}_findType(e){for(const r in E.regexTokens){const i=E.regexTokens[r];if(this._match(e,i.rule))return i}const n=E.literalTokens[e];return n||E.none}_match(e,n){const r=n.exec(e);return r&&r.index==0&&r[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"}_isAlphaNumeric(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e=="_"||e>="0"&&e<="9"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let n=this._source[this._current];return e=e||0,e++,this._current+=e,n}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const n=this._source.substring(this._start,this._current);this._tokens.push(new g0(e,n,this._line))}}class hk{constructor(){this._tokens=[],this._current=0,this._currentLine=0,this._context=new BO,this._deferArrayCountEval=[]}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const n=[];for(;!this._isAtEnd();){const r=this._global_decl_or_directive();if(!r)break;n.push(r)}if(this._deferArrayCountEval.length>0){for(const r of this._deferArrayCountEval){const i=r.arrayType,s=r.countNode;if(s instanceof sp){const a=s.name,l=this._context.constants.get(a);if(l)try{const c=l.evaluate(this._context);i.count=c}catch{}}}this._deferArrayCountEval.length=0}return n}_initialize(e){if(e)if(typeof e=="string"){const n=new fk(e);this._tokens=n.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_error(e,n){return{token:e,message:n,toString:function(){return`${n}`}}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==E.eof}_match(e){if(e instanceof C)return this._check(e)?(this._advance(),!0):!1;for(let n=0,r=e.length;n<r;++n){const i=e[n];if(this._check(i))return this._advance(),!0}return!1}_consume(e,n){if(this._check(e))return this._advance();throw this._error(this._peek(),n)}_check(e){if(this._isAtEnd())return!1;const n=this._peek();if(e instanceof Array){const r=n.type;return e.indexOf(r)!=-1}return n.type==e}_advance(){var e,n;return this._currentLine=(n=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&n!==void 0?n:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(E.tokens.semicolon)&&!this._isAtEnd(););if(this._match(E.keywords.alias)){const n=this._type_alias();return this._consume(E.tokens.semicolon,"Expected ';'"),n}if(this._match(E.keywords.diagnostic)){const n=this._diagnostic();return this._consume(E.tokens.semicolon,"Expected ';'"),n}if(this._match(E.keywords.requires)){const n=this._requires_directive();return this._consume(E.tokens.semicolon,"Expected ';'"),n}if(this._match(E.keywords.enable)){const n=this._enable_directive();return this._consume(E.tokens.semicolon,"Expected ';'"),n}const e=this._attribute();if(this._check(E.keywords.var)){const n=this._global_variable_decl();return n!=null&&(n.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),n}if(this._check(E.keywords.override)){const n=this._override_variable_decl();return n!=null&&(n.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),n}if(this._check(E.keywords.let)){const n=this._global_let_decl();return n!=null&&(n.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),n}if(this._check(E.keywords.const)){const n=this._global_const_decl();return n!=null&&(n.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),n}if(this._check(E.keywords.struct)){const n=this._struct_decl();return n!=null&&(n.attributes=e),n}if(this._check(E.keywords.fn)){const n=this._function_decl();return n!=null&&(n.attributes=e),n}return null}_function_decl(){if(!this._match(E.keywords.fn))return null;const e=this._currentLine,n=this._consume(E.tokens.ident,"Expected function name.").toString();this._consume(E.tokens.paren_left,"Expected '(' for function arguments.");const r=[];if(!this._check(E.tokens.paren_right))do{if(this._check(E.tokens.paren_right))break;const a=this._attribute(),l=this._consume(E.tokens.ident,"Expected argument name.").toString();this._consume(E.tokens.colon,"Expected ':' for argument type.");const c=this._attribute(),u=this._type_decl();u!=null&&(u.attributes=c,r.push(new ak(l,u,a)))}while(this._match(E.tokens.comma));this._consume(E.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(E.tokens.arrow)){const a=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=a)}const s=this._compound_statement(),o=this._currentLine;return new rp(n,r,i,s,e,o)}_compound_statement(){const e=[];for(this._consume(E.tokens.brace_left,"Expected '{' for block.");!this._check(E.tokens.brace_right);){const n=this._statement();n!==null&&e.push(n)}return this._consume(E.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(E.tokens.semicolon)&&!this._isAtEnd(););if(this._check(E.tokens.attr)&&this._attribute(),this._check(E.keywords.if))return this._if_statement();if(this._check(E.keywords.switch))return this._switch_statement();if(this._check(E.keywords.loop))return this._loop_statement();if(this._check(E.keywords.for))return this._for_statement();if(this._check(E.keywords.while))return this._while_statement();if(this._check(E.keywords.continuing))return this._continuing_statement();if(this._check(E.keywords.static_assert))return this._static_assert_statement();if(this._check(E.tokens.brace_left))return this._compound_statement();let e=null;return this._check(E.keywords.return)?e=this._return_statement():this._check([E.keywords.var,E.keywords.let,E.keywords.const])?e=this._variable_statement():this._match(E.keywords.discard)?e=new QO:this._match(E.keywords.break)?e=new JO:this._match(E.keywords.continue)?e=new GO:e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement(),e!=null&&this._consume(E.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(E.keywords.static_assert))return null;const e=this._optional_paren_expression();return new LO(e)}_while_statement(){if(!this._match(E.keywords.while))return null;const e=this._optional_paren_expression();this._check(E.tokens.attr)&&this._attribute();const n=this._compound_statement();return new UO(e,n)}_continuing_statement(){if(!this._match(E.keywords.continuing))return null;const e=this._compound_statement();return new zO(e)}_for_statement(){if(!this._match(E.keywords.for))return null;this._consume(E.tokens.paren_left,"Expected '('.");const e=this._check(E.tokens.semicolon)?null:this._for_init();this._consume(E.tokens.semicolon,"Expected ';'.");const n=this._check(E.tokens.semicolon)?null:this._short_circuit_or_expression();this._consume(E.tokens.semicolon,"Expected ';'.");const r=this._check(E.tokens.paren_right)?null:this._for_increment();this._consume(E.tokens.paren_right,"Expected ')'."),this._check(E.tokens.attr)&&this._attribute();const i=this._compound_statement();return new VO(e,n,r,i)}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(E.keywords.var)){const e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let n=null;return this._match(E.tokens.equal)&&(n=this._short_circuit_or_expression()),new Fr(e.name,e.type,e.storage,e.access,n)}if(this._match(E.keywords.let)){const e=this._consume(E.tokens.ident,"Expected name for let.").toString();let n=null;if(this._match(E.tokens.colon)){const i=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=i)}this._consume(E.tokens.equal,"Expected '=' for let.");const r=this._short_circuit_or_expression();return new ip(e,n,null,null,r)}if(this._match(E.keywords.const)){const e=this._consume(E.tokens.ident,"Expected name for const.").toString();let n=null;if(this._match(E.tokens.colon)){const i=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=i)}this._consume(E.tokens.equal,"Expected '=' for const.");const r=this._short_circuit_or_expression();return new u0(e,n,null,null,r)}return null}_increment_decrement_statement(){const e=this._current,n=this._unary_expression();if(n==null)return null;if(!this._check(E.increment_operators))return this._current=e,null;const r=this._consume(E.increment_operators,"Expected increment operator");return new $O(r.type===E.tokens.plus_plus?ms.increment:ms.decrement,n)}_assignment_statement(){let e=null;if(this._check(E.tokens.brace_right))return null;let n=this._match(E.tokens.underscore);if(n||(e=this._unary_expression()),!n&&e==null)return null;const r=this._consume(E.assignment_operators,"Expected assignment operator."),i=this._short_circuit_or_expression();return new jO(qo.parse(r.lexeme),e,i)}_func_call_statement(){if(!this._check(E.tokens.ident))return null;const e=this._current,n=this._consume(E.tokens.ident,"Expected function name."),r=this._argument_expression_list();return r===null?(this._current=e,null):new ZE(n.lexeme,r)}_loop_statement(){if(!this._match(E.keywords.loop))return null;this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Expected '{' for loop.");const e=[];let n=this._statement();for(;n!==null;){if(Array.isArray(n))for(let i of n)e.push(i);else e.push(n);n=this._statement()}let r=null;return this._match(E.keywords.continuing)&&(r=this._compound_statement()),this._consume(E.tokens.brace_right,"Expected '}' for loop."),new WO(e,r)}_switch_statement(){if(!this._match(E.keywords.switch))return null;const e=this._optional_paren_expression();this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Expected '{' for switch.");const n=this._switch_body();if(n==null||n.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(E.tokens.brace_right,"Expected '}' for switch."),new HO(e,n)}_switch_body(){const e=[];if(this._match(E.keywords.case)){const n=this._case_selectors();this._match(E.tokens.colon),this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Exected '{' for switch case.");const r=this._case_body();this._consume(E.tokens.brace_right,"Exected '}' for switch case."),e.push(new sk(n,r))}if(this._match(E.keywords.default)){this._match(E.tokens.colon),this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Exected '{' for switch default.");const n=this._case_body();this._consume(E.tokens.brace_right,"Exected '}' for switch default."),e.push(new ok(n))}if(this._check([E.keywords.default,E.keywords.case])){const n=this._switch_body();e.push(n[0])}return e}_case_selectors(){const e=[this._shift_expression()];for(;this._match(E.tokens.comma);)e.push(this._shift_expression());return e}_case_body(){if(this._match(E.keywords.fallthrough))return this._consume(E.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);const n=this._case_body();return n.length==0?e:[...e,n[0]]}_if_statement(){if(!this._match(E.keywords.if))return null;const e=this._optional_paren_expression();this._check(E.tokens.attr)&&this._attribute();const n=this._compound_statement();let r=[];this._match_elseif()&&(this._check(E.tokens.attr)&&this._attribute(),r=this._elseif_statement(r));let i=null;return this._match(E.keywords.else)&&(this._check(E.tokens.attr)&&this._attribute(),i=this._compound_statement()),new XO(e,n,r,i)}_match_elseif(){return this._tokens[this._current].type===E.keywords.else&&this._tokens[this._current+1].type===E.keywords.if?(this._advance(),this._advance(),!0):!1}_elseif_statement(e=[]){const n=this._optional_paren_expression(),r=this._compound_statement();return e.push(new lk(n,r)),this._match_elseif()&&(this._check(E.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(E.keywords.return))return null;const e=this._short_circuit_or_expression();return new YO(e)}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(E.tokens.or_or);)e=new Kt(this._previous().toString(),e,this._short_circuit_and_expr());return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(E.tokens.and_and);)e=new Kt(this._previous().toString(),e,this._inclusive_or_expression());return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(E.tokens.or);)e=new Kt(this._previous().toString(),e,this._exclusive_or_expression());return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(E.tokens.xor);)e=new Kt(this._previous().toString(),e,this._and_expression());return e}_and_expression(){let e=this._equality_expression();for(;this._match(E.tokens.and);)e=new Kt(this._previous().toString(),e,this._equality_expression());return e}_equality_expression(){const e=this._relational_expression();return this._match([E.tokens.equal_equal,E.tokens.not_equal])?new Kt(this._previous().toString(),e,this._relational_expression()):e}_relational_expression(){let e=this._shift_expression();for(;this._match([E.tokens.less_than,E.tokens.greater_than,E.tokens.less_than_equal,E.tokens.greater_than_equal]);)e=new Kt(this._previous().toString(),e,this._shift_expression());return e}_shift_expression(){let e=this._additive_expression();for(;this._match([E.tokens.shift_left,E.tokens.shift_right]);)e=new Kt(this._previous().toString(),e,this._additive_expression());return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([E.tokens.plus,E.tokens.minus]);)e=new Kt(this._previous().toString(),e,this._multiplicative_expression());return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([E.tokens.star,E.tokens.forward_slash,E.tokens.modulo]);)e=new Kt(this._previous().toString(),e,this._unary_expression());return e}_unary_expression(){return this._match([E.tokens.minus,E.tokens.bang,E.tokens.tilde,E.tokens.star,E.tokens.and])?new ik(this._previous().toString(),this._unary_expression()):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),n=this._postfix_expression();return n&&(e.postfix=n),e}_postfix_expression(){if(this._match(E.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(E.tokens.bracket_right,"Expected ']'.");const n=new rk(e),r=this._postfix_expression();return r&&(n.postfix=r),n}if(this._match(E.tokens.period)){const e=this._consume(E.tokens.ident,"Expected member name."),n=this._postfix_expression(),r=new f0(e.lexeme);return n&&(r.postfix=n),r}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_primary_expression(){if(this._match(E.tokens.ident)){const r=this._previous().toString();if(this._check(E.tokens.paren_left)){const i=this._argument_expression_list(),s=this._getStruct(r);return s!=null?new zi(s,i):new e1(r,i)}if(this._context.constants.has(r)){const i=this._context.constants.get(r);return new h0(r,i.value)}return new sp(r)}if(this._match(E.const_literal))return new d0(parseFloat(this._previous().toString()));if(this._check(E.tokens.paren_left))return this._paren_expression();if(this._match(E.keywords.bitcast)){this._consume(E.tokens.less_than,"Expected '<'.");const r=this._type_decl();this._consume(E.tokens.greater_than,"Expected '>'.");const i=this._paren_expression();return new tk(r,i)}const e=this._type_decl(),n=this._argument_expression_list();return new nk(e,n)}_argument_expression_list(){if(!this._match(E.tokens.paren_left))return null;const e=[];do{if(this._check(E.tokens.paren_right))break;const n=this._short_circuit_or_expression();e.push(n)}while(this._match(E.tokens.comma));return this._consume(E.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(E.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(E.tokens.paren_right),new p0([e])}_paren_expression(){this._consume(E.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(E.tokens.paren_right,"Expected ')'."),new p0([e])}_struct_decl(){if(!this._match(E.keywords.struct))return null;const e=this._currentLine,n=this._consume(E.tokens.ident,"Expected name for struct.").toString();this._consume(E.tokens.brace_left,"Expected '{' for struct body.");const r=[];for(;!this._check(E.tokens.brace_right);){const o=this._attribute(),a=this._consume(E.tokens.ident,"Expected variable name.").toString();this._consume(E.tokens.colon,"Expected ':' for struct member type.");const l=this._attribute(),c=this._type_decl();c!=null&&(c.attributes=l),this._check(E.tokens.brace_right)?this._match(E.tokens.comma):this._consume(E.tokens.comma,"Expected ',' for struct member."),r.push(new ck(a,c,o))}this._consume(E.tokens.brace_right,"Expected '}' after struct body.");const i=this._currentLine,s=new kr(n,r,e,i);return this._context.structs.set(n,s),s}_global_variable_decl(){const e=this._variable_decl();return e&&this._match(E.tokens.equal)&&(e.value=this._const_expression()),e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(E.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){if(!this._match(E.keywords.const))return null;const e=this._consume(E.tokens.ident,"Expected variable name");let n=null;if(this._match(E.tokens.colon)){const s=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=s)}let r=null;if(this._match(E.tokens.equal)){const s=this._short_circuit_or_expression();if(s instanceof zi)r=s;else if(s instanceof h0&&s.initializer instanceof zi)r=s.initializer;else try{const o=s.evaluate(this._context);r=new d0(o)}catch{r=s}}const i=new u0(e.toString(),n,"","",r);return this._context.constants.set(i.name,i),i}_global_let_decl(){if(!this._match(E.keywords.let))return null;const e=this._consume(E.tokens.ident,"Expected variable name");let n=null;if(this._match(E.tokens.colon)){const i=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=i)}let r=null;return this._match(E.tokens.equal)&&(r=this._const_expression()),new ip(e.toString(),n,"","",r)}_const_expression(){if(this._match(E.const_literal))return new f0(this._previous().toString());const e=this._type_decl();this._consume(E.tokens.paren_left,"Expected '('.");let n=[];for(;!this._check(E.tokens.paren_right)&&(n.push(this._const_expression()),!!this._check(E.tokens.comma));)this._advance();return this._consume(E.tokens.paren_right,"Expected ')'."),new zi(e,n)}_variable_decl(){if(!this._match(E.keywords.var))return null;let e="",n="";this._match(E.tokens.less_than)&&(e=this._consume(E.storage_class,"Expected storage_class.").toString(),this._match(E.tokens.comma)&&(n=this._consume(E.access_mode,"Expected access_mode.").toString()),this._consume(E.tokens.greater_than,"Expected '>'."));const r=this._consume(E.tokens.ident,"Expected variable name");let i=null;if(this._match(E.tokens.colon)){const s=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=s)}return new Fr(r.toString(),i,e,n,null)}_override_decl(){if(!this._match(E.keywords.override))return null;const e=this._consume(E.tokens.ident,"Expected variable name");let n=null;if(this._match(E.tokens.colon)){const r=this._attribute();n=this._type_decl(),n!=null&&(n.attributes=r)}return new qE(e.toString(),n,null)}_diagnostic(){this._consume(E.tokens.paren_left,"Expected '('");const e=this._consume(E.tokens.ident,"Expected severity control name.");this._consume(E.tokens.comma,"Expected ','");const n=this._consume(E.tokens.ident,"Expected diagnostic rule name.");return this._consume(E.tokens.paren_right,"Expected ')'"),new ZO(e.toString(),n.toString())}_enable_directive(){const e=this._consume(E.tokens.ident,"identity expected.");return new KO(e.toString())}_requires_directive(){const e=[this._consume(E.tokens.ident,"identity expected.").toString()];for(;this._match(E.tokens.comma);){const n=this._consume(E.tokens.ident,"identity expected.");e.push(n.toString())}return new qO(e)}_type_alias(){const e=this._consume(E.tokens.ident,"identity expected.");this._consume(E.tokens.equal,"Expected '=' for type alias.");let n=this._type_decl();if(n===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(n.name)&&(n=this._context.aliases.get(n.name).type);const r=new QE(e.toString(),n);return this._context.aliases.set(r.name,r),r}_type_decl(){if(this._check([E.tokens.ident,...E.texel_format,E.keywords.bool,E.keywords.f32,E.keywords.i32,E.keywords.u32])){const r=this._advance(),i=r.toString();return this._context.structs.has(i)?this._context.structs.get(i):this._context.aliases.has(i)?this._context.aliases.get(i).type:new fi(r.toString())}let e=this._texture_sampler_types();if(e)return e;if(this._check(E.template_types)){let r=this._advance().toString(),i=null,s=null;return this._match(E.tokens.less_than)&&(i=this._type_decl(),s=null,this._match(E.tokens.comma)&&(s=this._consume(E.access_mode,"Expected access_mode for pointer").toString()),this._consume(E.tokens.greater_than,"Expected '>' for type.")),new JE(r,i,s)}if(this._match(E.keywords.ptr)){let r=this._previous().toString();this._consume(E.tokens.less_than,"Expected '<' for pointer.");const i=this._consume(E.storage_class,"Expected storage_class for pointer");this._consume(E.tokens.comma,"Expected ',' for pointer.");const s=this._type_decl();let o=null;return this._match(E.tokens.comma)&&(o=this._consume(E.access_mode,"Expected access_mode for pointer").toString()),this._consume(E.tokens.greater_than,"Expected '>' for pointer."),new ek(r,i.toString(),s,o)}const n=this._attribute();if(this._match(E.keywords.array)){let r=null,i=-1;const s=this._previous();let o=null;if(this._match(E.tokens.less_than)){r=this._type_decl(),this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);let l="";if(this._match(E.tokens.comma)){o=this._shift_expression();try{l=o.evaluate(this._context).toString(),o=null}catch{l="1"}}this._consume(E.tokens.greater_than,"Expected '>' for array."),i=l?parseInt(l):0}const a=new GE(s.toString(),n,r,i);return o&&this._deferArrayCountEval.push({arrayType:a,countNode:o}),a}return null}_texture_sampler_types(){if(this._match(E.sampler_type))return new so(this._previous().toString(),null,null);if(this._match(E.depth_texture_type))return new so(this._previous().toString(),null,null);if(this._match(E.sampled_texture_type)||this._match(E.multisampled_texture_type)){const e=this._previous();this._consume(E.tokens.less_than,"Expected '<' for sampler type.");const n=this._type_decl();return this._consume(E.tokens.greater_than,"Expected '>' for sampler type."),new so(e.toString(),n,null)}if(this._match(E.storage_texture_type)){const e=this._previous();this._consume(E.tokens.less_than,"Expected '<' for sampler type.");const n=this._consume(E.texel_format,"Invalid texel format.").toString();this._consume(E.tokens.comma,"Expected ',' after texel format.");const r=this._consume(E.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(E.tokens.greater_than,"Expected '>' for sampler type."),new so(e.toString(),n,r)}return null}_attribute(){let e=[];for(;this._match(E.tokens.attr);){const n=this._consume(E.attribute_name,"Expected attribute name"),r=new uk(n.toString(),null);if(this._match(E.tokens.paren_left)){if(r.value=this._consume(E.literal_or_ident,"Expected attribute value").toString(),this._check(E.tokens.comma)){this._advance();do{const i=this._consume(E.literal_or_ident,"Expected attribute value").toString();r.value instanceof Array||(r.value=[r.value]),r.value.push(i)}while(this._match(E.tokens.comma))}this._consume(E.tokens.paren_right,"Expected ')'")}e.push(r)}return e.length==0?null:e}}class ns{constructor(e,n){this.name=e,this.attributes=n,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}}class _0{constructor(e,n,r){this.name=e,this.type=n,this.attributes=r,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class ll extends ns{constructor(e,n){super(e,n),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class dh extends ns{constructor(e,n){super(e,n),this.count=0,this.stride=0}get isArray(){return!0}}class m0 extends ns{constructor(e,n,r,i){super(e,r),this.format=n,this.access=i}get isTemplate(){return!0}}var Yn;(function(t){t[t.Uniform=0]="Uniform",t[t.Storage=1]="Storage",t[t.Texture=2]="Texture",t[t.Sampler=3]="Sampler",t[t.StorageTexture=4]="StorageTexture"})(Yn||(Yn={}));class cl{constructor(e,n,r,i,s,o,a){this.name=e,this.type=n,this.group=r,this.binding=i,this.attributes=s,this.resourceType=o,this.access=a}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class dk{constructor(e,n){this.name=e,this.type=n}}class ul{constructor(e,n){this.align=e,this.size=n}}class pk{constructor(e,n,r,i){this.name=e,this.type=n,this.locationType=r,this.location=i,this.interpolation=null}}class y0{constructor(e,n,r,i){this.name=e,this.type=n,this.locationType=r,this.location=i}}class gk{constructor(e,n=null){this.stage=null,this.inputs=[],this.outputs=[],this.resources=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=n}}class _k{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}class mk{constructor(e,n,r,i){this.name=e,this.type=n,this.attributes=r,this.id=i}}class yk{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class An{constructor(e){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new _k,this.functions=[],this._types=new Map,this._functions=new Map,e&&this.update(e)}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}update(e){const r=new hk().parse(e);for(const i of r)i instanceof rp&&this._functions.set(i.name,new yk(i));for(const i of r)if(i instanceof kr){const s=this._getTypeInfo(i,null);s instanceof ll&&this.structs.push(s)}for(const i of r){if(i instanceof QE){this.aliases.push(this._getAliasInfo(i));continue}if(i instanceof qE){const s=i,o=this._getAttributeNum(s.attributes,"id",0),a=s.type!=null?this._getTypeInfo(s.type,s.attributes):null;this.overrides.push(new mk(s.name,a,s.attributes,o));continue}if(this._isUniformVar(i)){const s=i,o=this._getAttributeNum(s.attributes,"group",0),a=this._getAttributeNum(s.attributes,"binding",0),l=this._getTypeInfo(s.type,s.attributes),c=new cl(s.name,l,o,a,s.attributes,Yn.Uniform,s.access);this.uniforms.push(c);continue}if(this._isStorageVar(i)){const s=i,o=this._getAttributeNum(s.attributes,"group",0),a=this._getAttributeNum(s.attributes,"binding",0),l=this._getTypeInfo(s.type,s.attributes),c=this._isStorageTexture(l),u=new cl(s.name,l,o,a,s.attributes,c?Yn.StorageTexture:Yn.Storage,s.access);this.storage.push(u);continue}if(this._isTextureVar(i)){const s=i,o=this._getAttributeNum(s.attributes,"group",0),a=this._getAttributeNum(s.attributes,"binding",0),l=this._getTypeInfo(s.type,s.attributes),c=this._isStorageTexture(l),u=new cl(s.name,l,o,a,s.attributes,c?Yn.StorageTexture:Yn.Texture,s.access);c?this.storage.push(u):this.textures.push(u);continue}if(this._isSamplerVar(i)){const s=i,o=this._getAttributeNum(s.attributes,"group",0),a=this._getAttributeNum(s.attributes,"binding",0),l=this._getTypeInfo(s.type,s.attributes),c=new cl(s.name,l,o,a,s.attributes,Yn.Sampler,s.access);this.samplers.push(c);continue}if(i instanceof rp){const s=this._getAttribute(i,"vertex"),o=this._getAttribute(i,"fragment"),a=this._getAttribute(i,"compute"),l=s||o||a,c=new gk(i.name,l==null?void 0:l.name);c.startLine=i.startLine,c.endLine=i.endLine,this.functions.push(c),this._functions.get(i.name).info=c,l&&(this._functions.get(i.name).inUse=!0,c.inUse=!0,c.resources=this._findResources(i,!!l),c.inputs=this._getInputs(i.args),c.outputs=this._getOutputs(i.returnType),this.entry[l.name].push(c));continue}}for(const i of this._functions.values())i.info&&(i.info.inUse=i.inUse,this._addCalls(i.node,i.info.calls));for(const i of this.uniforms)this._markStructsInUse(i.type);for(const i of this.storage)this._markStructsInUse(i.type)}_markStructsInUse(e){if(e.isStruct){e.inUse=!0;for(const n of e.members)this._markStructsInUse(n.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)this._markStructsInUse(e.format);else{const n=this._getAlias(e.name);n&&this._markStructsInUse(n)}}_addCalls(e,n){var r;for(const i of e.calls){const s=(r=this._functions.get(i.name))===null||r===void 0?void 0:r.info;s&&n.add(s)}}findResource(e,n){for(const r of this.uniforms)if(r.group==e&&r.binding==n)return r;for(const r of this.storage)if(r.group==e&&r.binding==n)return r;for(const r of this.textures)if(r.group==e&&r.binding==n)return r;for(const r of this.samplers)if(r.group==e&&r.binding==n)return r;return null}_findResource(e){for(const n of this.uniforms)if(n.name==e)return n;for(const n of this.storage)if(n.name==e)return n;for(const n of this.textures)if(n.name==e)return n;for(const n of this.samplers)if(n.name==e)return n;return null}_markStructsFromAST(e){const n=this._getTypeInfo(e,null);this._markStructsInUse(n)}_findResources(e,n){const r=[],i=this,s=[];return e.search(o=>{if(o instanceof Fc)s.push({});else if(o instanceof Dc)s.pop();else if(o instanceof Fr){const a=o;n&&a.type!==null&&this._markStructsFromAST(a.type),s.length>0&&(s[s.length-1][a.name]=a)}else if(o instanceof zi){const a=o;n&&a.type!==null&&this._markStructsFromAST(a.type)}else if(o instanceof ip){const a=o;n&&a.type!==null&&this._markStructsFromAST(a.type),s.length>0&&(s[s.length-1][a.name]=a)}else if(o instanceof sp){const a=o;if(s.length>0&&s[s.length-1][a.name])return;const l=i._findResource(a.name);l&&r.push(l)}else if(o instanceof e1){const a=o,l=i._functions.get(a.name);l&&(n&&(l.inUse=!0),e.calls.add(l.node),l.resources===null&&(l.resources=i._findResources(l.node,n)),r.push(...l.resources))}else if(o instanceof ZE){const a=o,l=i._functions.get(a.name);l&&(n&&(l.inUse=!0),e.calls.add(l.node),l.resources===null&&(l.resources=i._findResources(l.node,n)),r.push(...l.resources))}}),[...new Map(r.map(o=>[o.name,o])).values()]}getBindGroups(){const e=[];function n(r,i){r>=e.length&&(e.length=r+1),e[r]===void 0&&(e[r]=[]),i>=e[r].length&&(e[r].length=i+1)}for(const r of this.uniforms){n(r.group,r.binding);const i=e[r.group];i[r.binding]=r}for(const r of this.storage){n(r.group,r.binding);const i=e[r.group];i[r.binding]=r}for(const r of this.textures){n(r.group,r.binding);const i=e[r.group];i[r.binding]=r}for(const r of this.samplers){n(r.group,r.binding);const i=e[r.group];i[r.binding]=r}return e}_getOutputs(e,n=void 0){if(n===void 0&&(n=[]),e instanceof kr)this._getStructOutputs(e,n);else{const r=this._getOutputInfo(e);r!==null&&n.push(r)}return n}_getStructOutputs(e,n){for(const r of e.members)if(r.type instanceof kr)this._getStructOutputs(r.type,n);else{const i=this._getAttribute(r,"location")||this._getAttribute(r,"builtin");if(i!==null){const s=this._getTypeInfo(r.type,r.type.attributes),o=this._parseInt(i.value),a=new y0(r.name,s,i.name,o);n.push(a)}}}_getOutputInfo(e){const n=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(n!==null){const r=this._getTypeInfo(e,e.attributes),i=this._parseInt(n.value);return new y0("",r,n.name,i)}return null}_getInputs(e,n=void 0){n===void 0&&(n=[]);for(const r of e)if(r.type instanceof kr)this._getStructInputs(r.type,n);else{const i=this._getInputInfo(r);i!==null&&n.push(i)}return n}_getStructInputs(e,n){for(const r of e.members)if(r.type instanceof kr)this._getStructInputs(r.type,n);else{const i=this._getInputInfo(r);i!==null&&n.push(i)}}_getInputInfo(e){const n=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(n!==null){const r=this._getAttribute(e,"interpolation"),i=this._getTypeInfo(e.type,e.attributes),s=this._parseInt(n.value),o=new pk(e.name,i,n.name,s);return r!==null&&(o.interpolation=this._parseString(r.value)),o}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const n=parseInt(e);return isNaN(n)?e:n}_getAlias(e){for(const n of this.aliases)if(n.name==e)return n.type;return null}_getAliasInfo(e){return new dk(e.name,this._getTypeInfo(e.type,null))}_getTypeInfo(e,n){if(this._types.has(e))return this._types.get(e);if(e instanceof GE){const i=e,s=this._getTypeInfo(i.format,i.attributes),o=new dh(i.name,n);return o.format=s,o.count=i.count,this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof kr){const i=e,s=new ll(i.name,n);s.startLine=i.startLine,s.endLine=i.endLine;for(const o of i.members){const a=this._getTypeInfo(o.type,o.attributes);s.members.push(new _0(o.name,a,o.attributes))}return this._types.set(e,s),this._updateTypeInfo(s),s}if(e instanceof so){const i=e,s=i.format instanceof fi,o=i.format?s?this._getTypeInfo(i.format,null):new ns(i.format,null):null,a=new m0(i.name,o,n,i.access);return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof JE){const i=e,s=i.format?this._getTypeInfo(i.format,null):null,o=new m0(i.name,s,n,i.access);return this._types.set(e,o),this._updateTypeInfo(o),o}const r=new ns(e.name,n);return this._types.set(e,r),this._updateTypeInfo(r),r}_updateTypeInfo(e){var n,r;const i=this._getTypeSize(e);if(e.size=(n=i==null?void 0:i.size)!==null&&n!==void 0?n:0,e instanceof dh){const s=this._getTypeSize(e.format);e.stride=(r=s==null?void 0:s.size)!==null&&r!==void 0?r:0,this._updateTypeInfo(e.format)}e instanceof ll&&this._updateStructInfo(e)}_updateStructInfo(e){var n;let r=0,i=0,s=0,o=0;for(let a=0,l=e.members.length;a<l;++a){const c=e.members[a],u=this._getTypeSize(c);if(!u)continue;(n=this._getAlias(c.type.name))!==null&&n!==void 0||c.type;const f=u.align,h=u.size;r=this._roundUp(f,r+i),i=h,s=r,o=Math.max(o,f),c.offset=r,c.size=h,this._updateTypeInfo(c.type)}e.size=this._roundUp(o,s+i),e.align=o}_getTypeSize(e){var n,r;if(e==null)return null;const i=this._getAttributeNum(e.attributes,"size",0),s=this._getAttributeNum(e.attributes,"align",0);if(e instanceof _0&&(e=e.type),e instanceof ns){const o=this._getAlias(e.name);o!==null&&(e=o)}{const o=An._typeInfo[e.name];if(o!==void 0){const a=((n=e.format)===null||n===void 0?void 0:n.name)==="f16"?2:1;return new ul(Math.max(s,o.align/a),Math.max(i,o.size/a))}}{const o=An._typeInfo[e.name.substring(0,e.name.length-1)];if(o){const a=e.name[e.name.length-1]==="h"?2:1;return new ul(Math.max(s,o.align/a),Math.max(i,o.size/a))}}if(e instanceof dh){let o=e,a=8,l=8;const c=this._getTypeSize(o.format);c!==null&&(l=c.size,a=c.align);const u=o.count,f=this._getAttributeNum((r=e==null?void 0:e.attributes)!==null&&r!==void 0?r:null,"stride",this._roundUp(a,l));return l=u*f,i&&(l=i),new ul(Math.max(s,a),Math.max(i,l))}if(e instanceof ll){let o=0,a=0,l=0,c=0,u=0;for(const f of e.members){const h=this._getTypeSize(f.type);h!==null&&(o=Math.max(h.align,o),l=this._roundUp(h.align,l+c),c=h.size,u=l)}return a=this._roundUp(o,u+c),new ul(Math.max(s,o),Math.max(i,a))}return null}_isUniformVar(e){return e instanceof Fr&&e.storage=="uniform"}_isStorageVar(e){return e instanceof Fr&&e.storage=="storage"}_isTextureVar(e){return e instanceof Fr&&e.type!==null&&An._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof Fr&&e.type!==null&&An._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,n){const r=e;if(!r||!r.attributes)return null;const i=r.attributes;for(let s of i)if(s.name==n)return s;return null}_getAttributeNum(e,n,r){if(e===null)return r;for(let i of e)if(i.name==n){let s=i!==null&&i.value!==null?i.value:r;return s instanceof Array&&(s=s[0]),typeof s=="number"?s:typeof s=="string"?parseInt(s):r}return r}_roundUp(e,n){return Math.ceil(n/e)*e}}An._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}};An._textureTypes=E.any_texture_type.map(t=>t.name);An._samplerTypes=E.sampler_type.map(t=>t.name);function vk(t){var s;const e={attributes:[],bindings:[]};let n;try{n=Tk(t)}catch(o){return U.error(o.message)(),e}for(const o of n.uniforms){const a=[];for(const l of((s=o.type)==null?void 0:s.members)||[])a.push({name:l.name,type:v0(l.type)});e.bindings.push({type:"uniform",name:o.name,location:o.binding,group:o.group,members:a})}const r=n.entry.vertex[0],i=(r==null?void 0:r.inputs.length)||0;for(let o=0;o<i;o++){const a=r.inputs[o];if(a.locationType==="location"){const l=v0(a.type);e.attributes.push({name:a.name,location:Number(a.location),type:l})}}return e}function v0(t){return t.format?`${t.name}<${t.format.name}>`:t.name}function Tk(t){try{return new An(t)}catch(e){if(e instanceof Error)throw e;let n="WGSL parse error";throw typeof e=="object"&&(e!=null&&e.message)&&(n+=`: ${e.message} `),typeof e=="object"&&(e!=null&&e.token)&&(n+=e.token.line||""),new Error(n,{cause:e})}}const wk=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;
const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;
const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;
const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;
float sin_taylor_fp32(float a) {
float r, s, t, x;
if (a == 0.0) {
return 0.0;
}
x = -a * a;
s = a;
r = a;
r = r * x;
t = r * INVERSE_FACTORIAL_3;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_5;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_7;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_9;
s = s + t;
return s;
}
void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
if (a == 0.0) {
sin_t = 0.0;
cos_t = 1.0;
}
sin_t = sin_taylor_fp32(a);
cos_t = sqrt(1.0 - sin_t * sin_t);
}
float tan_taylor_fp32(float a) {
float sin_a;
float cos_a;
if (a == 0.0) {
return 0.0;
}
float z = floor(a / TWO_PI);
float r = a - TWO_PI * z;
float t;
float q = floor(r / PI_2 + 0.5);
int j = int(q);
if (j < -2 || j > 2) {
return 1.0 / 0.0;
}
t = r - PI_2 * q;
q = floor(t / PI_16 + 0.5);
int k = int(q);
int abs_k = int(abs(float(k)));
if (abs_k > 4) {
return 1.0 / 0.0;
} else {
t = t - PI_16 * q;
}
float u = 0.0;
float v = 0.0;
float sin_t, cos_t;
float s, c;
sincos_taylor_fp32(t, sin_t, cos_t);
if (k == 0) {
s = sin_t;
c = cos_t;
} else {
if (abs(float(abs_k) - 1.0) < 0.5) {
u = COS_TABLE_0;
v = SIN_TABLE_0;
} else if (abs(float(abs_k) - 2.0) < 0.5) {
u = COS_TABLE_1;
v = SIN_TABLE_1;
} else if (abs(float(abs_k) - 3.0) < 0.5) {
u = COS_TABLE_2;
v = SIN_TABLE_2;
} else if (abs(float(abs_k) - 4.0) < 0.5) {
u = COS_TABLE_3;
v = SIN_TABLE_3;
}
if (k > 0) {
s = u * sin_t + v * cos_t;
c = u * cos_t - v * sin_t;
} else {
s = u * sin_t - v * cos_t;
c = u * cos_t + v * sin_t;
}
}
if (j == 0) {
sin_a = s;
cos_a = c;
} else if (j == 1) {
sin_a = c;
cos_a = -s;
} else if (j == -1) {
sin_a = -c;
cos_a = s;
} else {
sin_a = -s;
cos_a = -c;
}
return sin_a / cos_a;
}
#endif
float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
return tan_taylor_fp32(a);
#else
return tan(a);
#endif
}
`,Sk={name:"fp32",vs:wk},Ek=[0,1,1,1],bk=`uniform pickingUniforms {
float isActive;
float isAttribute;
float isHighlightActive;
float useFloatColors;
vec3 highlightedObjectColor;
vec4 highlightColor;
} picking;
out vec4 picking_vRGBcolor_Avalid;
vec3 picking_normalizeColor(vec3 color) {
return picking.useFloatColors > 0.5 ? color : color / 255.0;
}
vec4 picking_normalizeColor(vec4 color) {
return picking.useFloatColors > 0.5 ? color : color / 255.0;
}
bool picking_isColorZero(vec3 color) {
return dot(color, vec3(1.0)) < 0.00001;
}
bool picking_isColorValid(vec3 color) {
return dot(color, vec3(1.0)) > 0.00001;
}
bool isVertexHighlighted(vec3 vertexColor) {
vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
return
bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}
void picking_setPickingColor(vec3 pickingColor) {
pickingColor = picking_normalizeColor(pickingColor);
if (bool(picking.isActive)) {
picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));
if (!bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rgb = pickingColor;
}
} else {
picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
}
}
void picking_setPickingAttribute(float value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.r = value;
}
}
void picking_setPickingAttribute(vec2 value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rg = value;
}
}
void picking_setPickingAttribute(vec3 value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rgb = value;
}
}
`,Ak=`uniform pickingUniforms {
float isActive;
float isAttribute;
float isHighlightActive;
float useFloatColors;
vec3 highlightedObjectColor;
vec4 highlightColor;
} picking;
in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
if (picking.isActive > 0.5) {
return color;
}
bool selected = bool(picking_vRGBcolor_Avalid.a);
if (selected) {
float highLightAlpha = picking.highlightColor.a;
float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
float highLightRatio = highLightAlpha / blendedAlpha;
vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
return vec4(blendedRGB, blendedAlpha);
} else {
return color;
}
}
vec4 picking_filterPickingColor(vec4 color) {
if (bool(picking.isActive)) {
if (picking_vRGBcolor_Avalid.a == 0.0) {
discard;
}
return picking_vRGBcolor_Avalid;
}
return color;
}
vec4 picking_filterColor(vec4 color) {
vec4 highlightColor = picking_filterHighlightColor(color);
return picking_filterPickingColor(highlightColor);
}
`,T0={name:"picking",vs:bk,fs:Ak,uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:Ek},getUniforms:Rk};function Rk(t={},e){const n={};if(t.highlightedObjectColor!==void 0)if(t.highlightedObjectColor===null)n.isHighlightActive=!1;else{n.isHighlightActive=!0;const r=t.highlightedObjectColor.slice(0,3);n.highlightedObjectColor=r}if(t.highlightColor){const r=Array.from(t.highlightColor,i=>i/255);Number.isFinite(r[3])||(r[3]=1),n.highlightColor=r}return t.isActive!==void 0&&(n.isActive=!!t.isActive,n.isAttribute=!!t.isAttribute),t.useFloatColors!==void 0&&(n.useFloatColors=!!t.useFloatColors),n}function r1(t,e=[],n=0){const r=Math.fround(t),i=t-r;return e[n]=r,e[n+1]=i,e}function xk(t){return t-Math.fround(t)}function Ck(t){const e=new Float32Array(32);for(let n=0;n<4;++n)for(let r=0;r<4;++r){const i=n*4+r;r1(t[r*4+n],e,i*2)}return e}const Pk=`uniform float ONE;
vec2 split(float a) {
const float SPLIT = 4097.0;
float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float a_hi = t * ONE - (t - a);
float a_lo = a * ONE - a_hi;
#else
float a_hi = t - (t - a);
float a_lo = a - a_hi;
#endif
return vec2(a_hi, a_lo);
}
vec2 split2(vec2 a) {
vec2 b = split(a.x);
b.y += a.y;
return b;
}
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float sum = (a + b) * ONE;
float err = b - (sum - a) * ONE;
#else
float sum = a + b;
float err = b - (sum - a);
#endif
return vec2(sum, err);
}
vec2 twoSum(float a, float b) {
float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float v = (s * ONE - a) * ONE;
float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);
#else
float v = s - a;
float err = (a - (s - v)) + (b - v);
#endif
return vec2(s, err);
}
vec2 twoSub(float a, float b) {
float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float v = (s * ONE - a) * ONE;
float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);
#else
float v = s - a;
float err = (a - (s - v)) - (b + v);
#endif
return vec2(s, err);
}
vec2 twoSqr(float a) {
float prod = a * a;
vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *
a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;
#else
float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
return vec2(prod, err);
}
vec2 twoProd(float a, float b) {
float prod = a * b;
vec2 a_fp64 = split(a);
vec2 b_fp64 = split(b);
float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
return vec2(prod, err);
}
vec2 sum_fp64(vec2 a, vec2 b) {
vec2 s, t;
s = twoSum(a.x, b.x);
t = twoSum(a.y, b.y);
s.y += t.x;
s = quickTwoSum(s.x, s.y);
s.y += t.y;
s = quickTwoSum(s.x, s.y);
return s;
}
vec2 sub_fp64(vec2 a, vec2 b) {
vec2 s, t;
s = twoSub(a.x, b.x);
t = twoSub(a.y, b.y);
s.y += t.x;
s = quickTwoSum(s.x, s.y);
s.y += t.y;
s = quickTwoSum(s.x, s.y);
return s;
}
vec2 mul_fp64(vec2 a, vec2 b) {
vec2 prod = twoProd(a.x, b.x);
prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
prod = split2(prod);
#endif
prod = quickTwoSum(prod.x, prod.y);
prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
prod = split2(prod);
#endif
prod = quickTwoSum(prod.x, prod.y);
return prod;
}
vec2 div_fp64(vec2 a, vec2 b) {
float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
vec2 yn = a * xn;
#endif
float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
vec2 prod = twoProd(xn, diff);
return sum_fp64(yn, prod);
}
vec2 sqrt_fp64(vec2 a) {
if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);
float x = 1.0 / sqrt(a.x);
float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
vec2 yn_sqr = twoSqr(yn) * ONE;
#else
vec2 yn_sqr = twoSqr(yn);
#endif
float diff = sub_fp64(a, yn_sqr).x;
vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
return sum_fp64(split(yn), prod);
#else
return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,Ik={ONE:1};function Mk(){return Ik}const Nk={name:"fp64-arithmetic",vs:Pk,getUniforms:Mk,fp64ify:r1,fp64LowPart:xk,fp64ifyMatrix4:Ck},Ok={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...Ok}};const dt=globalThis.mathgl.config;function kk(t,{precision:e=dt.precision}={}){return t=Fk(t),`${parseFloat(t.toPrecision(e))}`}function ys(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Gn(t,e,n){return Bk(t,r=>Math.max(e,Math.min(n,r)))}function Bc(t,e,n){return ys(t)?t.map((r,i)=>Bc(r,e[i],n)):n*e+(1-n)*t}function Zo(t,e,n){const r=dt.EPSILON;n&&(dt.EPSILON=n);try{if(t===e)return!0;if(ys(t)&&ys(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!Zo(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=dt.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{dt.EPSILON=r}}function Fk(t){return Math.round(t/dt.EPSILON)*dt.EPSILON}function Dk(t){return t.clone?t.clone():new Array(t.length)}function Bk(t,e,n){if(ys(t)){const r=t;n=n||Dk(r);for(let i=0;i<n.length&&i<r.length;++i){const s=typeof t=="number"?t:t[i];n[i]=e(s,i,n)}return n}return e(t)}class i1 extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:ys(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(dt)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+kk(this[r],e);return`${e.printTypes?this.constructor.name:""}[${n}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Zo(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const s=e[i],o=typeof n=="number"?n:n[i];this[i]=s+r*(o-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(dt.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function Lk(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function ft(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function ph(t,e,n=""){if(dt.debug&&!Lk(t,e))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return t}function w0(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}class Uk extends i1{get x(){return this[0]}set x(e){this[0]=ft(e)}get y(){return this[1]}set y(e){this[1]=ft(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return ft(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return ft(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return w0(e>=0&&e<this.ELEMENTS,"index is out of range"),ft(this[e])}setComponent(e,n){return w0(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}const $l=1e-6;let vs=typeof Float32Array<"u"?Float32Array:Array;function zk(){const t=new vs(2);return vs!=Float32Array&&(t[0]=0,t[1]=0),t}function S0(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Vk(t,e){return t[0]=-e[0],t[1]=-e[1],t}function s1(t,e,n,r){const i=e[0],s=e[1];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t}function $k(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}(function(){const t=zk();return function(e,n,r,i,s,o){let a,l;for(n||(n=2),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function jk(t,e,n){const r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function o1(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}function Wk(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function Hk(){const t=new vs(3);return vs!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Xk(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Yk(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Kk(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function qk(t,e,n){const r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],l=n[2];return t[0]=i*l-s*a,t[1]=s*o-r*l,t[2]=r*a-i*o,t}function a1(t,e,n){const r=e[0],i=e[1],s=e[2];let o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function Zk(t,e,n){const r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function Qk(t,e,n){const r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],l=e[1],c=e[2];let u=i*c-s*l,f=s*a-r*c,h=r*l-i*a,d=i*h-s*f,_=s*u-r*h,g=r*f-i*u;const b=o*2;return u*=b,f*=b,h*=b,d*=2,_*=2,g*=2,t[0]=a+u+d,t[1]=l+f+_,t[2]=c+h+g,t}function Jk(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function Gk(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function eF(t,e,n,r){const i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function tF(t,e){const n=t[0],r=t[1],i=t[2],s=e[0],o=e[1],a=e[2],l=Math.sqrt((n*n+r*r+i*i)*(s*s+o*o+a*a)),c=l&&Kk(t,e)/l;return Math.acos(Math.min(Math.max(c,-1),1))}const nF=Xk;(function(){const t=Hk();return function(e,n,r,i,s,o){let a,l;for(n||(n=3),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const gh=[0,0,0];let fl;class cn extends Uk{static get ZERO(){return fl||(fl=new cn(0,0,0),Object.freeze(fl)),fl}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&ys(e)?this.copy(e):(dt.debug&&(ft(e),ft(n),ft(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return dt.debug&&(ft(e.x),ft(e.y),ft(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=ft(e)}angle(e){return tF(this,e)}cross(e){return qk(this,this,e),this.check()}rotateX({radians:e,origin:n=gh}){return Jk(this,this,n,e),this.check()}rotateY({radians:e,origin:n=gh}){return Gk(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=gh}){return eF(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return a1(this,this,e),this.check()}transformAsVector(e){return o1(this,this,e),this.check()}transformByMatrix3(e){return Zk(this,this,e),this.check()}transformByMatrix2(e){return Wk(this,this,e),this.check()}transformByQuaternion(e){return Qk(this,this,e),this.check()}}class rF extends i1{toString(){let e="[";if(dt.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=` ${this[r*this.RANK+n]}`}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=` ${this[n]}`}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=ft(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function iF(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function sF(t,e){if(t===e){const n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function op(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],u=e[8],f=e[9],h=e[10],d=e[11],_=e[12],g=e[13],b=e[14],m=e[15],p=n*a-r*o,y=n*l-i*o,S=n*c-s*o,R=r*l-i*a,P=r*c-s*a,O=i*c-s*l,k=u*g-f*_,D=u*b-h*_,z=u*m-d*_,H=f*b-h*g,X=f*m-d*g,Y=h*m-d*b;let Z=p*Y-y*X+S*H+R*z-P*D+O*k;return Z?(Z=1/Z,t[0]=(a*Y-l*X+c*H)*Z,t[1]=(i*X-r*Y-s*H)*Z,t[2]=(g*O-b*P+m*R)*Z,t[3]=(h*P-f*O-d*R)*Z,t[4]=(l*z-o*Y-c*D)*Z,t[5]=(n*Y-i*z+s*D)*Z,t[6]=(b*S-_*O-m*y)*Z,t[7]=(u*O-h*S+d*y)*Z,t[8]=(o*X-a*z+c*k)*Z,t[9]=(r*z-n*X-s*k)*Z,t[10]=(_*P-g*S+m*p)*Z,t[11]=(f*S-u*P-d*p)*Z,t[12]=(a*D-o*H-l*k)*Z,t[13]=(n*H-r*D+i*k)*Z,t[14]=(g*y-_*R-b*p)*Z,t[15]=(u*R-f*y+h*p)*Z,t):null}function oF(t){const e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],f=t[10],h=t[11],d=t[12],_=t[13],g=t[14],b=t[15],m=e*o-n*s,p=e*a-r*s,y=n*a-r*o,S=c*_-u*d,R=c*g-f*d,P=u*g-f*_,O=e*P-n*R+r*S,k=s*P-o*R+a*S,D=c*y-u*p+f*m,z=d*y-_*p+g*m;return l*O-i*k+b*D-h*z}function Yr(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],f=e[8],h=e[9],d=e[10],_=e[11],g=e[12],b=e[13],m=e[14],p=e[15];let y=n[0],S=n[1],R=n[2],P=n[3];return t[0]=y*r+S*a+R*f+P*g,t[1]=y*i+S*l+R*h+P*b,t[2]=y*s+S*c+R*d+P*m,t[3]=y*o+S*u+R*_+P*p,y=n[4],S=n[5],R=n[6],P=n[7],t[4]=y*r+S*a+R*f+P*g,t[5]=y*i+S*l+R*h+P*b,t[6]=y*s+S*c+R*d+P*m,t[7]=y*o+S*u+R*_+P*p,y=n[8],S=n[9],R=n[10],P=n[11],t[8]=y*r+S*a+R*f+P*g,t[9]=y*i+S*l+R*h+P*b,t[10]=y*s+S*c+R*d+P*m,t[11]=y*o+S*u+R*_+P*p,y=n[12],S=n[13],R=n[14],P=n[15],t[12]=y*r+S*a+R*f+P*g,t[13]=y*i+S*l+R*h+P*b,t[14]=y*s+S*c+R*d+P*m,t[15]=y*o+S*u+R*_+P*p,t}function Lc(t,e,n){const r=n[0],i=n[1],s=n[2];let o,a,l,c,u,f,h,d,_,g,b,m;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*s+e[12],t[13]=e[1]*r+e[5]*i+e[9]*s+e[13],t[14]=e[2]*r+e[6]*i+e[10]*s+e[14],t[15]=e[3]*r+e[7]*i+e[11]*s+e[15]):(o=e[0],a=e[1],l=e[2],c=e[3],u=e[4],f=e[5],h=e[6],d=e[7],_=e[8],g=e[9],b=e[10],m=e[11],t[0]=o,t[1]=a,t[2]=l,t[3]=c,t[4]=u,t[5]=f,t[6]=h,t[7]=d,t[8]=_,t[9]=g,t[10]=b,t[11]=m,t[12]=o*r+u*i+_*s+e[12],t[13]=a*r+f*i+g*s+e[13],t[14]=l*r+h*i+b*s+e[14],t[15]=c*r+d*i+m*s+e[15]),t}function y_(t,e,n){const r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function aF(t,e,n,r){let i=r[0],s=r[1],o=r[2],a=Math.sqrt(i*i+s*s+o*o),l,c,u,f,h,d,_,g,b,m,p,y,S,R,P,O,k,D,z,H,X,Y,Z,je;return a<$l?null:(a=1/a,i*=a,s*=a,o*=a,c=Math.sin(n),l=Math.cos(n),u=1-l,f=e[0],h=e[1],d=e[2],_=e[3],g=e[4],b=e[5],m=e[6],p=e[7],y=e[8],S=e[9],R=e[10],P=e[11],O=i*i*u+l,k=s*i*u+o*c,D=o*i*u-s*c,z=i*s*u-o*c,H=s*s*u+l,X=o*s*u+i*c,Y=i*o*u+s*c,Z=s*o*u-i*c,je=o*o*u+l,t[0]=f*O+g*k+y*D,t[1]=h*O+b*k+S*D,t[2]=d*O+m*k+R*D,t[3]=_*O+p*k+P*D,t[4]=f*z+g*H+y*X,t[5]=h*z+b*H+S*X,t[6]=d*z+m*H+R*X,t[7]=_*z+p*H+P*X,t[8]=f*Y+g*Z+y*je,t[9]=h*Y+b*Z+S*je,t[10]=d*Y+m*Z+R*je,t[11]=_*Y+p*Z+P*je,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function l1(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+c*r,t[5]=o*i+u*r,t[6]=a*i+f*r,t[7]=l*i+h*r,t[8]=c*i-s*r,t[9]=u*i-o*r,t[10]=f*i-a*r,t[11]=h*i-l*r,t}function lF(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[8],u=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-c*r,t[1]=o*i-u*r,t[2]=a*i-f*r,t[3]=l*i-h*r,t[8]=s*r+c*i,t[9]=o*r+u*i,t[10]=a*r+f*i,t[11]=l*r+h*i,t}function c1(t,e,n){const r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],l=e[3],c=e[4],u=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+c*r,t[1]=o*i+u*r,t[2]=a*i+f*r,t[3]=l*i+h*r,t[4]=c*i-s*r,t[5]=u*i-o*r,t[6]=f*i-a*r,t[7]=h*i-l*r,t}function cF(t,e){const n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,l=i+i,c=n*o,u=r*o,f=r*a,h=i*o,d=i*a,_=i*l,g=s*o,b=s*a,m=s*l;return t[0]=1-f-_,t[1]=u+m,t[2]=h-b,t[3]=0,t[4]=u-m,t[5]=1-c-_,t[6]=d+g,t[7]=0,t[8]=h+b,t[9]=d-g,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function uF(t,e,n,r,i,s,o){const a=1/(n-e),l=1/(i-r),c=1/(s-o);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*l,t[10]=(o+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*c,t[15]=0,t}function fF(t,e,n,r,i){const s=1/Math.tan(e/2);if(t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0){const o=1/(r-i);t[10]=(i+r)*o,t[14]=2*i*r*o}else t[10]=-1,t[14]=-2*r;return t}const hF=fF;function dF(t,e,n,r,i,s,o){const a=1/(e-n),l=1/(r-i),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*l,t[14]=(o+s)*c,t[15]=1,t}const pF=dF;function gF(t,e,n,r){let i,s,o,a,l,c,u,f,h,d;const _=e[0],g=e[1],b=e[2],m=r[0],p=r[1],y=r[2],S=n[0],R=n[1],P=n[2];return Math.abs(_-S)<$l&&Math.abs(g-R)<$l&&Math.abs(b-P)<$l?iF(t):(f=_-S,h=g-R,d=b-P,i=1/Math.sqrt(f*f+h*h+d*d),f*=i,h*=i,d*=i,s=p*d-y*h,o=y*f-m*d,a=m*h-p*f,i=Math.sqrt(s*s+o*o+a*a),i?(i=1/i,s*=i,o*=i,a*=i):(s=0,o=0,a=0),l=h*a-d*o,c=d*s-f*a,u=f*o-h*s,i=Math.sqrt(l*l+c*c+u*u),i?(i=1/i,l*=i,c*=i,u*=i):(l=0,c=0,u=0),t[0]=s,t[1]=l,t[2]=f,t[3]=0,t[4]=o,t[5]=c,t[6]=h,t[7]=0,t[8]=a,t[9]=u,t[10]=d,t[11]=0,t[12]=-(s*_+o*g+a*b),t[13]=-(l*_+c*g+u*b),t[14]=-(f*_+h*g+d*b),t[15]=1,t)}function _F(){const t=new vs(4);return vs!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function mF(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Ea(t,e,n){const r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}(function(){const t=_F();return function(e,n,r,i,s,o){let a,l;for(n||(n=4),r||(r=0),i?l=Math.min(i*n+r,e.length):l=e.length,a=r;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var ap;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(ap||(ap={}));const yF=45*Math.PI/180,vF=1,_h=.1,mh=500,TF=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class un extends rF{static get IDENTITY(){return SF()}static get ZERO(){return wF()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return ap}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,s,o,a,l,c,u,f,h,d,_,g,b){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=s,this[5]=o,this[6]=a,this[7]=l,this[8]=c,this[9]=u,this[10]=f,this[11]=h,this[12]=d,this[13]=_,this[14]=g,this[15]=b,this.check()}setRowMajor(e,n,r,i,s,o,a,l,c,u,f,h,d,_,g,b){return this[0]=e,this[1]=s,this[2]=c,this[3]=d,this[4]=n,this[5]=o,this[6]=u,this[7]=_,this[8]=r,this[9]=a,this[10]=f,this[11]=g,this[12]=i,this[13]=l,this[14]=h,this[15]=b,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(TF)}fromObject(e){return this.check()}fromQuaternion(e){return cF(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:s,near:o=_h,far:a=mh}=e;return a===1/0?EF(this,n,r,i,s,o):uF(this,n,r,i,s,o,a),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return gF(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:s,near:o=_h,far:a=mh}=e;return pF(this,n,r,i,s,o,a),this.check()}orthographic(e){const{fovy:n=yF,aspect:r=vF,focalDistance:i=1,near:s=_h,far:o=mh}=e;E0(n);const a=n/2,l=i*Math.tan(a),c=l*r;return this.ortho({left:-c,right:c,bottom:-l,top:l,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:s=500}=e;return E0(n),hF(this,n,r,i,s),this.check()}determinant(){return oF(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],s=1/r[1],o=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*i,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*i,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return sF(this,this),this.check()}invert(){return op(this,this),this.check()}multiplyLeft(e){return Yr(this,e,this),this.check()}multiplyRight(e){return Yr(this,this,e),this.check()}rotateX(e){return l1(this,this,e),this.check()}rotateY(e){return lF(this,this,e),this.check()}rotateZ(e){return c1(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return aF(this,this,e,n),this.check()}scale(e){return y_(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Lc(this,this,e),this.check()}transform(e,n){return e.length===4?(n=Ea(n||[-0,-0,-0,-0],e,this),ph(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=$k(n||[-0,-0],e,this);break;case 3:i=a1(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return ph(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=jk(n||[-0,-0],e,this);break;case 3:r=o1(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return ph(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let hl,dl;function wF(){return hl||(hl=new un([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(hl)),hl}function SF(){return dl||(dl=new un,Object.freeze(dl)),dl}function E0(t){if(t>Math.PI*2)throw Error("expected radians")}function EF(t,e,n,r,i,s){const o=2*s/(n-e),a=2*s/(i-r),l=(n+e)/(n-e),c=(i+r)/(i-r),u=-1,f=-1,h=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=c,t[10]=u,t[11]=f,t[12]=0,t[13]=0,t[14]=h,t[15]=0,t}const b0=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
vec3 color;
};
struct PointLight {
vec3 color;
vec3 position;
vec3 attenuation;
};
struct DirectionalLight {
vec3 color;
vec3 direction;
};
uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;
uniform bool lighting_uEnabled;
float getPointLightAttenuation(PointLight pointLight, float distance) {
return pointLight.attenuation.x
+ pointLight.attenuation.y * distance
+ pointLight.attenuation.z * distance * distance;
}
#endif
`,bF={lightSources:{}};function yh(t={}){const{color:e=[0,0,0],intensity:n=1}=t;return e.map(r=>r*n/255)}function AF({ambientLight:t,pointLights:e=[],directionalLights:n=[]}){const r={};return t?r["lighting_uAmbientLight.color"]=yh(t):r["lighting_uAmbientLight.color"]=[0,0,0],e.forEach((i,s)=>{r[`lighting_uPointLight[${s}].color`]=yh(i),r[`lighting_uPointLight[${s}].position`]=i.position,r[`lighting_uPointLight[${s}].attenuation`]=i.attenuation||[1,0,0]}),r.lighting_uPointLightCount=e.length,n.forEach((i,s)=>{r[`lighting_uDirectionalLight[${s}].color`]=yh(i),r[`lighting_uDirectionalLight[${s}].direction`]=i.direction}),r.lighting_uDirectionalLightCount=n.length,r}function u1(t=bF){var e,n;if("lightSources"in t){const{ambientLight:r,pointLights:i,directionalLights:s}=t.lightSources||{};return r||i&&i.length>0||s&&s.length>0?Object.assign({},AF({ambientLight:r,pointLights:i,directionalLights:s}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const r={pointLights:[],directionalLights:[]};for(const i of t.lights||[])switch(i.type){case"ambient":r.ambientLight=i;break;case"directional":(e=r.directionalLights)==null||e.push(i);break;case"point":(n=r.pointLights)==null||n.push(i);break}return u1({lightSources:r})}return{}}const RF={name:"lights",vs:b0,fs:b0,getUniforms:u1,defines:{MAX_LIGHTS:3}},xF=`uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;
vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
vec3 halfway_direction = normalize(light_direction + view_direction);
float lambertian = dot(light_direction, normal_worldspace);
float specular = 0.0;
if (lambertian > 0.0) {
float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
specular = pow(specular_angle, lighting_uShininess);
}
lambertian = max(lambertian, 0.0);
return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}
vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
vec3 lightColor = surfaceColor;
if (lighting_uEnabled) {
vec3 view_direction = normalize(cameraPosition - position_worldspace);
lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uPointLightCount) {
break;
}
PointLight pointLight = lighting_uPointLight[i];
vec3 light_position_worldspace = pointLight.position;
vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
}
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uDirectionalLightCount) {
break;
}
DirectionalLight directionalLight = lighting_uDirectionalLight[i];
lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
}
}
return lightColor;
}
vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
vec3 lightColor = vec3(0, 0, 0);
vec3 surfaceColor = vec3(0, 0, 0);
if (lighting_uEnabled) {
vec3 view_direction = normalize(cameraPosition - position_worldspace);
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uPointLightCount) {
break;
}
PointLight pointLight = lighting_uPointLight[i];
vec3 light_position_worldspace = pointLight.position;
vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
}
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uDirectionalLightCount) {
break;
}
DirectionalLight directionalLight = lighting_uDirectionalLight[i];
lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
}
}
return lightColor;
}
`,CF={};function PF(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(s=>s/255)}}function IF(t=CF){if(!("material"in t))return{};const{material:e}=t;return e?PF(e):{lighting_uEnabled:!1}}const MF={name:"gouraud-lighting",dependencies:[RF],vs:xF,defines:{LIGHTING_VERTEX:1},getUniforms:IF},f1="#define SMOOTH_EDGE_RADIUS 0.5",NF=`
${f1}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,OF=`
${f1}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,kF={name:"geometry",vs:NF,fs:OF},te={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(te,"IDENTITY",{get:()=>(J.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const sn={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},ei={common:0,meters:1,pixels:2},lp={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},FF=Object.keys(te).map(t=>`const int COORDINATE_SYSTEM_${t} = ${te[t]};`).join(""),DF=Object.keys(sn).map(t=>`const int PROJECTION_MODE_${t} = ${sn[t]};`).join(""),BF=Object.keys(ei).map(t=>`const int UNIT_${t.toUpperCase()} = ${ei[t]};`).join(""),LF=`${FF}
${DF}
${BF}
uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project_uPseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project_uCommonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project_uCommonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project_uCommonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project_uWrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project_uModelMatrix * position;
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project_uCoordinateOrigin;
}
}
if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
(project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project_uCoordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
return offset * project_uFocalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project_uScale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project_uScale;
}
`;function UF(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function ba(t){let e={},n;return r=>{for(const i in r)if(!UF(r[i],e[i])){n=t(r),e=r;break}return n}}const A0=[0,0,0,0],zF=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],h1=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],VF=[0,0,0],d1=[0,0,0],$F=ba(HF);function p1(t,e,n=d1){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,s=!0;switch(e===te.LNGLAT_OFFSETS||e===te.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case sn.WEB_MERCATOR:(e===te.LNGLAT||e===te.CARTESIAN)&&(i=[0,0,0],s=!1);break;case sn.WEB_MERCATOR_AUTO_OFFSET:e===te.LNGLAT?r=i:e===te.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case sn.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case sn.GLOBE:s=!1,i=null;break;default:s=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:s}}function jF(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=A0,l=A0,c=t.cameraPosition;const{geospatialOrigin:u,shaderCoordinateOrigin:f,offsetMode:h}=p1(t,e,n);return h&&(l=t.projectPosition(u||f),c=[c[0]-l[0],c[1]-l[1],c[2]-l[2]],l[3]=1,a=Ea([],l,o),s=r||s,o=Yr([],i,s),o=Yr([],o,zF)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:f,geospatialOrigin:u}}function WF({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=te.DEFAULT,coordinateOrigin:i=d1,autoWrapLongitude:s=!1}){r===te.DEFAULT&&(r=t.isGeospatial?te.LNGLAT:te.CARTESIAN);const o=$F({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return o.project_uWrapLongitude=s,o.project_uModelMatrix=n||h1,o}function HF({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:c}=jF(t,n,r),u=t.getDistanceScales(),f=[t.width*e,t.height*e],h=Ea([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,d={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:o.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:f,project_uDevicePixelRatio:e,project_uFocalDistance:h,project_uCommonUnitsPerMeter:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit:u.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:VF,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:h1,project_uCameraPosition:a};if(c){const _=t.getDistanceScales(c);switch(n){case te.METER_OFFSETS:d.project_uCommonUnitsPerWorldUnit=_.unitsPerMeter,d.project_uCommonUnitsPerWorldUnit2=_.unitsPerMeter2;break;case te.LNGLAT:case te.LNGLAT_OFFSETS:t._pseudoMeters||(d.project_uCommonUnitsPerMeter=_.unitsPerMeter),d.project_uCommonUnitsPerWorldUnit=_.unitsPerDegree,d.project_uCommonUnitsPerWorldUnit2=_.unitsPerDegree2;break;case te.CARTESIAN:d.project_uCommonUnitsPerWorldUnit=[1,1,_.unitsPerMeter[2]],d.project_uCommonUnitsPerWorldUnit2=[0,0,_.unitsPerMeter2[2]];break}}return d}const XF={};function YF(t=XF){return"viewport"in t?WF(t):{}}const v_={name:"project",dependencies:[Sk,kF],vs:LF,getUniforms:YF},KF=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Aa={name:"project32",dependencies:[v_],vs:KF};function qF(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function rs(t,e){const n=Ea([],e,t);return mF(n,n,1/n[3]),n}function R0(t,e){const n=t%e;return n<0?e+n:n}function cp(t,e,n){return t<e?e:t>n?n:t}function ZF(t){return Math.log(t)*Math.LOG2E}const T_=Math.log2||ZF;function Mn(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Dt=Math.PI,g1=Dt/4,Rt=Dt/180,up=180/Dt,Ts=512,Uc=4003e4,pl=85.051129,QF=1.5;function JF(t){return T_(t)}function Qo(t){const[e,n]=t;Mn(Number.isFinite(e)),Mn(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*Rt,i=n*Rt,s=Ts*(r+Dt)/(2*Dt),o=Ts*(Dt+Math.log(Math.tan(g1+i*.5)))/(2*Dt);return[s,o]}function ws(t){const[e,n]=t,r=e/Ts*(2*Dt)-Dt,i=2*(Math.atan(Math.exp(n/Ts*(2*Dt)-Dt))-g1);return[r*up,i*up]}function GF(t){const{latitude:e}=t;Mn(Number.isFinite(e));const n=Math.cos(e*Rt);return JF(Uc*n)-9}function jl(t){const e=Math.cos(t*Rt);return Ts/Uc/e}function fp(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;Mn(Number.isFinite(e)&&Number.isFinite(n));const i=Ts,s=Math.cos(e*Rt),o=i/360,a=o/s,l=i/Uc/s,c={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[o,a,l],degreesPerUnit:[1/o,1/a,1/l]};if(r){const u=Rt*Math.tan(e*Rt)/s,f=o*u/2,h=i/Uc*u,d=h/a*l;c.unitsPerDegree2=[0,f,h],c.unitsPerMeter2=[d,0,d]}return c}function _1(t,e){const[n,r,i]=t,[s,o,a]=e,{unitsPerMeter:l,unitsPerMeter2:c}=fp({longitude:n,latitude:r,highPrecision:!0}),u=Qo(t);u[0]+=s*(l[0]+c[0]*o),u[1]+=o*(l[1]+c[1]*o);const f=ws(u),h=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[f[0],f[1],h]:f}function eD(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:s,center:o}=t,a=qF();Lc(a,a,[0,0,-i]),l1(a,a,-n*Rt),c1(a,a,r*Rt);const l=s/e;return y_(a,a,[l,l,l]),o&&Lc(a,a,Yk([],o)),a}function tD(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:s,center:o,scale:a,nearZMultiplier:l=1,farZMultiplier:c=1}=t;let{fovy:u=zc(QF)}=t;r!==void 0&&(u=zc(r));const f=u*Rt,h=i*Rt,d=m1(u);let _=d;o&&(_+=o[2]*a/Math.cos(h)/n);const g=f*(.5+(s?s[1]:0)/n),b=Math.sin(g)*_/Math.sin(cp(Math.PI/2-h-g,.01,Math.PI-.01)),m=Math.sin(h)*b+_,p=_*10,y=Math.min(m*c,p);return{fov:f,aspect:e/n,focalDistance:d,near:l,far:y}}function zc(t){return 2*Math.atan(.5/t)*up}function m1(t){return .5/Math.tan(.5*t*Rt)}function y1(t,e){const[n,r,i=0]=t;return Mn(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),rs(e,[n,r,i,1])}function w_(t,e,n=0){const[r,i,s]=t;if(Mn(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(s))return rs(e,[r,i,s,1]);const o=rs(e,[r,i,0,1]),a=rs(e,[r,i,1,1]),l=o[2],c=a[2],u=l===c?0:((n||0)-l)/(c-l);return s1([],o,a,u)}function nD(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,l],[c,u]]=r,f=rD(t.padding),h=Qo([a,cp(u,-pl,pl)]),d=Qo([c,cp(l,-pl,pl)]),_=[Math.max(Math.abs(d[0]-h[0]),i),Math.max(Math.abs(d[1]-h[1]),i)],g=[e-f.left-f.right-Math.abs(o[0])*2,n-f.top-f.bottom-Math.abs(o[1])*2];Mn(g[0]>0&&g[1]>0);const b=g[0]/_[0],m=g[1]/_[1],p=(f.right-f.left)/2/b,y=(f.top-f.bottom)/2/m,S=[(d[0]+h[0])/2+p,(d[1]+h[1])/2+y],R=ws(S),P=Math.min(s,T_(Math.abs(Math.min(b,m))));return Mn(Number.isFinite(P)),{longitude:R[0],latitude:R[1],zoom:P}}function rD(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Mn(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const x0=Math.PI/180;function iD(t,e=0){const{width:n,height:r,unproject:i}=t,s={targetZ:e},o=i([0,r],s),a=i([n,r],s);let l,c;const u=t.fovy?.5*t.fovy*x0:Math.atan(.5/t.altitude),f=(90-t.pitch)*x0;return u>f-.01?(l=C0(t,0,e),c=C0(t,n,e)):(l=i([0,0],s),c=i([n,0],s)),[o,a,c,l]}function C0(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=rs(r,[e,0,1,1]),s=rs(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(s[2]-i[2]),l=s1([],i,s,a),c=ws(l);return c.push(n),c}const P0=512;function sD(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:s,zoom:o,bearing:a=0}=t;(i<-180||i>180)&&(i=R0(i+180,360)-180),(a<-180||a>180)&&(a=R0(a+180,360)-180);const l=T_(n/P0);if(o<=l)o=l,s=0;else{const c=n/2/Math.pow(2,o),u=ws([0,c])[1];if(s<u)s=u;else{const f=ws([0,P0-c])[1];s>f&&(s=f)}}return{width:e,height:n,longitude:i,latitude:s,zoom:o,pitch:r,bearing:a}}const oD=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,aD=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,lD=ba(dD),cD=ba(pD),uD=[0,0,0,1],fD=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function hD(t,e){const[n,r,i]=t,s=w_([n,r,i],e);return Number.isFinite(i)?s:[s[0],s[1],0]}function dD({viewport:t,center:e}){return new un(t.viewProjectionMatrix).invert().transform(e)}function pD({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,s=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>hD(o,r));for(const o of e){const a=o.clone().translate(new cn(t.center).negate()),l=s.map(u=>a.transform(u)),c=new un().ortho({left:Math.min(...l.map(u=>u[0])),right:Math.max(...l.map(u=>u[0])),bottom:Math.min(...l.map(u=>u[1])),top:Math.max(...l.map(u=>u[1])),near:Math.min(...l.map(u=>-u[2])),far:Math.max(...l.map(u=>-u[2]))});n.push(c.multiplyRight(o))}return n}function gD(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1,shadow_uShadowMap0:t.dummyShadowMap,shadow_uShadowMap1:t.dummyShadowMap};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||uD,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=lD({viewport:t.viewport,center:e.project_uCenter}),s=[],o=cD({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const l=o[a],c=l.clone().translate(new cn(t.viewport.center).negate());e.project_uCoordinateSystem===te.LNGLAT&&e.project_uProjectionMode===sn.WEB_MERCATOR?(o[a]=c,s[a]=i):(o[a]=l.clone().multiplyRight(fD),s[a]=c.transform(i))}for(let a=0;a<o.length;a++)r[`shadow_uViewProjectionMatrices[${a}]`]=o[a],r[`shadow_uProjectCenters[${a}]`]=s[a];for(let a=0;a<2;a++)r[`shadow_uShadowMap${a}`]=t.shadowMaps&&t.shadowMaps[a]||t.dummyShadowMap;return r}const I0={name:"shadow",dependencies:[v_],vs:oD,fs:aD,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?gD(t,e):{}},Ra={...T0,defaultUniforms:{...T0.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},_D=[v_],mD=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function yD(){const t=Cc.getDefaultShaderAssembler();for(const e of _D)t.addDefaultModule(e);for(const e of mD)t.addShaderHook(e);return t}const vD=[255,255,255],TD=1;let wD=0;class SD{constructor(e={}){this.type="ambient";const{color:n=vD}=e,{intensity:r=TD}=e;this.id=e.id||`ambient-${wD++}`,this.color=n,this.intensity=r}}const ED=[255,255,255],bD=1,AD=[0,0,-1];let RD=0;class M0{constructor(e={}){this.type="directional";const{color:n=ED}=e,{intensity:r=bD}=e,{direction:i=AD}=e,{_shadow:s=!1}=e;this.id=e.id||`directional-${RD++}`,this.color=n,this.intensity=r,this.type="directional",this.direction=new cn(i).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class xD{constructor(e,n={id:"pass"}){const{id:r}=n;this.id=r,this.device=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class S_ extends xD{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[n,r]=this.device.canvasContext.getDrawingBufferSize(),i=e.clearCanvas??!0,s=e.clearColor??(i?[0,0,0,0]:!1),o=i?1:!1,a=i?0:!1,l=e.colorMask??15,c={viewport:[0,0,n,r]};e.colorMask&&(c.colorMask=l),e.scissorRect&&(c.scissorRect=e.scissorRect);const u=this.device.beginRenderPass({framebuffer:e.target,parameters:c,clearColor:s,clearDepth:o,clearStencil:a});try{return this._drawLayers(u,e)}finally{u.end()}}_drawLayers(e,n){const{target:r,moduleParameters:i,viewports:s,views:o,onViewportActive:a,clearStack:l=!0}=n;n.pass=n.pass||"unknown",l&&(this._lastRenderIndex=-1);const c=[];for(const u of s){const f=o&&o[u.id];a==null||a(u);const h=this._getDrawLayerParams(u,n),d=u.subViewports||[u];for(const _ of d){const g=this._drawLayersInViewport(e,{target:r,moduleParameters:i,viewport:_,view:f,pass:n.pass,layers:n.layers},h);c.push(g)}}return c}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:s,cullRect:o,effects:a,moduleParameters:l},c=!1){var _;const u=[],f=v1(this._lastRenderIndex+1),h={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:o},d={};for(let g=0;g<n.length;g++){const b=n[g],m=this._shouldDrawLayer(b,h,s,d),p={shouldDrawLayer:m};m&&!c&&(p.layerRenderIndex=f(b,m),p.moduleParameters=this._getModuleParameters(b,a,r,l),p.layerParameters={...(_=b.context.deck)==null?void 0:_.props.parameters,...this.getLayerParameters(b,g,e)}),u[g]=p}return u}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:s,viewport:o,view:a},l){const c=CD(this.device,{moduleParameters:r,target:s,viewport:o});if(a&&a.props.clear){const f=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;this.device.withParametersWebGL({scissorTest:!0,scissor:c},()=>this.device.clearWebGL(f))}const u={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:c});for(let f=0;f<n.length;f++){const h=n[f],{shouldDrawLayer:d,layerRenderIndex:_,moduleParameters:g,layerParameters:b}=l[f];if(d&&h.props.pickable&&u.pickableCount++,h.isComposite)u.compositeCount++;else if(d){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,_),g.viewport=o,h.context.renderPass=e;try{h._drawLayer({renderPass:e,moduleParameters:g,uniforms:{layerIndex:_},parameters:b})}catch(m){h.raiseError(m,`drawing ${h} to ${i}`)}}}return u}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(r){const a=n.layer.id;if(a in i||(i[a]=r(n)),!i[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var a,l;const s=this.device.canvasContext.cssToDeviceRatio(),o=Object.assign(Object.create(((a=e.internalState)==null?void 0:a.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,picking:{isActive:0},devicePixelRatio:s});if(n)for(const c of n)Object.assign(o,(l=c.getModuleParameters)==null?void 0:l.call(c,e));return Object.assign(o,this.getModuleParameters(e,n),i)}}function v1(t=0,e={}){const n={},r=(i,s)=>{const o=i.props._offset,a=i.id,l=i.parent&&i.parent.id;let c;if(l&&!(l in e)&&r(i.parent,!1),l in n){const u=n[l]=n[l]||v1(e[l],e);c=u(i,s),n[a]=u}else Number.isFinite(o)?(c=o+(e[l]||0),n[a]=null):c=t;return s&&c>=t&&(t=c+1),e[a]=c,c};return r}function CD(t,{moduleParameters:e,target:n,viewport:r}){const i=e&&e.devicePixelRatio||t.canvasContext.cssToDeviceRatio(),[,s]=t.canvasContext.getDrawingBufferSize(),o=n?n.height:s,a=r;return[a.x*i,o-(a.y+a.height)*i,a.width*i,a.height*i]}class PD extends S_{constructor(e,n){super(e,n),this.shadowMap=e.createTexture({width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),this.depthBuffer=e.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1,dataFormat:6402,type:5125}),this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[this.shadowMap],depthStencilAttachment:this.depthBuffer})}render(e){const n=this.fbo,r=this.device.canvasContext.cssToDeviceRatio(),i=e.viewports[0],s=i.width*r,o=i.height*r,a=[1,1,1,1];(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,clearColor:a,target:n,pass:"shadow"})}getLayerParameters(e,n,r){return{...e.props.parameters,blend:!1,depthRange:[0,1],depthTest:!0}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null),this.shadowMap&&(this.shadowMap.destroy(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.destroy(),this.depthBuffer=null)}}const ID={color:[255,255,255],intensity:1},N0=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],MD=[0,0,0,200/255];class T1{constructor(e={}){this.id="lighting-effect",this.shadowColor=MD,this.shadow=!1,this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:n,deck:r}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(n),r._addDefaultShaderModule(I0),this.dummyShadowMap=n.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:s}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let o=0;o<this.shadowPasses.length;o++)this.shadowPasses[o].render({layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:s,moduleParameters:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(e){for(const n of this.shadowPasses)n.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(I0))}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new un().lookAt({eye:new cn(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new PD(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new SD(ID),this.directionalLights.push(new M0(N0[0]),new M0(N0[1])))}}class ND{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:l}){const c=i||e&&e.constructor||Float32Array,u=n*r+s;if(ArrayBuffer.isView(e)){if(u<=e.length)return e;if(u*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new c(e.buffer,0,u)}let f=1/0;l&&(f=l*r+s);const h=this._allocate(c,u,a,f);return e&&o?h.set(e):a||h.fill(0,0,4),this._release(e),h}release(e){this._release(e)}_allocate(e,n,r,i){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>i&&(s=i);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,l=o.findIndex(c=>c.byteLength>=a);if(l>=0){const c=new e(o.splice(l,1)[0],0,s);return r&&c.fill(0),c}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,s=n.findIndex(o=>o.byteLength>=i);s<0?n.push(r):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,r),n.length>this.opts.poolSize&&n.shift()}}const Ss=new ND;function oo(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function OD(t){return[t[12],t[13],t[14]]}function kD(t){return{left:bi(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:bi(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:bi(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:bi(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:bi(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:bi(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const O0=new cn;function bi(t,e,n,r){O0.set(t,e,n);const i=O0.len();return{distance:r/i,normal:new cn(-t/i,-e/i,-n/i)}}function FD(t){return t-Math.fround(t)}let Ks;function vh(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,s=(i-r)/n;Ks=Ss.allocate(Ks,s,{type:Float32Array,size:n*2});let o=r,a=0;for(;o<i;){for(let l=0;l<n;l++){const c=t[o++];Ks[a+l]=c,Ks[a+l+n]=FD(c)}a+=n*2}return Ks.subarray(0,s*n*2)}function DD(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const BD=Math.PI/180,LD=oo(),k0=[0,0,0],UD={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function zD({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:s,near:o,far:a}){const l=t/e,c=n?new un().orthographic({fovy:r,aspect:l,focalDistance:i,near:o,far:a}):new un().perspective({fovy:r,aspect:l,near:o,far:a});if(s){const{left:u=0,right:f=0,top:h=0,bottom:d=0}=s,_=Gn((u+t-f)/2,0,t)-t/2,g=Gn((h+e-d)/2,0,e)-e/2;c[8]-=_*2/t,c[9]+=g*2/e}return c}const cu=class cu{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||UD,this.focalDistance=e.focalDistance||1,this.position=e.position||k0,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?sn.WEB_MERCATOR:sn.WEB_MERCATOR_AUTO_OFFSET:sn.IDENTITY}equals(e){return e instanceof cu?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Zo(e.projectionMatrix,this.projectionMatrix)&&Zo(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=y1(r,this.pixelProjectionMatrix),[s,o]=i,a=n?o:this.height-o;return e.length===2?[s,a]:[s,a,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,s,o]=e,a=n?s:this.height-s,l=r&&r*this.distanceScales.unitsPerMeter[2],c=w_([i,a,o],this.pixelUnprojectionMatrix,l),[u,f,h]=this.unprojectPosition(c);return Number.isFinite(o)?[u,f,h]:Number.isFinite(r)?[u,f,r]:[u,f]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=Qo(e);return n[1]=Gn(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?ws(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],s[0],o[0]),Math.min(r[1],i[1],s[1],o[1]),Math.max(r[0],i[0],s[0],o[0]),Math.max(r[1],i[1],s[1],o[1])]}getDistanceScales(e){return e?fp({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,kD(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=GF({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||fp({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:s,modelMatrix:o}=e;let a=k0;if(s&&(a=o?new un(o).transformAsVector(s,[]):s),this.isGeospatial){const l=this.projectPosition([n,r,0]);this.center=new cn(a).scale(this.distanceScales.unitsPerMeter).add(l)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=LD,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:l=1e3,padding:c=null,focalDistance:u=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new un().multiplyRight(n).translate(new cn(this.center).negate()),this.projectionMatrix=r||zD({width:this.width,height:this.height,orthographic:i,fovyRadians:s||o*BD,focalDistance:u,padding:c,near:a,far:l});const f=oo();Yr(f,f,this.projectionMatrix),Yr(f,f,this.viewMatrix),this.viewProjectionMatrix=f,this.viewMatrixInverse=op([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=OD(this.viewMatrixInverse);const h=oo(),d=oo();y_(h,h,[this.width/2,-this.height/2,1]),Lc(h,h,[1,-1,0]),Yr(d,h,this.viewProjectionMatrix),this.pixelProjectionMatrix=d,this.pixelUnprojectionMatrix=op(oo(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||J.warn("Pixel project matrix not invertible")()}};cu.displayName="Viewport";let Vc=cu;const xo=class xo extends Vc{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:l=1.01,nearZ:c,farZ:u,orthographic:f=!1,projectionMatrix:h,repeat:d=!1,worldOffset:_=0,position:g,padding:b,legacyMeterSizes:m=!1}=e;let{width:p,height:y,altitude:S=1.5}=e;const R=Math.pow(2,i);p=p||1,y=y||1;let P,O=null;if(h)S=h[5]/2,P=zc(S);else{e.fovy?(P=e.fovy,S=m1(P)):P=zc(S);let D;if(b){const{top:z=0,bottom:H=0}=b;D=[0,Gn((z+y-H)/2,0,y)-y/2]}O=tD({width:p,height:y,scale:R,center:g&&[0,0,g[2]*jl(n)],offset:D,pitch:s,fovy:P,nearZMultiplier:a,farZMultiplier:l}),Number.isFinite(c)&&(O.near=c),Number.isFinite(u)&&(O.far=u)}let k=eD({height:y,pitch:s,bearing:o,scale:R,altitude:S});_&&(k=new un().translate([512*_,0,0]).multiplyLeft(k)),super({...e,width:p,height:y,viewMatrix:k,longitude:r,latitude:n,zoom:i,...O,fovy:P,focalDistance:S}),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=s,this.bearing=o,this.altitude=S,this.fovy=P,this.orthographic=f,this._subViewports=d?[]:null,this._pseudoMeters=m,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const s=i?new xo({...this,worldOffset:i}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*jl(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/jl(r);return[n,r,i]}addMetersToLngLat(e,n){return _1(e,n)}panByPosition(e,n){const r=w_(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),s=S0([],i,Vk([],r)),o=S0([],this.center,s),[a,l]=this.unprojectFlat(o);return{longitude:a,latitude:l}}getBounds(e={}){const n=iD(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:s,latitude:o,zoom:a}=nD({width:r,height:i,bounds:e,...n});return new xo({width:r,height:i,longitude:s,latitude:o,zoom:a})}};xo.displayName="WebMercatorViewport";let Jo=xo;const F0=[0,0,0];function Th(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof Jo){const[i,s,o=0]=t,a=e.getDistanceScales([i,s]);r[2]=o*a.unitsPerMeter[2]}return r}function VD(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return i===te.DEFAULT&&(i=e.isGeospatial?te.LNGLAT:te.CARTESIAN),s===void 0&&(s=i),o===void 0&&(o=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function w1(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:s}){let[o,a,l=0]=t;switch(n&&([o,a,l]=Ea([],[o,a,l,1],n)),r){case te.LNGLAT:return Th([o,a,l],e,s);case te.LNGLAT_OFFSETS:return Th([o+i[0],a+i[1],l+(i[2]||0)],e,s);case te.METER_OFFSETS:return Th(_1(i,[o,a,l]),e,s);case te.CARTESIAN:default:return e.isGeospatial?[o+i[0],a+i[1],l+i[2]]:e.projectPosition([o,a,l])}}function $D(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=VD(e),{autoOffset:l=!0}=e,{geospatialOrigin:c=F0,shaderCoordinateOrigin:u=F0,offsetMode:f=!1}=l?p1(n,r,i):{},h=w1(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:f});if(f){const d=n.projectPosition(c||u);nF(h,h,d)}return h}let jD=1,WD=1;class S1{constructor(){T(this,"time",0);T(this,"channels",new Map);T(this,"animations",new Map);T(this,"playing",!1);T(this,"lastEngineTime",-1)}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:s=1}=e,o=jD++,a={time:0,delay:n,duration:r,rate:i,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:s,channel:o}=i;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=WD++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}let HD=0;const XD={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:t=>console.error(t),stats:ts.stats.get(`animation-loop-${HD++}`),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class YD{constructor(e){T(this,"device",null);T(this,"canvas",null);T(this,"props");T(this,"animationProps",null);T(this,"timeline",null);T(this,"stats");T(this,"cpuTime");T(this,"gpuTime");T(this,"frameRate");T(this,"display");T(this,"needsRedraw","initialized");T(this,"_initialized",!1);T(this,"_running",!1);T(this,"_animationFrameId",null);T(this,"_nextFramePromise",null);T(this,"_resolveNextFrame",null);T(this,"_cpuStartTime",0);if(this.props={...XD,...e},e=this.props,!e.device)throw new Error("No device provided");const{useDevicePixels:n=!0}=this.props;this.stats=e.stats||new Gu({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:n}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const n=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(n),n}}stop(){return this._running&&(this.animationProps&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){var e;return(e=this.device)!=null&&e.isLost?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=FO(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(DO(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),this.device.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){var e,n;if(!this.device)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:(n=(e=this.device)==null?void 0:e.canvasContext)==null?void 0:n.canvas,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){var e;if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=((e=this.device.canvasContext)==null?void 0:e.canvas)||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){var s,o,a,l;if(!this.device)return{width:1,height:1,aspect:1};const[e,n]=((o=(s=this.device)==null?void 0:s.canvasContext)==null?void 0:o.getPixelSize())||[1,1];let r=1;const i=(l=(a=this.device)==null?void 0:a.canvasContext)==null?void 0:l.canvas;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){var e,n;this.props.autoResizeDrawingBuffer&&((n=(e=this.device)==null?void 0:e.canvasContext)==null||n.resize({useDevicePixels:this.props.useDevicePixels}))}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}class D0{constructor(e){T(this,"id");T(this,"userData",{});T(this,"topology");T(this,"bufferLayout",[]);T(this,"vertexCount");T(this,"indices");T(this,"attributes");this.id=e.id||ui("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&ue(this.indices.usage===ge.INDEX)}destroy(){var e;(e=this.indices)==null||e.destroy();for(const n of Object.values(this.attributes))n.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices}_calculateVertexCount(e){return e.byteLength/12}}function KD(t,e){if(e instanceof D0)return e;const n=qD(t,e),{attributes:r,bufferLayout:i}=ZD(t,e);return new D0({topology:e.topology||"triangle-list",bufferLayout:i,vertexCount:e.vertexCount,indices:n,attributes:r})}function qD(t,e){if(!e.indices)return;const n=e.indices.value;return t.createBuffer({usage:ge.INDEX,data:n})}function ZD(t,e){const n=[],r={};for(const[s,o]of Object.entries(e.attributes)){let a=s;switch(s){case"POSITION":a="positions";break;case"NORMAL":a="normals";break;case"TEXCOORD_0":a="texCoords";break;case"COLOR_0":a="colors";break}r[a]=t.createBuffer({data:o.value,id:`${s}-buffer`});const{value:l,size:c,normalized:u}=o;n.push({name:a,format:IO(l,c,u)})}const i=e._calculateVertexCount(e.attributes,e.indices);return{attributes:r,bufferLayout:n,vertexCount:i}}class QD{constructor(e){T(this,"modules");T(this,"moduleUniforms");T(this,"moduleBindings");T(this,"moduleUniformsChanged");const n=tf(Object.values(e).filter(r=>r.dependencies));for(const r of n)e[r.name]=r;U.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[r,i]of Object.entries(e)){const s=r;this.moduleUniforms[s]=i.defaultUniforms||{},this.moduleBindings[s]={}}}destroy(){}setProps(e){var n;for(const r of Object.keys(e)){const i=r,s=e[i],o=this.modules[i];if(!o){U.warn(`Module ${r} not found`)();continue}const a=this.moduleUniforms[i],l=this.moduleBindings[i],c=((n=o.getUniforms)==null?void 0:n.call(o,s,a))||s,{uniforms:u,bindings:f}=m_(c);this.moduleUniforms[i]={...a,...u},this.moduleBindings[i]={...l,...f}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindings(){const e={};for(const n of Object.values(this.moduleBindings))Object.assign(e,n);return e}getDebugTable(){var n;const e={};for(const[r,i]of Object.entries(this.moduleUniforms))for(const[s,o]of Object.entries(i))e[`${r}.${s}`]={type:(n=this.modules[r].uniformTypes)==null?void 0:n[s],value:String(o)};return e}}const uu=class uu{constructor(e){T(this,"device");T(this,"_hashCounter",0);T(this,"_hashes",{});T(this,"_renderPipelineCache",{});T(this,"_computePipelineCache",{});this.device=e}static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new uu(e),e._lumaData.defaultPipelineFactory}createRenderPipeline(e){const n={..._s.defaultProps,...e},r=this._hashRenderPipeline(n);if(!this._renderPipelineCache[r]){const i=this.device.createRenderPipeline({...n,id:n.id?`${n.id}-cached`:void 0});i.hash=r,this._renderPipelineCache[r]={pipeline:i,useCount:0}}return this._renderPipelineCache[r].useCount++,this._renderPipelineCache[r].pipeline}createComputePipeline(e){const n={...kc.defaultProps,...e},r=this._hashComputePipeline(n);if(!this._computePipelineCache[r]){const i=this.device.createComputePipeline({...n,id:n.id?`${n.id}-cached`:void 0});i.hash=r,this._computePipelineCache[r]={pipeline:i,useCount:0}}return this._computePipelineCache[r].useCount++,this._computePipelineCache[r].pipeline}release(e){const n=e.hash,r=e instanceof kc?this._computePipelineCache:this._renderPipelineCache;r[n].useCount--,r[n].useCount===0&&(r[n].pipeline.destroy(),delete r[n])}_hashComputePipeline(e){return`${this._getHash(e.shader.source)}`}_hashRenderPipeline(e){const n=this._getHash(e.vs.source),r=e.fs?this._getHash(e.fs.source):0,i="-",s=this._getHash(JSON.stringify(e.bufferLayout));switch(this.device.type){case"webgl":return`${n}/${r}V${i}BL${s}`;default:const o=this._getHash(JSON.stringify(e.parameters));return`${n}/${r}V${i}T${e.topology}P${o}BL${s}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}};T(uu,"defaultProps",{..._s.defaultProps});let hp=uu;const fu=class fu{constructor(e){T(this,"device");T(this,"_cache",{});this.device=e}static getDefaultShaderFactory(e){var n;return(n=e._lumaData).defaultShaderFactory||(n.defaultShaderFactory=new fu(e)),e._lumaData.defaultShaderFactory}createShader(e){const n=this._hashShader(e);let r=this._cache[n];if(!r){const i=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[n]=r={shader:i,useCount:0}}return r.useCount++,r.shader}release(e){const n=this._hashShader(e),r=this._cache[n];r&&(r.useCount--,r.useCount===0&&(delete this._cache[n],r.shader.destroy()))}_hashShader(e){return`${e.stage}:${e.source}`}};T(fu,"defaultProps",{...Mc.defaultProps});let dp=fu;function JD(t,e){var i;const n={},r="Values";if(t.attributes.length===0&&!((i=t.varyings)!=null&&i.length))return{"No attributes or varyings":{[r]:"N/A"}};for(const s of t.attributes)if(s){const o=`${s.location} ${s.name}: ${s.type}`;n[`in ${o}`]={[r]:s.stepMode||"vertex"}}for(const s of t.varyings||[]){const o=`${s.location} ${s.name}`;n[`out ${o}`]={[r]:JSON.stringify(s.accessor)}}return n}let ke=null,wh=null;function GD(t,{id:e,minimap:n,opaque:r,top:i="0",left:s="0",rgbaScale:o=1}){ke||(ke=document.createElement("canvas"),ke.id=e,ke.title=e,ke.style.zIndex="100",ke.style.position="absolute",ke.style.top=i,ke.style.left=s,ke.style.border="blue 1px solid",ke.style.transform="scaleY(-1)",document.body.appendChild(ke),wh=ke.getContext("2d")),(ke.width!==t.width||ke.height!==t.height)&&(ke.width=t.width/2,ke.height=t.height/2,ke.style.width="400px",ke.style.height="400px");const a=t.device.readPixelsToArrayWebGL(t),l=wh.createImageData(t.width,t.height),c=0;for(let u=0;u<a.length;u+=4)l.data[c+u+0]=a[u+0]*o,l.data[c+u+1]=a[u+1]*o,l.data[c+u+2]=a[u+2]*o,l.data[c+u+3]=r?255:a[u+3]*o;wh.putImageData(l,0,0)}const Ai=2,e4=1e4,hu=class hu{constructor(e,n){T(this,"device");T(this,"id");T(this,"source");T(this,"vs");T(this,"fs");T(this,"pipelineFactory");T(this,"shaderFactory");T(this,"userData",{});T(this,"parameters");T(this,"topology");T(this,"bufferLayout");T(this,"isInstanced");T(this,"instanceCount",0);T(this,"vertexCount");T(this,"indexBuffer",null);T(this,"bufferAttributes",{});T(this,"constantAttributes",{});T(this,"bindings",{});T(this,"uniforms",{});T(this,"vertexArray");T(this,"transformFeedback",null);T(this,"pipeline");T(this,"shaderInputs");T(this,"_uniformStore");T(this,"_attributeInfos",{});T(this,"_gpuGeometry",null);T(this,"_getModuleUniforms");T(this,"props");T(this,"_pipelineNeedsUpdate","newly created");T(this,"_needsRedraw","initializing");T(this,"_destroyed",!1);T(this,"_lastDrawTimestamp",-1);T(this,"_lastLogTime",0);T(this,"_logOpen",!1);T(this,"_drawCount",0);var a,l,c,u;this.props={...hu.defaultProps,...n},n=this.props,this.id=n.id||ui("model"),this.device=e,Object.assign(this.userData,n.userData);const r=Object.fromEntries(((a=this.props.modules)==null?void 0:a.map(f=>[f.name,f]))||[]);this.setShaderInputs(n.shaderInputs||new QD(r));const i=t4(e),s=(((l=this.props.modules)==null?void 0:l.length)>0?this.props.modules:(c=this.shaderInputs)==null?void 0:c.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){(u=this.props).shaderLayout||(u.shaderLayout=vk(this.props.source));const{source:f,getUniforms:h}=this.props.shaderAssembler.assembleShader({platformInfo:i,...this.props,modules:s});this.source=f,this._getModuleUniforms=h}else{const{vs:f,fs:h,getUniforms:d}=this.props.shaderAssembler.assembleShaderPair({platformInfo:i,...this.props,modules:s});this.vs=f,this.fs=h,this._getModuleUniforms=d}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,n.geometry&&this.setGeometry(n.geometry),this.pipelineFactory=n.pipelineFactory||hp.getDefaultPipelineFactory(this.device),this.shaderFactory=n.shaderFactory||dp.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in n&&(this.isInstanced=n.isInstanced),n.instanceCount&&this.setInstanceCount(n.instanceCount),n.vertexCount&&this.setVertexCount(n.vertexCount),n.indexBuffer&&this.setIndexBuffer(n.indexBuffer),n.attributes&&this.setAttributes(n.attributes),n.constantAttributes&&this.setConstantAttributes(n.constantAttributes),n.bindings&&this.setBindings(n.bindings),n.uniforms&&this.setUniforms(n.uniforms),n.moduleSettings&&this.updateModuleSettings(n.moduleSettings),n.transformFeedback&&(this.transformFeedback=n.transformFeedback),Object.seal(this)}destroy(){var e;this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),(e=this._gpuGeometry)==null||e.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||(this._needsRedraw=e)}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){this.predraw();let n;try{this._logDrawCallStart(),this.pipeline=this._updatePipeline(),this.pipeline.setBindings(this.bindings,{disableWarnings:this.props.disableWarnings}),Pc(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:r}=this.vertexArray,i=r?r.byteLength/(r.indexType==="uint32"?4:2):void 0;n=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:i,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{this._logDrawCallEnd()}return this._logFramebuffer(e),n?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",n}setGeometry(e){var r;(r=this._gpuGeometry)==null||r.destroy();const n=e&&KD(this.device,e);n&&(this.setTopology(n.topology||"triangle-list"),this.bufferLayout=B0(n.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(n)),this._gpuGeometry=n}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){this.bufferLayout=this._gpuGeometry?B0(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){np(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new PO(this.shaderInputs.modules);for(const n of Object.keys(this.shaderInputs.modules)){const r=this._uniformStore.getManagedUniformBuffer(this.device,n);this.bindings[`${n}Uniforms`]=r}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindings()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,n){e.indices&&U.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)();for(const[r,i]of Object.entries(e)){const s=this.bufferLayout.find(l=>L0(l).includes(r));if(!s){U.warn(`Model(${this.id}): Missing layout for buffer "${r}".`)();continue}const o=L0(s);let a=!1;for(const l of o){const c=this._attributeInfos[l];c&&(this.vertexArray.setBuffer(c.location,i),a=!0)}!a&&!((n==null?void 0:n.disableWarnings)??this.props.disableWarnings)&&U.warn(`Model(${this.id}): Ignoring buffer "${i.id}" for unknown attribute "${r}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,n){for(const[r,i]of Object.entries(e)){const s=this._attributeInfos[r];s?this.vertexArray.setConstantWebGL(s.location,i):((n==null?void 0:n.disableWarnings)??this.props.disableWarnings)||U.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${r}"`)()}this.setNeedsRedraw("constants")}setUniforms(e){Pc(e)||(this.pipeline.setUniformsWebGL(e),Object.assign(this.uniforms,e)),this.setNeedsRedraw("uniforms")}updateModuleSettings(e){const{bindings:n,uniforms:r}=m_(this._getModuleUniforms(e));Object.assign(this.bindings,n),Object.assign(this.uniforms,r),this.setNeedsRedraw("moduleSettings")}_getBindingsUpdateTimestamp(){let e=0;for(const n of Object.values(this.bindings))n instanceof Ic?e=Math.max(e,n.texture.updateTimestamp):n instanceof ge||n instanceof bt?e=Math.max(e,n.updateTimestamp):n instanceof Nc||(e=Math.max(e,n.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const n={...e.attributes};for(const[r]of Object.entries(n))!this.pipeline.shaderLayout.attributes.find(i=>i.name===r)&&r!=="positions"&&delete n[r];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(n,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||(this._pipelineNeedsUpdate=e),this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,n=null;this.pipeline&&(U.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,n=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const r=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debug:this.props.debugShaders});let i=null;this.source?i=r:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debug:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,vs:r,fs:i}),this._attributeInfos=WE(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),n&&this.shaderFactory.release(n)}return this.pipeline}_logDrawCallStart(){const e=U.level>3?0:e4;U.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,U.group(Ai,`>>> DRAWING MODEL ${this.id}`,{collapsed:U.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=JD(this.pipeline.shaderLayout,this.id);U.table(Ai,e)();const n=this.shaderInputs.getDebugTable();for(const[i,s]of Object.entries(this.uniforms))n[i]={value:s};U.table(Ai,n)();const r=this._getAttributeDebugTable();U.table(Ai,this._attributeInfos)(),U.table(Ai,r)(),U.groupEnd(Ai)(),this._logOpen=!1}}_logFramebuffer(e){const n=U.get("framebuffer");if(this._drawCount++,!n||this._drawCount++>3&&this._drawCount%60)return;const r=e.props.framebuffer;r&&GD(r,{id:r.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[n,r]of Object.entries(this._attributeInfos))e[r.location]={name:n,type:r.shaderType,values:this._getBufferOrConstantValues(this.vertexArray.attributes[r.location],r.bufferDataType)};if(this.vertexArray.indexBuffer){const{indexBuffer:n}=this.vertexArray,r=n.indexType==="uint32"?new Uint32Array(n.debugData):new Uint16Array(n.debugData);e.indices={name:"indices",type:n.indexType,values:r.toString()}}return e}_getBufferOrConstantValues(e,n){const r=YE(n);return(e instanceof ge?new r(e.debugData):e).toString()}};T(hu,"defaultProps",{..._s.defaultProps,source:null,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:Cc.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0});let $t=hu;function B0(t,e){const n=[...t];for(const r of e){const i=n.findIndex(s=>s.name===r.name);i<0?n.push(r):n[i]=r}return n}function t4(t){return{type:t.type,shaderLanguage:t.info.shadingLanguage,shaderLanguageVersion:t.info.shadingLanguageVersion,gpu:t.info.gpu,features:t.features}}function L0(t){var e;return t.attributes?(e=t.attributes)==null?void 0:e.map(n=>n.attribute):[t.name]}class Go{constructor(e,n=$t.defaultProps){T(this,"device");T(this,"model");T(this,"transformFeedback");ue(Go.isSupported(e),"BufferTransform not yet implemented on WebGPU"),this.device=e,this.model=new $t(this.device,{id:n.id||"buffer-transform-model",fs:n.fs||MN(),topology:n.topology||"point-list",...n}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:n.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}static isSupported(e){var n;return((n=e==null?void 0:e.info)==null?void 0:n.type)==="webgl"}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){const n=this.device.beginRenderPass(e);this.model.draw(n),n.end()}update(...e){console.warn("TextureTransform#update() not implemented")}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const n=this.getBuffer(e);if(n instanceof ge)return n.readAsync();const{buffer:r,byteOffset:i=0,byteLength:s=r.byteLength}=n;return r.readAsync(i,s)}}class Es{constructor(e){T(this,"id");T(this,"topology");T(this,"vertexCount");T(this,"indices");T(this,"attributes");T(this,"userData",{});const{attributes:n={},indices:r=null,vertexCount:i=null}=e;this.id=e.id||ui("geometry"),this.topology=e.topology,r&&(this.indices=ArrayBuffer.isView(r)?{value:r,size:1}:r),this.attributes={};for(const[s,o]of Object.entries(n)){const a=ArrayBuffer.isView(o)?{value:o}:o;ue(ArrayBuffer.isView(a.value),`${this._print(s)}: must be typed array or object with value as typed array`),(s==="POSITION"||s==="positions")&&!a.size&&(a.size=3),s==="indices"?(ue(!this.indices),this.indices=a):this.attributes[s]=a}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=i||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,n){return this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i of Object.values(e)){const{value:s,size:o,constant:a}=i;!a&&s&&o>=1&&(r=Math.min(r,s.length/o))}return ue(Number.isFinite(r)),r}}const n4={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class E1 extends S_{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:l,width:c,height:u},cullRect:f,effects:h,pass:d="picking",pickZ:_,moduleParameters:g}){this.pickZ=_;const b=this._resetColorEncoder(_),m=[a,l,c,u],p=super.render({target:o,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:s,cullRect:f,effects:h==null?void 0:h.filter(S=>S.useInPicking),pass:d,isPicking:!0,moduleParameters:g,clearColor:[0,0,0,0],colorMask:15,scissorRect:m});return this._colorEncoderState=null,{decodePickingColor:b&&i4.bind(null,b),stats:p}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{picking:{isActive:1,isAttribute:this.pickZ},lightSources:{}}}getLayerParameters(e,n,r){const i={depthMask:!0,depthTest:!0,depthRange:[0,1],...e.props.parameters},{pickable:s,operation:o}=e.props;return!this._colorEncoderState||o.includes("terrain")?i.blend=!1:s&&o.includes("draw")&&(Object.assign(i,n4),i.blend=!0,i.blendColor=r4(this._colorEncoderState,e,r)),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function r4(t,e,n){const{byLayer:r,byAlpha:i}=t;let s,o=r.get(e);return o?(o.viewports.push(n),s=o.a):(s=r.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},r.set(e,o),i[s]=o):(J.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function i4(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const xi={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},$c=Symbol.for("component"),fr=Symbol.for("propTypes"),Sh=Symbol.for("deprecatedProps"),is=Symbol.for("asyncPropDefaults"),ti=Symbol.for("asyncPropOriginal"),er=Symbol.for("asyncPropResolved");function bs(t,e=()=>!0){return Array.isArray(t)?b1(t,e,[]):e(t)?[t]:[]}function b1(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?b1(i,e,n):e(i)&&n.push(i)}return n}function s4({target:t,source:e,start:n=0,count:r=1}){const i=e.length,s=r*i;let o=0;for(let a=n;o<i;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}class o4{constructor(e,n,r){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=Rc(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===r&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class a4{constructor(e){var n;this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:(n=e.device)==null?void 0:n.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let s=this._resources[e];s?s.setData(n,r):(s=new o4(e,n,this._context),this._resources[e]=s),s.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],s=this._resources[i.resourceId];s&&s.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(r,i,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const s=this._consumers,o=s[e]=s[e]||{};let a=o[n];const l=a&&a.resourceId&&this._resources[a.resourceId];l&&(l.unsubscribe(a),this.prune()),r&&(a?(a.onChange=i,a.resourceId=r.id):a={onChange:i,resourceId:r.id},o[n]=a,r.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const l4="layerManager.setLayers",c4="layerManager.activateViewport";class u4{constructor(e,n){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=a=>{Ke(c4,this,a),a&&(this.context.viewport=a)};const{deck:r,stats:i,viewport:s,timeline:o}=n||{};this.layers=[],this.resourceManager=new a4({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e==null?void 0:e.gl,deck:r,shaderAssembler:yD(),defaultShaderModules:[],renderPass:void 0,stats:i||new Gu({id:"deck.gl"}),viewport:s||new Vc({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new S1,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){Ke(l4,this,n,e),this._lastRenderedLayers=e;const r=bs(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:n}=this.context;n.find(r=>r.name===e.name)||(n.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:n}=this.context,r=n.findIndex(i=>i.name===e.name);r>=0&&(n.splice(r,1),this._defaultShaderModulesChanged=!0)}_handleError(e,n,r){r.raiseError(n,`${e} of ${r}`)}_updateLayers(e,n){const r={};for(const o of e)r[o.id]?J.warn(`Multiple old layers with same id ${o.id}`)():r[o.id]=o;if(this._defaultShaderModulesChanged){for(const o of e)o.setNeedsUpdate(),o.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let s=!1;for(const o of i)if(o.hasUniformTransition()){s=`Uniform transition in ${o}`;break}this._needsUpdate=s,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const s=n[i.id];s===null&&J.warn(`Multiple new layers with same id ${i.id}`)(),n[i.id]=null;let o=null;try{this._debug&&s!==i&&i.validateProps(),s?(this._transferLayerState(s,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),o=i.isComposite?i.getSubLayers():null}catch(a){this._handleError("matching",a,i)}o&&this._updateSublayersRecursively(o,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=xi.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=xi.MATCHED,n!==e&&(e.lifecycle=xi.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=xi.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=xi.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function Bt(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Bt(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const s of r)if(!e.hasOwnProperty(s)||!Bt(t[s],e[s],n-1))return!1;return!0}return!1}class f4{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let s=r.length-1;s>=0;--s){const o=r[s];if(o.containsPixel(i)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=bs(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Bt(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):J.warn("missing `viewState` or `initialViewState`")()}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>{var o;return(o=this.getView(e.id))==null?void 0:o.makeViewport({viewState:s,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const s=e.controller;if(s&&r){const o={...n,...s,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==s.type)&&(i=this._createController(e,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const s=e[i],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let l=n[s.id];const c=!!s.controller;c&&!l&&(r=!0),(r||!c)&&l&&(l.finalize(),l=null),this.controllers[s.id]=this._updateController(s,o,a,l),a&&this._viewports.unshift(a)}for(const i in n){const s=n[i];s&&!this.controllers[i]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const h4=/([0-9]+\.?[0-9]*)(%|px)/;function Vn(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=h4.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error(`Could not parse position string ${t}`)}}function $n(t,e){return t.relative?Math.round(t.position*e):t.position}class d4{constructor(e){const{id:n,x:r=0,y:i=0,width:s="100%",height:o="100%",padding:a=null}=e;this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Vn(r),this._y=Vn(i),this._width=Vn(s),this._height=Vn(o),this._padding=a&&{left:Vn(a.left||0),right:Vn(a.right||0),top:Vn(a.top||0),bottom:Vn(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.ViewportType===e.ViewportType&&Bt(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:$n(this._x,e),y:$n(this._y,n),width:$n(this._width,e),height:$n(this._height,n)};return this._padding&&(r.padding={left:$n(this._padding.left,e),top:$n(this._padding.top,n),right:$n(this._padding.right,e),bottom:$n(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class rf{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(r=(n=this.settings).onStart)==null||r.call(n,this)}end(){var e,n;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(n=(e=this.settings).onEnd)==null||n.call(e,this))}cancel(){var e,n;this._inProgress&&((n=(e=this.settings).onInterrupt)==null||n.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(n=(e=this.settings).onUpdate)==null||n.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const U0=()=>{},pp={BREAK:1,SNAP_TO_END:2,IGNORE:3},p4=t=>t,g4=pp.BREAK;class _4{constructor(e){this._onTransitionUpdate=n=>{const{time:r,settings:{interpolator:i,startProps:s,endProps:o,duration:a,easing:l}}=n,c=l(r/a),u=i.interpolateProps(s,o,c);this.propsInTransition=this.getControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new rf(e.timeline),this.onViewStateChange=e.onViewStateChange||U0,this.onStateChange=e.onStateChange||U0}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;i={...r,...s===pp.SNAP_TO_END?o:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===pp.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=s.initializeProps(e,i);this.propsInTransition={};const l={duration:o,easing:n.transitionEasing||p4,interpolator:s,interruption:n.transitionInterruption||g4,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(l),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}function Ce(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class m4{constructor(e){const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!Zo(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const s of this._propsToExtract)(s in e||s in n)&&(r[s]=e[s],i[s]=n[s]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];Ce(Number.isFinite(r)||Array.isArray(r),`${n} is required for transition`)})}}const y4=["longitude","latitude","zoom","bearing","pitch"],v4=["longitude","latitude","zoom"];class A1 extends m4{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:y4,required:v4},super(r.transitionProps),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:s}=this.opts;if(i&&s){const o=i(e),a=i(n),l=o.unproject(s);r.start.around=s,Object.assign(r.end,{around:a.project(l),aroundPosition:l,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const s of this._propsToExtract)i[s]=Bc(e[s]||0,n[s]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...i});Object.assign(i,s.panByPosition(n.aroundPosition,Bc(e.around,n.around,r)))}return i}}const jn={transitionDuration:0},T4=300,gl=t=>1-(1-t)*(1-t),Ri={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Mr={};class w4{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new _4({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){var e;for(const n in this._events)this._events[n]&&((e=this.eventManager)==null||e.off(n,this.handleEvent));this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?T4:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:l=!1,keyboard:c=!0}=e,u=!!this.onViewStateChange;this.toggleEvents(Ri.WHEEL,u&&r),this.toggleEvents(Ri.PAN,u),this.toggleEvents(Ri.PINCH,u&&(a||l)),this.toggleEvents(Ri.TRIPLE_PAN,u&&l),this.toggleEvents(Ri.DOUBLE_TAP,u&&o),this.toggleEvents(Ri.KEYBOARD,u&&c),this.scrollZoom=r,this.dragPan=i,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=l,this.keyboard=c}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:o,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,jn,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,jn,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:gl},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,jn,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:gl},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*r)));s<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,jn,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,jn,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:i});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:gl},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Mr._startPinchRotation=e.rotation,Mr._lastPinchEvent=e,this.updateViewport(r,jn,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:Mr._startPinchRotation-r})}return this.updateViewport(n,jn,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Mr._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=Mr;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),l=Math.pow(2,o+a*n/2);s=s.zoom({pos:i,scale:l}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:gl},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Mr._startPinchRotation=null,Mr._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let l;const c={};switch(e.srcEvent.code){case"Minus":l=n?a.zoomOut(r).zoomOut(r):a.zoomOut(r),c.isZooming=!0;break;case"Equal":l=n?a.zoomIn(r).zoomIn(r):a.zoomIn(r),c.isZooming=!0;break;case"ArrowLeft":n?(l=a.rotateLeft(s),c.isRotating=!0):(l=a.moveLeft(i),c.isPanning=!0);break;case"ArrowRight":n?(l=a.rotateRight(s),c.isRotating=!0):(l=a.moveRight(i),c.isPanning=!0);break;case"ArrowUp":n?(l=a.rotateUp(o),c.isRotating=!0):(l=a.moveUp(i),c.isPanning=!0);break;case"ArrowDown":n?(l=a.rotateDown(o),c.isRotating=!0):(l=a.moveDown(i),c.isPanning=!0);break;default:return!1}return this.updateViewport(l,this._getTransitionProps(),c),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?jn:e?{...n,transitionInterpolator:new A1({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class S4{constructor(e,n){this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const z0=5,E4=1.2;class b4 extends S4{constructor(e){const{width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a=0,pitch:l=0,altitude:c=1.5,position:u=[0,0,0],maxZoom:f=20,minZoom:h=0,maxPitch:d=60,minPitch:_=0,startPanLngLat:g,startZoomLngLat:b,startRotatePos:m,startBearing:p,startPitch:y,startZoom:S,normalize:R=!0}=e;Ce(Number.isFinite(s)),Ce(Number.isFinite(i)),Ce(Number.isFinite(o)),super({width:n,height:r,latitude:i,longitude:s,zoom:o,bearing:a,pitch:l,altitude:c,maxZoom:f,minZoom:h,maxPitch:d,minPitch:_,normalize:R,position:u},{startPanLngLat:g,startZoomLngLat:b,startRotatePos:m,startBearing:p,startPitch:y,startZoom:S}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:s,startPitch:o}=this.getState();if(!i||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,i,o,s):a={bearing:s+n,pitch:o+r},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:s}=this.getState();if(s||(i=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let l=i+Math.log2(r);l=Gn(l,a,o);const c=this.makeViewport({...this.getViewportProps(),zoom:l});return this._getUpdatedState({zoom:l,...c.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:s}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(s-n.longitude)>180&&(r.longitude=s<0?s+360:s-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=Gn(i,r,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=Gn(a,o,s);const{normalize:l=!0}=e;return l&&Object.assign(e,sD(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],l=n[1],{width:c,height:u}=this.getViewportProps(),f=s/c;let h=0;o>0?Math.abs(u-l)>z0&&(h=o/(l-u)*E4):o<0&&l>z0&&(h=1-a/l),h=Gn(h,-1,1);const{minPitch:d,maxPitch:_}=this.getViewportProps(),g=i+180*f;let b=r;return h>0?b=r+h*(_-r):h<0&&(b=r-h*(d-r)),{pitch:b,bearing:g}}}class A4 extends w4{constructor(){super(...arguments),this.ControllerState=b4,this.transition={transitionDuration:300,transitionInterpolator:new A1({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}const M_=class M_ extends d4{constructor(e={}){super(e)}get ViewportType(){return Jo}get ControllerType(){return A4}};M_.displayName="MapView";let jc=M_;const R4=new T1;function x4(t,e){const n=t.order??1/0,r=e.order??1/0;return n-r}class C4{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>x4(i,e)>0);r<0?n.push(e):n.splice(r,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Bt(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const s=n[i.id];let o=i;s&&s!==i?s.setProps?(s.setProps(i.props),o=s):s.cleanup(this._context):s||i.setup(this._context),r.push(o),delete n[i.id]}for(const i in n)n[i].cleanup(this._context);this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof T1)||this._resolvedEffects.push(R4),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class P4 extends S_{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const I4="deckRenderer.renderLayers";class M4{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new P4(e),this.pickLayersPass=new E1(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target;this.lastPostProcessEffect&&(r.clearColor=[0,0,0,0],r.clearCanvas=!0);const s=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,Ke(I4,this,s,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,n=this.device.canvasContext.getDrawingBufferSize();e.length===0&&[0,1].map(r=>{const i=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${r}`,colorAttachments:[i]}))});for(const r of e)r.resize(n)}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1]};for(const s of e)if(s.postRender){i.target=s.id===this.lastPostProcessEffect?n.target:void 0;const o=s.postRender(i);i.inputBuffer=o,i.swapBuffer=o===r[0]?r[1]:r[0]}}}const N4={pickedColor:null,pickedObjectIndex:-1};function O4({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:s}){const{x:o,y:a,width:l,height:c}=s;let u=i*i,f=-1,h=0;for(let d=0;d<c;d++){const _=d+a-r,g=_*_;if(g>u)h+=4*l;else for(let b=0;b<l;b++){if(t[h+3]-1>=0){const p=b+o-n,y=p*p+g;y<=u&&(u=y,f=h)}h+=4}}if(f>=0){const d=t.slice(f,f+4),_=e(d);if(_){const g=Math.floor(f/4/l),b=f/4-g*l;return{..._,pickedColor:d,pickedX:o+b,pickedY:a+g}}J.error("Picked non-existent layer. Is picking buffer corrupt?")()}return N4}function k4({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const s=t.slice(r,r+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):J.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function R1({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:s}){let o=e[0];e.length>1&&(o=D4((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let a;if(o){const l=[r-o.x,i-o.y];s!==void 0&&(l[2]=s),a=o.unproject(l)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function F4(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,l=o?[o]:[];if(r==="hover"){const f=n.index,h=n.layerId,d=o?o.props.id:null;if(d!==h||a!==f){if(d!==h){const _=i.find(g=>g.props.id===h);_&&l.unshift(_)}n.layerId=d,n.index=a,n.info=null}}const c=R1(t),u=new Map;return u.set(null,c),l.forEach(f=>{let h={...c};f===o&&(h.color=s,h.index=a,h.picked=!0),h=x1({layer:f,info:h,mode:r});const d=h.layer;f===o&&r==="hover"&&(n.info=h),u.set(d.id,h),r==="hover"&&d.updateAutoHighlight(h)}),u}function x1({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function D4(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class B4{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new E1(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,l=o?r.find(h=>h.id===o):null,c=a&&i.find(h=>h.id===a)||i[0],u=c&&c.unproject([e-c.x,n-c.y]);return{...s,...{x:e,y:n,viewport:c,coordinate:u,layer:l}}}_resizeBuffer(){var n,r;if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const i=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=i}const{canvas:e}=this.device.getCanvasContext();(n=this.pickingFBO)==null||n.resize({width:e.width,height:e.height}),(r=this.depthFBO)==null||r.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:s,radius:o=0,depth:a=1,mode:l="query",unproject3D:c,onViewportActive:u,effects:f}){const h=this.device.canvasContext.cssToDeviceRatio(),d=this._getPickable(e);if(!d||r.length===0)return{result:[],emptyInfo:R1({viewports:r,x:i,y:s,pixelRatio:h})};this._resizeBuffer();const _=this.device.canvasContext.cssToDevicePixels([i,s],!0),g=[_.x+Math.floor(_.width/2),_.y+Math.floor(_.height/2)],b=Math.round(o*h),{width:m,height:p}=this.pickingFBO,y=this._getPickingRect({deviceX:g[0],deviceY:g[1],deviceRadius:b,deviceWidth:m,deviceHeight:p}),S={x:i-o,y:s-o,width:o*2+1,height:o*2+1};let R;const P=[],O=new Set;for(let k=0;k<a;k++){let D;if(y){const H=this._drawAndSample({layers:d,views:n,viewports:r,onViewportActive:u,deviceRect:y,cullRect:S,effects:f,pass:`picking:${l}`});D=O4({...H,deviceX:g[0],deviceY:g[1],deviceRadius:b,deviceRect:y})}else D={pickedColor:null,pickedObjectIndex:-1};let z;if(D.pickedLayer&&c&&this.depthFBO){const{pickedColors:H}=this._drawAndSample({layers:[D.pickedLayer],views:n,viewports:r,onViewportActive:u,deviceRect:{x:D.pickedX,y:D.pickedY,width:1,height:1},cullRect:S,effects:f,pass:`picking:${l}:z`},!0);H[3]&&(z=H[0])}D.pickedLayer&&k+1<a&&(O.add(D.pickedLayer),D.pickedLayer.disablePickingIndex(D.pickedObjectIndex)),R=F4({pickInfo:D,lastPickedInfo:this.lastPickedInfo,mode:l,layers:d,viewports:r,x:i,y:s,z,pixelRatio:h});for(const H of R.values())H.layer&&P.push(H);if(!D.pickedColor)break}for(const k of O)k.restorePickingColors();return{result:P,emptyInfo:R.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:s,width:o=1,height:a=1,mode:l="query",maxObjects:c=null,onViewportActive:u,effects:f}){const h=this._getPickable(e);if(!h||r.length===0)return[];this._resizeBuffer();const d=this.device.canvasContext.cssToDeviceRatio(),_=this.device.canvasContext.cssToDevicePixels([i,s],!0),g=_.x,b=_.y+_.height,m=this.device.canvasContext.cssToDevicePixels([i+o,s+a],!0),p=m.x+m.width,y=m.y,S={x:g,y,width:p-g,height:b-y},R=this._drawAndSample({layers:h,views:n,viewports:r,onViewportActive:u,deviceRect:S,cullRect:{x:i,y:s,width:o,height:a},effects:f,pass:`picking:${l}`}),P=k4(R),O=new Map,k=[],D=Number.isFinite(c);for(let z=0;z<P.length&&!(D&&k.length>=c);z++){const H=P[z];let X={color:H.pickedColor,layer:null,index:H.pickedObjectIndex,picked:!0,x:i,y:s,pixelRatio:d};X=x1({layer:H.pickedLayer,info:X,mode:l});const Y=X.layer.id;O.has(Y)||O.set(Y,new Set);const Z=O.get(Y),je=X.object??X.index;Z.has(je)||(Z.add(je),k.push(X))}return k}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:s,cullRect:o,effects:a,pass:l},c=!1){const u=c?this.depthFBO:this.pickingFBO,f={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:u,deviceRect:s,cullRect:o,effects:a,pass:l,pickZ:c,preRenderStats:{}};for(const p of a)p.useInPicking&&(f.preRenderStats[p.id]=p.preRender(f));const{decodePickingColor:h}=this.pickLayersPass.render(f),{x:d,y:_,width:g,height:b}=s,m=new(c?Float32Array:Uint8Array)(g*b*4);return this.device.readPixelsToArrayWebGL(u,{sourceX:d,sourceY:_,sourceWidth:g,sourceHeight:b,target:m}),{pickedColors:m,decodePickingColor:h}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:s}){const o=Math.max(0,e-r),a=Math.max(0,n-r),l=Math.min(i,e+r+1)-o,c=Math.min(s,n+r+1)-a;return l<=0||c<=0?null:{x:o,y:a,width:l,height:c}}}const L4={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},U4="top-left",V0="__root";class z4{constructor({deck:e,parentElement:n}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,this.parentElement=n}getWidgets(){return this.resolvedWidgets}setProps(e){e.widgets&&!Bt(e.widgets,this.widgets,1)&&this._setWidgets(e.widgets)}finalize(){for(const e of this.getWidgets())this._remove(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(n=>n.id===e.id)||(this._add(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}_setWidgets(e){const n={};for(const r of this.resolvedWidgets)n[r.id]=r;this.resolvedWidgets.length=0;for(const r of this.defaultWidgets)n[r.id]=null,this.resolvedWidgets.push(r);for(let r of e){const i=n[r.id];i?i.viewId!==r.viewId||i.placement!==r.placement?(this._remove(i),this._add(r)):r!==i&&(i.setProps(r.props),r=i):this._add(r),n[r.id]=null,this.resolvedWidgets.push(r)}for(const r in n){const i=n[r];i&&this._remove(i)}this.widgets=e}_add(e){const{viewId:n=null,placement:r=U4}=e,i=e.onAdd({deck:this.deck,viewId:n});i&&this._getContainer(n,r).append(i),e._element=i}_remove(e){e.onRemove(),e._element&&e._element.remove(),e._element=void 0}_getContainer(e,n){var o;const r=e||V0;let i=this.containers[r];i||(i=document.createElement("div"),i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",(o=this.parentElement)==null||o.append(i),this.containers[r]=i);let s=i.querySelector(`.${n}`);return s||(s=document.createElement("div"),s.className=n,s.style.position="absolute",s.style.zIndex="2",Object.assign(s.style,L4[n]),i.append(s)),s}_updateContainers(){const e=this.deck.width,n=this.deck.height;for(const r in this.containers){const i=this.lastViewports[r]||null,s=r===V0||i,o=this.containers[r];s?(o.style.display="block",o.style.left=`${i?i.x:0}px`,o.style.top=`${i?i.y:0}px`,o.style.width=`${i?i.width:e}px`,o.style.height=`${i?i.height:n}px`):o.style.display="none"}}onRedraw({viewports:e,layers:n}){var s,o;const r=e.reduce((a,l)=>(a[l.id]=l,a),{}),{lastViewports:i}=this;for(const a of this.getWidgets()){const{viewId:l}=a;if(l){const c=r[l];c&&(a.onViewportChange&&!c.equals(i[l])&&a.onViewportChange(c),(s=a.onRedraw)==null||s.call(a,{viewports:[c],layers:n}))}else{if(a.onViewportChange)for(const c of e)c.equals(i[c.id])||a.onViewportChange(c);(o=a.onRedraw)==null||o.call(a,{viewports:e,layers:n})}}this.lastViewports=r,this._updateContainers()}onHover(e,n){var r,i;for(const s of this.getWidgets()){const{viewId:o}=s;(!o||o===((r=e.viewport)==null?void 0:r.id))&&((i=s.onHover)==null||i.call(s,e,n))}}onEvent(e,n){var i,s;const r=lp[n.type];if(r)for(const o of this.getWidgets()){const{viewId:a}=o;(!a||a===((i=e.viewport)==null?void 0:i.id))&&((s=o[r.handler])==null||s.call(o,e,n))}}}const V4={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class $4{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:e}){const n=document.createElement("div");return n.className="deck-tooltip",Object.assign(n.style,V4),this.deck=e,this.element=n,n}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(e){var n;this.isVisible&&e.id===((n=this.lastViewport)==null?void 0:n.id)&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:n}=this,r=n&&n.props.getTooltip;if(!r)return;const i=r(e);this.lastViewport=e.viewport,this.setTooltip(i,e.x,e.y)}setTooltip(e,n,r){const i=this.element;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform=`translate(${n}px, ${r}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}}var Vi;(function(t){t[t.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",t[t.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",t[t.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN",t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",t[t.FUNC_ADD=32774]="FUNC_ADD",t[t.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",t[t.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",t[t.BLEND_EQUATION=32777]="BLEND_EQUATION",t[t.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",t[t.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",t[t.BLEND_DST_RGB=32968]="BLEND_DST_RGB",t[t.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",t[t.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",t[t.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",t[t.BLEND_COLOR=32773]="BLEND_COLOR",t[t.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",t[t.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",t[t.LINE_WIDTH=2849]="LINE_WIDTH",t[t.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",t[t.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",t[t.CULL_FACE_MODE=2885]="CULL_FACE_MODE",t[t.FRONT_FACE=2886]="FRONT_FACE",t[t.DEPTH_RANGE=2928]="DEPTH_RANGE",t[t.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",t[t.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",t[t.DEPTH_FUNC=2932]="DEPTH_FUNC",t[t.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",t[t.STENCIL_FUNC=2962]="STENCIL_FUNC",t[t.STENCIL_FAIL=2964]="STENCIL_FAIL",t[t.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",t[t.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",t[t.STENCIL_REF=2967]="STENCIL_REF",t[t.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",t[t.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",t[t.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",t[t.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",t[t.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",t[t.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",t[t.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",t[t.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",t[t.VIEWPORT=2978]="VIEWPORT",t[t.SCISSOR_BOX=3088]="SCISSOR_BOX",t[t.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",t[t.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",t[t.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",t[t.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",t[t.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",t[t.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",t[t.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",t[t.RED_BITS=3410]="RED_BITS",t[t.GREEN_BITS=3411]="GREEN_BITS",t[t.BLUE_BITS=3412]="BLUE_BITS",t[t.ALPHA_BITS=3413]="ALPHA_BITS",t[t.DEPTH_BITS=3414]="DEPTH_BITS",t[t.STENCIL_BITS=3415]="STENCIL_BITS",t[t.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",t[t.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",t[t.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",t[t.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",t[t.SAMPLES=32937]="SAMPLES",t[t.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",t[t.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",t[t.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",t[t.VENDOR=7936]="VENDOR",t[t.RENDERER=7937]="RENDERER",t[t.VERSION=7938]="VERSION",t[t.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",t[t.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",t[t.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.BUFFER_SIZE=34660]="BUFFER_SIZE",t[t.BUFFER_USAGE=34661]="BUFFER_USAGE",t[t.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",t[t.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",t[t.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",t[t.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",t[t.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",t[t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",t[t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",t[t.CULL_FACE=2884]="CULL_FACE",t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK",t[t.BLEND=3042]="BLEND",t[t.DEPTH_TEST=2929]="DEPTH_TEST",t[t.DITHER=3024]="DITHER",t[t.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",t[t.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",t[t.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",t[t.SCISSOR_TEST=3089]="SCISSOR_TEST",t[t.STENCIL_TEST=2960]="STENCIL_TEST",t[t.NO_ERROR=0]="NO_ERROR",t[t.INVALID_ENUM=1280]="INVALID_ENUM",t[t.INVALID_VALUE=1281]="INVALID_VALUE",t[t.INVALID_OPERATION=1282]="INVALID_OPERATION",t[t.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",t[t.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",t[t.CW=2304]="CW",t[t.CCW=2305]="CCW",t[t.DONT_CARE=4352]="DONT_CARE",t[t.FASTEST=4353]="FASTEST",t[t.NICEST=4354]="NICEST",t[t.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.DOUBLE=5130]="DOUBLE",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER",t[t.COMPILE_STATUS=35713]="COMPILE_STATUS",t[t.DELETE_STATUS=35712]="DELETE_STATUS",t[t.LINK_STATUS=35714]="LINK_STATUS",t[t.VALIDATE_STATUS=35715]="VALIDATE_STATUS",t[t.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",t[t.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",t[t.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",t[t.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",t[t.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",t[t.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",t[t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",t[t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",t[t.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",t[t.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",t[t.SHADER_TYPE=35663]="SHADER_TYPE",t[t.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",t[t.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP",t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",t[t.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",t[t.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",t[t.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",t[t.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE=5890]="TEXTURE",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",t[t.TEXTURE0=33984]="TEXTURE0",t[t.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",t[t.REPEAT=10497]="REPEAT",t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",t[t.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",t[t.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.LOW_FLOAT=36336]="LOW_FLOAT",t[t.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",t[t.HIGH_FLOAT=36338]="HIGH_FLOAT",t[t.LOW_INT=36339]="LOW_INT",t[t.MEDIUM_INT=36340]="MEDIUM_INT",t[t.HIGH_INT=36341]="HIGH_INT",t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.RENDERBUFFER=36161]="RENDERBUFFER",t[t.RGBA4=32854]="RGBA4",t[t.RGB5_A1=32855]="RGB5_A1",t[t.RGB565=36194]="RGB565",t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX=6401]="STENCIL_INDEX",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",t[t.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",t[t.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",t[t.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",t[t.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",t[t.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",t[t.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",t[t.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",t[t.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",t[t.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",t[t.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",t[t.NONE=0]="NONE",t[t.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",t[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",t[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",t[t.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",t[t.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",t[t.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",t[t.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",t[t.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",t[t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",t[t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",t[t.READ_BUFFER=3074]="READ_BUFFER",t[t.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",t[t.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",t[t.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",t[t.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",t[t.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",t[t.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",t[t.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",t[t.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",t[t.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",t[t.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",t[t.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",t[t.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",t[t.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",t[t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",t[t.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",t[t.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",t[t.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",t[t.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",t[t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",t[t.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",t[t.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",t[t.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",t[t.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",t[t.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",t[t.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",t[t.RED=6403]="RED",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB10_A2=32857]="RGB10_A2",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",t[t.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",t[t.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",t[t.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",t[t.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",t[t.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",t[t.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",t[t.SRGB=35904]="SRGB",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",t[t.RGBA32F=34836]="RGBA32F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.RGB16F=34843]="RGB16F",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R16F=33325]="R16F",t[t.R32F=33326]="R32F",t[t.RG16F=33327]="RG16F",t[t.RG32F=33328]="RG32F",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2UI=36975]="RGB10_A2UI",t[t.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",t[t.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.RG=33319]="RG",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",t[t.CURRENT_QUERY=34917]="CURRENT_QUERY",t[t.QUERY_RESULT=34918]="QUERY_RESULT",t[t.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",t[t.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",t[t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",t[t.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",t[t.DRAW_BUFFER0=34853]="DRAW_BUFFER0",t[t.DRAW_BUFFER1=34854]="DRAW_BUFFER1",t[t.DRAW_BUFFER2=34855]="DRAW_BUFFER2",t[t.DRAW_BUFFER3=34856]="DRAW_BUFFER3",t[t.DRAW_BUFFER4=34857]="DRAW_BUFFER4",t[t.DRAW_BUFFER5=34858]="DRAW_BUFFER5",t[t.DRAW_BUFFER6=34859]="DRAW_BUFFER6",t[t.DRAW_BUFFER7=34860]="DRAW_BUFFER7",t[t.DRAW_BUFFER8=34861]="DRAW_BUFFER8",t[t.DRAW_BUFFER9=34862]="DRAW_BUFFER9",t[t.DRAW_BUFFER10=34863]="DRAW_BUFFER10",t[t.DRAW_BUFFER11=34864]="DRAW_BUFFER11",t[t.DRAW_BUFFER12=34865]="DRAW_BUFFER12",t[t.DRAW_BUFFER13=34866]="DRAW_BUFFER13",t[t.DRAW_BUFFER14=34867]="DRAW_BUFFER14",t[t.DRAW_BUFFER15=34868]="DRAW_BUFFER15",t[t.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",t[t.MAX_SAMPLES=36183]="MAX_SAMPLES",t[t.SAMPLER_BINDING=35097]="SAMPLER_BINDING",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",t[t.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",t[t.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",t[t.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",t[t.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",t[t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",t[t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",t[t.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",t[t.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",t[t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",t[t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",t[t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",t[t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",t[t.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",t[t.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",t[t.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",t[t.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",t[t.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",t[t.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",t[t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",t[t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",t[t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",t[t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",t[t.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",t[t.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",t[t.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",t[t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",t[t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",t[t.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",t[t.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",t[t.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",t[t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",t[t.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",t[t.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",t[t.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",t[t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",t[t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",t[t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",t[t.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",t[t.UNIFORM_TYPE=35383]="UNIFORM_TYPE",t[t.UNIFORM_SIZE=35384]="UNIFORM_SIZE",t[t.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",t[t.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",t[t.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",t[t.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",t[t.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",t[t.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",t[t.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",t[t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",t[t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",t[t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS",t[t.SYNC_FENCE=37142]="SYNC_FENCE",t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED",t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED",t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",t[t.COLOR=6144]="COLOR",t[t.DEPTH=6145]="DEPTH",t[t.STENCIL=6146]="STENCIL",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STREAM_COPY=35042]="STREAM_COPY",t[t.STATIC_READ=35045]="STATIC_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",t[t.INVALID_INDEX=4294967295]="INVALID_INDEX",t[t.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",t[t.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",t[t.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",t[t.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",t[t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",t[t.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",t[t.R16_EXT=33322]="R16_EXT",t[t.RG16_EXT=33324]="RG16_EXT",t[t.RGB16_EXT=32852]="RGB16_EXT",t[t.RGBA16_EXT=32859]="RGBA16_EXT",t[t.R16_SNORM_EXT=36760]="R16_SNORM_EXT",t[t.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",t[t.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",t[t.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",t[t.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",t[t.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",t[t.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",t[t.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",t[t.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",t[t.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",t[t.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",t[t.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",t[t.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",t[t.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",t[t.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",t[t.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",t[t.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",t[t.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",t[t.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",t[t.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",t[t.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",t[t.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",t[t.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",t[t.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",t[t.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",t[t.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",t[t.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",t[t.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",t[t.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",t[t.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",t[t.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",t[t.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",t[t.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",t[t.LINE_WEBGL=6913]="LINE_WEBGL",t[t.FILL_WEBGL=6914]="FILL_WEBGL",t[t.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",t[t.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",t[t.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",t[t.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",t[t.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",t[t.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",t[t.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",t[t.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",t[t.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",t[t.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",t[t.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",t[t.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",t[t.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",t[t.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",t[t.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",t[t.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",t[t.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",t[t.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",t[t.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",t[t.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",t[t.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",t[t.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",t[t.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",t[t.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(Vi||(Vi={}));const E_={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},xe=(t,e,n)=>e?t.enable(n):t.disable(n),$0=(t,e,n)=>t.hint(n,e),ct=(t,e,n)=>t.pixelStorei(n,e),j0=(t,e,n)=>{const r=n===36006?36009:36008;return t.bindFramebuffer(r,e)},qs=(t,e,n)=>{const i={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[n];t.bindBuffer(i,e)};function Eh(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}const j4={3042:xe,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:xe,2885:(t,e)=>t.cullFace(e),2929:xe,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:xe,35723:$0,35725:(t,e)=>t.useProgram(e),36007:(t,e)=>t.bindRenderbuffer(36161,e),36389:(t,e)=>{var n;return(n=t.bindTransformFeedback)==null?void 0:n.call(t,36386,e)},34229:(t,e)=>t.bindVertexArray(e),36006:j0,36010:j0,34964:qs,36662:qs,36663:qs,35053:qs,35055:qs,2886:(t,e)=>t.frontFace(e),33170:$0,2849:(t,e)=>t.lineWidth(e),32823:xe,32824:"polygonOffset",10752:"polygonOffset",35977:xe,32926:xe,32928:xe,32938:"sampleCoverage",32939:"sampleCoverage",3089:xe,3088:(t,e)=>t.scissor(...e),2960:xe,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),34383:xe,10754:xe,12288:xe,12289:xe,12290:xe,12291:xe,12292:xe,12293:xe,12294:xe,12295:xe,3333:ct,3317:ct,37440:ct,37441:ct,37443:ct,3330:ct,3332:ct,3331:ct,3314:ct,32878:ct,3316:ct,3315:ct,32877:ct,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{const n=typeof e=="number"?[e,e]:e;t.blendEquationSeparate(...n)},blendFunc:(t,e)=>{const n=(e==null?void 0:e.length)===2?[...e,...e]:e;t.blendFuncSeparate(...n)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Eh(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=Eh(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=Eh(e)&&e.length===3?[...e,...e]:e;const[n,r,i,s,o,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function be(t,e,n){return e[t]!==void 0?e[t]:n[t]}const W4={blendEquation:(t,e,n)=>t.blendEquationSeparate(be(32777,e,n),be(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(be(32969,e,n),be(32968,e,n),be(32971,e,n),be(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(be(32824,e,n),be(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(be(32938,e,n),be(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,be(2962,e,n),be(2967,e,n),be(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,be(34816,e,n),be(36003,e,n),be(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,be(2964,e,n),be(2965,e,n),be(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,be(34817,e,n),be(34818,e,n),be(34819,e,n))},W0={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),useProgram:(t,e)=>t({35725:e}),bindRenderbuffer:(t,e,n)=>t({36007:n}),bindTransformFeedback:(t,e,n)=>t({36389:n}),bindVertexArray:(t,e)=>t({34229:e}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},bindBuffer:(t,e,n)=>{const r={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return r?t({[r]:n}):{valueChanged:!0}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},qt=(t,e)=>t.isEnabled(e),H0={3042:qt,2884:qt,2929:qt,3024:qt,32823:qt,32926:qt,32928:qt,3089:qt,2960:qt,35977:qt},H4=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function Ms(t,e){if(Y4(e))return;const n={};for(const i in e){const s=Number(i),o=j4[i];o&&(typeof o=="string"?n[o]=!0:o(t,e[i],s))}const r=t.state&&t.state.cache;if(r)for(const i in n){const s=W4[i];s(t,e,r)}}function C1(t,e=E_){if(typeof e=="number"){const i=e,s=H0[i];return s?s(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const s=H0[i];r[i]=s?s(t,Number(i)):t.getParameter(Number(i))}return r}function X4(t){Ms(t,E_)}function Y4(t){for(const e in t)return!1;return!0}function K4(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}class q4{constructor(e,{copyState:n=!1,log:r=()=>{}}={}){T(this,"gl");T(this,"program",null);T(this,"stateStack",[]);T(this,"enable",!0);T(this,"cache");T(this,"log");this.gl=e,this.cache=n?C1(e):Object.assign({},E_),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){ue(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];Ms(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const s in e){ue(s!==void 0);const o=e[s],a=this.cache[s];K4(o,a)||(n=!0,r=a,i&&!(s in i)&&(i[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:r}}}function ni(t){return t.state}function P1(t,e){const{enable:n=!0,copyState:r}=e;if(ue(r!==void 0),!t.state){t.state=new q4(t,{copyState:r}),Q4(t);for(const s in W0){const o=W0[s];Z4(t,s,o)}X0(t,"getParameter"),X0(t,"isEnabled")}const i=ni(t);return i.enable=n,t}function sf(t){let e=ni(t);e||(P1(t,{copyState:!1}),e=ni(t)),e.push()}function ea(t){const e=ni(t);ue(e),e.pop()}function X0(t,e){const n=t[e].bind(t);t[e]=function(i){if(i===void 0||H4.has(i))return n(i);const s=ni(t);return i in s.cache||(s.cache[i]=n(i)),s.enable?s.cache[i]:n(i)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function Z4(t,e,n){if(!t[e])return;const r=t[e].bind(t);t[e]=function(...s){const o=ni(t),{valueChanged:a,oldValue:l}=n(o._updateCache,...s);return a&&r(...s),l},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}function Q4(t){const e=t.useProgram.bind(t);t.useProgram=function(r){const i=ni(t);i.program!==r&&(e(r),i.program=r)}}const J4={powerPreference:"high-performance",onContextLost:()=>console.error("WebGL context lost"),onContextRestored:()=>console.info("WebGL context restored")};function G4(t,e){e={...J4,...e};let n=null;const r=s=>n=s.statusMessage||n;t.addEventListener("webglcontextcreationerror",r,!1);let i=null;if(i||(i=t.getContext("webgl2",e)),t.removeEventListener("webglcontextcreationerror",r,!1),!i)throw new Error(`Failed to create WebGL context: ${n||"Unknown error"}`);if(e.onContextLost){const{onContextLost:s}=e;t.addEventListener("webglcontextlost",o=>s(o),!1)}if(e.onContextRestored){const{onContextRestored:s}=e;t.addEventListener("webglcontextrestored",o=>s(o),!1)}return i}function _r(t,e,n){return n[e]===void 0&&(n[e]=t.getExtension(e)||null),n[e]}function eB(t,e){const n=t.getParameter(7936),r=t.getParameter(7937);_r(t,"WEBGL_debug_renderer_info",e);const i=e.WEBGL_debug_renderer_info,s=t.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936),o=t.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937),a=s||n,l=o||r,c=t.getParameter(7938),u=I1(a,l),f=tB(a,l),h=nB(a,l);return{type:"webgl",gpu:u,gpuType:h,gpuBackend:f,vendor:a,renderer:l,version:c,shadingLanguage:"glsl",shadingLanguageVersion:300}}function I1(t,e){return/NVIDIA/i.exec(t)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(t)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(t)||/Apple/i.exec(e)?"apple":/AMD/i.exec(t)||/AMD/i.exec(e)||/ATI/i.exec(t)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e)?"software":"unknown"}function tB(t,e){return/Metal/i.exec(t)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(t)||/ANGLE/i.exec(e)?"opengl":"unknown"}function nB(t,e){if(/SwiftShader/i.exec(t)||/SwiftShader/i.exec(e))return"cpu";switch(I1(t,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function M1(t){switch(t){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(t))}const Ye="texture-compression-bc",ie="texture-compression-astc",Zt="texture-compression-etc2",rB="texture-compression-etc1-webgl",_l="texture-compression-pvrtc-webgl",bh="texture-compression-atc-webgl",Zs="float32-renderable-webgl",Ah="float16-renderable-webgl",iB="rgb9e5ufloat_renderable-webgl",Rh="snorm8-renderable-webgl",Qs="norm16-renderable-webgl",xh="snorm16-renderable-webgl",ml="float32-filterable",Y0="float16-filterable-webgl",ao="WEBGL_compressed_texture_s3tc",lo="WEBGL_compressed_texture_s3tc_srgb",$i="EXT_texture_compression_rgtc",ji="EXT_texture_compression_bptc",sB="WEBGL_compressed_texture_etc",oB="WEBGL_compressed_texture_astc",aB="WEBGL_compressed_texture_etc1",lB="WEBGL_compressed_texture_pvrtc",cB="WEBGL_compressed_texture_atc",K0="EXT_texture_norm16",q0="EXT_render_snorm",uB="EXT_color_buffer_float",b_={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat_renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[q0],"norm16-renderable-webgl":[K0],"snorm16-renderable-webgl":[K0,q0],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[ao,lo,$i,ji],"texture-compression-bc5-webgl":[$i],"texture-compression-bc7-webgl":[ji],"texture-compression-etc2":[sB],"texture-compression-astc":[oB],"texture-compression-etc1-webgl":[aB],"texture-compression-pvrtc-webgl":[lB],"texture-compression-atc-webgl":[cB]};function fB(t){return t in b_}function hB(t,e,n){return(b_[e]||[]).every(i=>_r(t,i,n))}const of={"rgb8unorm-unsized":{gl:6407,b:4,c:2,bpp:4,dataFormat:6407,types:[5121,33635]},"rgba8unorm-unsized":{gl:6408,b:4,c:2,bpp:4,dataFormat:6408,types:[5121,32819,32820]},r8unorm:{gl:33321,b:1,c:1,rb:!0},r8snorm:{gl:36756,b:1,c:1,render:Rh},r8uint:{gl:33330,b:1,c:1,rb:!0},r8sint:{gl:33329,b:1,c:1,rb:!0},rg8unorm:{gl:33323,b:2,c:2,rb:!0},rg8snorm:{gl:36757,b:2,c:2,render:Rh},rg8uint:{gl:33336,b:2,c:2,rb:!0},rg8sint:{gl:33335,b:2,c:2,rb:!0},r16uint:{gl:33332,b:2,c:1,rb:!0},r16sint:{gl:33331,b:2,c:1,rb:!0},r16float:{gl:33325,b:2,c:1,render:Ah,filter:"float16-filterable-webgl",rb:!0},"r16unorm-webgl":{gl:33322,b:2,c:1,f:Qs,rb:!0},"r16snorm-webgl":{gl:36760,b:2,c:1,f:xh},"rgba4unorm-webgl":{gl:32854,b:2,c:4,wgpu:!1,rb:!0},"rgb565unorm-webgl":{gl:36194,b:2,c:4,wgpu:!1,rb:!0},"rgb5a1unorm-webgl":{gl:32855,b:2,c:4,wgpu:!1,rb:!0},"rgb8unorm-webgl":{gl:32849,b:3,c:3,wgpu:!1},"rgb8snorm-webgl":{gl:36758,b:3,c:3,wgpu:!1},rgba8unorm:{gl:32856,b:4,c:2,bpp:4},"rgba8unorm-srgb":{gl:35907,b:4,c:4,bpp:4},rgba8snorm:{gl:36759,b:4,c:4,render:Rh},rgba8uint:{gl:36220,b:4,c:4,bpp:4},rgba8sint:{gl:36238,b:4,c:4,bpp:4},bgra8unorm:{b:4,c:4},"bgra8unorm-srgb":{b:4,c:4},rg16uint:{gl:33338,b:4,c:1,bpp:4},rg16sint:{gl:33337,b:4,c:2,bpp:4},rg16float:{gl:33327,bpp:4,b:4,c:2,render:Ah,filter:Y0,rb:!0},"rg16unorm-webgl":{gl:33324,b:2,c:2,render:Qs},"rg16snorm-webgl":{gl:36761,b:2,c:2,render:xh},r32uint:{gl:33334,b:4,c:1,bpp:4,rb:!0},r32sint:{gl:33333,b:4,c:1,bpp:4,rb:!0},r32float:{gl:33326,bpp:4,b:4,c:1,render:Zs,filter:ml},rgb9e5ufloat:{gl:35901,b:4,c:3,p:1,render:iB},rg11b10ufloat:{gl:35898,b:4,c:3,p:1,render:Zs,rb:!0},rgb10a2unorm:{gl:32857,b:4,c:4,p:1,rb:!0},"rgb10a2uint-webgl":{b:4,c:4,gl:36975,p:1,wgpu:!1,bpp:4,rb:!0},"rgb16unorm-webgl":{gl:32852,b:2,c:3,f:Qs},"rgb16snorm-webgl":{gl:36762,b:2,c:3,f:Qs},rg32uint:{gl:33340,b:8,c:2,rb:!0},rg32sint:{gl:33339,b:8,c:2,rb:!0},rg32float:{gl:33328,b:8,c:2,render:Zs,filter:ml,rb:!0},rgba16uint:{gl:36214,b:8,c:4,rb:!0},rgba16sint:{gl:36232,b:8,c:4,rb:!0},rgba16float:{gl:34842,b:8,c:4,render:Ah,filter:Y0},"rgba16unorm-webgl":{gl:32859,b:2,c:4,render:Qs,rb:!0},"rgba16snorm-webgl":{gl:36763,b:2,c:4,render:xh},"rgb32float-webgl":{gl:34837,render:Zs,filter:ml,gl2ext:uB,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,b:16,c:4,rb:!0},rgba32sint:{gl:36226,b:16,c:4,rb:!0},rgba32float:{gl:34836,b:16,c:4,render:Zs,filter:ml,rb:!0},stencil8:{gl:36168,b:1,c:1,attachment:36128,rb:!0},depth16unorm:{gl:33189,b:2,c:1,attachment:36096,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,b:3,c:1,attachment:36096,dataFormat:6402,types:[5125]},depth32float:{gl:36012,b:4,c:1,attachment:36096,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth24unorm-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,dataFormat:34041,types:[34042],rb:!0},"depth32float-stencil8":{gl:36013,b:5,c:2,p:1,attachment:33306,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:ao,f:Ye},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:lo,f:Ye},"bc1-rgba-unorm":{gl:33777,x:ao,f:Ye},"bc1-rgba-unorm-srgb":{gl:35916,x:lo,f:Ye},"bc2-rgba-unorm":{gl:33778,x:ao,f:Ye},"bc2-rgba-unorm-srgb":{gl:35918,x:lo,f:Ye},"bc3-rgba-unorm":{gl:33779,x:ao,f:Ye},"bc3-rgba-unorm-srgb":{gl:35919,x:lo,f:Ye},"bc4-r-unorm":{gl:36283,x:$i,f:Ye},"bc4-r-snorm":{gl:36284,x:$i,f:Ye},"bc5-rg-unorm":{gl:36285,x:$i,f:Ye},"bc5-rg-snorm":{gl:36286,x:$i,f:Ye},"bc6h-rgb-ufloat":{gl:36495,x:ji,f:Ye},"bc6h-rgb-float":{gl:36494,x:ji,f:Ye},"bc7-rgba-unorm":{gl:36492,x:ji,f:Ye},"bc7-rgba-unorm-srgb":{gl:36493,x:ji,f:Ye},"etc2-rgb8unorm":{gl:37492,f:Zt},"etc2-rgb8unorm-srgb":{gl:37494,f:Zt},"etc2-rgb8a1unorm":{gl:37496,f:Zt},"etc2-rgb8a1unorm-srgb":{gl:37497,f:Zt},"etc2-rgba8unorm":{gl:37493,f:Zt},"etc2-rgba8unorm-srgb":{gl:37495,f:Zt},"eac-r11unorm":{gl:37488,f:Zt},"eac-r11snorm":{gl:37489,f:Zt},"eac-rg11unorm":{gl:37490,f:Zt},"eac-rg11snorm":{gl:37491,f:Zt},"astc-4x4-unorm":{gl:37808,f:ie},"astc-4x4-unorm-srgb":{gl:37840,f:ie},"astc-5x4-unorm":{gl:37809,f:ie},"astc-5x4-unorm-srgb":{gl:37841,f:ie},"astc-5x5-unorm":{gl:37810,f:ie},"astc-5x5-unorm-srgb":{gl:37842,f:ie},"astc-6x5-unorm":{gl:37811,f:ie},"astc-6x5-unorm-srgb":{gl:37843,f:ie},"astc-6x6-unorm":{gl:37812,f:ie},"astc-6x6-unorm-srgb":{gl:37844,f:ie},"astc-8x5-unorm":{gl:37813,f:ie},"astc-8x5-unorm-srgb":{gl:37845,f:ie},"astc-8x6-unorm":{gl:37814,f:ie},"astc-8x6-unorm-srgb":{gl:37846,f:ie},"astc-8x8-unorm":{gl:37815,f:ie},"astc-8x8-unorm-srgb":{gl:37847,f:ie},"astc-10x5-unorm":{gl:37819,f:ie},"astc-10x5-unorm-srgb":{gl:37851,f:ie},"astc-10x6-unorm":{gl:37817,f:ie},"astc-10x6-unorm-srgb":{gl:37849,f:ie},"astc-10x8-unorm":{gl:37818,f:ie},"astc-10x8-unorm-srgb":{gl:37850,f:ie},"astc-10x10-unorm":{gl:37819,f:ie},"astc-10x10-unorm-srgb":{gl:37851,f:ie},"astc-12x10-unorm":{gl:37820,f:ie},"astc-12x10-unorm-srgb":{gl:37852,f:ie},"astc-12x12-unorm":{gl:37821,f:ie},"astc-12x12-unorm-srgb":{gl:37853,f:ie},"pvrtc-rgb4unorm-webgl":{gl:35840,f:_l},"pvrtc-rgba4unorm-webgl":{gl:35842,f:_l},"pvrtc-rbg2unorm-webgl":{gl:35841,f:_l},"pvrtc-rgba2unorm-webgl":{gl:35843,f:_l},"etc1-rbg-unorm-webgl":{gl:36196,f:rB},"atc-rgb-unorm-webgl":{gl:35986,f:bh},"atc-rgba-unorm-webgl":{gl:35986,f:bh},"atc-rgbai-unorm-webgl":{gl:34798,f:bh}},dB={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},pB={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function A_(t,e,n){const r=of[e];if(!r||r.gl===void 0)return!1;const i=r.x||r.gl2ext;return i?!!_r(t,i,n):!0}function N1(t){const e=of[t],n=e==null?void 0:e.gl;if(n===void 0)throw new Error(`Unsupported texture format ${t}`);return n}function gB(t,e,n){if(!A_(t,e,n)||e.startsWith("depth")||e.startsWith("stencil"))return!1;try{if(zE(e).signed)return!1}catch{return!1}return e.endsWith("32float")?!!_r(t,"OES_texture_float_linear, extensions",n):e.endsWith("16float")?!!_r(t,"OES_texture_half_float_linear, extensions",n):!0}function _B(t,e,n){return!(!A_(t,e,n)||typeof e=="number")}function Wc(t){var i;const e=of[t],n=N1(t),r=zE(t);return{format:n,dataFormat:(e==null?void 0:e.dataFormat)||yB(r.format,r.integer,r.normalized,n),type:r.dataType?M1(r.dataType):((i=e==null?void 0:e.types)==null?void 0:i[0])||5121,compressed:r.compressed}}function mB(t){const e=of[t];if(!(e!=null&&e.attachment))throw new Error(`${t} is not a depth stencil format`);return e.attachment}function Z0(t){const e=Wc(t),n=dB[e.dataFormat]||4,r=pB[e.type]||1;return n*r}function yB(t,e,n,r){if(r===6408||r===6407)return r;switch(t){case"r":return e&&!n?36244:6403;case"rg":return e&&!n?33320:33319;case"rgb":return e&&!n?36248:6407;case"rgba":return e&&!n?36249:6408;default:return 6408}}const Q0={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class vB extends YN{constructor(n,r,i){super([],i);T(this,"gl");T(this,"extensions");T(this,"testedFeatures",new Set);this.gl=n,this.extensions=r,_r(n,"EXT_color_buffer_float",r)}*[Symbol.iterator](){const n=this.getFeatures();for(const r of n)this.has(r)&&(yield r);return[]}has(n){return this.disabledFeatures[n]?!1:(this.testedFeatures.has(n)||(this.testedFeatures.add(n),fB(n)&&hB(this.gl,n,this.extensions)&&this.features.add(n),this.getWebGLFeature(n)&&this.features.add(n)),this.features.has(n))}initializeFeatures(){const n=this.getFeatures().filter(r=>r!=="polygon-mode-webgl");for(const r of n)this.has(r)}getFeatures(){return[...Object.keys(Q0),...Object.keys(b_)]}getWebGLFeature(n){const r=Q0[n];return typeof r=="string"?!!_r(this.gl,r,this.extensions):!!r}}class TB extends XN{constructor(n){super();T(this,"gl");T(this,"limits",{});this.gl=n}get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}getParameter(n){return this.limits[n]===void 0&&(this.limits[n]=this.gl.getParameter(n)),this.limits[n]}}function tr(t,e,n){if(wB(e))return n(t);const{nocatch:r=!0}=e;sf(t),Ms(t,e);let i;if(r)i=n(t),ea(t);else try{i=n(t)}finally{ea(t)}return i}function wB(t){for(const e in t)return!1;return!0}function SB(t,e,n,r){if(Pc(e))return r(t);const i=t;sf(i.gl);try{return EB(t,e),Ms(i.gl,n),r(t)}finally{ea(i.gl)}}function EB(t,e){const n=t,{gl:r}=n;if(e.cullMode)switch(e.cullMode){case"none":r.disable(2884);break;case"front":r.enable(2884),r.cullFace(1028);break;case"back":r.enable(2884),r.cullFace(1029);break}if(e.frontFace&&r.frontFace(Kr("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&t.features.has("depth-clip-control")&&r.enable(34383),e.depthBias!==void 0&&(r.enable(32823),r.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&t.features.has("provoking-vertex-webgl")){const s=n.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,o=Kr("provokingVertex",e.provokingVertex,{first:36429,last:36430});s==null||s.provokingVertexWEBGL(o)}if((e.polygonMode||e.polygonOffsetLine)&&t.features.has("polygon-mode-webgl")){if(e.polygonMode){const s=n.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,o=Kr("polygonMode",e.polygonMode,{fill:6914,line:6913});s==null||s.polygonModeWEBGL(1028,o),s==null||s.polygonModeWEBGL(1029,o)}e.polygonOffsetLine&&r.enable(10754)}if(t.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&r.enable(12288),e.clipDistance1&&r.enable(12289),e.clipDistance2&&r.enable(12290),e.clipDistance3&&r.enable(12291),e.clipDistance4&&r.enable(12292),e.clipDistance5&&r.enable(12293),e.clipDistance6&&r.enable(12294),e.clipDistance7&&r.enable(12295)),e.depthWriteEnabled!==void 0&&r.depthMask(AB("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?r.enable(2929):r.disable(2929),r.depthFunc(gp("depthCompare",e.depthCompare))),e.stencilWriteMask){const i=e.stencilWriteMask;r.stencilMaskSeparate(1028,i),r.stencilMaskSeparate(1029,i)}if(e.stencilReadMask&&U.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const i=e.stencilReadMask||4294967295,s=gp("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?r.enable(2960):r.disable(2960),r.stencilFuncSeparate(1028,s,0,i),r.stencilFuncSeparate(1029,s,0,i)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const i=Ch("stencilPassOperation",e.stencilPassOperation),s=Ch("stencilFailOperation",e.stencilFailOperation),o=Ch("stencilDepthFailOperation",e.stencilDepthFailOperation);r.stencilOpSeparate(1028,s,o,i),r.stencilOpSeparate(1029,s,o,i)}if(e.blendColorOperation||e.blendAlphaOperation){r.enable(3042);const i=J0("blendColorOperation",e.blendColorOperation||"add"),s=J0("blendAlphaOperation",e.blendAlphaOperation||"add");r.blendEquationSeparate(i,s);const o=yl("blendColorSrcFactor",e.blendColorSrcFactor||"one"),a=yl("blendColorDstFactor",e.blendColorDstFactor||"zero"),l=yl("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),c=yl("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");r.blendFuncSeparate(o,a,l,c)}}function gp(t,e){return Kr(t,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function Ch(t,e){return Kr(t,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function J0(t,e){return Kr(t,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function yl(t,e){return Kr(t,e,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function bB(t,e){return`Illegal parameter ${e} for ${t}`}function Kr(t,e,n){if(!(e in n))throw new Error(bB(t,e));return n[e]}function AB(t,e){return e}function O1(t){const e={};return t.addressModeU&&(e[10242]=Ph(t.addressModeU)),t.addressModeV&&(e[10243]=Ph(t.addressModeV)),t.addressModeW&&(e[32882]=Ph(t.addressModeW)),t.magFilter&&(e[10240]=k1(t.magFilter)),(t.minFilter||t.mipmapFilter)&&(e[10241]=RB(t.minFilter||"linear",t.mipmapFilter)),t.lodMinClamp!==void 0&&(e[33082]=t.lodMinClamp),t.lodMaxClamp!==void 0&&(e[33083]=t.lodMaxClamp),t.type==="comparison-sampler"&&(e[34892]=34894),t.compare&&(e[34893]=gp("compare",t.compare)),t.maxAnisotropy&&(e[34046]=t.maxAnisotropy),e}function Ph(t){switch(t){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function k1(t){switch(t){case"nearest":return 9728;case"linear":return 9729}}function RB(t,e){if(!e)return k1(t);switch(t){case"nearest":return e==="nearest"?9984:9986;case"linear":return e==="nearest"?9985:9987}}class hr extends ge{constructor(n,r={}){super(n,r);T(this,"device");T(this,"gl");T(this,"handle");T(this,"glTarget");T(this,"glUsage");T(this,"glIndexType",5123);T(this,"byteLength");T(this,"bytesUsed");this.device=n,this.gl=this.device.gl;const i=typeof r=="object"?r.handle:void 0;this.handle=i||this.gl.createBuffer(),n.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=xB(this.props.usage),this.glUsage=CB(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,r.data?this._initWithData(r.data,r.byteOffset,r.byteLength):this._initWithByteLength(r.byteLength||0)}_initWithData(n,r=0,i=n.byteLength+r){const s=this.glTarget;this.gl.bindBuffer(s,this.handle),this.gl.bufferData(s,i,this.glUsage),this.gl.bufferSubData(s,r,n),this.gl.bindBuffer(s,null),this.bytesUsed=i,this.byteLength=i,this._setDebugData(n,r,i),this.trackAllocatedMemory(i)}_initWithByteLength(n){ue(n>=0);let r=n;n===0&&(r=new Float32Array(0));const i=this.glTarget;return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.glUsage),this.gl.bindBuffer(i,null),this.bytesUsed=n,this.byteLength=n,this._setDebugData(null,0,n),this.trackAllocatedMemory(n),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(n,r=0){this.gl.bindBuffer(36663,this.handle),this.gl.bufferSubData(36663,r,n),this.gl.bindBuffer(36663,null),this._setDebugData(n,r,n.byteLength)}async readAsync(n=0,r){return this.readSyncWebGL(n,r)}readSyncWebGL(n=0,r){r=r??this.byteLength-n;const i=new Uint8Array(r),s=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,i,s,r),this.gl.bindBuffer(36662,null),this._setDebugData(i,n,r),i}}function xB(t){return t&ge.INDEX?34963:t&ge.VERTEX?34962:t&ge.UNIFORM?35345:34962}function CB(t){return t&ge.INDEX||t&ge.VERTEX?35044:t&ge.UNIFORM?35048:35044}class _p extends Nc{constructor(n,r){super(n,r);T(this,"device");T(this,"handle");T(this,"parameters");this.device=n,this.parameters=O1(r),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(n){for(const[r,i]of Object.entries(n)){const s=Number(r);switch(s){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,s,i);break;default:this.device.gl.samplerParameteri(this.handle,s,i);break}}}}class Wi extends Ic{constructor(n,r){super(n,{...bt.defaultProps,...r});T(this,"device");T(this,"gl");T(this,"handle");T(this,"texture");this.device=n,this.gl=this.device.gl,this.handle=null,this.texture=r.texture}}const PB={parameters:{},pixelStore:{},pixels:null,border:0,dataFormat:void 0,textureUnit:void 0,target:void 0},Co=class Co extends bt{constructor(n,r){var i;super(n,{...PB,format:"rgba8unorm",...r});T(this,"MAX_ATTRIBUTES");T(this,"device");T(this,"gl");T(this,"handle");T(this,"sampler");T(this,"view");T(this,"glFormat");T(this,"type");T(this,"dataFormat");T(this,"mipmaps");T(this,"target");T(this,"textureUnit");T(this,"loaded",!1);T(this,"_video");this.device=n,this.gl=this.device.gl,this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glFormat=6408,this.target=IB(this.props),this.loaded=!1,typeof((i=this.props)==null?void 0:i.data)=="string"&&Object.assign(this.props,{data:kO(this.props.data)}),this.initialize(this.props),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}toString(){return`Texture(${this.id},${this.width}x${this.height})`}createView(n){return new Wi(this.device,{...n,texture:this})}initialize(n={}){if(this.props.dimension==="cube")return this.initializeCube(n);let r=n.data;if(r instanceof Promise)return r.then(m=>this.initialize(Object.assign({},n,{pixels:m,data:m}))),this;const i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement;if(i&&r.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,r.addEventListener("loadeddata",()=>this.initialize(n)),this;const{parameters:s={}}=n,{pixels:o=null,pixelStore:a={},textureUnit:l=void 0,mipmaps:c=!0}=n;r||(r=o);let{width:u,height:f,dataFormat:h,type:d,compressed:_=!1}=n;const{depth:g=0}=n,b=N1(n.format);return{width:u,height:f,compressed:_,dataFormat:h,type:d}=this._deduceParameters({format:n.format,type:d,dataFormat:h,compressed:_,data:r,width:u,height:f}),this.width=u,this.height=f,this.glFormat=b,this.type=d,this.dataFormat=h,this.textureUnit=l,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),this.mipmaps=c,this.setImageData({data:r,width:u,height:f,depth:g,format:n.format,type:d,dataFormat:h,parameters:a,compressed:_}),this.setSampler(n.sampler),this._setSamplerParameters(s),this.view=this.createView({...this.props,mipLevelCount:1,arrayLayerCount:1}),c&&this.device.isTextureFormatFilterable(n.format)&&this.generateMipmap(),i&&(this._video={video:r,parameters:s,lastTime:r.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?r.currentTime:-1}),this}initializeCube(n){const{mipmaps:r=!0,parameters:i={}}=n;return this.setCubeMapImageData(n).then(()=>{this.loaded=!0,r&&this.generateMipmap(n),this.setSampler(n.sampler),this._setSamplerParameters(i)}),this}setSampler(n={}){let r;n instanceof _p?(this.sampler=n,r=n.props):(this.sampler=new _p(this.device,n),r=n);const i=O1(r);return this._setSamplerParameters(i),this}resize(n){const{height:r,width:i,mipmaps:s=!1}=n;return i!==this.width||r!==this.height?this.initialize({width:i,height:r,format:this.format,type:this.type,dataFormat:this.dataFormat,mipmaps:s}):this}update(){if(this._video){const{video:n,parameters:r,lastTime:i}=this._video;if(i===n.currentTime||n.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:n,parameters:r}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=n.currentTime}}generateMipmap(n={}){return this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),tr(this.gl,n,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this}setImageData(n){if(this.props.dimension==="3d"||this.props.dimension==="2d-array")return this.setImageData3D(n);this.trackDeallocatedMemory("Texture");const{target:r=this.target,pixels:i=null,level:s=0,glFormat:o=this.glFormat,offset:a=0,parameters:l={}}=n;let{data:c=null,type:u=this.type,width:f=this.width,height:h=this.height,dataFormat:d=this.dataFormat,compressed:_=!1}=n;c||(c=i),{type:u,dataFormat:d,compressed:_,width:f,height:h}=this._deduceParameters({format:this.props.format,type:u,dataFormat:d,compressed:_,data:c,width:f,height:h});const{gl:g}=this;g.bindTexture(this.target,this.handle);let b=null;if({data:c,dataType:b}=this._getDataType({data:c,compressed:_}),tr(this.gl,l,()=>{switch(b){case"null":g.texImage2D(r,s,o,f,h,0,d,u,c);break;case"typed-array":g.texImage2D(r,s,o,f,h,0,d,u,c,a);break;case"buffer":this.device.gl.bindBuffer(35052,c.handle||c),this.device.gl.texImage2D(r,s,o,f,h,0,d,u,a),this.device.gl.bindBuffer(35052,null);break;case"browser-object":g.texImage2D(r,s,o,f,h,0,d,u,c);break;case"compressed":for(const[m,p]of c.entries())g.compressedTexImage2D(r,m,p.format,p.width,p.height,0,p.data);break;default:ue(!1,"Unknown image data type")}}),c&&c.byteLength)this.trackAllocatedMemory(c.byteLength,"Texture");else{const m=Z0(this.props.format);this.trackAllocatedMemory(this.width*this.height*m,"Texture")}return this.loaded=!0,this}setSubImageData({target:n=this.target,pixels:r=null,data:i=null,x:s=0,y:o=0,width:a=this.width,height:l=this.height,level:c=0,glFormat:u=this.glFormat,type:f=this.type,dataFormat:h=this.dataFormat,compressed:d=!1,offset:_=0,parameters:g={}}){if({type:f,dataFormat:h,compressed:d,width:a,height:l}=this._deduceParameters({format:this.props.format,type:f,dataFormat:h,compressed:d,data:i,width:a,height:l}),ue(this.depth===1,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const b=i;i=b.data,a=b.shape[0],l=b.shape[1]}i instanceof hr&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),tr(this.gl,g,()=>{d?this.gl.compressedTexSubImage2D(n,c,s,o,a,l,u,i):i===null?this.gl.texSubImage2D(n,c,s,o,a,l,h,f,null):ArrayBuffer.isView(i)?this.gl.texSubImage2D(n,c,s,o,a,l,h,f,i,_):typeof WebGLBuffer<"u"&&i instanceof WebGLBuffer?(this.device.gl.bindBuffer(35052,i),this.device.gl.texSubImage2D(n,c,s,o,a,l,h,f,_),this.device.gl.bindBuffer(35052,null)):this.device.gl.texSubImage2D(n,c,s,o,a,l,h,f,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(n={}){return U.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(n=this.textureUnit){const{gl:r}=this;return n!==void 0&&(this.textureUnit=n,r.activeTexture(33984+n)),r.bindTexture(this.target,this.handle),n}unbind(n=this.textureUnit){const{gl:r}=this;return n!==void 0&&(this.textureUnit=n,r.activeTexture(33984+n)),r.bindTexture(this.target,null),n}_getDataType({data:n,compressed:r=!1}){return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof hr?{data:n.handle,dataType:"buffer"}:typeof WebGLBuffer<"u"&&n instanceof WebGLBuffer?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(n){const{format:r,data:i}=n;let{width:s,height:o,dataFormat:a,type:l,compressed:c}=n;const u=Wc(r);return a=a||u.dataFormat,l=l||u.type,c=c||u.compressed,{width:s,height:o}=this._deduceImageSize(i,s,o),{dataFormat:a,type:l,compressed:c,width:s,height:o,format:r,data:i}}_deduceImageSize(n,r,i){let s;return typeof ImageData<"u"&&n instanceof ImageData?s={width:n.width,height:n.height}:typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement?s={width:n.naturalWidth,height:n.naturalHeight}:typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement?s={width:n.width,height:n.height}:typeof ImageBitmap<"u"&&n instanceof ImageBitmap?s={width:n.width,height:n.height}:typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement?s={width:n.videoWidth,height:n.videoHeight}:n?s={width:r,height:i}:s={width:r>=0?r:1,height:i>=0?i:1},ue(s,"Could not deduced texture size"),ue(r===void 0||s.width===r,"Deduced texture width does not match supplied width"),ue(i===void 0||s.height===i,"Deduced texture height does not match supplied height"),s}async setCubeMapImageData(n){const{gl:r}=this,{width:i,height:s,pixels:o,data:a,format:l=6408,type:c=5121}=n,u=o||a,f=await Promise.all(Co.FACES.map(h=>{const d=u[h];return Promise.all(Array.isArray(d)?d:[d])}));this.bind(),Co.FACES.forEach((h,d)=>{f[d].length>1&&this.props.mipmaps!==!1&&U.warn(`${this.id} has mipmap and multiple LODs.`)(),f[d].forEach((_,g)=>{i&&s?r.texImage2D(h,g,l,i,s,0,l,c,_):r.texImage2D(h,g,l,l,c,_)})}),this.unbind()}setImageDataForFace(n){const{face:r,width:i,height:s,pixels:o,data:a,format:l=6408,type:c=5121}=n,{gl:u}=this,f=o||a;return this.bind(),f instanceof Promise?f.then(h=>this.setImageDataForFace(Object.assign({},n,{face:r,data:h,pixels:h}))):this.width||this.height?u.texImage2D(r,0,l,i,s,0,l,c,f):u.texImage2D(r,0,l,l,c,f),this}setImageData3D(n){const{level:r=0,dataFormat:i,format:s,type:o,width:a,height:l,depth:c=1,offset:u=0,data:f,parameters:h={}}=n;this.trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle);const d=Wc(s);if(tr(this.gl,h,()=>{ArrayBuffer.isView(f)&&this.gl.texImage3D(this.target,r,d.format,a,l,c,0,d.dataFormat,d.type,f),f instanceof hr&&(this.gl.bindBuffer(35052,f.handle),this.gl.texImage3D(this.target,r,i,a,l,c,0,s,o,u))}),f&&f.byteLength)this.trackAllocatedMemory(f.byteLength,"Texture");else{const _=Z0(this.props.format);this.trackAllocatedMemory(this.width*this.height*this.depth*_,"Texture")}return this.loaded=!0,this}_setSamplerParameters(n){if(!Pc(n)){MB(n),this.gl.bindTexture(this.target,this.handle);for(const[r,i]of Object.entries(n)){const s=Number(r),o=i;switch(s){case 33082:case 33083:this.gl.texParameterf(this.target,s,o);break;default:this.gl.texParameteri(this.target,s,o);break}}this.gl.bindTexture(this.target,null)}}};T(Co,"FACES",[34069,34070,34071,34072,34073,34074]);let on=Co;function IB(t){switch(t.dimension){case"2d":return 3553;case"cube":return 34067;case"2d-array":return 35866;case"3d":return 32879;case"1d":case"cube-array":default:throw new Error(t.dimension)}}function MB(t){U.log(1,"texture sampler parameters",t)()}class So extends Oc{constructor(n,r){super(n,r);T(this,"device");T(this,"gl");T(this,"handle");const i=r.handle===null;if(this.device=n,this.gl=n.gl,this.handle=this.props.handle||i?this.props.handle:this.gl.createFramebuffer(),!i){n.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures();const s=this.gl.bindFramebuffer(36160,this.handle);for(let o=0;o<this.colorAttachments.length;++o){const a=this.colorAttachments[o],l=36064+o;a&&this._attachOne(l,a)}if(this.depthStencilAttachment&&this._attachOne(mB(this.depthStencilAttachment.props.format),this.depthStencilAttachment),r.check!==!1){const o=this.gl.checkFramebufferStatus(36160);if(o!==36053)throw new Error(`Framebuffer ${OB(o)}`)}this.gl.bindFramebuffer(36160,s)}}get texture(){return this.colorAttachments[0]}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}createDepthStencilTexture(n){return new on(this.device,{id:`${this.id}-depth-stencil`,format:n,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(n,r){if(this.handle===null)return this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight);for(const i of this.colorAttachments)i.texture.resize({width:n,height:r});return this.depthStencilAttachment&&this.depthStencilAttachment.texture.resize({width:n,height:r}),this}_attachOne(n,r){if(Array.isArray(r)){const[i,s=0,o=0]=r;return this._attachTexture(n,i,s,o),i}if(r instanceof on)return this._attachTexture(n,r,0,0),r;if(r instanceof Wi){const i=r;return this._attachTexture(n,i.texture,i.props.baseMipLevel,i.props.baseArrayLayer),r.texture}throw new Error("attach")}_attachTexture(n,r,i,s){const{gl:o}=this.device;switch(o.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:o.framebufferTextureLayer(36160,n,r.target,s,i);break;case 34067:const a=NB(i);o.framebufferTexture2D(36160,n,a,r.handle,s);break;case 3553:o.framebufferTexture2D(36160,n,3553,r.handle,s);break;default:ue(!1,"Illegal texture type")}o.bindTexture(r.target,null)}}function NB(t){return t<34069?t+34069:t}function OB(t){switch(t){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${t}`}}class kB extends __{constructor(n,r){super(r);T(this,"device");T(this,"presentationSize");T(this,"_framebuffer",null);this.device=n,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new So(this.device,{handle:null}),this._framebuffer}update(){const n=this.getPixelSize();(n[0]!==this.presentationSize[0]||n[1]!==this.presentationSize[1])&&(this.presentationSize=n,this.resize())}resize(n){if(this.device.gl&&this.canvas){const r=this.getDevicePixelRatio(n==null?void 0:n.useDevicePixels);this.setDevicePixelRatio(r,n);return}}commit(){}}const FB={spector:U.get("spector")||U.get("spectorjs")},DB="https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",BB=1;let se=null,G0=!1;async function LB(t){if(!globalThis.SPECTOR)try{await KE(DB)}catch(e){U.warn(String(e))}}function UB(t){if(t={...FB,...t},!(t!=null&&t.spector)||(!se&&globalThis.SPECTOR&&(U.probe(BB,"SPECTOR found and initialized")(),se=new globalThis.SPECTOR.Spector,globalThis.luma&&(globalThis.luma.spector=se)),!se))return null;if(G0||(G0=!0,se.spyCanvases(),se==null||se.onCaptureStarted.add(e=>U.info("Spector capture started:",e)()),se==null||se.onCapture.add(e=>{U.info("Spector capture complete:",e)(),se==null||se.getResultUI(),se==null||se.resultView.display(),se==null||se.resultView.addCapture(e)})),t!=null&&t.canvas){if(typeof t.spector=="string"&&t.spector!==t.canvas.id)return se;se==null||se.startCapture(t==null?void 0:t.canvas,500),new Promise(e=>setTimeout(e,2e3)).then(e=>{U.info("Spector capture stopped after 2 seconds")(),se==null||se.stopCapture()})}return se}const zB="https://unpkg.com/webgl-debug@2.0.1/index.js";function F1(t){return t.luma=t.luma||{},t.luma}async function VB(){Er()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await KE(zB))}function $B(t,e={}){return t?e.debug?WB(t,e):jB(t):null}function jB(t){const e=F1(t);return e.realContext?e.realContext:t}function WB(t,e){if(!globalThis.WebGLDebugUtils)return U.warn("webgl-debug not loaded")(),t;const n=F1(t);if(n.debugContext)return n.debugContext;globalThis.WebGLDebugUtils.init({...Vi,...t});const r=globalThis.WebGLDebugUtils.makeDebugContext(t,HB.bind(null,e),XB.bind(null,e));for(const o in Vi)!(o in r)&&typeof Vi[o]=="number"&&(r[o]=Vi[o]);class i{}Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.setPrototypeOf(i,r);const s=Object.create(i);return n.realContext=t,n.debugContext=s,s.debug=!0,s}function Ih(t,e){e=Array.from(e).map(r=>r===void 0?"undefined":r);let n=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,e);return n=`${n.slice(0,100)}${n.length>100?"...":""}`,`gl.${t}(${n})`}function HB(t,e,n,r){r=Array.from(r).map(a=>a===void 0?"undefined":a);const i=globalThis.WebGLDebugUtils.glEnumToString(e),s=globalThis.WebGLDebugUtils.glFunctionArgsToString(n,r),o=`${i} in gl.${n}(${s})`;U.error(o)();debugger;if(t.throwOnError)throw new Error(o)}function XB(t,e,n){let r="";if(U.level>=1&&(r=Ih(e,n),U.log(1,r)()),t.break&&t.break.length>0&&(r=r||Ih(e,n),t.break.every(s=>r.indexOf(s)!==-1)))debugger;for(const i of n)if(i===void 0){if(r=r||Ih(e,n),t.throwOnError)throw new Error(`Undefined argument: ${r}`);U.error(`Undefined argument: ${r}`)();debugger}}function YB(t){const e=t.split(/\r?\n/),n=[];for(const r of e){if(r.length<=1)continue;const i=r.split(":");if(i.length===2){const[f,h]=i;n.push({message:h.trim(),type:ev(f),lineNum:0,linePos:0});continue}const[s,o,a,...l]=i;let c=parseInt(a,10);isNaN(c)&&(c=0);let u=parseInt(o,10);isNaN(u)&&(u=0),n.push({message:l.join(":").trim(),type:ev(s),lineNum:c,linePos:u})}return n}function ev(t){const e=["warning","error","info"],n=t.toLowerCase();return e.includes(n)?n:"info"}class KB extends Mc{constructor(n,r){super(n,r);T(this,"device");T(this,"handle");switch(this.device=n,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const n=this.device.gl.getShaderInfoLog(this.handle);return YB(n)}getTranslatedSource(){const r=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return r==null?void 0:r.getTranslatedShaderSource(this.handle)}async _compile(n){n=(s=>s.startsWith("#version ")?s:`#version 100
${s}`)(n);const{gl:i}=this.device;if(i.shaderSource(this.handle,n),i.compileShader(this.handle),U.level===0){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}U.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),U.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const n=async s=>await new Promise(o=>setTimeout(o,s));if(!this.device.features.has("compilation-status-async-webgl")){await n(10);return}const{gl:i}=this.device;for(;;){if(i.getShaderParameter(this.handle,37297))return;await n(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}const qB=256,ZB=1024,QB=16384,Mh=6144,JB=[1,2,4,8];class GB extends Zd{constructor(n,r){super(n,r);T(this,"device");T(this,"glParameters");this.device=n,sf(this.device.gl),this.setParameters(this.props.parameters),this.clear()}end(){ea(this.device.gl)}pushDebugGroup(n){}popDebugGroup(){}insertDebugMarker(n){}setParameters(n={}){const r={...this.glParameters};this.props.framebuffer&&(r.framebuffer=this.props.framebuffer),this.props.depthReadOnly&&(r.depthMask=!this.props.depthReadOnly),r.stencilMask=this.props.stencilReadOnly?0:1,r[35977]=this.props.discard,n.viewport&&(n.viewport.length>=6?(r.viewport=n.viewport.slice(0,4),r.depthRange=[n.viewport[4],n.viewport[5]]):r.viewport=n.viewport),n.scissorRect&&(r.scissorTest=!0,r.scissor=n.scissorRect),n.blendConstant&&(r.blendColor=n.blendConstant),n.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),n[2967]=n.stencilReference),n.colorMask&&(r.colorMask=JB.map(i=>!!(i&n.colorMask))),this.glParameters=r,Ms(this.device.gl,r)}beginOcclusionQuery(n){const r=this.props.occlusionQuerySet;r==null||r.beginOcclusionQuery()}endOcclusionQuery(){const n=this.props.occlusionQuerySet;n==null||n.endOcclusionQuery()}clear(){const n={...this.glParameters};let r=0;this.props.clearColor!==!1&&(r|=QB,n.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(r|=qB,n.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(r|=ZB,n.clearStencil=this.props.clearStencil),r!==0&&tr(this.device.gl,n,()=>{this.device.gl.clear(r)})}clearColorBuffer(n=0,r=[0,0,0,0]){tr(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(r.constructor){case Int32Array:this.device.gl.clearBufferiv(Mh,n,r);break;case Uint32Array:this.device.gl.clearBufferuiv(Mh,n,r);break;case Float32Array:default:this.device.gl.clearBufferfv(Mh,n,r);break}})}}const e6="Failed to deduce GL constant from typed array";function t6(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(e6)}}function mp(t,e){const{clamped:n=!0}=e||{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return n?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}const n6={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},r6={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Eo{constructor(...e){T(this,"offset");T(this,"stride");T(this,"type");T(this,"size");T(this,"divisor");T(this,"normalized");T(this,"integer");T(this,"buffer");T(this,"index");e.forEach(n=>this._assign(n)),Object.freeze(this)}static getBytesPerElement(e){return mp(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return ue(e.size),mp(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(...e){return new Eo(n6,...e)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Eo.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Eo.getBytesPerVertex(this)}_assign(e={}){return e=NO("Accessor",e,r6),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalize!==void 0&&(this.normalized=e.normalize),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this.offset===void 0&&delete this.offset,this.stride===void 0&&delete this.stride,this.type===void 0&&delete this.type,this.size===void 0&&delete this.size,this.divisor===void 0&&delete this.divisor,this.normalized===void 0&&delete this.normalized,this.integer===void 0&&delete this.integer,this.buffer===void 0&&delete this.buffer,this.index===void 0&&delete this.index,this}}function i6(t){return s6.includes(t)}const s6=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],D1={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function B1(t){const e=D1[t];if(!e)throw new Error("uniform");const[n,r,,i]=e;return{format:i,components:r,glType:n}}function o6(t){const e=D1[t];if(!e)throw new Error("attribute");const[,n,,r,i]=e;return{attributeType:r,vertexFormat:i,components:n}}function a6(t,e){const n={attributes:[],bindings:[]};n.attributes=l6(t,e);const r=f6(t,e);for(const a of r){const l=a.uniforms.map(c=>({name:c.name,format:c.format,byteOffset:c.byteOffset,byteStride:c.byteStride,arrayLength:c.arrayLength}));n.bindings.push({type:"uniform",name:a.name,location:a.location,visibility:(a.vertex?1:0)&(a.fragment?2:0),minBindingSize:a.byteLength,uniforms:l})}const i=u6(t,e);let s=0;for(const a of i)if(i6(a.type)){const{viewDimension:l,sampleType:c}=d6(a.type);n.bindings.push({type:"texture",name:a.name,location:s,viewDimension:l,sampleType:c}),a.textureUnit=s,s+=1}i.length&&(n.uniforms=i);const o=c6(t,e);return o!=null&&o.length&&(n.varyings=o),n}function l6(t,e){const n=[],r=t.getProgramParameter(e,35721);for(let i=0;i<r;i++){const s=t.getActiveAttrib(e,i);if(!s)throw new Error("activeInfo");const{name:o,type:a}=s,l=t.getAttribLocation(e,o);if(l>=0){const{attributeType:c}=o6(a),u=/instance/i.test(o)?"instance":"vertex";n.push({name:o,location:l,stepMode:u,type:c})}}return n.sort((i,s)=>i.location-s.location),n}function c6(t,e){const n=[],r=t.getProgramParameter(e,35971);for(let i=0;i<r;i++){const s=t.getTransformFeedbackVarying(e,i);if(!s)throw new Error("activeInfo");const{name:o,type:a,size:l}=s,{glType:c,components:u}=B1(a),f=new Eo({type:c,size:l*u}),h={location:i,name:o,accessor:f};n.push(h)}return n.sort((i,s)=>i.location-s.location),n}function u6(t,e){const n=[],r=t.getProgramParameter(e,35718);for(let i=0;i<r;i++){const s=t.getActiveUniform(e,i);if(!s)throw new Error("activeInfo");const{name:o,size:a,type:l}=s,{name:c,isArray:u}=p6(o);let f=t.getUniformLocation(e,c);const h={location:f,name:c,size:a,type:l,isArray:u};if(n.push(h),h.size>1)for(let d=0;d<h.size;d++){const _=`${c}[${d}]`;f=t.getUniformLocation(e,_);const g={...h,name:_,location:f};n.push(g)}}return n}function f6(t,e){const n=(s,o)=>t.getActiveUniformBlockParameter(e,s,o),r=[],i=t.getProgramParameter(e,35382);for(let s=0;s<i;s++){const o={name:t.getActiveUniformBlockName(e,s)||"",location:n(s,35391),byteLength:n(s,35392),vertex:n(s,35396),fragment:n(s,35398),uniformCount:n(s,35394),uniforms:[]},a=n(s,35395)||[],l=t.getActiveUniforms(e,a,35383),c=t.getActiveUniforms(e,a,35384),u=t.getActiveUniforms(e,a,35387),f=t.getActiveUniforms(e,a,35388);for(let h=0;h<o.uniformCount;++h){const d=t.getActiveUniform(e,a[h]);if(!d)throw new Error("activeInfo");o.uniforms.push({name:d.name,format:B1(l[h]).format,type:l[h],arrayLength:c[h],byteOffset:u[h],byteStride:f[h]})}r.push(o)}return r.sort((s,o)=>s.location-o.location),r}const h6={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function d6(t){const e=h6[t];if(!e)throw new Error("sampler");const[n,r]=e;return{viewDimension:n,sampleType:r}}function p6(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const n=/([^[]*)(\[[0-9]+\])?/.exec(t);if(!n||n.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:n[1],length:n[2]?1:0,isArray:!!n[2]}}function g6(t,e,n,r){const i=t;let s=r;s===!0&&(s=1),s===!1&&(s=0);const o=typeof s=="number"?[s]:s;switch(n){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof r!="number")throw new Error("samplers must be set to integers");return t.uniform1i(e,r);case 5126:return t.uniform1fv(e,o);case 35664:return t.uniform2fv(e,o);case 35665:return t.uniform3fv(e,o);case 35666:return t.uniform4fv(e,o);case 5124:return t.uniform1iv(e,o);case 35667:return t.uniform2iv(e,o);case 35668:return t.uniform3iv(e,o);case 35669:return t.uniform4iv(e,o);case 35670:return t.uniform1iv(e,o);case 35671:return t.uniform2iv(e,o);case 35672:return t.uniform3iv(e,o);case 35673:return t.uniform4iv(e,o);case 5125:return i.uniform1uiv(e,o,1);case 36294:return i.uniform2uiv(e,o,2);case 36295:return i.uniform3uiv(e,o,3);case 36296:return i.uniform4uiv(e,o,4);case 35674:return t.uniformMatrix2fv(e,!1,o);case 35675:return t.uniformMatrix3fv(e,!1,o);case 35676:return t.uniformMatrix4fv(e,!1,o);case 35685:return i.uniformMatrix2x3fv(e,!1,o);case 35686:return i.uniformMatrix2x4fv(e,!1,o);case 35687:return i.uniformMatrix3x2fv(e,!1,o);case 35688:return i.uniformMatrix3x4fv(e,!1,o);case 35689:return i.uniformMatrix4x2fv(e,!1,o);case 35690:return i.uniformMatrix4x3fv(e,!1,o)}throw new Error("Illegal uniform")}function _6(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"line-loop-webgl":return 2;case"triangle-list":return 4;case"triangle-strip":return 5;case"triangle-fan-webgl":return 6;default:throw new Error(t)}}function m6(t){switch(t){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"line-loop-webgl":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;case"triangle-fan-webgl":return 4;default:throw new Error(t)}}const tv=4;class y6 extends _s{constructor(n,r){super(n,r);T(this,"device");T(this,"handle");T(this,"vs");T(this,"fs");T(this,"introspectedLayout");T(this,"uniforms",{});T(this,"bindings",{});T(this,"varyings",null);T(this,"_uniformCount",0);T(this,"_uniformSetters",{});this.device=n,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=r.vs,this.fs=r.fs;const{varyings:i,bufferMode:s=35981}=r;switch(i&&i.length>0&&(this.varyings=i,this.device.gl.transformFeedbackVaryings(this.handle,i,s)),this._linkShaders(),U.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=a6(this.device.gl,this.handle),U.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=vO(this.introspectedLayout,r.shaderLayout),this.props.topology){case"triangle-fan-webgl":case"line-loop-webgl":U.warn(`Primitive topology ${this.props.topology} is deprecated and will be removed in v9.1`);break}}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(n,r){for(const[i,s]of Object.entries(n)){const o=this.shaderLayout.bindings.find(a=>a.name===i)||this.shaderLayout.bindings.find(a=>a.name===`${i}Uniforms`);if(!o){const a=this.shaderLayout.bindings.map(l=>`"${l.name}"`).join(", ");r!=null&&r.disableWarnings||U.warn(`Unknown binding "${i}" in render pipeline "${this.id}", expected one of ${a}`)();continue}switch(s||U.warn(`Unsetting binding "${i}" in render pipeline "${this.id}"`)(),o.type){case"uniform":if(!(s instanceof hr)&&!(s.buffer instanceof hr))throw new Error("buffer value");break;case"texture":if(!(s instanceof Wi||s instanceof on||s instanceof So))throw new Error("texture value");break;case"sampler":U.warn(`Ignoring sampler ${i}`)();break;default:throw new Error(o.type)}this.bindings[i]=s}}draw(n){var b;const{renderPass:r,parameters:i=this.props.parameters,topology:s=this.props.topology,vertexArray:o,vertexCount:a,instanceCount:l,isInstanced:c=!1,firstVertex:u=0,transformFeedback:f}=n,h=_6(s),d=!!o.indexBuffer,_=(b=o.indexBuffer)==null?void 0:b.glIndexType;if(this.linkStatus!=="success")return U.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable()||a===0)return U.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;if(a===0)return U.info(2,`RenderPipeline:${this.id}.draw() aborted - no vertices to draw`)(),!0;this.device.gl.useProgram(this.handle),o.bindBeforeRender(r),f&&f.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const g=r;return SB(this.device,i,g.glParameters,()=>{d&&c?this.device.gl.drawElementsInstanced(h,a||0,_,u,l||0):d?this.device.gl.drawElements(h,a||0,_,u):c?this.device.gl.drawArraysInstanced(h,u,a||0,l||0):this.device.gl.drawArrays(h,u,a||0),f&&f.end()}),o.unbindAfterRender(r),!0}setUniformsWebGL(n){const{bindings:r}=m_(n);Object.keys(r).forEach(i=>{U.warn(`Unsupported value "${JSON.stringify(r[i])}" used in setUniforms() for key ${i}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,n)}async _linkShaders(){const{gl:n}=this.device;if(n.attachShader(this.handle,this.vs.handle),n.attachShader(this.handle,this.fs.handle),U.time(tv,`linkProgram for ${this.id}`)(),n.linkProgram(this.handle),U.timeEnd(tv,`linkProgram for ${this.id}`)(),U.level,!this.device.features.has("compilation-status-async-webgl")){const i=this._getLinkStatus();this._reportLinkStatus(i);return}U.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),U.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const r=this._getLinkStatus();this._reportLinkStatus(r)}_reportLinkStatus(n){var r;switch(n){case"success":return;default:throw this.vs.compilationStatus==="error"?(this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`)):((r=this.fs)==null?void 0:r.compilationStatus)==="error"?(this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`)):new Error(`Error during ${n}: ${this.device.gl.getProgramInfoLog(this.handle)}`)}}_getLinkStatus(){const{gl:n}=this.device;return n.getProgramParameter(this.handle,35714)?(n.validateProgram(this.handle),n.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")):(this.linkStatus="error","linking")}async _waitForLinkComplete(){const n=async s=>await new Promise(o=>setTimeout(o,s));if(!this.device.features.has("compilation-status-async-webgl")){await n(10);return}const{gl:i}=this.device;for(;;){if(i.getProgramParameter(this.handle,37297))return;await n(10)}}_areTexturesRenderable(){let n=!0;for(const[,r]of Object.entries(this.bindings))r instanceof on&&(r.update(),n=n&&r.loaded);return n}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:n}=this.device;n.useProgram(this.handle);let r=0,i=0;for(const s of this.shaderLayout.bindings){const o=this.bindings[s.name]||this.bindings[s.name.replace(/Uniforms$/,"")];if(!o)throw new Error(`No value for binding ${s.name} in ${this.id}`);switch(s.type){case"uniform":const{name:a}=s,l=n.getUniformBlockIndex(this.handle,a);if(l===4294967295)throw new Error(`Invalid uniform block name ${a}`);n.uniformBlockBinding(this.handle,i,l),o instanceof hr?n.bindBufferBase(35345,i,o.handle):n.bindBufferRange(35345,i,o.buffer.handle,o.offset||0,o.size||o.buffer.byteLength-o.offset),i+=1;break;case"texture":if(!(o instanceof Wi||o instanceof on||o instanceof So))throw new Error("texture");let c;if(o instanceof Wi)c=o.texture;else if(o instanceof on)c=o;else if(o instanceof So&&o.colorAttachments[0]instanceof Wi)U.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),c=o.colorAttachments[0].texture;else throw new Error("No texture");n.activeTexture(33984+r),n.bindTexture(c.target,c.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${s.type}' not supported in WebGL`)}}}_applyUniforms(){for(const n of this.shaderLayout.uniforms||[]){const{name:r,location:i,type:s,textureUnit:o}=n,a=this.uniforms[r]??o;a!==void 0&&g6(this.device.gl,i,s,a)}}}class v6 extends Jd{constructor(n){super(n,{});T(this,"device");T(this,"commands",[]);this.device=n}submitCommands(n=this.commands){for(const r of n)switch(r.name){case"copy-buffer-to-buffer":T6(this.device,r.options);break;case"copy-buffer-to-texture":w6(this.device,r.options);break;case"copy-texture-to-buffer":S6(this.device,r.options);break;case"copy-texture-to-texture":E6(this.device,r.options);break}}}function T6(t,e){const n=e.source,r=e.destination;t.gl.bindBuffer(36662,n.handle),t.gl.bindBuffer(36663,r.handle),t.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),t.gl.bindBuffer(36662,null),t.gl.bindBuffer(36663,null)}function w6(t,e){throw new Error("Not implemented")}function S6(t,e){const{source:n,mipLevel:r=0,aspect:i="all",width:s=e.source.width,height:o=e.source.height,depthOrArrayLayers:a=0,origin:l=[0,0],destination:c,byteOffset:u=0,bytesPerRow:f,rowsPerImage:h}=e;if(i!=="all")throw new Error("not supported");if(r!==0||a!==0||f||h)throw new Error("not implemented");const{framebuffer:d,destroyFramebuffer:_}=L1(n);let g;try{const b=c,m=s||d.width,p=o||d.height,y=Wc(d.texture.props.format),S=y.dataFormat,R=y.type;t.gl.bindBuffer(35051,b.handle),g=t.gl.bindFramebuffer(36160,d.handle),t.gl.readPixels(l[0],l[1],m,p,S,R,u)}finally{t.gl.bindBuffer(35051,null),g!==void 0&&t.gl.bindFramebuffer(36160,g),_&&d.destroy()}}function E6(t,e){const{source:n,destinationMipLevel:r=0,origin:i=[0,0],destinationOrigin:s=[0,0],destination:o}=e;let{width:a=e.destination.width,height:l=e.destination.height}=e;const{framebuffer:c,destroyFramebuffer:u}=L1(n),[f,h]=i,[d,_,g]=s,b=t.gl.bindFramebuffer(36160,c.handle);let m=null,p;if(o instanceof on)m=o,a=Number.isFinite(a)?a:m.width,l=Number.isFinite(l)?l:m.height,m.bind(0),p=m.target;else throw new Error("invalid destination");switch(p){case 3553:case 34067:t.gl.copyTexSubImage2D(p,r,d,_,f,h,a,l);break;case 35866:case 32879:t.gl.copyTexSubImage3D(p,r,d,_,g,f,h,a,l);break}m&&m.unbind(),t.gl.bindFramebuffer(36160,b),u&&c.destroy()}function L1(t){if(t instanceof bt){const{width:e,height:n,id:r}=t;return{framebuffer:t.device.createFramebuffer({id:`framebuffer-for-${r}`,width:e,height:n,colorAttachments:[t]}),destroyFramebuffer:!0}}return{framebuffer:t,destroyFramebuffer:!1}}class b6 extends Qd{constructor(n,r){super(n,r);T(this,"device");T(this,"commandBuffer");this.device=n,this.commandBuffer=new v6(n)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(n){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:n})}copyBufferToTexture(n){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:n})}copyTextureToBuffer(n){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:n})}copyTextureToTexture(n){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:n})}pushDebugGroup(n){}popDebugGroup(){}insertDebugMarker(n){}resolveQuerySet(n,r,i){}}class R_ extends Gd{constructor(n,r){super(n,r);T(this,"device");T(this,"handle");T(this,"buffer",null);T(this,"bufferValue",null);this.device=n,this.handle=this.device.gl.createVertexArray()}get[Symbol.toStringTag](){return"VertexArray"}static isConstantAttributeZeroSupported(n){return U2()==="Chrome"}destroy(){var n;super.destroy(),this.buffer&&((n=this.buffer)==null||n.destroy()),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(n){const r=n;if(r&&r.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,r?r.handle:null),this.indexBuffer=r,this.device.gl.bindVertexArray(null)}setBuffer(n,r){const i=r;if(i.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:s,type:o,stride:a,offset:l,normalized:c,integer:u,divisor:f}=this._getAccessor(n);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,i.handle),u?this.device.gl.vertexAttribIPointer(n,s,o,a,l):this.device.gl.vertexAttribPointer(n,s,o,c,a,l),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(n),this.device.gl.vertexAttribDivisor(n,f||0),this.attributes[n]=i,this.device.gl.bindVertexArray(null)}setConstantWebGL(n,r){this._enable(n,!1),this.attributes[n]=r}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let n=0;n<this.maxVertexAttributes;++n){const r=this.attributes[n];ArrayBuffer.isView(r)&&this.device.setConstantAttributeWebGL(n,r)}}_getAccessor(n){const r=this.attributeInfos[n];if(!r)throw new Error(`Unknown attribute location ${n}`);const i=M1(r.bufferDataType);return{size:r.bufferComponents,type:i,stride:r.byteStride,offset:r.byteOffset,normalized:r.normalized,integer:r.integer,divisor:r.stepMode==="instance"?1:0}}_enable(n,r=!0){const s=R_.isConstantAttributeZeroSupported(this.device)||n!==0;(r||s)&&(n=Number(n),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(n):this.device.gl.disableVertexAttribArray(n),this.device.gl.bindVertexArray(null))}getConstantBuffer(n,r){const i=A6(r),s=i.byteLength*n,o=i.length*n;if(this.buffer&&s!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${s} !== ${this.buffer.byteLength}.`);let a=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:s}),a=a||!R6(i,this.bufferValue),a){const l=EO(r.constructor,o);bO({target:l,source:i,start:0,count:o}),this.buffer.write(l),this.bufferValue=r}return this.buffer}}function A6(t){return Array.isArray(t)?new Float32Array(t):t}function R6(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}class x6 extends ep{constructor(n,r){super(n,r);T(this,"device");T(this,"gl");T(this,"handle");T(this,"layout");T(this,"buffers",{});T(this,"unusedBuffers",{});T(this,"bindOnUse",!0);T(this,"_bound",!1);this.device=n,this.gl=n.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,r.buffers&&this.setBuffers(r.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(n="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(m6(n))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(n){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const r in n)this.setBuffer(r,n[r])})}setBuffer(n,r){const i=this._getVaryingIndex(n),{buffer:s,byteLength:o,byteOffset:a}=this._getBufferRange(r);if(i<0){this.unusedBuffers[n]=s,U.warn(`${this.id} unusedBuffers varying buffer ${n}`)();return}this.buffers[i]={buffer:s,byteLength:o,byteOffset:a},this.bindOnUse||this._bindBuffer(i,s,a,o)}getBuffer(n){if(nv(n))return this.buffers[n]||null;const r=this._getVaryingIndex(n);return r>=0?this.buffers[r]:null}bind(n=this.handle){if(typeof n!="function")return this.gl.bindTransformFeedback(36386,n),this;let r;return this._bound?r=n():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,r=n(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),r}unbind(){this.bind(null)}_getBufferRange(n){if(n instanceof hr)return{buffer:n,byteOffset:0,byteLength:n.byteLength};const{buffer:r,byteOffset:i=0,byteLength:s=n.buffer.byteLength}=n;return{buffer:r,byteOffset:i,byteLength:s}}_getVaryingIndex(n){if(nv(n))return Number(n);for(const r of this.layout.varyings)if(n===r.name)return r.location;return-1}_bindBuffers(){for(const n in this.buffers){const{buffer:r,byteLength:i,byteOffset:s}=this._getBufferRange(this.buffers[n]);this._bindBuffer(Number(n),r,s,i)}}_unbindBuffers(){for(const n in this.buffers)this.gl.bindBufferBase(35982,Number(n),null)}_bindBuffer(n,r,i=0,s){const o=r&&r.handle;!o||s===void 0?this.gl.bindBufferBase(35982,n,o):this.gl.bindBufferRange(35982,n,o,i,s)}}function nv(t){return typeof t=="number"?Number.isInteger(t):/^\d+$/.test(t)}class C6 extends tp{constructor(n,r){super(n,r);T(this,"device");T(this,"handle");T(this,"target",null);T(this,"_queryPending",!1);T(this,"_pollingPromise",null);if(this.device=n,r.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}get[Symbol.toStringTag](){return"Query"}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(n){return this._begin(n!=null&&n.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(n){this._queryPending||(this.target=n,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const n=this.device.gl.getQueryParameter(this.handle,34919);return n&&(this._queryPending=!1),n}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(n=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let r=0;return this._pollingPromise=new Promise((i,s)=>{const o=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):r++>n?(s("Timed out"),this._pollingPromise=null):requestAnimationFrame(o)};requestAnimationFrame(o)}),this._pollingPromise}}function U1(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return ue(!1),0}}function P6(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return ue(!1),0}}function I6(t,e){var b,m;const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408,sourceAttachment:s=36064}=e||{};let{target:o=null,sourceWidth:a,sourceHeight:l,sourceType:c}=e||{};const{framebuffer:u,deleteFramebuffer:f}=z1(t);ue(u);const{gl:h,handle:d}=u;a=a||u.width,l=l||u.height;const _=s-36064;c=c||((m=(b=u.colorAttachments[_])==null?void 0:b.texture)==null?void 0:m.type)||5121,o=O6(o,c,i,a,l),c=c||t6(o);const g=h.bindFramebuffer(36160,d);return h.readPixels(n,r,a,l,i,c,o),h.bindFramebuffer(36160,g||null),f&&u.destroy(),o}function M6(t,e){const{target:n,sourceX:r=0,sourceY:i=0,sourceFormat:s=6408,targetByteOffset:o=0}=e||{};let{sourceWidth:a,sourceHeight:l,sourceType:c}=e||{};const{framebuffer:u,deleteFramebuffer:f}=z1(t);ue(u),a=a||u.width,l=l||u.height;const h=u;c=c||5121;let d=n;if(!d){const g=U1(s),b=P6(c),m=o+a*l*g*b;d=h.device.createBuffer({byteLength:m})}const _=t.device.createCommandEncoder();return _.copyTextureToBuffer({source:t,width:a,height:l,origin:[r,i],destination:d,byteOffset:o}),_.destroy(),f&&u.destroy(),d}function z1(t){return t instanceof Oc?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:N6(t),deleteFramebuffer:!0}}function N6(t,e){const{device:n,width:r,height:i,id:s}=t;return n.createFramebuffer({...e,id:`framebuffer-for-${s}`,width:r,height:i,colorAttachments:[t]})}function O6(t,e,n,r,i){if(t)return t;e=e||5121;const s=mp(e,{clamped:!1}),o=U1(n);return new s(r*i*o)}const k6=256,F6=1024,D6=16384,B6="clear: bad arguments";function L6(t,e){const{framebuffer:n=null,color:r=null,depth:i=null,stencil:s=null}=e||{},o={};n&&(o.framebuffer=n);let a=0;r&&(a|=D6,r!==!0&&(o.clearColor=r)),i&&(a|=k6,i!==!0&&(o.clearDepth=i)),s&&(a|=F6,i!==!0&&(o.clearStencil=i)),ue(a!==0,B6);const l=t.gl;tr(l,o,()=>{l.clear(a)})}const Js=1,Br=class Br extends gs{constructor(n){var l,c;super({...n,id:n.id||ui("webgl-device")});T(this,"type","webgl");T(this,"handle");T(this,"features");T(this,"limits");T(this,"info");T(this,"canvasContext");T(this,"lost");T(this,"_resolveContextLost");T(this,"renderPass",null);T(this,"gl");T(this,"debug",!1);T(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1});T(this,"_extensions",{});T(this,"_polyfilled",!1);T(this,"spectorJS");T(this,"_constants");const r=(l=n.gl)==null?void 0:l.device;if(r)throw new Error(`WebGL context already attached to device ${r.id}`);const i=((c=n.gl)==null?void 0:c.canvas)||n.canvas;this.canvasContext=new kB(this,{...n,canvas:i}),this.lost=new Promise(u=>{this._resolveContextLost=u});let s=n.gl||null;if(s||(s=G4(this.canvasContext.canvas,{...n,onContextLost:u=>{var f;return(f=this._resolveContextLost)==null?void 0:f.call(this,{reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."})}})),!s)throw new Error("WebGL context creation failed");this.handle=s,this.gl=s,this.gl.device=this,this.gl._version=2,n.spector&&(this.spectorJS=UB({...this.props,canvas:this.handle.canvas})),this.info=eB(this.gl,this._extensions),this.limits=new TB(this.gl),this.features=new vB(this.gl,this._extensions,this.props.disabledFeatures),this.props.initalizeFeatures&&this.features.initializeFeatures(),this.canvasContext.resize();const{enable:o=!0,copyState:a=!1}=n;P1(this.gl,{enable:o,copyState:a,log:(...u)=>U.log(1,...u)()}),n.debug&&(this.gl=$B(this.gl,{...n,throwOnError:!0}),this.debug=!0,U.level=Math.max(U.level,1),U.warn("WebGL debug mode activated. Performance reduced.")())}static isSupported(){return typeof WebGL2RenderingContext<"u"}static attach(n){if(n instanceof Br)return n;if((n==null?void 0:n.device)instanceof gs)return n.device;if(!U6(n))throw new Error("Invalid WebGL2RenderingContext");return new Br({gl:n})}static async create(n={}){var a;U.groupCollapsed(Js,"WebGLDevice created")();const r=[];n.debug&&r.push(VB()),n.spector&&r.push(LB()),typeof n.canvas=="string"&&r.push(__.pageLoaded);const i=await Promise.allSettled(r);for(const l of i)l.status==="rejected"&&U.error(`Failed to initialize debug libraries ${l.reason}`)();if(U.probe(Js+1,"DOM is loaded")(),(a=n.gl)!=null&&a.device)return U.warn("reattaching existing device")(),Br.attach(n.gl);const s=new Br(n),o=`Created ${s.type}${s.debug?" debug":""} context: ${s.info.vendor}, ${s.info.renderer} for canvas: ${s.canvasContext.id}`;return U.probe(Js,o)(),U.table(Js,s.info)(),U.groupEnd(Js)(),s}destroy(){}get isLost(){return this.gl.isContextLost()}getSize(){return[this.gl.drawingBufferWidth,this.gl.drawingBufferHeight]}isTextureFormatSupported(n){return A_(this.gl,n,this._extensions)}isTextureFormatFilterable(n){return gB(this.gl,n,this._extensions)}isTextureFormatRenderable(n){return _B(this.gl,n,this._extensions)}createCanvasContext(n){throw new Error("WebGL only supports a single canvas")}createBuffer(n){const r=this._getBufferProps(n);return new hr(this,r)}_createTexture(n){return new on(this,n)}createExternalTexture(n){throw new Error("createExternalTexture() not implemented")}createSampler(n){return new _p(this,n)}createShader(n){return new KB(this,n)}createFramebuffer(n){return new So(this,n)}createVertexArray(n){return new R_(this,n)}createTransformFeedback(n){return new x6(this,n)}createQuerySet(n){return new C6(this,n)}createRenderPipeline(n){return new y6(this,n)}beginRenderPass(n){return new GB(this,n)}createComputePipeline(n){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(n){throw new Error("ComputePass not supported in WebGL")}createCommandEncoder(n){return new b6(this,n)}submit(){var n;(n=this.renderPass)==null||n.end(),this.renderPass=null}readPixelsToArrayWebGL(n,r){return I6(n,r)}readPixelsToBufferWebGL(n,r){return M6(n,r)}setParametersWebGL(n){Ms(this.gl,n)}getParametersWebGL(n){return C1(this.gl,n)}withParametersWebGL(n,r){return tr(this.gl,n,r)}clearWebGL(n){L6(this,n)}resetWebGL(){U.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),X4(this.gl)}loseDevice(){var s;let n=!1;const i=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return i&&(n=!0,i.loseContext()),(s=this._resolveContextLost)==null||s.call(this,{reason:"destroyed",message:"Application triggered context loss"}),n}pushState(){sf(this.gl)}popState(){ea(this.gl)}setSpectorMetadata(n,r){n.__SPECTOR_Metadata=r}getGLKey(n,r){r=r||this.gl2||this.gl;const i=Number(n);for(const s in r)if(r[s]===i)return`GL.${s}`;return String(n)}setConstantAttributeWebGL(n,r){const i=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(i).fill(null);const s=this._constants[n];switch(s&&j6(s,r)&&U.info(1,`setConstantAttributeWebGL(${n}) could have been skipped, value unchanged`)(),this._constants[n]=r,r.constructor){case Float32Array:z6(this,n,r);break;case Int32Array:V6(this,n,r);break;case Uint32Array:$6(this,n,r);break;default:ue(!1)}}getExtension(n){return _r(this.gl,n,this._extensions),this._extensions}};T(Br,"type","webgl");let bo=Br;function U6(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function z6(t,e,n){switch(n.length){case 1:t.gl.vertexAttrib1fv(e,n);break;case 2:t.gl.vertexAttrib2fv(e,n);break;case 3:t.gl.vertexAttrib3fv(e,n);break;case 4:t.gl.vertexAttrib4fv(e,n);break;default:ue(!1)}}function V6(t,e,n){t.gl.vertexAttribI4iv(e,n)}function $6(t,e,n){t.gl.vertexAttribI4uiv(e,n)}function j6(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}var V1={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var s=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),a="function",l=Math.round,c=Math.abs,u=Date.now;function f(v,w,A){return setTimeout(y(v,A),w)}function h(v,w,A){return Array.isArray(v)?(d(v,A[w],A),!0):!1}function d(v,w,A){var N;if(v)if(v.forEach)v.forEach(w,A);else if(v.length!==i)for(N=0;N<v.length;)w.call(A,v[N],N,v),N++;else for(N in v)v.hasOwnProperty(N)&&w.call(A,v[N],N,v)}function _(v,w,A){var N="DEPRECATED METHOD: "+w+`
`+A+` AT 
`;return function(){var B=new Error("get-stack-trace"),j=B&&B.stack?B.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Q=e.console&&(e.console.warn||e.console.log);return Q&&Q.call(e.console,N,j),v.apply(this,arguments)}}var g;typeof Object.assign!="function"?g=function(w){if(w===i||w===null)throw new TypeError("Cannot convert undefined or null to object");for(var A=Object(w),N=1;N<arguments.length;N++){var B=arguments[N];if(B!==i&&B!==null)for(var j in B)B.hasOwnProperty(j)&&(A[j]=B[j])}return A}:g=Object.assign;var b=_(function(w,A,N){for(var B=Object.keys(A),j=0;j<B.length;)(!N||N&&w[B[j]]===i)&&(w[B[j]]=A[B[j]]),j++;return w},"extend","Use `assign`."),m=_(function(w,A){return b(w,A,!0)},"merge","Use `assign`.");function p(v,w,A){var N=w.prototype,B;B=v.prototype=Object.create(N),B.constructor=v,B._super=N,A&&g(B,A)}function y(v,w){return function(){return v.apply(w,arguments)}}function S(v,w){return typeof v==a?v.apply(w&&w[0]||i,w):v}function R(v,w){return v===i?w:v}function P(v,w,A){d(z(w),function(N){v.addEventListener(N,A,!1)})}function O(v,w,A){d(z(w),function(N){v.removeEventListener(N,A,!1)})}function k(v,w){for(;v;){if(v==w)return!0;v=v.parentNode}return!1}function D(v,w){return v.indexOf(w)>-1}function z(v){return v.trim().split(/\s+/g)}function H(v,w,A){if(v.indexOf&&!A)return v.indexOf(w);for(var N=0;N<v.length;){if(A&&v[N][A]==w||!A&&v[N]===w)return N;N++}return-1}function X(v){return Array.prototype.slice.call(v,0)}function Y(v,w,A){for(var N=[],B=[],j=0;j<v.length;){var Q=w?v[j][w]:v[j];H(B,Q)<0&&N.push(v[j]),B[j]=Q,j++}return A&&(w?N=N.sort(function(Be,Qe){return Be[w]>Qe[w]}):N=N.sort()),N}function Z(v,w){for(var A,N,B=w[0].toUpperCase()+w.slice(1),j=0;j<s.length;){if(A=s[j],N=A?A+B:w,N in v)return N;j++}return i}var je=1;function br(){return je++}function Bn(v){var w=v.ownerDocument||v;return w.defaultView||w.parentWindow||e}var $=/mobile|tablet|ip(ad|hone|od)|android/i,K="ontouchstart"in e,q=Z(e,"PointerEvent")!==i,fe=K&&$.test(navigator.userAgent),le="touch",Ln="pen",lt="mouse",Ar="kinect",It=25,Se=1,dn=2,Ee=4,We=8,hi=1,Rr=2,xr=4,Cr=8,Pr=16,yt=Rr|xr,pn=Cr|Pr,Ca=yt|pn,Pa=["x","y"],Ns=["clientX","clientY"];function vt(v,w){var A=this;this.manager=v,this.callback=w,this.element=v.element,this.target=v.options.inputTarget,this.domHandler=function(N){S(v.options.enable,[v])&&A.handler(N)},this.init()}vt.prototype={handler:function(){},init:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(Bn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&O(this.element,this.evEl,this.domHandler),this.evTarget&&O(this.target,this.evTarget,this.domHandler),this.evWin&&O(Bn(this.element),this.evWin,this.domHandler)}};function Rb(v){var w,A=v.options.inputClass;return A?w=A:q?w=hf:fe?w=Na:K?w=df:w=Ma,new w(v,xb)}function xb(v,w,A){var N=A.pointers.length,B=A.changedPointers.length,j=w&Se&&N-B===0,Q=w&(Ee|We)&&N-B===0;A.isFirst=!!j,A.isFinal=!!Q,j&&(v.session={}),A.eventType=w,Cb(v,A),v.emit("hammer.input",A),v.recognize(A),v.session.prevInput=A}function Cb(v,w){var A=v.session,N=w.pointers,B=N.length;A.firstInput||(A.firstInput=O_(w)),B>1&&!A.firstMultiple?A.firstMultiple=O_(w):B===1&&(A.firstMultiple=!1);var j=A.firstInput,Q=A.firstMultiple,Oe=Q?Q.center:j.center,Be=w.center=k_(N);w.timeStamp=u(),w.deltaTime=w.timeStamp-j.timeStamp,w.angle=ff(Oe,Be),w.distance=Ia(Oe,Be),Pb(A,w),w.offsetDirection=D_(w.deltaX,w.deltaY);var Qe=F_(w.deltaTime,w.deltaX,w.deltaY);w.overallVelocityX=Qe.x,w.overallVelocityY=Qe.y,w.overallVelocity=c(Qe.x)>c(Qe.y)?Qe.x:Qe.y,w.scale=Q?Nb(Q.pointers,N):1,w.rotation=Q?Mb(Q.pointers,N):0,w.maxPointers=A.prevInput?w.pointers.length>A.prevInput.maxPointers?w.pointers.length:A.prevInput.maxPointers:w.pointers.length,Ib(A,w);var Xt=v.element;k(w.srcEvent.target,Xt)&&(Xt=w.srcEvent.target),w.target=Xt}function Pb(v,w){var A=w.center,N=v.offsetDelta||{},B=v.prevDelta||{},j=v.prevInput||{};(w.eventType===Se||j.eventType===Ee)&&(B=v.prevDelta={x:j.deltaX||0,y:j.deltaY||0},N=v.offsetDelta={x:A.x,y:A.y}),w.deltaX=B.x+(A.x-N.x),w.deltaY=B.y+(A.y-N.y)}function Ib(v,w){var A=v.lastInterval||w,N=w.timeStamp-A.timeStamp,B,j,Q,Oe;if(w.eventType!=We&&(N>It||A.velocity===i)){var Be=w.deltaX-A.deltaX,Qe=w.deltaY-A.deltaY,Xt=F_(N,Be,Qe);j=Xt.x,Q=Xt.y,B=c(Xt.x)>c(Xt.y)?Xt.x:Xt.y,Oe=D_(Be,Qe),v.lastInterval=w}else B=A.velocity,j=A.velocityX,Q=A.velocityY,Oe=A.direction;w.velocity=B,w.velocityX=j,w.velocityY=Q,w.direction=Oe}function O_(v){for(var w=[],A=0;A<v.pointers.length;)w[A]={clientX:l(v.pointers[A].clientX),clientY:l(v.pointers[A].clientY)},A++;return{timeStamp:u(),pointers:w,center:k_(w),deltaX:v.deltaX,deltaY:v.deltaY}}function k_(v){var w=v.length;if(w===1)return{x:l(v[0].clientX),y:l(v[0].clientY)};for(var A=0,N=0,B=0;B<w;)A+=v[B].clientX,N+=v[B].clientY,B++;return{x:l(A/w),y:l(N/w)}}function F_(v,w,A){return{x:w/v||0,y:A/v||0}}function D_(v,w){return v===w?hi:c(v)>=c(w)?v<0?Rr:xr:w<0?Cr:Pr}function Ia(v,w,A){A||(A=Pa);var N=w[A[0]]-v[A[0]],B=w[A[1]]-v[A[1]];return Math.sqrt(N*N+B*B)}function ff(v,w,A){A||(A=Pa);var N=w[A[0]]-v[A[0]],B=w[A[1]]-v[A[1]];return Math.atan2(B,N)*180/Math.PI}function Mb(v,w){return ff(w[1],w[0],Ns)+ff(v[1],v[0],Ns)}function Nb(v,w){return Ia(w[0],w[1],Ns)/Ia(v[0],v[1],Ns)}var Ob={mousedown:Se,mousemove:dn,mouseup:Ee},kb="mousedown",Fb="mousemove mouseup";function Ma(){this.evEl=kb,this.evWin=Fb,this.pressed=!1,vt.apply(this,arguments)}p(Ma,vt,{handler:function(w){var A=Ob[w.type];A&Se&&w.button===0&&(this.pressed=!0),A&dn&&w.which!==1&&(A=Ee),this.pressed&&(A&Ee&&(this.pressed=!1),this.callback(this.manager,A,{pointers:[w],changedPointers:[w],pointerType:lt,srcEvent:w}))}});var Db={pointerdown:Se,pointermove:dn,pointerup:Ee,pointercancel:We,pointerout:We},Bb={2:le,3:Ln,4:lt,5:Ar},B_="pointerdown",L_="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(B_="MSPointerDown",L_="MSPointerMove MSPointerUp MSPointerCancel");function hf(){this.evEl=B_,this.evWin=L_,vt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}p(hf,vt,{handler:function(w){var A=this.store,N=!1,B=w.type.toLowerCase().replace("ms",""),j=Db[B],Q=Bb[w.pointerType]||w.pointerType,Oe=Q==le,Be=H(A,w.pointerId,"pointerId");j&Se&&(w.button===0||Oe)?Be<0&&(A.push(w),Be=A.length-1):j&(Ee|We)&&(N=!0),!(Be<0)&&(A[Be]=w,this.callback(this.manager,j,{pointers:A,changedPointers:[w],pointerType:Q,srcEvent:w}),N&&A.splice(Be,1))}});var Lb={touchstart:Se,touchmove:dn,touchend:Ee,touchcancel:We},Ub="touchstart",zb="touchstart touchmove touchend touchcancel";function U_(){this.evTarget=Ub,this.evWin=zb,this.started=!1,vt.apply(this,arguments)}p(U_,vt,{handler:function(w){var A=Lb[w.type];if(A===Se&&(this.started=!0),!!this.started){var N=Vb.call(this,w,A);A&(Ee|We)&&N[0].length-N[1].length===0&&(this.started=!1),this.callback(this.manager,A,{pointers:N[0],changedPointers:N[1],pointerType:le,srcEvent:w})}}});function Vb(v,w){var A=X(v.touches),N=X(v.changedTouches);return w&(Ee|We)&&(A=Y(A.concat(N),"identifier",!0)),[A,N]}var $b={touchstart:Se,touchmove:dn,touchend:Ee,touchcancel:We},jb="touchstart touchmove touchend touchcancel";function Na(){this.evTarget=jb,this.targetIds={},vt.apply(this,arguments)}p(Na,vt,{handler:function(w){var A=$b[w.type],N=Wb.call(this,w,A);N&&this.callback(this.manager,A,{pointers:N[0],changedPointers:N[1],pointerType:le,srcEvent:w})}});function Wb(v,w){var A=X(v.touches),N=this.targetIds;if(w&(Se|dn)&&A.length===1)return N[A[0].identifier]=!0,[A,A];var B,j,Q=X(v.changedTouches),Oe=[],Be=this.target;if(j=A.filter(function(Qe){return k(Qe.target,Be)}),w===Se)for(B=0;B<j.length;)N[j[B].identifier]=!0,B++;for(B=0;B<Q.length;)N[Q[B].identifier]&&Oe.push(Q[B]),w&(Ee|We)&&delete N[Q[B].identifier],B++;if(Oe.length)return[Y(j.concat(Oe),"identifier",!0),Oe]}var Hb=2500,z_=25;function df(){vt.apply(this,arguments);var v=y(this.handler,this);this.touch=new Na(this.manager,v),this.mouse=new Ma(this.manager,v),this.primaryTouch=null,this.lastTouches=[]}p(df,vt,{handler:function(w,A,N){var B=N.pointerType==le,j=N.pointerType==lt;if(!(j&&N.sourceCapabilities&&N.sourceCapabilities.firesTouchEvents)){if(B)Xb.call(this,A,N);else if(j&&Yb.call(this,N))return;this.callback(w,A,N)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Xb(v,w){v&Se?(this.primaryTouch=w.changedPointers[0].identifier,V_.call(this,w)):v&(Ee|We)&&V_.call(this,w)}function V_(v){var w=v.changedPointers[0];if(w.identifier===this.primaryTouch){var A={x:w.clientX,y:w.clientY};this.lastTouches.push(A);var N=this.lastTouches,B=function(){var j=N.indexOf(A);j>-1&&N.splice(j,1)};setTimeout(B,Hb)}}function Yb(v){for(var w=v.srcEvent.clientX,A=v.srcEvent.clientY,N=0;N<this.lastTouches.length;N++){var B=this.lastTouches[N],j=Math.abs(w-B.x),Q=Math.abs(A-B.y);if(j<=z_&&Q<=z_)return!0}return!1}var $_=Z(o.style,"touchAction"),j_=$_!==i,W_="compute",H_="auto",pf="manipulation",Ir="none",Os="pan-x",ks="pan-y",Oa=qb();function gf(v,w){this.manager=v,this.set(w)}gf.prototype={set:function(v){v==W_&&(v=this.compute()),j_&&this.manager.element.style&&Oa[v]&&(this.manager.element.style[$_]=v),this.actions=v.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var v=[];return d(this.manager.recognizers,function(w){S(w.options.enable,[w])&&(v=v.concat(w.getTouchAction()))}),Kb(v.join(" "))},preventDefaults:function(v){var w=v.srcEvent,A=v.offsetDirection;if(this.manager.session.prevented){w.preventDefault();return}var N=this.actions,B=D(N,Ir)&&!Oa[Ir],j=D(N,ks)&&!Oa[ks],Q=D(N,Os)&&!Oa[Os];if(B){var Oe=v.pointers.length===1,Be=v.distance<2,Qe=v.deltaTime<250;if(Oe&&Be&&Qe)return}if(!(Q&&j)&&(B||j&&A&yt||Q&&A&pn))return this.preventSrc(w)},preventSrc:function(v){this.manager.session.prevented=!0,v.preventDefault()}};function Kb(v){if(D(v,Ir))return Ir;var w=D(v,Os),A=D(v,ks);return w&&A?Ir:w||A?w?Os:ks:D(v,pf)?pf:H_}function qb(){if(!j_)return!1;var v={},w=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(A){v[A]=w?e.CSS.supports("touch-action",A):!0}),v}var ka=1,Tt=2,di=4,Un=8,gn=Un,Fs=16,Ht=32;function _n(v){this.options=g({},this.defaults,v||{}),this.id=br(),this.manager=null,this.options.enable=R(this.options.enable,!0),this.state=ka,this.simultaneous={},this.requireFail=[]}_n.prototype={defaults:{},set:function(v){return g(this.options,v),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(v){if(h(v,"recognizeWith",this))return this;var w=this.simultaneous;return v=Fa(v,this),w[v.id]||(w[v.id]=v,v.recognizeWith(this)),this},dropRecognizeWith:function(v){return h(v,"dropRecognizeWith",this)?this:(v=Fa(v,this),delete this.simultaneous[v.id],this)},requireFailure:function(v){if(h(v,"requireFailure",this))return this;var w=this.requireFail;return v=Fa(v,this),H(w,v)===-1&&(w.push(v),v.requireFailure(this)),this},dropRequireFailure:function(v){if(h(v,"dropRequireFailure",this))return this;v=Fa(v,this);var w=H(this.requireFail,v);return w>-1&&this.requireFail.splice(w,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(v){return!!this.simultaneous[v.id]},emit:function(v){var w=this,A=this.state;function N(B){w.manager.emit(B,v)}A<Un&&N(w.options.event+X_(A)),N(w.options.event),v.additionalEvent&&N(v.additionalEvent),A>=Un&&N(w.options.event+X_(A))},tryEmit:function(v){if(this.canEmit())return this.emit(v);this.state=Ht},canEmit:function(){for(var v=0;v<this.requireFail.length;){if(!(this.requireFail[v].state&(Ht|ka)))return!1;v++}return!0},recognize:function(v){var w=g({},v);if(!S(this.options.enable,[this,w])){this.reset(),this.state=Ht;return}this.state&(gn|Fs|Ht)&&(this.state=ka),this.state=this.process(w),this.state&(Tt|di|Un|Fs)&&this.tryEmit(w)},process:function(v){},getTouchAction:function(){},reset:function(){}};function X_(v){return v&Fs?"cancel":v&Un?"end":v&di?"move":v&Tt?"start":""}function Y_(v){return v==Pr?"down":v==Cr?"up":v==Rr?"left":v==xr?"right":""}function Fa(v,w){var A=w.manager;return A?A.get(v):v}function Mt(){_n.apply(this,arguments)}p(Mt,_n,{defaults:{pointers:1},attrTest:function(v){var w=this.options.pointers;return w===0||v.pointers.length===w},process:function(v){var w=this.state,A=v.eventType,N=w&(Tt|di),B=this.attrTest(v);return N&&(A&We||!B)?w|Fs:N||B?A&Ee?w|Un:w&Tt?w|di:Tt:Ht}});function Da(){Mt.apply(this,arguments),this.pX=null,this.pY=null}p(Da,Mt,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ca},getTouchAction:function(){var v=this.options.direction,w=[];return v&yt&&w.push(ks),v&pn&&w.push(Os),w},directionTest:function(v){var w=this.options,A=!0,N=v.distance,B=v.direction,j=v.deltaX,Q=v.deltaY;return B&w.direction||(w.direction&yt?(B=j===0?hi:j<0?Rr:xr,A=j!=this.pX,N=Math.abs(v.deltaX)):(B=Q===0?hi:Q<0?Cr:Pr,A=Q!=this.pY,N=Math.abs(v.deltaY))),v.direction=B,A&&N>w.threshold&&B&w.direction},attrTest:function(v){return Mt.prototype.attrTest.call(this,v)&&(this.state&Tt||!(this.state&Tt)&&this.directionTest(v))},emit:function(v){this.pX=v.deltaX,this.pY=v.deltaY;var w=Y_(v.direction);w&&(v.additionalEvent=this.options.event+w),this._super.emit.call(this,v)}});function _f(){Mt.apply(this,arguments)}p(_f,Mt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ir]},attrTest:function(v){return this._super.attrTest.call(this,v)&&(Math.abs(v.scale-1)>this.options.threshold||this.state&Tt)},emit:function(v){if(v.scale!==1){var w=v.scale<1?"in":"out";v.additionalEvent=this.options.event+w}this._super.emit.call(this,v)}});function mf(){_n.apply(this,arguments),this._timer=null,this._input=null}p(mf,_n,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[H_]},process:function(v){var w=this.options,A=v.pointers.length===w.pointers,N=v.distance<w.threshold,B=v.deltaTime>w.time;if(this._input=v,!N||!A||v.eventType&(Ee|We)&&!B)this.reset();else if(v.eventType&Se)this.reset(),this._timer=f(function(){this.state=gn,this.tryEmit()},w.time,this);else if(v.eventType&Ee)return gn;return Ht},reset:function(){clearTimeout(this._timer)},emit:function(v){this.state===gn&&(v&&v.eventType&Ee?this.manager.emit(this.options.event+"up",v):(this._input.timeStamp=u(),this.manager.emit(this.options.event,this._input)))}});function yf(){Mt.apply(this,arguments)}p(yf,Mt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ir]},attrTest:function(v){return this._super.attrTest.call(this,v)&&(Math.abs(v.rotation)>this.options.threshold||this.state&Tt)}});function vf(){Mt.apply(this,arguments)}p(vf,Mt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:yt|pn,pointers:1},getTouchAction:function(){return Da.prototype.getTouchAction.call(this)},attrTest:function(v){var w=this.options.direction,A;return w&(yt|pn)?A=v.overallVelocity:w&yt?A=v.overallVelocityX:w&pn&&(A=v.overallVelocityY),this._super.attrTest.call(this,v)&&w&v.offsetDirection&&v.distance>this.options.threshold&&v.maxPointers==this.options.pointers&&c(A)>this.options.velocity&&v.eventType&Ee},emit:function(v){var w=Y_(v.offsetDirection);w&&this.manager.emit(this.options.event+w,v),this.manager.emit(this.options.event,v)}});function Ba(){_n.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}p(Ba,_n,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[pf]},process:function(v){var w=this.options,A=v.pointers.length===w.pointers,N=v.distance<w.threshold,B=v.deltaTime<w.time;if(this.reset(),v.eventType&Se&&this.count===0)return this.failTimeout();if(N&&B&&A){if(v.eventType!=Ee)return this.failTimeout();var j=this.pTime?v.timeStamp-this.pTime<w.interval:!0,Q=!this.pCenter||Ia(this.pCenter,v.center)<w.posThreshold;this.pTime=v.timeStamp,this.pCenter=v.center,!Q||!j?this.count=1:this.count+=1,this._input=v;var Oe=this.count%w.taps;if(Oe===0)return this.hasRequireFailures()?(this._timer=f(function(){this.state=gn,this.tryEmit()},w.interval,this),Tt):gn}return Ht},failTimeout:function(){return this._timer=f(function(){this.state=Ht},this.options.interval,this),Ht},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==gn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function mn(v,w){return w=w||{},w.recognizers=R(w.recognizers,mn.defaults.preset),new Tf(v,w)}mn.VERSION="2.0.7",mn.defaults={domEvents:!1,touchAction:W_,enable:!0,inputTarget:null,inputClass:null,preset:[[yf,{enable:!1}],[_f,{enable:!1},["rotate"]],[vf,{direction:yt}],[Da,{direction:yt},["swipe"]],[Ba],[Ba,{event:"doubletap",taps:2},["tap"]],[mf]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Zb=1,K_=2;function Tf(v,w){this.options=g({},mn.defaults,w||{}),this.options.inputTarget=this.options.inputTarget||v,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=v,this.input=Rb(this),this.touchAction=new gf(this,this.options.touchAction),q_(this,!0),d(this.options.recognizers,function(A){var N=this.add(new A[0](A[1]));A[2]&&N.recognizeWith(A[2]),A[3]&&N.requireFailure(A[3])},this)}Tf.prototype={set:function(v){return g(this.options,v),v.touchAction&&this.touchAction.update(),v.inputTarget&&(this.input.destroy(),this.input.target=v.inputTarget,this.input.init()),this},stop:function(v){this.session.stopped=v?K_:Zb},recognize:function(v){var w=this.session;if(!w.stopped){this.touchAction.preventDefaults(v);var A,N=this.recognizers,B=w.curRecognizer;(!B||B&&B.state&gn)&&(B=w.curRecognizer=null);for(var j=0;j<N.length;)A=N[j],w.stopped!==K_&&(!B||A==B||A.canRecognizeWith(B))?A.recognize(v):A.reset(),!B&&A.state&(Tt|di|Un)&&(B=w.curRecognizer=A),j++}},get:function(v){if(v instanceof _n)return v;for(var w=this.recognizers,A=0;A<w.length;A++)if(w[A].options.event==v)return w[A];return null},add:function(v){if(h(v,"add",this))return this;var w=this.get(v.options.event);return w&&this.remove(w),this.recognizers.push(v),v.manager=this,this.touchAction.update(),v},remove:function(v){if(h(v,"remove",this))return this;if(v=this.get(v),v){var w=this.recognizers,A=H(w,v);A!==-1&&(w.splice(A,1),this.touchAction.update())}return this},on:function(v,w){if(v!==i&&w!==i){var A=this.handlers;return d(z(v),function(N){A[N]=A[N]||[],A[N].push(w)}),this}},off:function(v,w){if(v!==i){var A=this.handlers;return d(z(v),function(N){w?A[N]&&A[N].splice(H(A[N],w),1):delete A[N]}),this}},emit:function(v,w){this.options.domEvents&&Qb(v,w);var A=this.handlers[v]&&this.handlers[v].slice();if(!(!A||!A.length)){w.type=v,w.preventDefault=function(){w.srcEvent.preventDefault()};for(var N=0;N<A.length;)A[N](w),N++}},destroy:function(){this.element&&q_(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function q_(v,w){var A=v.element;if(A.style){var N;d(v.options.cssProps,function(B,j){N=Z(A.style,j),w?(v.oldCssProps[N]=A.style[N],A.style[N]=B):A.style[N]=v.oldCssProps[N]||""}),w||(v.oldCssProps={})}}function Qb(v,w){var A=n.createEvent("Event");A.initEvent(v,!0,!0),A.gesture=w,w.target.dispatchEvent(A)}g(mn,{INPUT_START:Se,INPUT_MOVE:dn,INPUT_END:Ee,INPUT_CANCEL:We,STATE_POSSIBLE:ka,STATE_BEGAN:Tt,STATE_CHANGED:di,STATE_ENDED:Un,STATE_RECOGNIZED:gn,STATE_CANCELLED:Fs,STATE_FAILED:Ht,DIRECTION_NONE:hi,DIRECTION_LEFT:Rr,DIRECTION_RIGHT:xr,DIRECTION_UP:Cr,DIRECTION_DOWN:Pr,DIRECTION_HORIZONTAL:yt,DIRECTION_VERTICAL:pn,DIRECTION_ALL:Ca,Manager:Tf,Input:vt,TouchAction:gf,TouchInput:Na,MouseInput:Ma,PointerEventInput:hf,TouchMouseInput:df,SingleTouchInput:U_,Recognizer:_n,AttrRecognizer:Mt,Tap:Ba,Pan:Da,Swipe:vf,Pinch:_f,Rotate:yf,Press:mf,on:P,off:O,each:d,merge:m,extend:b,assign:g,inherit:p,bindFn:y,prefixed:Z});var Jb=typeof e<"u"?e:typeof self<"u"?self:{};Jb.Hammer=mn,typeof i=="function"&&i.amd?i(function(){return mn}):t.exports?t.exports=mn:e[r]=mn})(window,document,"Hammer")})(V1);var xa=V1.exports;const W6=bu(xa),Qt=tA({__proto__:null,default:W6},[xa]),$1=1,j1=2,yp=4,H6={mousedown:$1,mousemove:j1,mouseup:yp};function X6(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function Y6(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(X6(i,s=>s.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function K6(t){t.prototype.handler=function(n){let r=H6[n.type];r&$1&&n.button>=0&&(this.pressed=!0),r&j1&&n.buttons===0&&(r=yp),this.pressed&&(r&yp&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}Y6(xa.PointerEventInput);K6(xa.MouseInput);const q6=xa.Manager;class af{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}}const Z6=Qt?[[Qt.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Qt.Rotate,{enable:!1}],[Qt.Pinch,{enable:!1}],[Qt.Swipe,{enable:!1}],[Qt.Pan,{threshold:0,enable:!1}],[Qt.Press,{enable:!1}],[Qt.Tap,{event:"doubletap",taps:2,enable:!1}],[Qt.Tap,{event:"anytap",enable:!1}],[Qt.Tap,{enable:!1}]]:null,rv={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},Q6={doubletap:["tap"]},J6={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},x_={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},G6={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},iv={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},eL=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Hi=typeof window<"u"?window:global;let vp=!1;try{const t={get passive(){return vp=!0,!0}};Hi.addEventListener("test",null,t),Hi.removeEventListener("test",null)}catch{vp=!1}const tL=eL.indexOf("firefox")!==-1,{WHEEL_EVENTS:nL}=x_,sv="wheel",ov=4.000244140625,rL=40,iL=.25;class sL extends af{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let s=i.deltaY;Hi.WheelEvent&&(tL&&i.deltaMode===Hi.WheelEvent.DOM_DELTA_PIXEL&&(s/=Hi.devicePixelRatio),i.deltaMode===Hi.WheelEvent.DOM_DELTA_LINE&&(s*=rL)),s!==0&&s%ov===0&&(s=Math.floor(s/ov)),i.shiftKey&&s&&(s=s*iL),this.callback({type:sv,center:{x:i.clientX,y:i.clientY},delta:-s,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(nL),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,vp?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===sv&&(this.options.enable=n)}}const{MOUSE_EVENTS:oL}=x_,av="pointermove",lv="pointerover",cv="pointerout",uv="pointerenter",fv="pointerleave";class aL extends af{constructor(e,n,r){super(e,n,r),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(oL),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===av&&(this.enableMoveEvent=n),e===lv&&(this.enableOverEvent=n),e===cv&&(this.enableOutEvent=n),e===uv&&(this.enableEnterEvent=n),e===fv&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(lv,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(cv,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(uv,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(fv,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit(av,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:lL}=x_,hv="keydown",dv="keyup";class cL extends af{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const s=i.target||i.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:hv,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:dv,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(lL),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===hv&&(this.enableDownEvent=n),e===dv&&(this.enableUpEvent=n)}}const pv="contextmenu";class uL extends af{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:pv,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===pv&&(this.options.enable=n)}}const gv=1,Tp=2,_v=4,fL={pointerdown:gv,pointermove:Tp,pointerup:_v,mousedown:gv,mousemove:Tp,mouseup:_v},hL=0,dL=1,pL=2,gL=1,_L=2,mL=4;function yL(t){const e=fL[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r}=t.srcEvent;let i=!1,s=!1,o=!1;return e===Tp?(i=!!(n&gL),s=!!(n&mL),o=!!(n&_L)):(i=r===hL,s=r===dL,o=r===pL),{leftButton:i,middleButton:s,rightButton:o}}function vL(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,s=r.height/e.offsetHeight||1,o={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/s};return{center:n,offsetCenter:o}}const Nh={srcElement:"root",priority:0};class TL{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let l=Nh;typeof r=="string"||r&&r.addEventListener?l={...Nh,srcElement:r}:r&&(l={...Nh,...r});let c=a.get(l.srcElement);c||(c=[],a.set(l.srcElement,c));const u={type:e,handler:n,srcElement:l.srcElement,priority:l.priority};i&&(u.once=!0),s&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let f=c.length-1;for(;f>=0&&!(c[f].priority>=u.priority);)f--;c.splice(f+1,0,u)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let s=r.length-1;s>=0;s--){const o=r[s];if(o.type===e&&o.handler===n){r.splice(s,1);const a=i.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&i.delete(o.srcElement)}}this._active=r.some(s=>!s.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,i=!0},a=[];for(let l=0;l<r.length;l++){const{type:c,handler:u,once:f}=r[l];if(u({...e,type:c,stopPropagation:s,stopImmediatePropagation:o}),f&&a.push(r[l]),i)break}for(let l=0;l<a.length;l++){const{type:c,handler:u}=a[l];this.remove(c,u)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...yL(e),...vL(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const wL={events:null,recognizers:null,recognizerOptions:{},Manager:q6,touchAction:"none",tabIndex:0};class SL{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:s}=i,o=J6[s.type];o&&this.manager.emit(o,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...wL,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||Z6}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(rv).forEach(i=>{const s=this.manager.get(i);s&&rv[i].forEach(o=>{s.recognizeWith(o)})});for(const i in n.recognizerOptions){const s=this.manager.get(i);if(s){const o=n.recognizerOptions[i];delete o.enable,s.set(o)}}this.wheelInput=new sL(e,this._onOtherEvent,{enable:!1}),this.moveInput=new aL(e,this._onOtherEvent,{enable:!1}),this.keyInput=new cL(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new uL(e,this._onOtherEvent,{enable:!1});for(const[i,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(i,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const s=Q6[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=r.get(o);n?(a.requireFailure(e),i.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,s){if(typeof e!="string"){r=n;for(const u in e)this._addEventHandler(u,e[u],r,i,s);return}const{manager:o,events:a}=this,l=iv[e]||e;let c=a.get(l);c||(c=new TL(this),a.set(l,c),c.recognizerName=G6[l]||l,o&&o.on(l,c.handleEvent)),c.add(e,n,r,i,s),c.isEmpty()||this._toggleRecognizer(c.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:r}=this,i=iv[e]||e,s=r.get(i);if(s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const l of r.values())if(l.recognizerName===o&&!l.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function Wn(){}const EL=({isDragging:t})=>t?"grabbing":"grab",mv={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{type:"webgl"},gl:null,glOptions:{},canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:Wn,onWebGLInitialized:Wn,onResize:Wn,onViewStateChange:Wn,onInteractionStateChange:Wn,onBeforeRender:Wn,onAfterRender:Wn,onLoad:Wn,onError:t=>J.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:EL,getTooltip:null,debug:!1,drawPickingColors:!1},du=class du{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new Gu({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=r=>{const{_pickRequest:i}=this;if(r.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(r.leftButton||r.rightButton)return;{const s=r.offsetCenter;if(!s)return;i.x=s.x,i.y=s.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=r},this._onEvent=r=>{const i=lp[r.type],s=r.offsetCenter;if(!i||!s||!this.layerManager)return;const o=this.layerManager.getLayers(),a=this.deckPicker.getLastPickedObject({x:s.x,y:s.y,layers:o,viewports:this.getViewports(s)},this._lastPointerDownInfo),{layer:l}=a,c=l&&(l[i.handler]||l.props[i.handler]),u=this.props[i.handler];let f=!1;c&&(f=c.call(l,a,r)),f||(u==null||u(a,r),this.widgetManager.onEvent(a,r))},this._onPointerDown=r=>{const i=r.offsetCenter,s=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=s.result[0]||s.emptyInfo},this.props={...mv,...e},e=this.props,e.viewState&&e.initialViewState&&J.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device?this.device=e.device:e.gl&&(e.gl instanceof WebGLRenderingContext&&J.error("WebGL1 context not supported.")(),this.device=bo.attach(e.gl));let n=this.device;n||(ts.registerDevices([bo]),n=ts.createDevice({...e.deviceProps,canvas:this._createCanvas(e)})),this.animationLoop=this._createAnimationLoop(n,e),this.setProps(e),e._typedArrayManagerProps&&Ss.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,s,o,a,l,c,u;(e=this.animationLoop)==null||e.stop(),(n=this.animationLoop)==null||n.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,(r=this.layerManager)==null||r.finalize(),this.layerManager=null,(i=this.viewManager)==null||i.finalize(),this.viewManager=null,(s=this.effectManager)==null||s.finalize(),this.effectManager=null,(o=this.deckRenderer)==null||o.finalize(),this.deckRenderer=null,(a=this.deckPicker)==null||a.finalize(),this.deckPicker=null,(l=this.eventManager)==null||l.destroy(),this.eventManager=null,(c=this.widgetManager)==null||c.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&((u=this.canvas.parentElement)==null||u.removeChild(this.canvas),this.canvas=null)}setProps(e){var r;this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&J.removed("onLayerHover","onHover")(),"onLayerClick"in e&&J.removed("onLayerClick","onClick")(),e.initialViewState&&!Bt(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),(r=this.animationLoop)==null||r.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n),this.widgetManager.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||r||i||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return Ce(this.viewManager),this.viewManager.views}getViewports(e){return Ce(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){var n;(n=this.layerManager)==null||n.removeDefaultShaderModule(e)}_pick(e,n,r){Ce(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),Ce(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){var i;if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const s=Number.isFinite(n)?`${n}px`:n;this.canvas.style.width=s}if(r||r===0){const s=Number.isFinite(r)?`${r}px`:r;this.canvas.style.position=((i=e.style)==null?void 0:i.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){var i,s;const{canvas:e}=this;if(!e)return;const n=e.clientWidth??e.width,r=e.clientHeight??e.height;(n!==this.width||r!==this.height)&&(this.width=n,this.height=r,(i=this.viewManager)==null||i.setProps({width:n,height:r}),(s=this.layerManager)==null||s.activateViewport(this.getViewports()[0]),this.props.onResize({width:n,height:r}))}_createAnimationLoop(e,n){const{gl:r,onError:i,useDevicePixels:s}=n;return new YD({device:e,useDevicePixels:s,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,onInitialize:o=>this._setDevice(o.device),onRender:this._onRenderFrame.bind(this),onError:i})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,n=Array.isArray(e)?e:e?[e]:[new jc({id:"default-view"})];return n.length&&this.props.controller&&(n[0].props.controller=this.props.controller),n}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){var n,r,i;const{_pickRequest:e}=this;if(e.event){const{result:s,emptyInfo:o}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=s.length>0;let a=o,l=!1;for(const c of s)a=c,l=((n=c.layer)==null?void 0:n.onHover(c,e.event))||l;l||((i=(r=this.props).onHover)==null||i.call(r,a,e.event),this.widgetManager.onHover(a,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){var i,s;if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=(i=this.device.canvasContext)==null?void 0:i.canvas),this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device instanceof bo&&this.props.onWebGLInitialized(this.device.gl);const n=new S1;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new SL(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const o in lp)this.eventManager.on(o,this._onEvent);this.viewManager=new f4({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new u4(this.device,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new C4({deck:this,device:this.device}),this.deckRenderer=new M4(this.device),this.deckPicker=new B4(this.device),this.widgetManager=new z4({deck:this,parentElement:(s=this.canvas)==null?void 0:s.parentElement}),this.widgetManager.addDefault(new $4),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){var o;const{device:r,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:r,gl:i});const s={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n};(o=this.deckRenderer)==null||o.renderLayers(s),s.pass==="screen"&&this.widgetManager.onRedraw({viewports:s.viewports,layers:s.layers}),this.props.onAfterRender({device:r,gl:i})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),J.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=ts.stats.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}};du.defaultProps=mv,du.VERSION=sN;let ta=du;function bL(t){switch(t){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return YE(t)}}const AL=XE;function vl(t,e){return{attribute:t,format:e.size>1?`${e.type}x${e.size}`:e.type,byteOffset:e.offset||0}}function jr(t){return t.stride||t.size*t.bytesPerElement}function RL(t,e){return t.type===e.type&&t.size===e.size&&jr(t)===jr(e)&&(t.offset||0)===(e.offset||0)}function wp(t,e){e.offset&&J.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=jr(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,s=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function xL(t,e){const n=wp(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class CL{constructor(e,n,r){this._buffer=null,this.device=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,s=i==="float64";let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a="float32":!i&&n.isIndexed?a="uint32":a=i||"float32";let l=bL(i||a);this.doublePrecision=s,s&&n.fp64===!1&&(l=Float32Array),this.value=null,this.settings={...n,defaultType:l,defaultValue:o,logicalType:i,type:a,normalized:a.includes("norm"),size:this.size,bytesPerElement:l.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*jr(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Ss.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,n=null){const r={};if(this.state.constant){const i=this.value;if(n){const s=wp(this.getAccessor(),n),o=s.offset/i.BYTES_PER_ELEMENT,a=s.size||this.size;r[e]=i.subarray(o,o+a)}else r[e]=i}else r[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?r[`${e}64Low`]=r[e]:r[`${e}64Low`]=new Float32Array(this.size)),r}_getBufferLayout(e=this.id,n=null){const r=this.getAccessor(),i=[],s={name:this.id,byteStride:jr(r),attributes:i};if(this.doublePrecision){const o=xL(r,n||{});i.push(vl(e,{...r,...o.high}),vl(`${e}64Low`,{...r,...o.low}))}else if(n){const o=wp(r,n);i.push(vl(e,{...r,...o}))}else i.push(vl(e,r));return s}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,s=r*i;if(n&&s&&n.length>=s){const o=new Array(i).fill(1/0),a=new Array(i).fill(-1/0);for(let l=0;l<s;)for(let c=0;c<i;c++){const u=n[l++];u<o[c]&&(o[c]=u),u>a[c]&&(a[c]=u)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof ge?r={buffer:e}:r=e;const i={...this.settings,...r};if(ArrayBuffer.isView(r.value)){if(!r.type)if(this.doublePrecision&&r.value instanceof Float64Array)i.type="float32";else{const o=AL(r.value);i.type=i.normalized?o.replace("int","norm"):o}i.bytesPerElement=r.value.BYTES_PER_ELEMENT,i.stride=jr(i)}if(n.bounds=null,r.constant){let s=r.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=ArrayBuffer.isView(s)?s:new Float32Array(s)}else if(r.buffer){const s=r.buffer;n.externalBuffer=s,n.constant=!1,this.value=r.value||null}else if(r.value){this._checkExternalBuffer(r);let s=r.value;n.externalBuffer=null,n.constant=!1,this.value=s;let{buffer:o}=this;const a=jr(i),l=(i.vertexOffset||0)*a;if(this.doublePrecision&&s instanceof Float64Array&&(s=vh(s,i)),this.settings.isIndexed){const u=this.settings.defaultType;s.constructor!==u&&(s=new u(s))}const c=s.byteLength+l+a*2;(!o||o.byteLength<c)&&(o=this._createBuffer(c)),o.write(s,l)}return this.setAccessor(i),!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.write(this.doublePrecision&&n instanceof Float64Array?vh(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),r*n.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,s=Ss.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{byteOffset:o}=this;let{buffer:a}=this;return(!a||a.byteLength<s.byteLength+o)&&(a=this._createBuffer(s.byteLength+o),n&&i&&a.write(i instanceof Float64Array?vh(i,this):i,o)),r.allocatedValue=s,r.constant=!1,r.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error(`Attribute ${this.id} value is not TypedArray`);const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${n.constructor.name}`);!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&J.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(n=>(n+128)/255*2-1);case"snorm16":return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(n=>n/255);case"unorm16":return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:s}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let o=s;for(;--o>=0;)n[r+o]=i[o];return n}switch(s){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let o=s;for(;--o>=0;)n[r+o]=Number.isFinite(e[o])?e[o]:i[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}_createBuffer(e){var i;this._buffer&&this._buffer.destroy();const{isIndexed:n,type:r}=this.settings;return this._buffer=this.device.createBuffer({...(i=this._buffer)==null?void 0:i.props,id:this.id,usage:n?ge.INDEX:ge.VERTEX,indexType:n?r:void 0,byteLength:e}),this._buffer}}const yv=[],vv=[];function lf(t,e=0,n=1/0){let r=yv;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(vv.length=t.length,r=vv):r=yv,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function W1(t){return t&&t[Symbol.asyncIterator]}function H1(t,e){const{size:n,stride:r,offset:i,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,l=r?r/a:n,c=i?i/a:0,u=Math.floor((t.length-c)/l);return(f,{index:h,target:d})=>{if(!s){const m=h*l+c;for(let p=0;p<n;p++)d[p]=t[m+p];return d}const _=s[h],g=s[h+1]||u;let b;if(o){b=new Array(g-_);for(let m=_;m<g;m++){const p=m*l+c;d=new Array(n);for(let y=0;y<n;y++)d[y]=t[p+y];b[m-_]=d}}else if(l===n)b=t.subarray(_*n+c,g*n+c);else{b=new t.constructor((g-_)*n);let m=0;for(let p=_;p<g;p++){const y=p*l+c;for(let S=0;S<n;S++)b[m++]=t[y+S]}}return b}}const PL=[],Wl=[[0,1/0]];function IL(t,e){if(t===Wl||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let s=0;s<r;s++){const o=t[s];o[1]<e[0]?(n.push(o),i=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(i,0,e),n}const ML={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function X1(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...ML[n],...e,...t,type:n}}class Y1 extends CL{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:Wl}),this.constant=!1,this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var n;(n=this.state).layoutChanged||(n.layoutChanged=!RL(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return X1(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=IL(this.state.updateRanges,[r,i])}else this.state.updateRanges=Wl}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=PL}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==Wl),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let l=!0;if(o){for(const[c,u]of s)o.call(i,this,{data:n,startRow:c,endRow:u,props:r,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[c,u]of s){const f=Number.isFinite(c)?this.getVertexOffset(c):0,h=Number.isFinite(u)?this.getVertexOffset(u):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:f,endOffset:h})}this._checkAttributeArray()}else l=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),l}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;Ce(ArrayBuffer.isView(o.value),`invalid ${i.accessor}`);const a=!!o.size&&o.size!==this.size;return r.binaryAccessor=H1(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,n=super.getValue();if(!e)return n;for(const r in e)Object.assign(n,super.getValue(r,e[r]));return n}getBufferLayout(e){this.state.layoutChanged=!1;const n=this.settings.shaderAttributes,r=super._getBufferLayout(),{stepMode:i}=this.settings;if(i==="dynamic"?r.stepMode=e?e.isInstanced?"instance":"vertex":"instance":r.stepMode=i??"vertex",!n)return r;for(const s in n){const o=super._getBufferLayout(s,n[s]);r.attributes.push(...o.attributes)}return r}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:l,value:c,size:u,startIndices:f}=e,{accessor:h,transform:d}=a,_=l.binaryAccessor||(typeof h=="function"?h:s[h]);Ce(typeof _=="function",`accessor "${h}" is not a function`);let g=e.getVertexOffset(r);const{iterable:b,objectInfo:m}=lf(n,r,i);for(const p of b){m.index++;let y=_(p,m);if(d&&(y=d.call(this,y)),f){const S=(m.index<f.length-1?f[m.index+1]:o)-f[m.index];if(y&&Array.isArray(y[0])){let R=g;for(const P of y)e._normalizeValue(P,c,R),R+=u}else y&&y.length>u?c.set(y,g):(e._normalizeValue(y,m.target,0),s4({target:c,source:m.target,start:g,count:S}));g+=S*u}else e._normalizeValue(y,c,g),g+=u}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function Oh(t){const{source:e,target:n,start:r=0,size:i,getData:s}=t,o=t.end||n.length,a=e.length,l=o-r;if(a>l){n.set(e.subarray(0,l),r);return}if(n.set(e,r),!s)return;let c=a;for(;c<l;){const u=s(c,e);for(let f=0;f<i;f++)n[r+c]=u[f]||0,c++}}function NL({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:s}){if(!i||!s)return Oh({source:t,target:e,size:n,getData:r}),e;let o=0,a=0;const l=r&&((u,f)=>r(u+a,f)),c=Math.min(i.length,s.length);for(let u=1;u<c;u++){const f=i[u]*n,h=s[u]*n;Oh({source:t.subarray(o,f),target:e,start:a,end:h,size:n,getData:l}),o=f,a=h}return a<e.length&&Oh({source:[],target:e,start:a,size:n,getData:l}),e}function OL(t){const{device:e,settings:n,value:r}=t,i=new Y1(e,n);return i.setData({value:r instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:n.normalized}),i}function K1(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${t}"`)}}function q1(t){switch(t){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function Z1(t){t.push(t.shift())}function kL(t,e){const{doublePrecision:n,settings:r,value:i,size:s}=t,o=n&&i instanceof Float64Array?2:1;let a=0;const{shaderAttributes:l}=t.settings;if(l)for(const c of Object.values(l))a=Math.max(a,c.vertexOffset??0);return(r.noAlloc?i.length:(e+a)*s)*o}function Q1({device:t,source:e,target:n}){return(!n||n.byteLength<e.byteLength)&&(n==null||n.destroy(),n=t.createBuffer({byteLength:e.byteLength,usage:e.usage})),n}function J1({device:t,buffer:e,attribute:n,fromLength:r,toLength:i,fromStartIndices:s,getData:o=a=>a}){const a=n.doublePrecision&&n.value instanceof Float64Array?2:1,l=n.size*a,c=n.byteOffset,u=n.settings.bytesPerElement<4?c/n.settings.bytesPerElement*4:c,f=n.startIndices,h=s&&f,d=n.isConstant;if(!h&&e&&r>=i)return e;const _=n.value instanceof Float64Array?Float32Array:n.value.constructor,g=d?n.value:new _(n.getBuffer().readSyncWebGL(c,i*_.BYTES_PER_ELEMENT).buffer);if(n.settings.normalized&&!d){const y=o;o=(S,R)=>n.normalizeConstant(y(S,R))}const b=d?(y,S)=>o(g,S):(y,S)=>o(g.subarray(y+c,y+c+l),S),m=e?new Float32Array(e.readSyncWebGL(u,r*4).buffer):new Float32Array(0),p=new Float32Array(i);return NL({source:m,target:p,sourceStartIndices:s,targetStartIndices:f,size:l,getData:b}),(!e||e.byteLength<p.byteLength+u)&&(e==null||e.destroy(),e=t.createBuffer({byteLength:p.byteLength+u,usage:35050})),e.write(p,u),e}class G1{constructor({device:e,attribute:n,timeline:r}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new rf(r),this.attribute=n,this.attributeInTransition=OL(n),this.currentStartIndices=n.startIndices}get inProgress(){return this.transition.inProgress}start(e,n,r=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=kL(this.attribute,n),this.transition.start({...e,duration:r})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}class FL extends G1{constructor({device:e,attribute:n,timeline:r}){super({device:e,attribute:n,timeline:r}),this.type="interpolation",this.transform=LL(e,n)}start(e,n){const r=this.currentLength,i=this.currentStartIndices;if(super.start(e,n,e.duration),e.duration<=0){this.transition.cancel();return}const{buffers:s,attribute:o}=this;Z1(s),s[0]=J1({device:this.device,buffer:s[0],attribute:o,fromLength:r,toLength:this.currentLength,fromStartIndices:i,getData:e.enter}),s[1]=Q1({device:this.device,source:s[0],target:s[1]}),this.setBuffer(s[1]);const{transform:a}=this,l=a.model;let c=Math.floor(this.currentLength/o.size);eb(o)&&(c/=2),l.setVertexCount(c),o.isConstant?(l.setAttributes({aFrom:s[0]}),l.setConstantAttributes({aTo:o.value})):l.setAttributes({aFrom:s[0],aTo:o.getBuffer()}),a.transformFeedback.setBuffers({vCurrent:s[1]})}onUpdate(){const{duration:e,easing:n}=this.settings,{time:r}=this.transition;let i=r/e;n&&(i=n(i));const{model:s}=this.transform;s.setUniforms({time:i}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const DL=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`,BL=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function eb(t){return t.doublePrecision&&t.value instanceof Float64Array}function LL(t,e){const n=e.size,r=K1(n),i=q1(n),s=e.getBufferLayout();return eb(e)?new Go(t,{vs:BL,bufferLayout:[{name:"aFrom",byteStride:8*n,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*n}]},{name:"aTo",byteStride:8*n,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*n}]}],modules:[Nk],defines:{ATTRIBUTE_TYPE:r,ATTRIBUTE_SIZE:n},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new Go(t,{vs:DL,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:s.attributes[0].format}],defines:{ATTRIBUTE_TYPE:r},varyings:["vCurrent"],disableWarnings:!0})}class UL extends G1{constructor({device:e,attribute:n,timeline:r}){super({device:e,attribute:n,timeline:r}),this.type="spring",this.texture=jL(e),this.framebuffer=WL(e,this.texture),this.transform=$L(e,n)}start(e,n){const r=this.currentLength,i=this.currentStartIndices;super.start(e,n);const{buffers:s,attribute:o}=this;for(let l=0;l<2;l++)s[l]=J1({device:this.device,buffer:s[l],attribute:o,fromLength:r,toLength:this.currentLength,fromStartIndices:i,getData:e.enter});s[2]=Q1({device:this.device,source:s[0],target:s[2]}),this.setBuffer(s[1]);const{model:a}=this.transform;a.setVertexCount(Math.floor(this.currentLength/o.size)),o.isConstant?a.setConstantAttributes({aTo:o.value}):a.setAttributes({aTo:o.getBuffer()})}onUpdate(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this,s=this.settings;n.model.setAttributes({aPrev:e[0],aCur:e[1]}),n.transformFeedback.setBuffers({vNext:e[2]}),n.model.setUniforms({stiffness:s.stiffness,damping:s.damping}),n.run({framebuffer:r,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),Z1(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(r)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const zL=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,VL=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function $L(t,e){const n=K1(e.size),r=q1(e.size);return new Go(t,{vs:zL,fs:VL,bufferLayout:[{name:"aPrev",format:r},{name:"aCur",format:r},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],defines:{ATTRIBUTE_TYPE:n},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function jL(t){return t.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}function WL(t,e){return t.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}const HL={interpolation:FL,spring:UL};class XL{constructor(e,{id:n,timeline:r}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=n,this.device=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const s=e[i],o=s.getTransitionSetting(n);o&&this._updateAttribute(i,s,o)}for(const i in this.transitions){const s=e[i];(!s||!s.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let s=!i||i.type!==r.type;if(s){i&&this._removeTransition(e);const o=HL[r.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,device:this.device}):(J.error(`unsupported transition type '${r.type}'`)(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const Tv="attributeManager.invalidate",YL="attributeManager.updateStart",KL="attributeManager.updateEnd",qL="attribute.updateStart",ZL="attribute.allocate",QL="attribute.updateEnd";class JL{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){this.mergeBoundsMemoized=ba(DD),this.id=n,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new XL(e,{id:`${n}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);Ke(Tv,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);Ke(Tv,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:s={},buffers:o={},context:a={}}){let l=!1;Ke(YL,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const c in this.attributes){const u=this.attributes[c],f=u.settings.accessor;u.startIndices=r,u.numInstances=n,s[c]&&J.removed(`props.${c}`,`data.attributes.${c}`)(),u.setExternalBuffer(o[c])||u.setBinaryValue(typeof f=="string"?o[f]:void 0,e.startIndices)||typeof f=="string"&&!o[f]&&u.setConstantValue(s[f])||u.needsUpdate()&&(l=!0,this._updateAttribute({attribute:u,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||u.needsRedraw()}l&&Ke(KL,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])==null?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!r.hasAttribute(s)&&(i[s]=o)}return i}getBufferLayouts(e){return Object.values(this.getAttributes()).map(n=>n.getBufferLayout(e))}_add(e,n){for(const r in e){const i=e[r],s={...i,id:r,size:i.isIndexed&&1||i.size||1,...n};this.attributes[r]=new Y1(this.device,s)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,s=i[e];return s&&s.forEach(o=>{const a=r[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(Ke(qL,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&Ke(ZL,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,Ke(QL,n,r))}}class GL extends rf{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:s}}=this,o=s(e/i);this._value=Bc(n,r,o)}}const wv=1e-5;function Sv(t,e,n,r,i){const s=e-t,a=(n-e)*i,l=-s*r;return a+l+s+e}function eU(t,e,n,r,i){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=Sv(t[o],e[o],n[o],r,i);return s}return Sv(t,e,n,r,i)}function Ev(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class tU extends rf{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=eU(s,o,n,r,i);const l=Ev(a,n),c=Ev(a,o);l<wv&&c<wv&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const nU={interpolation:GL,spring:tU};class rU{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:s}=this;if(s.has(e)){const l=s.get(e),{value:c=l.settings.fromValue}=l;n=c,this.remove(e)}if(i=X1(i),!i)return;const o=nU[i.type];if(!o){J.error(`unsupported transition type '${i.type}'`)();return}const a=new o(this.timeline);a.start({...i,fromValue:n,toValue:r}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function iU(t){const e=t[fr];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error(`Invalid prop ${n}: ${t[n]}`)}}function sU(t,e){const n=tb({newProps:t,oldProps:e,propTypes:t[fr],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=aU(t,e);let i=!1;return r||(i=lU(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:cU(t,e),transitionsChanged:oU(t,e)}}function oU(t,e){if(!t.transitions)return!1;const n={},r=t[fr];let i=!1;for(const s in t.transitions){const o=r[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&Sp(t[s],e[s],o)&&(n[s]=!0,i=!0)}return i?n:!1}function tb({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null)return`${i} changed shallowly`;if(typeof e!="object"||e===null)return`${i} changed shallowly`;for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return`${i}.${s} added`;const o=Sp(t[s],e[s],r[s]);if(o)return`${i}.${s} ${o}`}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return`${i}.${s} dropped`;if(!Object.hasOwnProperty.call(t,s)){const o=Sp(t[s],e[s],r[s]);if(o)return`${i}.${s} ${o}`}}return!1}function Sp(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function aU(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function lU(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&bv(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&bv(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function cU(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function bv(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},tb({oldProps:i,newProps:r,triggerName:n})}const uU="count(): argument not an object",fU="count(): argument not a container";function hU(t){if(!pU(t))throw new Error(uU);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(dU(t))return Object.keys(t).length;throw new Error(fU)}function dU(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function pU(t){return t!==null&&typeof t=="object"}function Av(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const gU={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},Ep={};function _U(t,e,n,r){if(n instanceof bt)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={minFilter:"linear",mipmapFilter:n.data.length>1?"nearest":"linear"});const s=e.createTexture({...n,sampler:{...gU,...i,...r}});return Ep[s.id]=t,s}function mU(t,e){!e||!(e instanceof bt)||Ep[e.id]===t&&(e.delete(),delete Ep[e.id])}const yU={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||bp(t)&&(t.length===3||t.length===4)},equal(t,e,n){return Bt(t,e,1)}},accessor:{validate(t,e){const n=Hc(t);return n==="function"||n===Hc(e.value)},equal(t,e,n){return typeof e=="function"?!0:Bt(t,e,1)}},array:{validate(t,e){return e.optional&&!t||bp(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Bt(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?Bt(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{if(!t)return t;const{dataTransform:r}=n.props;return r?r(t):typeof t.shape=="string"&&t.shape.endsWith("-table")&&Array.isArray(t.data)?t.data:t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.device?null:_U(n.id,r.device,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{mU(n.id,t)}}};function vU(t){const e={},n={},r={};for(const[i,s]of Object.entries(t)){const o=s==null?void 0:s.deprecatedFor;if(o)r[i]=Array.isArray(o)?o:[o];else{const a=TU(i,s);e[i]=a,n[i]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function TU(t,e){switch(Hc(e)){case"object":return Gs(t,e);case"array":return Gs(t,{type:"array",value:e,compare:!1});case"boolean":return Gs(t,{type:"boolean",value:e});case"number":return Gs(t,{type:"number",value:e});case"function":return Gs(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Gs(t,e){return"type"in e?{name:t,...yU[e.type],...e}:"value"in e?{name:t,type:Hc(e.value),...e}:{name:t,type:"object",value:e}}function bp(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Hc(t){return bp(t)?"array":t===null?"null":typeof t}function wU(t,e){let n;for(let s=e.length-1;s>=0;s--){const o=e[s];"extensions"in o&&(n=o.extensions)}const r=Ap(t.constructor,n),i=Object.create(r);i[$c]=t,i[ti]={},i[er]={};for(let s=0;s<e.length;++s){const o=e[s];for(const a in o)i[a]=o[a]}return Object.freeze(i),i}const SU="_mergedDefaultProps";function Ap(t,e){let n=SU;if(e)for(const i of e){const s=i.constructor;s&&(n+=`:${s.extensionName||s.name}`)}const r=nb(t,n);return r||(t[n]=EU(t,e||[]))}function EU(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=Ap(r),s=nb(t,"defaultProps")||{},o=vU(s),a=Object.assign(Object.create(null),i,o.defaultProps),l=Object.assign(Object.create(null),i==null?void 0:i[fr],o.propTypes),c=Object.assign(Object.create(null),i==null?void 0:i[Sh],o.deprecatedProps);for(const u of e){const f=Ap(u.constructor);f&&(Object.assign(a,f),Object.assign(l,f[fr]),Object.assign(c,f[Sh]))}return bU(a,t),RU(a,l),AU(a,c),a[fr]=l,a[Sh]=c,e.length===0&&!C_(t,"_propTypes")&&(t._propTypes=l),a}function bU(t,e){const n=CU(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function AU(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i=`${this.id}: ${n}`;for(const s of e[n])C_(this,s)||(this[s]=r);J.deprecated(i,e[n].join("/"))()}})}function RU(t,e){const n={},r={};for(const i in e){const s=e[i],{name:o,value:a}=s;s.async&&(n[o]=a,r[o]=xU(o))}t[is]=n,t[ti]={},Object.defineProperties(t,r)}function xU(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||W1(e)?this[ti][t]=e:this[er][t]=e},get(){if(this[er]){if(t in this[er])return this[er][t]||this[is][t];if(t in this[ti]){const e=this[$c]&&this[$c].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[is][t]}}return this[is][t]}}}function C_(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function nb(t,e){return C_(t,e)&&t[e]}function CU(t){const e=t.componentName;return e||J.warn(`${t.name}.componentName not specified`)(),e||t.name}let PU=0;const pu=class pu{constructor(...e){this.props=wU(this,e),this.id=this.props.id,this.count=PU++}clone(e){const{props:n}=this,r={};for(const i in n[is])i in n[er]?r[i]=n[er][i]:i in n[ti]&&(r[i]=n[ti][i]);return new this.constructor({...n,...r,...e})}};pu.componentName="Component",pu.defaultProps={};let Rp=pu;const IU=Object.freeze({});class MU{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||IU}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[$c]||this.component;const n=e[er]||{},r=e[ti]||e,i=e[is]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in r){const o=r[s];this._createAsyncPropData(s,i[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(W1(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(s=>{this.component&&(s=this._postProcessValue(r,s),this._setAsyncPropValue(e,s,i),this._onResolve(e,s))}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let s=[],o=0;for await(const a of n){if(!this.component)return;const{dataTransform:l}=this.component.props;l?s=l(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,i)}this._onResolve(e,s)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[fr];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class NU extends MU{constructor({attributeManager:e,layer:n}){super(n),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,`loading ${e} of ${this.layer}`)}}const OU="layer.changeFlag",kU="layer.initialize",FU="layer.update",DU="layer.finalize",BU="layer.matched",Rv=2**24-1,LU=Object.freeze([]),UU=ba(({oldViewport:t,viewport:e})=>t.equals(e));let Jt=new Uint8ClampedArray(0);const zU={data:{type:"data",value:LU,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:s})=>{const{resourceManager:o}=n.context;i=i||n.getLoadOptions(),r=r||n.props.loaders,s&&(i={...i,fetch:{...i==null?void 0:i.fetch,signal:s}});let a=o.contains(t);return!a&&!i&&(o.add({resourceId:t,data:Rc(t,r),persistent:!1}),a=!0),a?o.subscribe({resourceId:t,onChange:l=>{var c;return(c=n.internalState)==null?void 0:c.reloadAsyncProp(e,l)},consumerId:n.id,requestId:e}):Rc(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:te.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}},gu=class gu extends Rp{constructor(){super(...arguments),this.internalState=null,this.lifecycle=xi.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){Ce(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=w1(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,s,o]=y1(r,n.pixelProjectionMatrix);return e.length===2?[i,s]:[i,s,o]}unproject(e){return Ce(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){Ce(this.internalState);const r=this.internalState.viewport||this.context.viewport;return $D(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}setShaderModuleProps(...e){for(const n of this.getModels())n.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===te.DEFAULT||e===te.LNGLAT||e===te.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){Ce(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:hU(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){e=Av(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const n of this.props.extensions)e=Av(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,s=this.internalState.hasPickingBuffer,o=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(s!==o){this.internalState.hasPickingBuffer=o;const{pickingColors:a,instancePickingColors:l}=n.attributes,c=a||l;c&&(o&&c.constant&&(c.constant=!1,n.invalidate(c.id)),!c.value&&!o&&(c.constant=!0,c.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.destroy();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i,s,o;n&&(e=new Error(`${n}: ${e.message}`,{cause:e})),(i=(r=this.props).onError)!=null&&i.call(r,e)||(o=(s=this.context)==null?void 0:s.onError)==null||o.call(s,e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)==null?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!UU({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){let n=!1;for(const r in e)e[r].layoutChanged()&&(n=!0);for(const r of this.getModels())this._setModelAttributes(r,e,n)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(Jt.length/4);if(this.internalState.usesPickingColorCache=!0,r<n){n>Rv&&J.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Jt=Ss.allocate(Jt,n,{size:4,copy:!0,maxCount:Math.max(n,Rv)});const i=Math.floor(Jt.length/4),s=[];for(let o=r;o<i;o++)this.encodePickingColor(o,s),Jt[o*4+0]=s[0],Jt[o*4+1]=s[1],Jt[o*4+2]=s[2]}e.value=Jt.subarray(0,n*4)}_setModelAttributes(e,n,r=!1){var a;if(!Object.keys(n).length)return;if(r){const l=this.getAttributeManager();e.setBufferLayout(l.getBufferLayouts(e)),n=l.getAttributes()}const i=((a=e.userData)==null?void 0:a.excludeAttributes)||{},s={},o={};for(const l in n){if(i[l])continue;const c=n[l].getValue();for(const u in c){const f=c[u];f instanceof ge?n[l].settings.isIndexed?e.setIndexBuffer(f):s[u]=f:f&&(o[u]=f)}}e.setAttributes(s),e.setConstantAttributes(o)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i,o=s&&n.attributes&&n.attributes[s.id];if(o&&o.value){const a=o.value,l=this.encodePickingColor(e);for(let c=0;c<n.length;c++){const u=s.getVertexOffset(c);a[u]===l[0]&&a[u+1]===l[1]&&a[u+2]===l[2]&&this._disablePickingIndex(c)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const s=i.getVertexOffset(e),o=i.getVertexOffset(e+1);i.buffer.write(new Uint8Array(o-s),s)}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==Jt.buffer&&(r.value=Jt.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Ce(!this.internalState),Ce(Number.isFinite(this.props.coordinateSystem)),Ke(kU,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new NU({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(J.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new rU(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Ke(BU,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Ke(FU,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,s=r.viewport,o=this._updateUniformTransition();i.propsInTransition=o,r.viewport=i.viewport||s,this.props=o;try{const a=this._getUpdateParams(),l=this.getModels();if(r.device)this.updateState(a);else try{this.updateState(a)}catch{}for(const u of this.props.extensions)u.updateState.call(this,a,u);const c=this.getModels()[0]!==l[0];this._postUpdate(a,c)}finally{r.viewport=s,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Ke(DU,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,moduleParameters:n=null,uniforms:r={},parameters:i={}}){this._updateAttributeTransition();const s=this.props,o=this.context;this.props=this.internalState.propsInTransition||s;const a=this.props.opacity;r.opacity=Math.pow(a,1/2.2);try{if(n){const{isActive:u,isAttribute:f}=n.picking;this.setModuleParameters(n),this.setShaderModuleProps({picking:{isActive:u,isAttribute:f}})}const{getPolygonOffset:l}=this.props,c=l&&l(r)||[0,0];o.device.setParametersWebGL({polygonOffset:c});for(const u of this.getModels())u.setParameters(i);o.device.withParametersWebGL(i,()=>{const u={renderPass:e,moduleParameters:n,uniforms:r,parameters:i,context:o};for(const f of this.props.extensions)f.draw.call(this,u,f);this.draw(u)})}finally{this.props=s}}getChangeFlags(){var e;return(e=this.internalState)==null?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let s=!1;switch(i){case"dataChanged":const o=e[i],a=n[i];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:n[i]||(n[i]=e[i],s=!0)}s&&Ke(OU,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){var i;const r=sU(e,n);if(r.updateTriggersChanged)for(const s in r.updateTriggersChanged)r.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(r.transitionsChanged)for(const s in r.transitionsChanged)this.internalState.uniformTransitions.add(s,n[s],e[s],(i=e.transitions)==null?void 0:i[s]);return this.setChangeFlags(r)}validateProps(){iU(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={highlightedObjectColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.highlightColor=r(e)),this.setShaderModuleProps({picking:n}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new JL(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const s=this.state.model;s!=null&&s.isInstanced&&s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:l}=r;if(n||i.autoHighlight!==o||i.highlightedObjectIndex!==a||i.highlightColor!==l){const c={};Array.isArray(l)&&(c.highlightColor=l),(n||i.autoHighlight!==o||a!==i.highlightedObjectIndex)&&(c.highlightedObjectColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setShaderModuleProps({picking:c})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const s of this.props.extensions)s.onNeedsRedraw.call(this,s);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}};gu.defaultProps=zU,gu.layerName="Layer";let mr=gu;const VU="compositeLayer.renderLayers",N_=class N_ extends mr{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var O;const{opacity:n,pickable:r,visible:i,parameters:s,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:l,highlightColor:c,coordinateSystem:u,coordinateOrigin:f,wrapLongitude:h,positionFormat:d,modelMatrix:_,extensions:g,fetch:b,operation:m,_subLayerProps:p}=this.props,y={id:"",updateTriggers:{},opacity:n,pickable:r,visible:i,parameters:s,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:l,highlightColor:c,coordinateSystem:u,coordinateOrigin:f,wrapLongitude:h,positionFormat:d,modelMatrix:_,extensions:g,fetch:b,operation:m},S=p&&e.id&&p[e.id],R=S&&S.updateTriggers,P=e.id||"sublayer";if(S){const k=this.props[fr],D=e.type?e.type._propTypes:{};for(const z in S){const H=D[z]||k[z];H&&H.type==="accessor"&&(S[z]=this.getSubLayerAccessor(S[z]))}}Object.assign(y,e,S),y.id=`${this.props.id}-${P}`,y.updateTriggers={all:(O=this.props.updateTriggers)==null?void 0:O.all,...e.updateTriggers,...R};for(const k of g){const D=k.getSubLayerProps.call(this,k);D&&Object.assign(y,D,{updateTriggers:Object.assign(y.updateTriggers,D.updateTriggers)})}return y}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const s=this.renderLayers();r=bs(s,Boolean),this.internalState.subLayers=r}Ke(VU,this,i,r);for(const s of r)s.parent=this}};N_.layerName="CompositeLayer";let Xc=N_;class rb{constructor(e){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;const{attributes:n={}}=e;this.typedArrayManager=Ss,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:s,positionFormat:o,dataChanged:a,normalize:l=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=s&&s.size||(o==="XY"?2:3),this.buffers=r,this.normalize=l,s&&(Ce(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),l||(r.vertexPositions=s)),this.geometryBuffer=r.vertexPositions,Array.isArray(a))for(const c of a)this._rebuildGeometry(c);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?H1(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:s,typedArrayManager:o}=this;for(const a in s)if(a in i)o.release(r[a]),r[a]=null;else{const l=s[a];l.copy=n,r[a]=o.allocate(r[a],e,l)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:s}=this,{iterable:o,objectInfo:a}=lf(i,n,r);for(const l of o){a.index++;const c=s?s(l,a):null;e(c,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:s,geometryBuffer:o}=this,{startRow:a=0,endRow:l=1/0}=e||{},c={};if(e||(n=[0],r=[0]),this.normalize||!o)this._forEachGeometry((f,h)=>{const d=f&&this.normalizeGeometry(f);c[h]=d,r[h+1]=r[h]+(d?this.getGeometrySize(d):0)},a,l),i=r[r.length-1];else if(r=s.startIndices,i=r[s.length]||0,ArrayBuffer.isView(o))i=i||o.length/this.positionSize;else if(o instanceof ge){const f=this.positionSize*4;i=i||o.byteLength/f}else if(o.buffer){const f=o.stride||this.positionSize*4;i=i||o.buffer.byteLength/f}else if(o.value){const f=o.value,h=o.stride/f.BYTES_PER_ELEMENT||this.positionSize;i=i||f.length/h}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const u={};this._forEachGeometry((f,h)=>{const d=c[h]||f;u.vertexStart=r[h],u.indexStart=n[h];const _=h<r.length-1?r[h+1]:i;u.geometrySize=_-r[h],u.geometryIndex=h,this.updateGeometryAttributes(d,u)},a,l),this.vertexCount=n[n.length-1]}}const $U=`#version 300 es
#define SHADER_NAME icon-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceSizes;
in float instanceAngles;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec4 instanceIconFrames;
in float instanceColorModes;
in vec2 instanceOffsets;
in vec2 instancePixelOffset;
uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;
out float vColorMode;
out vec4 vColor;
out vec2 vTextureCoords;
out vec2 uv;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = angle * PI / 180.0;
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vec2 iconSize = instanceIconFrames.zw;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
sizeMinPixels, sizeMaxPixels
);
float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
pixelOffset += instancePixelOffset;
pixelOffset.y *= -1.0;
if (billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vTextureCoords = mix(
instanceIconFrames.xy,
instanceIconFrames.xy + iconSize,
(positions.xy + 1.0) / 2.0
) / iconsTextureDim;
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
vColorMode = instanceColorModes;
}
`,jU=`#version 300 es
#define SHADER_NAME icon-layer-fragment-shader
precision highp float;
uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;
in float vColorMode;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec4 texColor = texture(iconsTexture, vTextureCoords);
vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
float a = texColor.a * opacity * vColor.a;
if (a < alphaCutoff) {
discard;
}
fragColor = vec4(color, a);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,WU=1024,HU=4,xv=()=>{},Cv={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},XU={x:0,y:0,width:0,height:0};function YU(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function KU(t,e,n,r){const i=Math.min(n/e.width,r/e.height),s=Math.floor(e.width*i),o=Math.floor(e.height*i);return i===1?{data:e,width:s,height:o}:(t.canvas.height=o,t.canvas.width=s,t.clearRect(0,0,s,o),t.drawImage(e,0,0,e.width,e.height,0,0,s,o),{data:t.canvas,width:s,height:o})}function na(t){return t&&(t.id||t.url)}function qU(t,e,n,r){const{width:i,height:s,device:o}=t,a=o.createTexture({format:"rgba8unorm",width:e,height:n,sampler:r}),l=o.createCommandEncoder();return l.copyTextureToTexture({source:t,destination:a,width:i,height:s}),l.finish(),t.destroy(),a}function Pv(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:s}=e[r],o=na(i);t[o]={...i,x:s,y:n}}}function ZU({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let l=0;l<t.length;l++){const c=t[l],u=na(c);if(!n[u]){const{height:f,width:h}=c;r+h+e>o&&(Pv(n,a,i),r=0,i=s+i+e,s=0,a=[]),a.push({icon:c,xOffset:r}),r=r+h+e,s=Math.max(s,f)}}return a.length>0&&Pv(n,a,i),{mapping:n,rowHeight:s,xOffset:r,yOffset:i,canvasWidth:o,canvasHeight:YU(s+i+e)}}function QU(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:s}=lf(t);for(const o of i){s.index++;const a=e(o,s),l=na(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!r[l]&&(!n[l]||a.url!==n[l].url)&&(r[l]={...a,source:o,sourceIndex:s.index})}return r}class JU{constructor(e,{onUpdate:n=xv,onError:r=xv}){this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._textureParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=HU,this._canvasWidth=WU,this._canvasHeight=0,this._canvas=null,this.device=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)==null||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?na(e):e;return this._mapping[n]||XU}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:s}){var o;e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r&&((o=this._texture)==null||o.delete(),this._texture=null,this._externalTexture=r),s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(QU(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:s,yOffset:o,rowHeight:a,canvasHeight:l}=ZU({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=i,this._xOffset=s,this._yOffset=o,this._canvasHeight=l,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",width:this._canvasWidth,height:this._canvasHeight,sampler:this._textureParameters||Cv})),this._texture.height!==this._canvasHeight&&(this._texture=qU(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||Cv)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,Rc(r.url,this._loadOptions).then(i=>{const s=na(r),o=this._mapping[s],{x:a,y:l,width:c,height:u}=o,{data:f,width:h,height:d}=KU(n,i,c,u);this._texture.setSubImageData({data:f,x:a+(c-h)/2,y:l+(u-d)/2,width:h,height:d}),o.width=h,o.height=d,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const ib=[0,0,0,255],GU={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:ib},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}},_u=class _u extends mr{getShaders(){return super.getShaders({vs:$U,fs:jU,modules:[Aa,Ra]})}initializeState(){this.state={iconManager:new JU(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:ib},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){var d;super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:l,getIcon:c,textureParameters:u}=n,{iconManager:f}=this.state;if(typeof o=="string")return;const h=o||this.internalState.isAsyncPropLoading("iconAtlas");f.setProps({loadOptions:n.loadOptions,autoPacking:!h,iconAtlas:o,iconMapping:h?a:null,textureParameters:u}),h?r.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&f.packIcons(l,c),i.extensionsChanged&&((d=this.state.model)==null||d.destroy(),this.state.model=this._getModel(),s.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:l}=this.state,c=l.getTexture();if(c){const u=this.state.model;u.setBindings({iconsTexture:c}),u.setUniforms(e),u.setUniforms({iconsTextureDim:[c.width,c.height],sizeUnits:ei[s],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:o,alphaCutoff:a}),u.draw(this.context.renderPass)}}_getModel(){const e=[-1,-1,1,-1,-1,1,1,1];return new $t(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Es({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var r;const n=(r=this.getCurrentLayer())==null?void 0:r.props.onIconError;n?n(e):J.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:s=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:s}=this.state.iconManager.getIconMapping(e);return[n,r,i,s]}};_u.defaultProps=GU,_u.layerName="IconLayer";let Yc=_u;const e8=`#version 300 es
#define SHADER_NAME scatterplot-layer-vertex-shader
in vec3 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceRadius;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;
out vec4 vFillColor;
out vec4 vLineColor;
out vec2 unitPosition;
out float innerUnitRadius;
out float outerRadiusPixels;
void main(void) {
geometry.worldPosition = instancePositions;
outerRadiusPixels = clamp(
project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
radiusMinPixels, radiusMaxPixels
);
float lineWidthPixels = clamp(
project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
lineWidthMinPixels, lineWidthMaxPixels
);
outerRadiusPixels += stroked * lineWidthPixels / 2.0;
float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
unitPosition = edgePadding * positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
if (billboard) {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = edgePadding * positions * outerRadiusPixels;
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,t8=`#version 300 es
#define SHADER_NAME scatterplot-layer-fragment-shader
precision highp float;
uniform bool filled;
uniform float stroked;
uniform bool antialiasing;
in vec4 vFillColor;
in vec4 vLineColor;
in vec2 unitPosition;
in float innerUnitRadius;
in float outerRadiusPixels;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition;
float distToCenter = length(unitPosition) * outerRadiusPixels;
float inCircle = antialiasing ?
smoothedge(distToCenter, outerRadiusPixels) :
step(distToCenter, outerRadiusPixels);
if (inCircle == 0.0) {
discard;
}
if (stroked > 0.5) {
float isLine = antialiasing ?
smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
step(innerUnitRadius * outerRadiusPixels, distToCenter);
if (filled) {
fragColor = mix(vFillColor, vLineColor, isLine);
} else {
if (isLine == 0.0) {
discard;
}
fragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
}
} else if (!filled) {
discard;
} else {
fragColor = vFillColor;
}
fragColor.a *= inCircle;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Iv=[0,0,0,255],n8={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:Iv},getLineColor:{type:"accessor",value:Iv},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}},mu=class mu extends mr{getShaders(){return super.getShaders({vs:e8,fs:t8,modules:[Aa,Ra]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){var n;super.updateState(e),e.changeFlags.extensionsChanged&&((n=this.state.model)==null||n.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,stroked:o,filled:a,billboard:l,antialiasing:c,lineWidthUnits:u,lineWidthScale:f,lineWidthMinPixels:h,lineWidthMaxPixels:d}=this.props,_=this.state.model;_.setUniforms(e),_.setUniforms({stroked:o?1:0,filled:a,billboard:l,antialiasing:c,radiusUnits:ei[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:s,lineWidthUnits:ei[u],lineWidthScale:f,lineWidthMinPixels:h,lineWidthMaxPixels:d}),_.draw(this.context.renderPass)}_getModel(){const e=[-1,-1,0,1,-1,0,-1,1,0,1,1,0];return new $t(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Es({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array(e)}}}),isInstanced:!0})}};mu.defaultProps=n8,mu.layerName="ScatterplotLayer";let xp=mu;const sb={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function ob(t,e,n={}){return r8(t,n)!==e?(s8(t,n),!0):!1}function r8(t,e={}){return Math.sign(i8(t,e))}const Mv={x:0,y:1,z:2};function i8(t,e={}){const{start:n=0,end:r=t.length,plane:i="xy"}=e,s=e.size||2;let o=0;const a=Mv[i[0]],l=Mv[i[1]];for(let c=n,u=r-s;c<r;c+=s)o+=(t[c+a]-t[u+a])*(t[c+l]+t[u+l]),u=c;return o/2}function s8(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,s=(r-n)/i,o=Math.floor(s/2);for(let a=0;a<o;++a){const l=n+a*i,c=n+(s-1-a)*i;for(let u=0;u<i;++u){const f=t[l+u];t[l+u]=t[c+u],t[c+u]=f}}}function Lt(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let s=0;s<n;s++)if(t[r-n+s]!==e[s]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function Cp(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function ra(t,e,n,r,i=[]){const s=r+e*n;for(let o=0;o<n;o++)i[o]=t[s+o];return i}function Pp(t,e,n,r,i=[]){let s,o;if(n&8)s=(r[3]-t[1])/(e[1]-t[1]),o=3;else if(n&4)s=(r[1]-t[1])/(e[1]-t[1]),o=1;else if(n&2)s=(r[2]-t[0])/(e[0]-t[0]),o=2;else if(n&1)s=(r[0]-t[0])/(e[0]-t[0]),o=0;else return null;for(let a=0;a<t.length;a++)i[a]=(o&1)===a?r[o]:s*(e[a]-t[a])+t[a];return i}function Hl(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function ab(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:s=[0,0],startIndex:o=0,endIndex:a=t.length}=e||{},l=(a-o)/n;let c=[];const u=[c],f=ra(t,0,n,o);let h,d;const _=cb(f,i,s,[]),g=[];Lt(c,f);for(let b=1;b<l;b++){for(h=ra(t,b,n,o,h),d=Hl(h,_);d;){Pp(f,h,d,_,g);const m=Hl(g,_);m&&(Pp(f,g,m,_,g),d=m),Lt(c,g),Cp(f,g),a8(_,i,d),r&&c.length>n&&(c=[],u.push(c),Lt(c,f)),d=Hl(h,_)}Lt(c,h),Cp(f,h)}return r?u:u[0]}const Nv=0,o8=1;function lb(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:s=[0,0],edgeTypes:o=!1}=n||{},a=[],l=[{pos:t,types:o?new Array(t.length/r).fill(o8):null,holes:e||[]}],c=[[],[]];let u=[];for(;l.length;){const{pos:f,types:h,holes:d}=l.shift();l8(f,r,d[0]||f.length,c),u=cb(c[0],i,s,u);const _=Hl(c[1],u);if(_){let g=Ov(f,h,r,0,d[0]||f.length,u,_);const b={pos:g[0].pos,types:g[0].types,holes:[]},m={pos:g[1].pos,types:g[1].types,holes:[]};l.push(b,m);for(let p=0;p<d.length;p++)g=Ov(f,h,r,d[p],d[p+1]||f.length,u,_),g[0]&&(b.holes.push(b.pos.length),b.pos=Tl(b.pos,g[0].pos),o&&(b.types=Tl(b.types,g[0].types))),g[1]&&(m.holes.push(m.pos.length),m.pos=Tl(m.pos,g[1].pos),o&&(m.types=Tl(m.types,g[1].types)))}else{const g={positions:f};o&&(g.edgeTypes=h),d.length&&(g.holeIndices=d),a.push(g)}}return a}function Ov(t,e,n,r,i,s,o){const a=(i-r)/n,l=[],c=[],u=[],f=[],h=[];let d,_,g;const b=ra(t,a-1,n,r);let m=Math.sign(o&8?b[1]-s[3]:b[0]-s[2]),p=e&&e[a-1],y=0,S=0;for(let R=0;R<a;R++)d=ra(t,R,n,r,d),_=Math.sign(o&8?d[1]-s[3]:d[0]-s[2]),g=e&&e[r/n+R],_&&m&&m!==_&&(Pp(b,d,o,s,h),Lt(l,h)&&u.push(p),Lt(c,h)&&f.push(p)),_<=0?(Lt(l,d)&&u.push(g),y-=_):u.length&&(u[u.length-1]=Nv),_>=0?(Lt(c,d)&&f.push(g),S+=_):f.length&&(f[f.length-1]=Nv),Cp(b,d),m=_,p=g;return[y?{pos:l,types:e&&u}:null,S?{pos:c,types:e&&f}:null]}function cb(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=s,r[2]=i+e,r[3]=s+e,r}function a8(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function l8(t,e,n,r){let i=1/0,s=-1/0,o=1/0,a=-1/0;for(let l=0;l<n;l+=e){const c=t[l],u=t[l+1];i=c<i?c:i,s=c>s?c:s,o=u<o?u:o,a=u>a?u:a}return r[0][0]=i,r[0][1]=o,r[1][0]=s,r[1][1]=a,r}function Tl(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}const c8=85.051129;function u8(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:s=!0}=e||{},o=t.slice(r,i);ub(o,n,0,i-r);const a=ab(o,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const l of a)fb(l,n);return a}function f8(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:s=!1}=n||{};e=e||[];const o=[],a=[];let l=0,c=0;for(let f=0;f<=e.length;f++){const h=e[f]||t.length,d=c,_=h8(t,r,l,h);for(let g=_;g<h;g++)o[c++]=t[g];for(let g=l;g<_;g++)o[c++]=t[g];ub(o,r,d,c),d8(o,r,d,c,n==null?void 0:n.maxLatitude),l=h,a[f]=c}a.pop();const u=lb(o,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(i)for(const f of u)fb(f.positions,r);return u}function h8(t,e,n,r){let i=-1,s=-1;for(let o=n+1;o<r;o+=e){const a=Math.abs(t[o]);a>i&&(i=a,s=o-1)}return s}function d8(t,e,n,r,i=c8){const s=t[n],o=t[r-e];if(Math.abs(s-o)>180){const a=ra(t,0,e,n);a[0]+=Math.round((o-s)/360)*360,Lt(t,a),a[1]=Math.sign(a[1])*i,Lt(t,a),a[0]=s,Lt(t,a)}}function ub(t,e,n,r){let i=t[0],s;for(let o=n;o<r;o+=e){s=t[o];const a=s-i;(a>180||a<-180)&&(s-=Math.round(a/360)*360),t[o]=i=s}}function fb(t,e){let n;const r=t.length/e;for(let s=0;s<r&&(n=t[s*e],(n+180)%360===0);s++);const i=-Math.round(n/360)*360;if(i!==0)for(let s=0;s<r;s++)t[s*e]+=i}function p8(t,e,n,r){let i;if(Array.isArray(t[0])){const s=t.length*e;i=new Array(s);for(let o=0;o<t.length;o++)for(let a=0;a<e;a++)i[o*e+a]=t[o][a]||0}else i=t;return n?ab(i,{size:e,gridResolution:n}):r?u8(i,{size:e}):i}const g8=1,_8=2,kh=4;class m8 extends rb{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?p8(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(kv(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&kv(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:o}=n;r.fill(0,s,s+o),i?(r[s]=kh,r[s+o-2]=kh):(r[s]+=g8,r[s+o-2]+=_8),r[s+o-1]=kh}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:s}=n,o=new Array(3);for(let a=i,l=0;l<s;a++,l++)this.getPointOnPath(e,l,o),r[a*3]=o[0],r[a*3+1]=o[1],r[a*3+2]=o[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const s=n*i;return r[0]=e[s],r[1]=e[s+1],r[2]=i===3&&e[s+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function kv(t){return Array.isArray(t[0])}const y8=`#version 300 es
#define SHADER_NAME path-layer-vertex-shader
in vec2 positions;
in float instanceTypes;
in vec3 instanceStartPositions;
in vec3 instanceEndPositions;
in vec3 instanceLeftPositions;
in vec3 instanceRightPositions;
in vec3 instanceLeftPositions64Low;
in vec3 instanceStartPositions64Low;
in vec3 instanceEndPositions64Low;
in vec3 instanceRightPositions64Low;
in float instanceStrokeWidths;
in vec4 instanceColors;
in vec3 instancePickingColors;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;
uniform float opacity;
out vec4 vColor;
out vec2 vCornerOffset;
out float vMiterLength;
out vec2 vPathPosition;
out float vPathLength;
out float vJointType;
const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);
float flipIfTrue(bool flag) {
return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
vec2 width
) {
bool isEnd = positions.x > 0.0;
float sideOfPath = positions.y;
float isJoint = float(sideOfPath == 0.0);
vec3 deltaA3 = (currPoint - prevPoint);
vec3 deltaB3 = (nextPoint - currPoint);
mat3 rotationMatrix;
bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
if (needsRotation) {
deltaA3 = deltaA3 * rotationMatrix;
deltaB3 = deltaB3 * rotationMatrix;
}
vec2 deltaA = deltaA3.xy / width;
vec2 deltaB = deltaB3.xy / width;
float lenA = length(deltaA);
float lenB = length(deltaB);
vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);
vec2 perpA = vec2(-dirA.y, dirA.x);
vec2 perpB = vec2(-dirB.y, dirB.x);
vec2 tangent = dirA + dirB;
tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
vec2 miterVec = vec2(-tangent.y, tangent.x);
vec2 dir = isEnd ? dirA : dirB;
vec2 perp = isEnd ? perpA : perpB;
float L = isEnd ? lenA : lenB;
float sinHalfA = abs(dot(miterVec, perp));
float cosHalfA = abs(dot(dirA, miterVec));
float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
float cornerPosition = sideOfPath * turnDirection;
float miterSize = 1.0 / max(sinHalfA, EPSILON);
miterSize = mix(
min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
miterSize,
step(0.0, cornerPosition)
);
vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
* (sideOfPath + isJoint * turnDirection);
bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
bool isCap = isStartCap || isEndCap;
if (isCap) {
offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
vJointType = capType;
} else {
vJointType = jointType;
}
vPathLength = L;
vCornerOffset = offsetVec;
vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
vMiterLength = isCap ? isJoint : vMiterLength;
vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
vPathPosition = vec2(
dot(offsetFromStartOfPath, perp),
dot(offsetFromStartOfPath, dir)
);
geometry.uv = vPathPosition;
float isValid = step(instanceTypes, 3.5);
vec3 offset = vec3(offsetVec * width * isValid, 0.0);
if (needsRotation) {
offset = rotationMatrix * offset;
}
return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
if (position.w < EPSILON) {
float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
position = refPosition + (position - refPosition) * r;
}
}
void main() {
geometry.pickingColor = instancePickingColors;
vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);
float isEnd = positions.x;
vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);
vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);
vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);
geometry.worldPosition = currPosition;
vec2 widthPixels = vec2(clamp(
project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
widthMinPixels, widthMaxPixels) / 2.0);
vec3 width;
if (billboard) {
vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);
clipLine(prevPositionScreen, currPositionScreen);
clipLine(nextPositionScreen, currPositionScreen);
clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));
width = vec3(widthPixels, 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(
prevPositionScreen.xyz / prevPositionScreen.w,
currPositionScreen.xyz / currPositionScreen.w,
nextPositionScreen.xyz / nextPositionScreen.w,
project_pixel_size_to_clipspace(width.xy)
);
DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
} else {
prevPosition = project_position(prevPosition, prevPosition64Low);
currPosition = project_position(currPosition, currPosition64Low);
nextPosition = project_position(nextPosition, nextPosition64Low);
width = vec3(project_pixel_size(widthPixels), 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
geometry.position = vec4(currPosition + offset, 1.0);
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,v8=`#version 300 es
#define SHADER_NAME path-layer-fragment-shader
precision highp float;
uniform float miterLimit;
in vec4 vColor;
in vec2 vCornerOffset;
in float vMiterLength;
in vec2 vPathPosition;
in float vPathLength;
in float vJointType;
out vec4 fragColor;
void main(void) {
geometry.uv = vPathPosition;
if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
discard;
}
if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
discard;
}
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,hb=[0,0,0,255],T8={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:hb},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},Fh={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t},yu=class yu extends mr{getShaders(){return super.getShaders({vs:y8,fs:v8,modules:[Aa,Ra]})}get wrapLongitude(){return!1}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["vertexPositions"])}initializeState(){this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:Fh,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:Fh,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:Fh,defaultValue:hb},instancePickingColors:{size:4,type:"uint8",accessor:(r,{index:i,target:s})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,s)}}),this.setState({pathTesselator:new m8({fp64:this.use64bitPositions()})})}updateState(e){var o;super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,l=n.data.attributes||{};a.updateGeometry({data:n.data,geometryBuffer:l.getPath,buffers:l,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),r.dataChanged||i.invalidateAll()}r.extensionsChanged&&((o=this.state.model)==null||o.destroy(),this.state.model=this._getModel(),i.invalidateAll())}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,i=this.props.data;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const n=this.props.data;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:s,widthUnits:o,widthScale:a,widthMinPixels:l,widthMaxPixels:c}=this.props,u=this.state.model;u.setUniforms(e),u.setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:ei[o],widthScale:a,miterLimit:s,widthMinPixels:l,widthMaxPixels:c}),u.draw(this.context.renderPass)}_getModel(){const e=[0,1,2,1,4,2,1,3,4,3,5,4],n=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new $t(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Es({topology:"triangle-list",attributes:{indices:new Uint16Array(e),positions:{value:new Float32Array(n),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}};yu.defaultProps=T8,yu.layerName="PathLayer";let Ip=yu;var P_={exports:{}};P_.exports=cf;P_.exports.default=cf;function cf(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,s=db(t,0,i,n,!0),o=[];if(!s||s.next===s.prev)return o;var a,l,c,u,f,h,d;if(r&&(s=A8(t,e,s,n)),t.length>80*n){a=c=t[0],l=u=t[1];for(var _=n;_<i;_+=n)f=t[_],h=t[_+1],f<a&&(a=f),h<l&&(l=h),f>c&&(c=f),h>u&&(u=h);d=Math.max(c-a,u-l),d=d!==0?32767/d:0}return ia(s,o,n,a,l,d,0),o}function db(t,e,n,r,i){var s,o;if(i===Op(t,e,n,r)>0)for(s=e;s<n;s+=r)o=Fv(s,t[s],t[s+1],o);else for(s=n-r;s>=e;s-=r)o=Fv(s,t[s],t[s+1],o);return o&&uf(o,o.next)&&(oa(o),o=o.next),o}function ri(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(uf(n,n.next)||ye(n.prev,n,n.next)===0)){if(oa(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function ia(t,e,n,r,i,s,o){if(t){!o&&s&&I8(t,r,i,s);for(var a=t,l,c;t.prev!==t.next;){if(l=t.prev,c=t.next,s?S8(t,r,i,s):w8(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(c.i/n|0),oa(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=E8(ri(t),e,n),ia(t,e,n,r,i,s,2)):o===2&&b8(t,e,n,r,i,s):ia(ri(t),e,n,r,i,s,1);break}}}}function w8(t){var e=t.prev,n=t,r=t.next;if(ye(e,n,r)>=0)return!1;for(var i=e.x,s=n.x,o=r.x,a=e.y,l=n.y,c=r.y,u=i<s?i<o?i:o:s<o?s:o,f=a<l?a<c?a:c:l<c?l:c,h=i>s?i>o?i:o:s>o?s:o,d=a>l?a>c?a:c:l>c?l:c,_=r.next;_!==e;){if(_.x>=u&&_.x<=h&&_.y>=f&&_.y<=d&&Xi(i,a,s,l,o,c,_.x,_.y)&&ye(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function S8(t,e,n,r){var i=t.prev,s=t,o=t.next;if(ye(i,s,o)>=0)return!1;for(var a=i.x,l=s.x,c=o.x,u=i.y,f=s.y,h=o.y,d=a<l?a<c?a:c:l<c?l:c,_=u<f?u<h?u:h:f<h?f:h,g=a>l?a>c?a:c:l>c?l:c,b=u>f?u>h?u:h:f>h?f:h,m=Mp(d,_,e,n,r),p=Mp(g,b,e,n,r),y=t.prevZ,S=t.nextZ;y&&y.z>=m&&S&&S.z<=p;){if(y.x>=d&&y.x<=g&&y.y>=_&&y.y<=b&&y!==i&&y!==o&&Xi(a,u,l,f,c,h,y.x,y.y)&&ye(y.prev,y,y.next)>=0||(y=y.prevZ,S.x>=d&&S.x<=g&&S.y>=_&&S.y<=b&&S!==i&&S!==o&&Xi(a,u,l,f,c,h,S.x,S.y)&&ye(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;y&&y.z>=m;){if(y.x>=d&&y.x<=g&&y.y>=_&&y.y<=b&&y!==i&&y!==o&&Xi(a,u,l,f,c,h,y.x,y.y)&&ye(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;S&&S.z<=p;){if(S.x>=d&&S.x<=g&&S.y>=_&&S.y<=b&&S!==i&&S!==o&&Xi(a,u,l,f,c,h,S.x,S.y)&&ye(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function E8(t,e,n){var r=t;do{var i=r.prev,s=r.next.next;!uf(i,s)&&pb(i,r,r.next,s)&&sa(i,s)&&sa(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),oa(r),oa(r.next),r=t=s),r=r.next}while(r!==t);return ri(r)}function b8(t,e,n,r,i,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&O8(o,a)){var l=gb(o,a);o=ri(o,o.next),l=ri(l,l.next),ia(o,e,n,r,i,s,0),ia(l,e,n,r,i,s,0);return}a=a.next}o=o.next}while(o!==t)}function A8(t,e,n,r){var i=[],s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*r,l=s<o-1?e[s+1]*r:t.length,c=db(t,a,l,r,!1),c===c.next&&(c.steiner=!0),i.push(N8(c));for(i.sort(R8),s=0;s<i.length;s++)n=x8(i[s],n);return n}function R8(t,e){return t.x-e.x}function x8(t,e){var n=C8(t,e);if(!n)return e;var r=gb(n,t);return ri(r,r.next),ri(n,n.next)}function C8(t,e){var n=e,r=t.x,i=t.y,s=-1/0,o;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var a=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>s&&(s=a,o=n.x<n.next.x?n:n.next,a===r))return o}n=n.next}while(n!==e);if(!o)return null;var l=o,c=o.x,u=o.y,f=1/0,h;n=o;do r>=n.x&&n.x>=c&&r!==n.x&&Xi(i<u?r:s,i,c,u,i<u?s:r,i,n.x,n.y)&&(h=Math.abs(i-n.y)/(r-n.x),sa(n,t)&&(h<f||h===f&&(n.x>o.x||n.x===o.x&&P8(o,n)))&&(o=n,f=h)),n=n.next;while(n!==l);return o}function P8(t,e){return ye(t.prev,t,e.prev)<0&&ye(e.next,t,t.next)<0}function I8(t,e,n,r){var i=t;do i.z===0&&(i.z=Mp(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,M8(i)}function M8(t){var e,n,r,i,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,r=n,a=0,e=0;e<c&&(a++,r=r.nextZ,!!r);e++);for(l=c;a>0||l>0&&r;)a!==0&&(l===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,c*=2}while(o>1);return t}function Mp(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function N8(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Xi(t,e,n,r,i,s,o,a){return(i-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(r-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(i-o)*(r-a)}function O8(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!k8(t,e)&&(sa(t,e)&&sa(e,t)&&F8(t,e)&&(ye(t.prev,t,e.prev)||ye(t,e.prev,e))||uf(t,e)&&ye(t.prev,t,t.next)>0&&ye(e.prev,e,e.next)>0)}function ye(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function uf(t,e){return t.x===e.x&&t.y===e.y}function pb(t,e,n,r){var i=Sl(ye(t,e,n)),s=Sl(ye(t,e,r)),o=Sl(ye(n,r,t)),a=Sl(ye(n,r,e));return!!(i!==s&&o!==a||i===0&&wl(t,n,e)||s===0&&wl(t,r,e)||o===0&&wl(n,t,r)||a===0&&wl(n,e,r))}function wl(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Sl(t){return t>0?1:t<0?-1:0}function k8(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&pb(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function sa(t,e){return ye(t.prev,t,t.next)<0?ye(t,e,t.next)>=0&&ye(t,t.prev,e)>=0:ye(t,e,t.prev)<0||ye(t,t.next,e)<0}function F8(t,e){var n=t,r=!1,i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function gb(t,e){var n=new Np(t.i,t.x,t.y),r=new Np(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function Fv(t,e,n,r){var i=new Np(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function oa(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Np(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}cf.deviation=function(t,e,n,r){var i=e&&e.length,s=i?e[0]*n:t.length,o=Math.abs(Op(t,0,s,n));if(i)for(var a=0,l=e.length;a<l;a++){var c=e[a]*n,u=a<l-1?e[a+1]*n:t.length;o-=Math.abs(Op(t,c,u,n))}var f=0;for(a=0;a<r.length;a+=3){var h=r[a]*n,d=r[a+1]*n,_=r[a+2]*n;f+=Math.abs((t[h]-t[_])*(t[d+1]-t[h+1])-(t[h]-t[d])*(t[_+1]-t[h+1]))}return o===0&&f===0?0:Math.abs((f-o)/o)};function Op(t,e,n,r){for(var i=0,s=e,o=n-r;s<n;s+=r)i+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return i}cf.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var s=0;s<t[i].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[i][s][o]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var D8=P_.exports;const B8=bu(D8),El=sb.CLOCKWISE,Dv=sb.COUNTER_CLOCKWISE,nr={isClosed:!0};function L8(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function co(t){return"positions"in t?t.positions:t}function Xl(t){return"holeIndices"in t?t.holeIndices:null}function U8(t){return Array.isArray(t[0])}function z8(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function V8(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function $8(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function Bv(t,e,n,r,i){let s=e;const o=n.length;for(let a=0;a<o;a++)for(let l=0;l<r;l++)t[s++]=n[a][l]||0;if(!V8(n))for(let a=0;a<r;a++)t[s++]=n[0][a]||0;return nr.start=e,nr.end=s,nr.size=r,ob(t,i,nr),s}function Lv(t,e,n,r,i=0,s,o){s=s||n.length;const a=s-i;if(a<=0)return e;let l=e;for(let c=0;c<a;c++)t[l++]=n[i+c];if(!$8(n,r,i,s))for(let c=0;c<r;c++)t[l++]=n[i+c];return nr.start=e,nr.end=l,nr.size=r,ob(t,o,nr),l}function j8(t,e){L8(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:s}=t;if(s){let o=0;for(let a=0;a<=s.length;a++)o=Lv(n,o,i,e,s[a-1],s[a],a===0?El:Dv),r.push(o);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!U8(t))return Lv(n,0,t,e,0,n.length,El),n;if(!z8(t)){let i=0;for(const[s,o]of t.entries())i=Bv(n,i,o,e,s===0?El:Dv),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return Bv(n,0,t,e,El),n}function Dh(t,e,n){const r=t.length/3;let i=0;for(let s=0;s<r;s++){const o=(s+1)%r;i+=t[s*3+e]*t[o*3+n],i-=t[o*3+e]*t[s*3+n]}return Math.abs(i/2)}function Uv(t,e,n,r){const i=t.length/3;for(let s=0;s<i;s++){const o=s*3,a=t[o+0],l=t[o+1],c=t[o+2];t[o+e]=a,t[o+n]=l,t[o+r]=c}}function W8(t,e,n,r){let i=Xl(t);i&&(i=i.map(a=>a/e));let s=co(t);const o=r&&e===3;if(n){const a=s.length;s=s.slice();const l=[];for(let c=0;c<a;c+=e){l[0]=s[c],l[1]=s[c+1],o&&(l[2]=s[c+2]);const u=n(l);s[c]=u[0],s[c+1]=u[1],o&&(s[c+2]=u[2])}}if(o){const a=Dh(s,0,1),l=Dh(s,0,2),c=Dh(s,1,2);if(!a&&!l&&!c)return[];a>l&&a>c||(l>c?(n||(s=s.slice()),Uv(s,0,2,1)):(n||(s=s.slice()),Uv(s,2,0,1)))}return B8(s,i,e)}class H8 extends rb{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=j8(e,this.positionSize);return this.opts.resolution?lb(co(n),Xl(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?f8(co(n),Xl(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(zv(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return co(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&zv(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else{const r=e;this._updateIndices(r,n),this._updatePositions(r,n),this._updateVertexValid(r,n)}}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:s,indexStarts:o,typedArrayManager:a}=this;let l=s.indices;if(!l||!e)return;let c=i;const u=W8(e,this.positionSize,this.opts.preproject,this.opts.full3d);l=a.allocate(l,i+u.length,{copy:!0});for(let f=0;f<u.length;f++)l[c++]=u[f]+r;o[n+1]=i+u.length,s.indices=l}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:s}=this;if(!i||!e)return;const o=co(e);for(let a=n,l=0;l<r;a++,l++){const c=o[l*s],u=o[l*s+1],f=s>2?o[l*s+2]:0;i[a*3]=c,i[a*3+1]=u,i[a*3+2]=f}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,s=this.attributes.vertexValid,o=e&&Xl(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+r),o)for(let a=0;a<o.length;a++)s[n+o[a]/i-1]=0;s[n+r-1]=0}}function zv(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const _b=`uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;
in vec4 fillColors;
in vec4 lineColors;
in vec3 pickingColors;
out vec4 vColor;
struct PolygonProps {
vec3 positions;
vec3 positions64Low;
vec3 normal;
float elevations;
};
vec3 project_offset_normal(vec3 vector) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
return normalize(vector * project_uCommonUnitsPerWorldUnit);
}
return project_normal(vector);
}
void calculatePosition(PolygonProps props) {
vec3 pos = props.positions;
vec3 pos64Low = props.positions64Low;
vec3 normal = props.normal;
vec4 colors = isWireframe ? lineColors : fillColors;
geometry.worldPosition = props.positions;
geometry.pickingColor = pickingColors;
if (extruded) {
pos.z += props.elevations * elevationScale;
}
gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (extruded) {
#ifdef IS_SIDE_VERTEX
normal = project_offset_normal(normal);
#else
normal = project_normal(normal);
#endif
geometry.normal = normal;
vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, colors.a * opacity);
} else {
vColor = vec4(colors.rgb, colors.a * opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,X8=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader
in vec3 vertexPositions;
in vec3 vertexPositions64Low;
in float elevations;
${_b}
void main(void) {
PolygonProps props;
props.positions = vertexPositions;
props.positions64Low = vertexPositions64Low;
props.elevations = elevations;
props.normal = vec3(0.0, 0.0, 1.0);
calculatePosition(props);
}
`,Y8=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX
in vec2 positions;
in vec3 vertexPositions;
in vec3 nextVertexPositions;
in vec3 vertexPositions64Low;
in vec3 nextVertexPositions64Low;
in float elevations;
in float instanceVertexValid;
${_b}
void main(void) {
if(instanceVertexValid < 0.5){
gl_Position = vec4(0.);
return;
}
PolygonProps props;
vec3 pos;
vec3 pos64Low;
vec3 nextPos;
vec3 nextPos64Low;
#if RING_WINDING_ORDER_CW == 1
pos = vertexPositions;
pos64Low = vertexPositions64Low;
nextPos = nextVertexPositions;
nextPos64Low = nextVertexPositions64Low;
#else
pos = nextVertexPositions;
pos64Low = nextVertexPositions64Low;
nextPos = vertexPositions;
nextPos64Low = vertexPositions64Low;
#endif
props.positions = mix(pos, nextPos, positions.x);
props.positions64Low = mix(pos64Low, nextPos64Low, positions.x);
props.normal = vec3(
pos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),
nextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),
0.0);
props.elevations = elevations * positions.y;
calculatePosition(props);
}
`,K8=`#version 300 es
#define SHADER_NAME solid-polygon-layer-fragment-shader
precision highp float;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Kc=[0,0,0,255],q8={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Kc},getLineColor:{type:"accessor",value:Kc},material:!0},bl={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t},vu=class vu extends mr{getShaders(e){return super.getShaders({vs:e==="top"?X8:Y8,fs:K8,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Aa,MF,Ra]})}get wrapLongitude(){return!1}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["vertexPositions"])}initializeState(){const{viewport:e}=this.context;let{coordinateSystem:n}=this.props;const{_full3d:r}=this.props;e.isGeospatial&&n===te.DEFAULT&&(n=te.LNGLAT);let i;n===te.LNGLAT&&(r?i=e.projectPosition.bind(e):i=e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new H8({preproject:i,fp64:this.use64bitPositions(),IndexType:Uint32Array})});const s=this.getAttributeManager(),o=!0;s.remove(["instancePickingColors"]),s.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:o},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:bl,accessor:"getPolygon",update:this.calculatePositions,noAlloc:o,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:o},elevations:{size:1,stepMode:"dynamic",transition:bl,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:bl,accessor:"getFillColor",defaultValue:Kc},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:bl,accessor:"getLineColor",defaultValue:Kc},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(a,{index:l,target:c})=>this.encodePickingColor(a&&a.__source?a.__source.index:l,c)}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,i=this.props.data;return i[0]&&i[0].__source&&(n.object=i.find(s=>s.__source.index===r)),n}disablePickingIndex(e){const n=this.props.data;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:s}=this.props,{topModel:o,sideModel:a,wireframeModel:l,polygonTesselator:c}=this.state,u={...e,extruded:!!n,elevationScale:s};l&&i&&(l.setInstanceCount(c.instanceCount-1),l.setUniforms(u),l.draw(this.context.renderPass)),a&&r&&(a.setInstanceCount(c.instanceCount-1),a.setUniforms(u),a.draw(this.context.renderPass)),o&&r&&(o.setVertexCount(c.vertexCount),o.setUniforms(u),o.draw(this.context.renderPass))}updateState(e){var a;super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,s=this.getAttributeManager();(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded)&&((a=this.state.models)==null||a.forEach(l=>l.destroy()),this.setState(this._getModels()),s.invalidateAll())}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,o=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:o.getPolygon,buffers:o,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){const{id:e,filled:n,extruded:r}=this.props;let i,s,o;if(n){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1;const l=this.getAttributeManager().getBufferLayouts({isInstanced:!1});i=new $t(this.context.device,{...a,id:`${e}-top`,topology:"triangle-list",uniforms:{isWireframe:!1},bufferLayout:l,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}if(r){const a=this.getAttributeManager().getBufferLayouts({isInstanced:!0});s=new $t(this.context.device,{...this.getShaders("side"),id:`${e}-side`,bufferLayout:a,uniforms:{isWireframe:!1},geometry:new Es({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),o=new $t(this.context.device,{...this.getShaders("side"),id:`${e}-wireframe`,bufferLayout:a,uniforms:{isWireframe:!0},geometry:new Es({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})}return{models:[s,o,i].filter(Boolean),topModel:i,sideModel:s,wireframeModel:o}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}};vu.defaultProps=q8,vu.layerName="SolidPolygonLayer";let kp=vu;function Z8({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:s=1/0}=n,o=t.length;let a=o,l=o;for(let h=0;h<o;h++){const d=e(t[h]);if(a>h&&d>=i&&(a=h),d>=s){l=h;break}}let c=a;const f=l-a!==r.length?t.slice(l):void 0;for(let h=0;h<r.length;h++)t[c++]=r[h];if(f){for(let h=0;h<f.length;h++)t[c++]=f[h];t.length=c}return{startRow:a,endRow:a+r.length}}function Q8(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?J8(t,r,n):null}function J8(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function G8(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const s=[];for(let o=0;o<i.length;o++)e(i[o],s),n[r][o*3+0]=s[0],n[r][o*3+1]=s[1],n[r][o*3+2]=s[2]}return n}const e5=`#version 300 es
#define SHADER_NAME multi-icon-layer-fragment-shader
precision highp float;
uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
if (!bool(picking.isActive)) {
float alpha = texture(iconsTexture, vTextureCoords).a;
vec4 color = vColor;
if (sdf) {
float distance = alpha;
alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);
if (outlineBuffer > 0.0) {
float inFill = alpha;
float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
color = mix(outlineColor, vColor, inFill);
alpha = inBorder;
}
}
float a = alpha * color.a;
if (a < alphaCutoff) {
discard;
}
fragColor = vec4(color.rgb, a * opacity);
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Bh=192/256,Vv=[],t5={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}},Tu=class Tu extends Yc{getShaders(){return{...super.getShaders(),fs:e5}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(s=>s/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&J.warn(`${this.id}: fontSettings.sdf is required to render outline`)()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:s}=this.state,o=i?Math.max(r,Bh*(1-i)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:Bh,outlineBuffer:o,gamma:r,sdf:!!n,outlineColor:s},super.draw(e),n&&i){const{iconManager:a}=this.state,l=a.getTexture(),c=this.state.model;l&&(c.setUniforms({outlineBuffer:Bh}),c.draw(this.context.renderPass))}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):Vv}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):Vv}};Tu.defaultProps=t5,Tu.layerName="MultiIconLayer";let Fp=Tu;const Ao=1e20;class n5{constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:s="sans-serif",fontWeight:o="normal",fontStyle:a="normal"}={}){this.buffer=n,this.cutoff=i,this.radius=r;const l=this.size=e+n*4,c=this._createCanvas(l),u=this.ctx=c.getContext("2d",{willReadFrequently:!0});u.font=`${a} ${o} ${e}px ${s}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Uint16Array(l)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:s,actualBoundingBoxRight:o}=this.ctx.measureText(e),a=Math.ceil(r),l=0,c=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-s))),u=Math.min(this.size-this.buffer,a+Math.ceil(i)),f=c+2*this.buffer,h=u+2*this.buffer,d=Math.max(f*h,0),_=new Uint8ClampedArray(d),g={data:_,width:f,height:h,glyphWidth:c,glyphHeight:u,glyphTop:a,glyphLeft:l,glyphAdvance:n};if(c===0||u===0)return g;const{ctx:b,buffer:m,gridInner:p,gridOuter:y}=this;b.clearRect(m,m,c,u),b.fillText(e,m,m+a);const S=b.getImageData(m,m,c,u);y.fill(Ao,0,d),p.fill(0,0,d);for(let R=0;R<u;R++)for(let P=0;P<c;P++){const O=S.data[4*(R*c+P)+3]/255;if(O===0)continue;const k=(R+m)*f+P+m;if(O===1)y[k]=0,p[k]=Ao;else{const D=.5-O;y[k]=D>0?D*D:0,p[k]=D<0?D*D:0}}$v(y,0,0,f,h,f,this.f,this.v,this.z),$v(p,m,m,c,u,f,this.f,this.v,this.z);for(let R=0;R<d;R++){const P=Math.sqrt(y[R])-Math.sqrt(p[R]);_[R]=Math.round(255-255*(P/this.radius+this.cutoff))}return g}}function $v(t,e,n,r,i,s,o,a,l){for(let c=e;c<e+r;c++)jv(t,n*s+c,s,i,o,a,l);for(let c=n;c<n+i;c++)jv(t,c*s+e,1,r,o,a,l)}function jv(t,e,n,r,i,s,o){s[0]=0,o[0]=-Ao,o[1]=Ao,i[0]=t[e];for(let a=1,l=0,c=0;a<r;a++){i[a]=t[e+a*n];const u=a*a;do{const f=s[l];c=(i[a]-i[f]+u-f*f)/(a-f)/2}while(c<=o[l]&&--l>-1);l++,s[l]=a,o[l]=c,o[l+1]=Ao}for(let a=0,l=0;a<r;a++){for(;o[l+1]<a;)l++;const c=s[l],u=a-c;t[e+a*n]=i[c]+u*u}}const r5=32,i5=[];function s5(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function o5({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:s={},xOffset:o=0,yOffset:a=0}){let l=0,c=o;const u=n+r*2;for(const f of t)if(!s[f]){const h=e(f);c+h+r*2>i&&(c=0,l++),s[f]={x:c+r,y:a+l*u+r,width:h,height:u,layoutWidth:h,layoutHeight:n},c+=h+r*2}return{mapping:s,xOffset:c,yOffset:a+l*u,canvasHeight:s5(a+(l+1)*u)}}function mb(t,e,n,r){var s;let i=0;for(let o=e;o<n;o++){const a=t[o];i+=((s=r[a])==null?void 0:s.layoutWidth)||0}return i}function yb(t,e,n,r,i,s){let o=e,a=0;for(let l=e;l<n;l++){const c=mb(t,l,l+1,i);a+c>r&&(o<l&&s.push(l),o=l,a=0),a+=c}return a}function a5(t,e,n,r,i,s){let o=e,a=e,l=e,c=0;for(let u=e;u<n;u++)if((t[u]===" "||t[u+1]===" "||u+1===n)&&(l=u+1),l>a){let f=mb(t,a,l,i);c+f>r&&(o<a&&(s.push(a),o=a,c=0),f>r&&(f=yb(t,a,l,r,i,s),o=s[s.length-1])),a=l,c+=f}return c}function l5(t,e,n,r,i=0,s){s===void 0&&(s=t.length);const o=[];return e==="break-all"?yb(t,i,s,n,r,o):a5(t,i,s,n,r,o),o}function c5(t,e,n,r,i,s){let o=0,a=0;for(let l=e;l<n;l++){const c=t[l],u=r[c];u?(a||(a=u.layoutHeight),i[l]=o+u.layoutWidth/2,o+=u.layoutWidth):(J.warn(`Missing character: ${c} (${c.codePointAt(0)})`)(),i[l]=o,o+=r5)}s[0]=o,s[1]=a}function u5(t,e,n,r,i){var b;const s=Array.from(t),o=s.length,a=new Array(o),l=new Array(o),c=new Array(o),u=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,f=[0,0],h=[0,0];let d=0,_=0,g=0;for(let m=0;m<=o;m++){const p=s[m];if((p===`
`||m===o)&&(g=m),g>_){const y=u?l5(s,n,r,i,_,g):i5;for(let S=0;S<=y.length;S++){const R=S===0?_:y[S-1],P=S<y.length?y[S]:g;c5(s,R,P,i,a,h);for(let O=R;O<P;O++){const k=s[O],D=((b=i[k])==null?void 0:b.layoutOffsetY)||0;l[O]=d+h[1]/2+D,c[O]=h[0]}d=d+h[1]*e,f[0]=Math.max(f[0],h[0])}_=g}p===`
`&&(a[_]=0,l[_]=0,c[_]=0,_++)}return f[1]=d,{x:a,y:l,rowWidth:c,size:f}}function f5({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:s}){const o=t.BYTES_PER_ELEMENT,a=n?n/o:1,l=r?r/o:0,c=i[e]||Math.ceil((t.length-l)/a),u=s&&new Set,f=new Array(e);let h=t;if(a>1||l>0){const d=t.constructor;h=new d(c);for(let _=0;_<c;_++)h[_]=t[_*a+l]}for(let d=0;d<e;d++){const _=i[d],g=i[d+1]||c,b=h.subarray(_,g);f[d]=String.fromCodePoint.apply(null,b),u&&b.forEach(u.add,u)}if(u)for(const d of u)s.add(String.fromCodePoint(d));return{texts:f,characterCount:c}}class vb{constructor(e=5){this._cache={},this._order=[],this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function h5(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const ss={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:h5(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},Wv=1024,Hv=.9,Xv=1.2,Tb=3;let qc=new vb(Tb);function d5(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=qc.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function p5(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function Yv(t,e,n,r){t.font=`${r} ${n}px ${e}`,t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function g5(t){J.assert(Number.isFinite(t)&&t>=Tb,"Invalid cache limit"),qc=new vb(t)}class _5{constructor(){this.props={...ss}}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*Xv+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=d5(this._key,this.props.characterSet),r=qc.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}const i=this._generateFontAtlas(n,r);this._atlas=i,qc.set(this._key,i)}_generateFontAtlas(e,n){const{fontFamily:r,fontWeight:i,fontSize:s,buffer:o,sdf:a,radius:l,cutoff:c}=this.props;let u=n&&n.data;u||(u=document.createElement("canvas"),u.width=Wv);const f=u.getContext("2d",{willReadFrequently:!0});Yv(f,r,s,i);const{mapping:h,canvasHeight:d,xOffset:_,yOffset:g}=o5({getFontWidth:b=>f.measureText(b).width,fontHeight:s*Xv,buffer:o,characterSet:e,maxCanvasWidth:Wv,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(u.height!==d){const b=f.getImageData(0,0,u.width,u.height);u.height=d,f.putImageData(b,0,0)}if(Yv(f,r,s,i),a){const b=new n5({fontSize:s,buffer:o,radius:l,cutoff:c,fontFamily:r,fontWeight:`${i}`});for(const m of e){const{data:p,width:y,height:S,glyphTop:R}=b.draw(m);h[m].width=y,h[m].layoutOffsetY=s*Hv-R;const P=f.createImageData(y,S);p5(p,P),f.putImageData(P,h[m].x,h[m].y)}}else for(const b of e)f.fillText(b,h[b].x,h[b].y+o+s*Hv);return{xOffset:_,yOffset:g,mapping:h,data:u,width:u.width,height:u.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:s,radius:o,cutoff:a}=this.props;return s?`${e} ${n} ${r} ${i} ${o} ${a}`:`${e} ${n} ${r} ${i}`}}const m5=`#version 300 es
#define SHADER_NAME text-background-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceRects;
in float instanceSizes;
in float instanceAngles;
in vec2 instancePixelOffsets;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;
out vec4 vFillColor;
out vec4 vLineColor;
out float vLineWidth;
out vec2 uv;
out vec2 dimensions;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = radians(angle);
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vLineWidth = instanceLineWidths;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
sizeMinPixels, sizeMaxPixels
);
dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;
vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
pixelOffset += instancePixelOffsets;
pixelOffset.y *= -1.0;
if (billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,y5=`#version 300 es
#define SHADER_NAME text-background-layer-fragment-shader
precision highp float;
uniform bool stroked;
in vec4 vFillColor;
in vec4 vLineColor;
in float vLineWidth;
in vec2 uv;
in vec2 dimensions;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec2 pixelPosition = uv * dimensions;
if (stroked) {
float distToEdge = min(
min(pixelPosition.x, dimensions.x - pixelPosition.x),
min(pixelPosition.y, dimensions.y - pixelPosition.y)
);
float isBorder = smoothedge(distToEdge, vLineWidth);
fragColor = mix(vFillColor, vLineColor, isBorder);
} else {
fragColor = vFillColor;
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,v5={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}},wu=class wu extends mr{getShaders(){return super.getShaders({vs:m5,fs:y5,modules:[Aa,Ra]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){var r;super.updateState(e);const{changeFlags:n}=e;n.extensionsChanged&&((r=this.state.model)==null||r.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:l}=this.props;l.length<4&&(l=[l[0],l[1],l[0],l[1]]);const c=this.state.model;c.setUniforms(e),c.setUniforms({billboard:n,stroked:!!a,padding:l,sizeUnits:ei[i],sizeScale:r,sizeMinPixels:s,sizeMaxPixels:o}),c.draw(this.context.renderPass)}_getModel(){const e=[0,0,1,0,1,1,0,1];return new $t(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Es({topology:"triangle-fan-webgl",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}};wu.defaultProps=v5,wu.layerName="TextBackgroundLayer";let Dp=wu;const Kv={start:1,middle:0,end:-1},qv={top:1,center:0,bottom:-1},Lh=[0,0,0,255],T5=1,w5={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Lh},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:ss.characterSet},fontFamily:ss.fontFamily,fontWeight:ss.fontWeight,lineHeight:T5,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Lh},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Lh},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}},Su=class Su extends Xc{constructor(){super(...arguments),this.getBoundingRect=(e,n)=>{let{size:[r,i]}=this.transformParagraph(e,n);const{fontSize:s}=this.state.fontAtlasManager.props;r/=s,i/=s;const{getTextAnchor:o,getAlignmentBaseline:a}=this.props,l=Kv[typeof o=="function"?o(e,n):o],c=qv[typeof a=="function"?a(e,n):a];return[(l-1)*r/2,(c-1)*i/2,r,i]},this.getIconOffsets=(e,n)=>{const{getTextAnchor:r,getAlignmentBaseline:i}=this.props,{x:s,y:o,rowWidth:a,size:[l,c]}=this.transformParagraph(e,n),u=Kv[typeof r=="function"?r(e,n):r],f=qv[typeof i=="function"?i(e,n):i],h=s.length,d=new Array(h*2);let _=0;for(let g=0;g<h;g++){const b=(1-u)*(l-a[g])/2;d[_++]=(u-1)*l/2+b+s[g],d[_++]=(f-1)*c/2+o[g]}return d}}initializeState(){this.state={styleVersion:0,fontAtlasManager:new _5},this.props.maxWidth>0&&J.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:s}=this.state,o={...e,characterSet:s,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(o),!0;for(const a in o)if(o[a]!==i.props[a])return i.setProps(o),!0;return!1}_updateText(){var l;const{data:e,characterSet:n}=this.props,r=(l=e.attributes)==null?void 0:l.getText;let{getText:i}=this.props,s=e.startIndices,o;const a=n==="auto"&&new Set;if(r&&s){const{texts:c,characterCount:u}=f5({...ArrayBuffer.isView(r)?{value:r}:r,length:e.length,startIndices:s,characterSet:a});o=u,i=(f,{index:h})=>c[h]}else{const{iterable:c,objectInfo:u}=lf(e);s=[0],o=0;for(const f of c){u.index++;const h=Array.from(i(f,u)||"");a&&h.forEach(a.add,a),o+=h.length,s.push(o)}}this.setState({getText:i,startIndices:s,numInstances:o,characterSet:a||n})}transformParagraph(e,n){const{fontAtlasManager:r}=this.state,i=r.mapping,s=this.state.getText,{wordBreak:o,lineHeight:a,maxWidth:l}=this.props,c=s(e,n)||"";return u5(c,a,o,l*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,atlas:s,mapping:o},styleVersion:a}=this.state,{data:l,_dataDiff:c,getPosition:u,getColor:f,getSize:h,getAngle:d,getPixelOffset:_,getBackgroundColor:g,getBorderColor:b,getBorderWidth:m,backgroundPadding:p,background:y,billboard:S,fontSettings:R,outlineWidth:P,outlineColor:O,sizeScale:k,sizeUnits:D,sizeMinPixels:z,sizeMaxPixels:H,transitions:X,updateTriggers:Y}=this.props,Z=this.getSubLayerClass("characters",Fp),je=this.getSubLayerClass("background",Dp);return[y&&new je({getFillColor:g,getLineColor:b,getLineWidth:m,padding:p,getPosition:u,getSize:h,getAngle:d,getPixelOffset:_,billboard:S,sizeScale:k,sizeUnits:D,sizeMinPixels:z,sizeMaxPixels:H,transitions:X&&{getPosition:X.getPosition,getAngle:X.getAngle,getSize:X.getSize,getFillColor:X.getBackgroundColor,getLineColor:X.getBorderColor,getLineWidth:X.getBorderWidth,getPixelOffset:X.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:Y.getPosition,getAngle:Y.getAngle,getSize:Y.getSize,getFillColor:Y.getBackgroundColor,getLineColor:Y.getBorderColor,getLineWidth:Y.getBorderWidth,getPixelOffset:Y.getPixelOffset,getBoundingRect:{getText:Y.getText,getTextAnchor:Y.getTextAnchor,getAlignmentBaseline:Y.getAlignmentBaseline,styleVersion:a}}}),{data:l.attributes&&l.attributes.background?{length:l.length,attributes:l.attributes.background}:l,_dataDiff:c,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new Z({sdf:R.sdf,smoothing:Number.isFinite(R.smoothing)?R.smoothing:ss.smoothing,outlineWidth:P/(R.radius||ss.radius),outlineColor:O,iconAtlas:s,iconMapping:o,getPosition:u,getColor:f,getSize:h,getAngle:d,getPixelOffset:_,billboard:S,sizeScale:k*i,sizeUnits:D,sizeMinPixels:z*i,sizeMaxPixels:H*i,transitions:X&&{getPosition:X.getPosition,getAngle:X.getAngle,getColor:X.getColor,getSize:X.getSize,getPixelOffset:X.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:Y.getText,getPosition:Y.getPosition,getAngle:Y.getAngle,getColor:Y.getColor,getSize:Y.getSize,getPixelOffset:Y.getPixelOffset,getIconOffsets:{getTextAnchor:Y.getTextAnchor,getAlignmentBaseline:Y.getAlignmentBaseline,styleVersion:a}}}),{data:l,_dataDiff:c,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){g5(e)}};Su.defaultProps=w5,Su.layerName="TextLayer";let Bp=Su;const Yl={circle:{type:xp,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:Yc,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:Bp,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Kl={type:Ip,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},Lp={type:kp,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function eo({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function Uh(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const o=e[s];let a=t.props[s];s.startsWith("get")&&(a=t.getSubLayerAccessor(a),i.updateTriggers[o]=r[s],n&&(i.transitions[o]=n[s])),i[o]=a}return i}function S5(t){if(Array.isArray(t))return t;switch(J.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return J.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function Zv(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:s=t.length}=n;for(let o=i;o<s;o++){const a=t[o],{geometry:l}=a;if(l)if(l.type==="GeometryCollection"){J.assert(Array.isArray(l.geometries),"GeoJSON does not have geometries array");const{geometries:c}=l;for(let u=0;u<c.length;u++){const f=c[u];Qv(f,r,e,a,o)}}else Qv(l,r,e,a,o)}return r}function Qv(t,e,n,r,i){const{type:s,coordinates:o}=t,{pointFeatures:a,lineFeatures:l,polygonFeatures:c,polygonOutlineFeatures:u}=e;if(!b5(s,o)){J.warn(`${s} coordinates are malformed`)();return}switch(s){case"Point":a.push(n({geometry:t},r,i));break;case"MultiPoint":o.forEach(f=>{a.push(n({geometry:{type:"Point",coordinates:f}},r,i))});break;case"LineString":l.push(n({geometry:t},r,i));break;case"MultiLineString":o.forEach(f=>{l.push(n({geometry:{type:"LineString",coordinates:f}},r,i))});break;case"Polygon":c.push(n({geometry:t},r,i)),o.forEach(f=>{u.push(n({geometry:{type:"LineString",coordinates:f}},r,i))});break;case"MultiPolygon":o.forEach(f=>{c.push(n({geometry:{type:"Polygon",coordinates:f}},r,i)),f.forEach(h=>{u.push(n({geometry:{type:"LineString",coordinates:h}},r,i))})});break}}const E5={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function b5(t,e){let n=E5[t];for(J.assert(n,`Unknown GeoJSON type ${t}`);e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function wb(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function Al(t){return t.geometry.coordinates}function A5(t,e){const n=wb(),{pointFeatures:r,lineFeatures:i,polygonFeatures:s,polygonOutlineFeatures:o}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=Al,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=Al,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=Al,n.polygonsOutline.data=o,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=Al,n}function R5(t,e){const n=wb(),{points:r,lines:i,polygons:s}=t,o=G8(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:o.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:o.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const x5=["points","linestrings","polygons"],C5={...eo(Yl.circle),...eo(Yl.icon),...eo(Yl.text),...eo(Kl),...eo(Lp),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}},Eu=class Eu extends Xc{initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=R5(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=S5(e.data),i=this.getSubLayerRow.bind(this);let s={};const o={};if(Array.isArray(n.dataChanged)){const l=this.state.features;for(const c in l)s[c]=l[c].slice(),o[c]=[];for(const c of n.dataChanged){const u=Zv(r,i,c);for(const f in l)o[f].push(Z8({data:s[f],getIndex:h=>h.__source.index,dataRange:c,replace:u[f]}))}}else s=Zv(r,i);const a=A5(s,o);this.setState({features:s,featuresDiff:o,layerProps:a})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=x5.find(s=>i.id.startsWith(`${this.id}-${s}-`)),r>=0&&i.id.startsWith(`${this.id}-points-text`)&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n=`${this.id}-points-`,r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){var o;const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",s=this.shouldRenderSubLayer(i,(o=r.polygons)==null?void 0:o.data)&&this.getSubLayerClass(i,Lp.type);if(s){const a=Uh(this,Lp.props),l=e&&n;return l||delete a.getLineColor,a.updateTriggers.lineColors=l,new s(a,this.getSubLayerProps({id:i,updateTriggers:a.updateTriggers}),r.polygons)}return null}_renderLineLayers(){var l,c;const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",s="linestrings",o=!e&&n&&this.shouldRenderSubLayer(i,(l=r.polygonsOutline)==null?void 0:l.data)&&this.getSubLayerClass(i,Kl.type),a=this.shouldRenderSubLayer(s,(c=r.lines)==null?void 0:c.data)&&this.getSubLayerClass(s,Kl.type);if(o||a){const u=Uh(this,Kl.props);return[o&&new o(u,this.getSubLayerProps({id:i,updateTriggers:u.updateTriggers}),r.polygonsOutline),a&&new a(u,this.getSubLayerProps({id:s,updateTriggers:u.updateTriggers}),r.lines)]}return null}_renderPointLayers(){var a;const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(l=>l.__source.index===i));const s=new Set(e.split("+")),o=[];for(const l of s){const c=`points-${l}`,u=Yl[l],f=u&&this.shouldRenderSubLayer(c,(a=n.points)==null?void 0:a.data)&&this.getSubLayerClass(c,u.type);if(f){const h=Uh(this,u.props);let d=n.points;if(l==="text"&&r){const{instancePickingColors:_,...g}=d.data.attributes;d={...d,data:{...d.data,attributes:g}}}o.push(new f(h,this.getSubLayerProps({id:c,updateTriggers:h.updateTriggers,highlightedObjectIndex:i}),d))}}return o}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:s,index:o}=i,a=Q8(s,o);return e(a,i)}}};Eu.layerName="GeoJsonLayer",Eu.defaultProps=C5;let Zc=Eu;const zh=512,P5=Math.PI/180;function Sb({map:t,gl:e,deck:n}){if(t.__deck)return t.__deck;const r=n==null?void 0:n.props._customRender,i=n==null?void 0:n.props.onLoad,s=bb({...n==null?void 0:n.props,_customRender:()=>{t.triggerRepaint(),r==null||r("")}});let o;return(!n||n.props.gl===e)&&(Object.assign(s,{gl:e,width:null,height:null,touchAction:"unset",viewState:aa(t)}),n!=null&&n.isInitialized?Jv(n,t):s.onLoad=()=>{i==null||i(),Jv(o,t)}),n?(o=n,n.setProps(s),n.userData.isExternal=!0):(o=new ta(s),t.on("remove",()=>{Eb(t)})),o.userData.mapboxLayers=new Set,t.__deck=o,t.on("render",()=>{o.isInitialized&&F5(o,t)}),o}function Jv(t,e){const n=()=>{t.isInitialized?D5(t,e):e.off("move",n)};e.on("move",n)}function Eb(t){var e;(e=t.__deck)==null||e.finalize(),t.__deck=null}function bb(t){return{...t,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...t.parameters},views:t.views||[new jc({id:"mapbox"})]}}function I5(t,e){t.userData.mapboxLayers.add(e),I_(t)}function M5(t,e){t.userData.mapboxLayers.delete(e),I_(t)}function N5(t,e){I_(t)}function O5(t,e,n){let{currentViewport:r}=t.userData,i=!1;r||(r=Ab(t,e,!0),t.userData.currentViewport=r,i=!0),t.isInitialized&&t._drawLayers("mapbox-repaint",{viewports:[r],layerFilter:({layer:s})=>n.id===s.id||s.props.operation.includes("terrain"),clearStack:i,clearCanvas:!1})}function aa(t){var i;const{lng:e,lat:n}=t.getCenter(),r={longitude:(e+540)%360-180,latitude:n,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch(),padding:t.getPadding(),repeat:t.getRenderWorldCopies()};return(i=t.getTerrain)!=null&&i.call(t)&&k5(t,r),r}function k5(t,e){if(t.getFreeCameraOptions){const{position:n}=t.getFreeCameraOptions();if(!n||n.z===void 0)return;const r=t.transform.height,{longitude:i,latitude:s,pitch:o}=e,a=n.x*zh,l=(1-n.y)*zh,c=n.z*zh,u=Qo([i,s]),f=a-u[0],h=l-u[1],d=Math.sqrt(f*f+h*h),_=o*P5,g=1.5*r,b=_<.001?g*Math.cos(_)/c:g*Math.sin(_)/d;e.zoom=Math.log2(b);const m=g*Math.cos(_)/b,p=c-m;e.position=[0,0,p/jl(s)]}else typeof t.transform.elevation=="number"&&(e.position=[0,0,t.transform.elevation])}function Ab(t,e,n=!0){return new Jo({id:"mapbox",x:0,y:0,width:t.width,height:t.height,...aa(e),nearZMultiplier:n?.02:.1,nearZ:e.transform._nearZ/e.transform.height,farZ:e.transform._farZ/e.transform.height})}function F5(t,e){const{mapboxLayers:n,isExternal:r}=t.userData;if(r){const i=Array.from(n,u=>u.id),o=bs(t.props.layers,Boolean).some(u=>u&&!i.includes(u.id));let a=t.getViewports();const l=a.findIndex(u=>u.id==="mapbox"),c=a.length>1||l<0;(o||c)&&(l>=0&&(a=a.slice(),a[l]=Ab(t,e,!1)),t._drawLayers("mapbox-repaint",{viewports:a,layerFilter:u=>(!t.props.layerFilter||t.props.layerFilter(u))&&(u.viewport.id!=="mapbox"||!i.includes(u.layer.id)),clearCanvas:!1}))}t.userData.currentViewport=null}function D5(t,e){t.setProps({viewState:aa(e)}),t.needsRedraw({clearRedrawFlags:!0})}function I_(t){if(t.userData.isExternal)return;const e=[];t.userData.mapboxLayers.forEach(n=>{const r=n.props.type,i=new r(n.props);e.push(i)}),t.setProps({layers:e})}class B5{constructor(e){if(!e.id)throw new Error("Layer must have an unique id");this.id=e.id,this.type="custom",this.renderingMode=e.renderingMode||"3d",this.map=null,this.deck=null,this.props=e}onAdd(e,n){this.map=e,this.deck=Sb({map:e,gl:n,deck:this.props.deck}),I5(this.deck,this)}onRemove(){this.deck&&M5(this.deck,this)}setProps(e){Object.assign(this.props,e,{id:this.id}),this.deck&&N5(this.deck)}render(){O5(this.deck,this.map,this)}}const Vh="__UNDEFINED__";function Rl(t,e,n,r){if(!t||!e||!t.style||!t.style._loaded)return;const i=bs(r,Boolean);if(n!==r){const a=bs(n,Boolean),l=new Set(a.map(c=>c.id));for(const c of i)l.delete(c.id);for(const c of l)t.getLayer(c)&&t.removeLayer(c)}for(const a of i){const l=t.getLayer(a.id);l?(l.implementation||l).setProps(a.props):t.addLayer(new B5({id:a.id,deck:e}),a.props.beforeId)}const s=t.style._order,o={};for(const a of i){let{beforeId:l}=a.props;(!l||!s.includes(l))&&(l=Vh),o[l]=o[l]||[],o[l].push(a.id)}for(const a in o){const l=o[a];let c=a===Vh?s.length:s.indexOf(a),u=a===Vh?void 0:a;for(let f=l.length-1;f>=0;f--){const h=l[f],d=s.indexOf(h);d!==c-1&&(t.moveLayer(h,u),d>c&&c++),c--,u=h}}}class L5{constructor(e){this._handleStyleChange=()=>{Rl(this._map,this._deck,this._props.layers,this._props.layers)},this._updateContainerSize=()=>{if(this._map&&this._container){const{clientWidth:i,clientHeight:s}=this._map.getContainer();Object.assign(this._container.style,{width:`${i}px`,height:`${s}px`})}},this._updateViewState=()=>{const i=this._deck;i&&(i.setProps({viewState:aa(this._map)}),i.isInitialized&&i.redraw())},this._handleMouseEvent=i=>{const s=this._deck;if(!s||!s.isInitialized)return;const o={type:i.type,offsetCenter:i.point,srcEvent:i},a=this._lastMouseDownPoint;switch(!i.point&&a&&(o.deltaX=i.originalEvent.clientX-a.clientX,o.deltaY=i.originalEvent.clientY-a.clientY,o.offsetCenter={x:a.x+o.deltaX,y:a.y+o.deltaY}),o.type){case"mousedown":s._onPointerDown(o),this._lastMouseDownPoint={...i.point,clientX:i.originalEvent.clientX,clientY:i.originalEvent.clientY};break;case"dragstart":o.type="panstart",s._onEvent(o);break;case"drag":o.type="panmove",s._onEvent(o);break;case"dragend":o.type="panend",s._onEvent(o);break;case"click":o.tapCount=1,s._onEvent(o);break;case"dblclick":o.type="click",o.tapCount=2,s._onEvent(o);break;case"mousemove":o.type="pointermove",s._onPointerMove(o);break;case"mouseout":o.type="pointerleave",s._onPointerMove(o);break;default:return}};const{interleaved:n=!1,...r}=e;this._interleaved=n,this._props=r}setProps(e){this._interleaved&&e.layers&&Rl(this._map,this._deck,this._props.layers,e.layers),Object.assign(this._props,e),this._deck&&this._deck.setProps(this._interleaved?bb(this._props):this._props)}onAdd(e){return this._map=e,this._interleaved?this._onAddInterleaved(e):this._onAddOverlaid(e)}_onAddOverlaid(e){const n=document.createElement("div");return Object.assign(n.style,{position:"absolute",left:0,top:0,textAlign:"initial",pointerEvents:"none"}),this._container=n,this._deck=new ta({...this._props,parent:n,viewState:aa(e)}),e.on("resize",this._updateContainerSize),e.on("render",this._updateViewState),e.on("mousedown",this._handleMouseEvent),e.on("dragstart",this._handleMouseEvent),e.on("drag",this._handleMouseEvent),e.on("dragend",this._handleMouseEvent),e.on("mousemove",this._handleMouseEvent),e.on("mouseout",this._handleMouseEvent),e.on("click",this._handleMouseEvent),e.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),n}_onAddInterleaved(e){const n=e.painter.context.gl;return n instanceof WebGLRenderingContext&&J.warn("Incompatible basemap library. See: https://deck.gl/docs/api-reference/mapbox/overview#compatibility")(),this._deck=Sb({map:e,gl:n,deck:new ta({...this._props,gl:n})}),e.on("styledata",this._handleStyleChange),Rl(e,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){const e=this._map;e&&(this._interleaved?this._onRemoveInterleaved(e):this._onRemoveOverlaid(e)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(e){var n;e.off("resize",this._updateContainerSize),e.off("render",this._updateViewState),e.off("mousedown",this._handleMouseEvent),e.off("dragstart",this._handleMouseEvent),e.off("drag",this._handleMouseEvent),e.off("dragend",this._handleMouseEvent),e.off("mousemove",this._handleMouseEvent),e.off("mouseout",this._handleMouseEvent),e.off("click",this._handleMouseEvent),e.off("dblclick",this._handleMouseEvent),(n=this._deck)==null||n.finalize()}_onRemoveInterleaved(e){e.off("styledata",this._handleStyleChange),Rl(e,this._deck,this._props.layers,[]),Eb(e)}getDefaultPosition(){return"top-left"}pickObject(e){return Ce(this._deck),this._deck.pickObject(e)}pickMultipleObjects(e){return Ce(this._deck),this._deck.pickMultipleObjects(e)}pickObjects(e){return Ce(this._deck),this._deck.pickObjects(e)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}}function U5(t){return ne.createElement(ne.Fragment,null,ne.createElement(hn,{opened:t.opened,onClose:t.close,title:ne.createElement(ne.Fragment,null,ne.createElement(o_,null,"One street at time")),position:"right"},ne.createElement(wc,{my:"md"}),ne.createElement(Sn,null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."),ne.createElement(wc,{my:"md"}),ne.createElement(Tc,{gap:"xs"},ne.createElement(Sn,{size:"lg",fw:"500"},"Completed:"),ne.createElement(Sn,{size:"lg"}," 45.61%")),ne.createElement(Tc,{gap:"xs"},ne.createElement(Sn,{size:"lg",fw:"500"},"Walked:"),ne.createElement(Sn,{size:"lg"}," 1558km"))))}const z5="https://raw.githubusercontent.com/kkornakiewicz/walks-fe/main/edges.json",V5="https://raw.githubusercontent.com/kkornakiewicz/walks-fe/main/nodes.json",$5={latitude:41.38685633118305,longitude:2.1696874299405295,zoom:13,bearing:0,pitch:30},j5={fontSizes:{xs:F(10),sm:F(11),md:F(14),lg:F(16),xl:F(20)}},W5="https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json";function H5(t){return Cs(()=>new L5(t)).setProps(t),null}function X5(){const[t,{toggle:e,open:n,close:r}]=aP(!1),[i,s]=I.useState(null),[o,a]=I.useState(null),[l,c]=I.useState(null),[u,f]=I.useState(!0),[h,d]=I.useState(null),[_,g]=I.useState(null),b=S=>{S!=null?g(S.properties.osmid):g(null)},m=S=>S.properties.osmid===_?[112,41,99]:S.properties.visited===!0?[250,128,114,140]:[250,128,114,10],p=S=>S.properties.visited===!0?[0,0,0,20]:[0,0,0,180];I.useEffect(()=>{(async()=>{try{const R=await fetch(z5);if(!R.ok)throw new Error(`HTTP error! Status: ${R.status}`);const P=await R.json();a(P),f(!1)}catch(R){d(R.message),f(!1)}})()},[]),I.useEffect(()=>{(async()=>{try{const R=await fetch(V5);if(!R.ok)throw new Error(`HTTP error! Status: ${R.status}`);const P=await R.json();c(P),console.log(P),f(!1)}catch(R){d(R.message),f(!1)}})()},[]);const y=[new Zc({id:"map",data:o,getLineColor:m,getLineWidth:8,autoHighlight:!0,pickable:!0,onClick:S=>s(S.object),onHover:S=>b(S.object),updateTriggers:{getLineColor:[_]},beforeId:"watername_ocean"}),new Zc({id:"nodes",data:l,getLineColor:p,autoHighlight:!0,getLineWidth:10,beforeId:"watername_ocean"})];return ne.createElement(BS,{theme:j5},ne.createElement(Vt,{header:{height:60}},ne.createElement(Vt.Header,{withBorder:!1},ne.createElement(B2,{opened:t,toggle:e})),ne.createElement(Vt.Main,null,ne.createElement(U5,{opened:t,close:r,open:n}),ne.createElement(s_,{h:"100vh",fluid:!0,w:"100%",p:"0"},ne.createElement(qx,{initialViewState:$5,mapStyle:W5},i&&ne.createElement(Zx,{key:i.properties.osmid,style:{zIndex:10},longitude:i.geometry.coordinates[0][0],latitude:i.geometry.coordinates[0][1],maxWidth:"60em"},ne.createElement(Sn,null,i.properties.name)),ne.createElement(H5,{layers:y,useDevicePixels:!1}))))))}const Y5=document.body.appendChild(document.createElement("div"));uS(Y5).render(ne.createElement(X5,null));export{q5 as c,bu as g};
